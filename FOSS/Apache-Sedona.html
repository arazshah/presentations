<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¢Ù…ÙˆØ²Ø´ Ø¬Ø§Ù…Ø¹ Apache Sedona - Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø¯Ø± Ù…Ù‚ÛŒØ§Ø³ Ø¨Ø²Ø±Ú¯</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Highlight.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    
    <style>
        :root {
            --primary: #e25a1c;
            --primary-light: #ff7043;
            --primary-dark: #bf360c;
            --secondary: #1976d2;
            --accent: #00bcd4;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --bg-dark: #0d1117;
            --bg-card: #161b22;
            --bg-code: #1e2430;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --border-color: #30363d;
            --spark-yellow: #f5a623;
            --spark-orange: #e25a1c;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Vazirmatn', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.8;
            font-size: 16px;
        }
        
        /* Scroll Progress */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--spark-yellow));
            z-index: 9999;
            transition: width 0.1s;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            padding: 60px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
            border-bottom: 3px solid var(--primary);
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23e25a1c' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.5;
        }
        
        .header-content {
            position: relative;
            z-index: 1;
            max-width: 900px;
            margin: 0 auto;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .logo {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--primary), var(--spark-yellow));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            box-shadow: 0 10px 40px rgba(226, 90, 28, 0.3);
        }
        
        .header h1 {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--primary-light), var(--spark-yellow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header .subtitle {
            font-size: 1.3rem;
            color: var(--text-secondary);
            margin-bottom: 25px;
        }
        
        .header-badges {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .badge {
            background: rgba(226, 90, 28, 0.2);
            border: 1px solid var(--primary);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .badge.spark {
            background: rgba(245, 166, 35, 0.2);
            border-color: var(--spark-yellow);
        }
        
        .badge.geo {
            background: rgba(0, 188, 212, 0.2);
            border-color: var(--accent);
        }
        
        /* Navigation */
        .nav {
            background: var(--bg-card);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
        }
        
        .nav-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .nav-brand {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            color: var(--primary);
        }
        
        .nav-links {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            transition: all 0.3s;
        }
        
        .nav-link:hover, .nav-link.active {
            background: rgba(226, 90, 28, 0.2);
            color: var(--primary);
        }
        
        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        /* Table of Contents */
        .toc {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 50px;
            border: 1px solid var(--border-color);
        }
        
        .toc h2 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--primary);
        }
        
        .toc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }
        
        .toc-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: rgba(226, 90, 28, 0.05);
            border-radius: 10px;
            text-decoration: none;
            color: var(--text-primary);
            transition: all 0.3s;
            border: 1px solid transparent;
        }
        
        .toc-item:hover {
            background: rgba(226, 90, 28, 0.15);
            border-color: var(--primary);
            transform: translateX(-5px);
        }
        
        .toc-number {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary), var(--spark-yellow));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
        }
        
        .toc-text {
            flex: 1;
        }
        
        .toc-title {
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .toc-desc {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        /* Sections */
        .section {
            margin-bottom: 60px;
            padding: 40px;
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border-color);
        }
        
        .section-header {
            display: flex;
            align-items: flex-start;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
        }
        
        .section-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--spark-yellow));
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            flex-shrink: 0;
        }
        
        .section-number {
            font-size: 0.85rem;
            color: var(--primary);
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .section-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .section-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
        }
        
        /* Headings */
        h3 {
            font-size: 1.4rem;
            color: var(--primary-light);
            margin: 35px 0 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        h4 {
            font-size: 1.15rem;
            color: var(--text-primary);
            margin: 25px 0 15px;
        }
        
        /* Paragraphs */
        p {
            margin-bottom: 15px;
            color: var(--text-secondary);
        }
        
        /* Lists */
        ul, ol {
            margin: 15px 0;
            padding-right: 25px;
        }
        
        li {
            margin-bottom: 10px;
            color: var(--text-secondary);
        }
        
        li strong {
            color: var(--text-primary);
        }
        
        /* Info Boxes */
        .info-box {
            padding: 20px 25px;
            border-radius: 12px;
            margin: 25px 0;
            border-right: 4px solid;
        }
        
        .info-box.info {
            background: rgba(25, 118, 210, 0.1);
            border-color: var(--secondary);
        }
        
        .info-box.success {
            background: rgba(76, 175, 80, 0.1);
            border-color: var(--success);
        }
        
        .info-box.warning {
            background: rgba(255, 152, 0, 0.1);
            border-color: var(--warning);
        }
        
        .info-box.danger {
            background: rgba(244, 67, 54, 0.1);
            border-color: var(--danger);
        }
        
        .info-box.spark {
            background: rgba(226, 90, 28, 0.1);
            border-color: var(--primary);
        }
        
        .info-box-title {
            font-weight: 700;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-primary);
        }
        
        .info-box-content {
            color: var(--text-secondary);
        }
        
        .info-box-content ul {
            margin: 10px 0 0;
        }
        
        /* Code Blocks */
        .code-block {
            margin: 25px 0;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            background: var(--bg-code);
        }
        
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 20px;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid var(--border-color);
        }
        
        .code-lang {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .code-lang-icon {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        
        .code-lang-icon.python {
            background: #3776ab;
        }
        
        .code-lang-icon.scala {
            background: #dc322f;
        }
        
        .code-lang-icon.sql {
            background: #f29111;
        }
        
        .code-lang-icon.bash {
            background: #4eaa25;
        }
        
        .code-lang-icon.java {
            background: #ed8b00;
        }
        
        .code-actions {
            display: flex;
            gap: 8px;
        }
        
        .code-btn {
            background: rgba(226, 90, 28, 0.2);
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 5px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
            font-family: 'Vazirmatn', sans-serif;
        }
        
        .code-btn:hover {
            background: var(--primary);
            color: white;
        }
        
        .code-body {
            padding: 0;
            overflow-x: auto;
        }
        
        .code-body pre {
            margin: 0;
            padding: 20px;
            background: transparent !important;
        }
        
        .code-body code {
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            direction: ltr;
            text-align: left;
        }
        
        /* Tables */
        .table-container {
            overflow-x: auto;
            margin: 25px 0;
            border-radius: 12px;
            border: 1px solid var(--border-color);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        
        th, td {
            padding: 14px 18px;
            text-align: right;
            border-bottom: 1px solid var(--border-color);
        }
        
        th {
            background: rgba(226, 90, 28, 0.15);
            font-weight: 600;
            color: var(--primary-light);
        }
        
        tr:hover {
            background: rgba(226, 90, 28, 0.05);
        }
        
        td code {
            background: rgba(226, 90, 28, 0.2);
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.85rem;
            direction: ltr;
        }
        
        /* Architecture Box */
        .architecture-box {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 30px;
            margin: 25px 0;
            border: 1px solid var(--border-color);
        }
        
        .arch-title {
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
            color: var(--primary);
            font-size: 1.1rem;
        }
        
        .arch-flow {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .arch-box {
            background: linear-gradient(135deg, rgba(226, 90, 28, 0.2), rgba(245, 166, 35, 0.1));
            border: 1px solid var(--primary);
            border-radius: 12px;
            padding: 15px 25px;
            text-align: center;
            min-width: 120px;
        }
        
        .arch-box.spark {
            background: linear-gradient(135deg, rgba(245, 166, 35, 0.2), rgba(226, 90, 28, 0.1));
            border-color: var(--spark-yellow);
        }
        
        .arch-box.data {
            background: linear-gradient(135deg, rgba(0, 188, 212, 0.2), rgba(25, 118, 210, 0.1));
            border-color: var(--accent);
        }
        
        .arch-box.output {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(0, 150, 136, 0.1));
            border-color: var(--success);
        }
        
        .arch-box-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        .arch-box-label {
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .arch-arrow {
            color: var(--primary);
            font-size: 24px;
            font-weight: bold;
        }
        
        /* Comparison Grid */
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .comparison-card {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
        }
        
        .comparison-card.highlight {
            border-color: var(--primary);
            background: rgba(226, 90, 28, 0.05);
        }
        
        .comparison-card h4 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 0;
            color: var(--primary-light);
        }
        
        /* Feature Grid */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .feature-card {
            background: rgba(226, 90, 28, 0.05);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
            transition: all 0.3s;
        }
        
        .feature-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }
        
        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        
        .feature-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text-primary);
        }
        
        .feature-desc {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        /* Use Case Cards */
        .usecase-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .usecase-card {
            background: linear-gradient(135deg, rgba(226, 90, 28, 0.1), rgba(245, 166, 35, 0.05));
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
            transition: all 0.3s;
        }
        
        .usecase-card:hover {
            border-color: var(--primary);
            box-shadow: 0 8px 30px rgba(226, 90, 28, 0.2);
        }
        
        .usecase-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        
        .usecase-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text-primary);
        }
        
        .usecase-desc {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        /* Diagram */
        .diagram {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 30px;
            margin: 25px 0;
            text-align: center;
        }
        
        .diagram-title {
            font-weight: 700;
            margin-bottom: 25px;
            color: var(--primary);
        }
        
        .diagram-layers {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .diagram-layer {
            padding: 20px;
            border-radius: 10px;
            font-weight: 600;
            position: relative;
        }
        
        .diagram-layer.app {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
        }
        
        .diagram-layer.sedona {
            background: linear-gradient(135deg, var(--primary), var(--spark-yellow));
        }
        
        .diagram-layer.spark {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .diagram-layer.storage {
            background: linear-gradient(135deg, #06b6d4, #0891b2);
        }
        
        .diagram-layer-desc {
            font-size: 0.8rem;
            font-weight: 400;
            opacity: 0.9;
            margin-top: 5px;
        }
        
        /* Footer */
        .footer {
            background: var(--bg-card);
            padding: 50px 20px;
            margin-top: 60px;
            border-top: 1px solid var(--border-color);
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
        }
        
        .footer-section h4 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.1rem;
        }
        
        .footer-section ul {
            list-style: none;
            padding: 0;
        }
        
        .footer-section li {
            margin-bottom: 10px;
        }
        
        .footer-section a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-section a:hover {
            color: var(--primary);
        }
        
        .footer-bottom {
            max-width: 1200px;
            margin: 40px auto 0;
            padding-top: 30px;
            border-top: 1px solid var(--border-color);
            text-align: center;
            color: var(--text-secondary);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .section {
                padding: 25px;
            }
            
            .section-header {
                flex-direction: column;
                text-align: center;
            }
            
            .nav-links {
                display: none;
            }
            
            .arch-flow {
                flex-direction: column;
            }
            
            .arch-arrow {
                transform: rotate(90deg);
            }
        }
        
        /* Print Styles */
        @media print {
            .nav, .scroll-progress {
                display: none;
            }
            
            .section {
                break-inside: avoid;
                page-break-inside: avoid;
            }
            
            body {
                background: white;
                color: black;
            }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section {
            animation: fadeIn 0.5s ease-out;
        }
        
        /* Inline Code */
        code:not([class*="language-"]) {
            background: rgba(226, 90, 28, 0.2);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9em;
            direction: ltr;
            display: inline-block;
        }
    </style>
</head>
<body>
    <!-- Scroll Progress -->
    <div class="scroll-progress" id="scrollProgress"></div>
    
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo-container">
                <div class="logo">ğŸŒ</div>
            </div>
            <h1>Apache Sedona</h1>
            <p class="subtitle">
                Ù¾Ø±Ø¯Ø§Ø²Ø´ Ùˆ ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø¯Ø± Ù…Ù‚ÛŒØ§Ø³ Ø¨Ø²Ø±Ú¯ Ø¨Ø§ Apache Spark
            </p>
            <div class="header-badges">
                <span class="badge spark">
                    <span>âš¡</span> Apache Spark
                </span>
                <span class="badge">
                    <span>ğŸ—ºï¸</span> Geospatial
                </span>
                <span class="badge geo">
                    <span>ğŸ“Š</span> Big Data
                </span>
                <span class="badge">
                    <span>ğŸ</span> Python & Scala
                </span>
            </div>
        </div>
    </header>
    
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-content">
            <div class="nav-brand">
                <span>ğŸŒ</span>
                <span>Apache Sedona</span>
            </div>
            <div class="nav-links">
                <a href="#intro" class="nav-link">Ù…Ø¹Ø±ÙÛŒ</a>
                <a href="#architecture" class="nav-link">Ù…Ø¹Ù…Ø§Ø±ÛŒ</a>
                <a href="#installation" class="nav-link">Ù†ØµØ¨</a>
                <a href="#data-types" class="nav-link">Ø§Ù†ÙˆØ§Ø¹ Ø¯Ø§Ø¯Ù‡</a>
                <a href="#sql" class="nav-link">Spatial SQL</a>
                <a href="#operations" class="nav-link">Ø¹Ù…Ù„ÛŒØ§Øª</a>
                <a href="#visualization" class="nav-link">ØªØ¬Ø³Ù…</a>
                <a href="#optimization" class="nav-link">Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ</a>
                <a href="#projects" class="nav-link">Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§</a>
            </div>
        </div>
    </nav>
    
    <!-- Main Content -->
    <div class="container">
        <!-- Table of Contents -->
        <div class="toc">
            <h2>ğŸ“š ÙÙ‡Ø±Ø³Øª Ù…Ø·Ø§Ù„Ø¨</h2>
            <div class="toc-grid">
                <a href="#intro" class="toc-item">
                    <div class="toc-number">1</div>
                    <div class="toc-text">
                        <div class="toc-title">Ù…Ø¹Ø±ÙÛŒ Apache Sedona</div>
                        <div class="toc-desc">Ø¢Ø´Ù†Ø§ÛŒÛŒ Ø¨Ø§ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ùˆ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§</div>
                    </div>
                </a>
                <a href="#architecture" class="toc-item">
                    <div class="toc-number">2</div>
                    <div class="toc-text">
                        <div class="toc-title">Ù…Ø¹Ù…Ø§Ø±ÛŒ Ùˆ Ù…ÙØ§Ù‡ÛŒÙ…</div>
                        <div class="toc-desc">Ø³Ø§Ø®ØªØ§Ø± Ùˆ Ù†Ø­ÙˆÙ‡ Ú©Ø§Ø± Sedona</div>
                    </div>
                </a>
                <a href="#installation" class="toc-item">
                    <div class="toc-number">3</div>
                    <div class="toc-text">
                        <div class="toc-title">Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ</div>
                        <div class="toc-desc">Python, Scala, Docker</div>
                    </div>
                </a>
                <a href="#data-types" class="toc-item">
                    <div class="toc-number">4</div>
                    <div class="toc-text">
                        <div class="toc-title">Ø§Ù†ÙˆØ§Ø¹ Ø¯Ø§Ø¯Ù‡ Ù…Ú©Ø§Ù†ÛŒ</div>
                        <div class="toc-desc">Point, Polygon, Raster</div>
                    </div>
                </a>
                <a href="#io" class="toc-item">
                    <div class="toc-number">5</div>
                    <div class="toc-text">
                        <div class="toc-title">Ø®ÙˆØ§Ù†Ø¯Ù† Ùˆ Ù†ÙˆØ´ØªÙ† Ø¯Ø§Ø¯Ù‡</div>
                        <div class="toc-desc">Shapefile, GeoJSON, GeoParquet</div>
                    </div>
                </a>
                <a href="#sql" class="toc-item">
                    <div class="toc-number">6</div>
                    <div class="toc-text">
                        <div class="toc-title">Spatial SQL</div>
                        <div class="toc-desc">Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø¨Ø§ SQL</div>
                    </div>
                </a>
                <a href="#operations" class="toc-item">
                    <div class="toc-number">7</div>
                    <div class="toc-text">
                        <div class="toc-title">Ø¹Ù…Ù„ÛŒØ§Øª Ù…Ú©Ø§Ù†ÛŒ</div>
                        <div class="toc-desc">Join, Buffer, Intersection</div>
                    </div>
                </a>
                <a href="#raster" class="toc-item">
                    <div class="toc-number">8</div>
                    <div class="toc-text">
                        <div class="toc-title">Ù¾Ø±Ø¯Ø§Ø²Ø´ Raster</div>
                        <div class="toc-desc">ØªØµØ§ÙˆÛŒØ± Ù…Ø§Ù‡ÙˆØ§Ø±Ù‡â€ŒØ§ÛŒ Ùˆ GeoTIFF</div>
                    </div>
                </a>
                <a href="#visualization" class="toc-item">
                    <div class="toc-number">9</div>
                    <div class="toc-text">
                        <div class="toc-title">ØªØ¬Ø³Ù… Ø¯Ø§Ø¯Ù‡</div>
                        <div class="toc-desc">SedonaKepler, Folium</div>
                    </div>
                </a>
                <a href="#optimization" class="toc-item">
                    <div class="toc-number">10</div>
                    <div class="toc-text">
                        <div class="toc-title">Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯</div>
                        <div class="toc-desc">Indexing, Partitioning</div>
                    </div>
                </a>
                <a href="#ml" class="toc-item">
                    <div class="toc-number">11</div>
                    <div class="toc-text">
                        <div class="toc-title">ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù…Ø§Ø´ÛŒÙ† Ù…Ú©Ø§Ù†ÛŒ</div>
                        <div class="toc-desc">MLlib + Geospatial</div>
                    </div>
                </a>
                <a href="#projects" class="toc-item">
                    <div class="toc-number">12</div>
                    <div class="toc-text">
                        <div class="toc-title">Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒ</div>
                        <div class="toc-desc">Ù†Ù…ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒ</div>
                    </div>
                </a>
            </div>
        </div>

        <!-- Section 1: Introduction -->
        <section class="section" id="intro">
            <div class="section-header">
                <div class="section-icon">ğŸŒ</div>
                <div class="section-title-group">
                    <div class="section-number">ÙØµÙ„ Ø§ÙˆÙ„</div>
                    <h2 class="section-title">Ù…Ø¹Ø±ÙÛŒ Apache Sedona</h2>
                    <p class="section-subtitle">Ø³ÛŒØ³ØªÙ… Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø¯Ø± Ù…Ù‚ÛŒØ§Ø³ Ú©Ù„Ø§Ù†</p>
                </div>
            </div>

            <div class="info-box spark">
                <div class="info-box-title">
                    <span>ğŸŒ</span>
                    Apache Sedona Ú†ÛŒØ³ØªØŸ
                </div>
                <div class="info-box-content">
                    <strong>Apache Sedona</strong> (Ù‚Ø¨Ù„Ø§Ù‹ GeoSpark) ÛŒÚ© Ø³ÛŒØ³ØªÙ… Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø¯Ø± Ù…Ù‚ÛŒØ§Ø³ Ú©Ù„Ø§Ù† Ø§Ø³Øª Ú©Ù‡ 
                    Ø¨Ø± Ø±ÙˆÛŒ Apache Spark Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø§Ø³Øª. Ø§ÛŒÙ† Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ø§Ù…Ú©Ø§Ù† Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…ÛŒÙ„ÛŒØ§Ø±Ø¯Ù‡Ø§ Ø±Ú©ÙˆØ±Ø¯ Ù…Ú©Ø§Ù†ÛŒ Ø±Ø§ 
                    Ø¨Ù‡ ØµÙˆØ±Øª ØªÙˆØ²ÛŒØ¹â€ŒØ´Ø¯Ù‡ ÙØ±Ø§Ù‡Ù… Ù…ÛŒâ€ŒÚ©Ù†Ø¯.
                </div>
            </div>

            <h3>ğŸ¯ Ú†Ø±Ø§ Apache SedonaØŸ</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">âš¡</div>
                    <div class="feature-title">Ø³Ø±Ø¹Øª Ø¨Ø§Ù„Ø§</div>
                    <div class="feature-desc">
                        Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…ÙˆØ§Ø²ÛŒ Ø±ÙˆÛŒ Ú©Ù„Ø§Ø³ØªØ± Spark Ø¨Ø§ Ø¨Ù‡Ø±Ù‡â€ŒÚ¯ÛŒØ±ÛŒ Ø§Ø² 
                        Ø´Ø§Ø®Øµâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
                    </div>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">ğŸ“Š</div>
                    <div class="feature-title">Ù…Ù‚ÛŒØ§Ø³â€ŒÙ¾Ø°ÛŒØ±ÛŒ</div>
                    <div class="feature-desc">
                        Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…ÛŒÙ„ÛŒØ§Ø±Ø¯Ù‡Ø§ Ù†Ù‚Ø·Ù‡ Ùˆ Ù¾Ù„ÛŒÚ¯ÙˆÙ† Ø¨Ù‡ ØµÙˆØ±Øª 
                        ØªÙˆØ²ÛŒØ¹â€ŒØ´Ø¯Ù‡ Ø±ÙˆÛŒ ØµØ¯Ù‡Ø§ Ù†ÙˆØ¯
                    </div>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">ğŸ—„ï¸</div>
                    <div class="feature-title">Spatial SQL</div>
                    <div class="feature-desc">
                        Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ú©Ø§Ù…Ù„ Ø§Ø² ØªÙˆØ§Ø¨Ø¹ Ù…Ú©Ø§Ù†ÛŒ SQL 
                        Ø³Ø§Ø²Ú¯Ø§Ø± Ø¨Ø§ OGC
                    </div>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">ğŸ–¼ï¸</div>
                    <div class="feature-title">Vector + Raster</div>
                    <div class="feature-desc">
                        Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø±Ø¯Ø§Ø±ÛŒ Ùˆ 
                        ØªØµØ§ÙˆÛŒØ± Ù…Ø§Ù‡ÙˆØ§Ø±Ù‡â€ŒØ§ÛŒ
                    </div>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">ğŸ</div>
                    <div class="feature-title">Ú†Ù†Ø¯ Ø²Ø¨Ø§Ù†Ù‡</div>
                    <div class="feature-desc">
                        API Ø¨Ø±Ø§ÛŒ Python, Scala, Java Ùˆ 
                        R
                    </div>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">ğŸ”—</div>
                    <div class="feature-title">ÛŒÚ©Ù¾Ø§Ø±Ú†Ú¯ÛŒ</div>
                    <div class="feature-desc">
                        Ø§Ø¯ØºØ§Ù… Ø¨Ø§ Ø§Ú©ÙˆØ³ÛŒØ³ØªÙ… Spark Ø´Ø§Ù…Ù„ 
                        MLlib Ùˆ Streaming
                    </div>
                </div>
            </div>

            <h3>ğŸ“ˆ Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¨Ø§ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø±</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>ÙˆÛŒÚ˜Ú¯ÛŒ</th>
                            <th>Apache Sedona</th>
                            <th>PostGIS</th>
                            <th>GeoPandas</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Ù…Ù‚ÛŒØ§Ø³â€ŒÙ¾Ø°ÛŒØ±ÛŒ</td>
                            <td>âœ… Ù…ÛŒÙ„ÛŒØ§Ø±Ø¯Ù‡Ø§ Ø±Ú©ÙˆØ±Ø¯</td>
                            <td>âš ï¸ Ù…ÛŒÙ„ÛŒÙˆÙ†â€ŒÙ‡Ø§ Ø±Ú©ÙˆØ±Ø¯</td>
                            <td>âŒ Ù…Ø­Ø¯ÙˆØ¯ Ø¨Ù‡ RAM</td>
                        </tr>
                        <tr>
                            <td>Ù¾Ø±Ø¯Ø§Ø²Ø´ ØªÙˆØ²ÛŒØ¹â€ŒØ´Ø¯Ù‡</td>
                            <td>âœ… Ø¨Ù„Ù‡</td>
                            <td>âŒ Ø®ÛŒØ±</td>
                            <td>âŒ Ø®ÛŒØ±</td>
                        </tr>
                        <tr>
                            <td>Spatial SQL</td>
                            <td>âœ… Ú©Ø§Ù…Ù„</td>
                            <td>âœ… Ú©Ø§Ù…Ù„</td>
                            <td>âš ï¸ Ù…Ø­Ø¯ÙˆØ¯</td>
                        </tr>
                        <tr>
                            <td>Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Raster</td>
                            <td>âœ… Ø¨Ù„Ù‡</td>
                            <td>âœ… Ø¨Ù„Ù‡</td>
                            <td>âŒ Ø®ÛŒØ±</td>
                        </tr>
                        <tr>
                            <td>ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù…Ø§Ø´ÛŒÙ†</td>
                            <td>âœ… MLlib</td>
                            <td>âŒ Ø®ÛŒØ±</td>
                            <td>âš ï¸ Scikit-learn</td>
                        </tr>
                        <tr>
                            <td>Real-time</td>
                            <td>âœ… Spark Streaming</td>
                            <td>âŒ Ø®ÛŒØ±</td>
                            <td>âŒ Ø®ÛŒØ±</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>ğŸ­ Ù…ÙˆØ§Ø±Ø¯ Ø§Ø³ØªÙØ§Ø¯Ù‡</h3>
            <div class="usecase-grid">
                <div class="usecase-card">
                    <div class="usecase-icon">ğŸš—</div>
                    <div class="usecase-title">ØªØ­Ù„ÛŒÙ„ ØªØ±Ø§ÙÛŒÚ©</div>
                    <div class="usecase-desc">
                        Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…ÛŒÙ„ÛŒÙˆÙ†â€ŒÙ‡Ø§ Ù†Ù‚Ø·Ù‡ GPS Ø§Ø² ÙˆØ³Ø§ÛŒÙ„ Ù†Ù‚Ù„ÛŒÙ‡ 
                        Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ ØªØ±Ø§ÙÛŒÚ©ÛŒ
                    </div>
                </div>
                
                <div class="usecase-card">
                    <div class="usecase-icon">ğŸ›°ï¸</div>
                    <div class="usecase-title">ØªØµØ§ÙˆÛŒØ± Ù…Ø§Ù‡ÙˆØ§Ø±Ù‡â€ŒØ§ÛŒ</div>
                    <div class="usecase-desc">
                        Ù¾Ø±Ø¯Ø§Ø²Ø´ ØªØµØ§ÙˆÛŒØ± Landsat Ùˆ Sentinel 
                        Ø¯Ø± Ù…Ù‚ÛŒØ§Ø³ Ø³ÛŒØ§Ø±Ù‡â€ŒØ§ÛŒ
                    </div>
                </div>
                
                <div class="usecase-card">
                    <div class="usecase-icon">ğŸ™ï¸</div>
                    <div class="usecase-title">Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ±ÛŒØ²ÛŒ Ø´Ù‡Ø±ÛŒ</div>
                    <div class="usecase-desc">
                        ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¬Ù…Ø¹ÛŒØªÛŒ Ùˆ Ø²ÛŒØ±Ø³Ø§Ø®ØªÛŒ 
                        Ø¨Ø±Ø§ÛŒ Ø´Ù‡Ø±Ù‡Ø§ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯
                    </div>
                </div>
                
                <div class="usecase-card">
                    <div class="usecase-icon">ğŸŒ¾</div>
                    <div class="usecase-title">Ú©Ø´Ø§ÙˆØ±Ø²ÛŒ Ø¯Ù‚ÛŒÙ‚</div>
                    <div class="usecase-desc">
                        ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ù†Ø³ÙˆØ± Ùˆ Ù…Ø§Ù‡ÙˆØ§Ø±Ù‡ 
                        Ø¨Ø±Ø§ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª
                    </div>
                </div>
                
                <div class="usecase-card">
                    <div class="usecase-icon">ğŸ“¦</div>
                    <div class="usecase-title">Ù„Ø¬Ø³ØªÛŒÚ©</div>
                    <div class="usecase-desc">
                        Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù…Ø³ÛŒØ± Ùˆ ØªØ­Ù„ÛŒÙ„ Ø´Ø¨Ú©Ù‡ 
                        ØªÙˆØ²ÛŒØ¹ Ø¯Ø± Ù…Ù‚ÛŒØ§Ø³ Ø¨Ø²Ø±Ú¯
                    </div>
                </div>
                
                <div class="usecase-card">
                    <div class="usecase-icon">ğŸŒŠ</div>
                    <div class="usecase-title">Ù…Ø­ÛŒØ· Ø²ÛŒØ³Øª</div>
                    <div class="usecase-desc">
                        Ù¾Ø§ÛŒØ´ ØªØºÛŒÛŒØ±Ø§Øª Ø§Ù‚Ù„ÛŒÙ…ÛŒ Ùˆ 
                        Ø¬Ù†Ú¯Ù„â€ŒØ²Ø¯Ø§ÛŒÛŒ
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Architecture -->
        <section class="section" id="architecture">
            <div class="section-header">
                <div class="section-icon">ğŸ—ï¸</div>
                <div class="section-title-group">
                    <div class="section-number">ÙØµÙ„ Ø¯ÙˆÙ…</div>
                    <h2 class="section-title">Ù…Ø¹Ù…Ø§Ø±ÛŒ Ùˆ Ù…ÙØ§Ù‡ÛŒÙ…</h2>
                    <p class="section-subtitle">Ø³Ø§Ø®ØªØ§Ø± Ø¯Ø§Ø®Ù„ÛŒ Ùˆ Ù†Ø­ÙˆÙ‡ Ú©Ø§Ø± Apache Sedona</p>
                </div>
            </div>

            <h3>ğŸ“ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ú©Ù„ÛŒ</h3>
            <div class="diagram">
                <div class="diagram-title">ğŸ—ï¸ Ù„Ø§ÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ù…Ø¹Ù…Ø§Ø±ÛŒ Apache Sedona</div>
                <div class="diagram-layers">
                    <div class="diagram-layer app">
                        <div>ğŸ–¥ï¸ Application Layer</div>
                        <div class="diagram-layer-desc">Python / Scala / Java / R API</div>
                    </div>
                    <div class="diagram-layer sedona">
                        <div>ğŸŒ Apache Sedona</div>
                        <div class="diagram-layer-desc">Spatial SQL + RDD API + Visualization</div>
                    </div>
                    <div class="diagram-layer spark">
                        <div>âš¡ Apache Spark</div>
                        <div class="diagram-layer-desc">Distributed Computing Engine</div>
                    </div>
                    <div class="diagram-layer storage">
                        <div>ğŸ’¾ Storage Layer</div>
                        <div class="diagram-layer-desc">HDFS / S3 / GCS / Local</div>
                    </div>
                </div>
            </div>

            <h3>ğŸ§© Ø§Ø¬Ø²Ø§ÛŒ Ø§ØµÙ„ÛŒ</h3>
            <div class="comparison-grid">
                <div class="comparison-card highlight">
                    <h4>ğŸ—„ï¸ Sedona SQL</h4>
                    <ul>
                        <li>Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² ØªÙˆØ§Ø¨Ø¹ Ù…Ú©Ø§Ù†ÛŒ OGC</li>
                        <li>Ø¨ÛŒØ´ Ø§Ø² 200 ØªØ§Ø¨Ø¹ Ù…Ú©Ø§Ù†ÛŒ</li>
                        <li>Spatial Join Ø¨Ù‡ÛŒÙ†Ù‡</li>
                        <li>Ø³Ø§Ø²Ú¯Ø§Ø± Ø¨Ø§ Spark SQL</li>
                    </ul>
                </div>
                
                <div class="comparison-card">
                    <h4>ğŸ“¦ Sedona Core</h4>
                    <ul>
                        <li>Spatial RDD API</li>
                        <li>Ø´Ø§Ø®Øµâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ (R-Tree, Quad-Tree)</li>
                        <li>Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ú©Ø§Ù†ÛŒ</li>
                        <li>Ø³Ø±ÛŒØ§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡</li>
                    </ul>
                </div>
                
                <div class="comparison-card">
                    <h4>ğŸ–¼ï¸ Sedona Viz</h4>
                    <ul>
                        <li>Ø±Ù†Ø¯Ø± Ù†Ù‚Ø´Ù‡ ØªÙˆØ²ÛŒØ¹â€ŒØ´Ø¯Ù‡</li>
                        <li>Heatmap Ùˆ Choropleth</li>
                        <li>Ø§Ø¯ØºØ§Ù… Ø¨Ø§ Kepler.gl</li>
                        <li>Ø®Ø±ÙˆØ¬ÛŒ PNG/SVG</li>
                    </ul>
                </div>
            </div>

            <h3>âš™ï¸ Ù†Ø­ÙˆÙ‡ Ù¾Ø±Ø¯Ø§Ø²Ø´</h3>
            <div class="architecture-box">
                <div class="arch-title">ğŸ”„ Pipeline Ù¾Ø±Ø¯Ø§Ø²Ø´ Spatial Join</div>
                <div class="arch-flow">
                    <div class="arch-box data">
                        <div class="arch-box-icon">ğŸ“</div>
                        <div class="arch-box-label">Load Data</div>
                    </div>
                    <div class="arch-arrow">â†’</div>
                    <div class="arch-box">
                        <div class="arch-box-icon">ğŸ“</div>
                        <div class="arch-box-label">Parse Geometry</div>
                    </div>
                    <div class="arch-arrow">â†’</div>
                    <div class="arch-box spark">
                        <div class="arch-box-icon">ğŸ“Š</div>
                        <div class="arch-box-label">Partition</div>
                    </div>
                    <div class="arch-arrow">â†’</div>
                    <div class="arch-box">
                        <div class="arch-box-icon">ğŸŒ²</div>
                        <div class="arch-box-label">Build Index</div>
                    </div>
                    <div class="arch-arrow">â†’</div>
                    <div class="arch-box output">
                        <div class="arch-box-icon">ğŸ”—</div>
                        <div class="arch-box-label">Join</div>
                    </div>
                </div>
            </div>

            <h3>ğŸŒ² Ø´Ø§Ø®Øµâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ</h3>
            <div class="info-box info">
                <div class="info-box-title">
                    <span>ğŸ“š</span>
                    Ø§Ù†ÙˆØ§Ø¹ Ø´Ø§Ø®Øµâ€ŒÙ‡Ø§ÛŒ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø´Ø¯Ù‡
                </div>
                <div class="info-box-content">
                    <ul>
                        <li><strong>R-Tree:</strong> Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§ ØªÙˆØ²ÛŒØ¹ ÛŒÚ©Ù†ÙˆØ§Ø®ØªØŒ Ø³Ø±ÛŒØ¹ Ø¯Ø± range query</li>
                        <li><strong>Quad-Tree:</strong> Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù‚Ø·Ù‡â€ŒØ§ÛŒØŒ ØªÙ‚Ø³ÛŒÙ…â€ŒØ¨Ù†Ø¯ÛŒ ÙØ¶Ø§ÛŒÛŒ Ú†Ù‡Ø§Ø±Ú¯Ø§Ù†Ù‡</li>
                        <li><strong>KDB-Tree:</strong> ØªØ±Ú©ÛŒØ¨ K-D Tree Ùˆ B-TreeØŒ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ø¯ÛŒØ³Ú©</li>
                    </ul>
                </div>
            </div>

            <h3>ğŸ“¦ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ</th>
                            <th>ØªÙˆØ¶ÛŒØ­</th>
                            <th>Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>KDB</code></td>
                            <td>ØªÙ‚Ø³ÛŒÙ…â€ŒØ¨Ù†Ø¯ÛŒ Ù…ØªÙˆØ§Ø²Ù† Ø¨Ø± Ø§Ø³Ø§Ø³ KDB-Tree</td>
                            <td>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§ ØªÙˆØ²ÛŒØ¹ Ù†Ø§Ù…ØªÙˆØ§Ø²Ù†</td>
                        </tr>
                        <tr>
                            <td><code>QUADTREE</code></td>
                            <td>ØªÙ‚Ø³ÛŒÙ…â€ŒØ¨Ù†Ø¯ÛŒ Ú†Ù‡Ø§Ø±Ú¯Ø§Ù†Ù‡ ÙØ¶Ø§</td>
                            <td>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù‚Ø·Ù‡â€ŒØ§ÛŒ</td>
                        </tr>
                        <tr>
                            <td><code>RTREE</code></td>
                            <td>Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ R-Tree</td>
                            <td>Ù¾Ù„ÛŒÚ¯ÙˆÙ†â€ŒÙ‡Ø§ Ùˆ Ø®Ø·ÙˆØ·</td>
                        </tr>
                        <tr>
                            <td><code>VORONOI</code></td>
                            <td>ØªÙ‚Ø³ÛŒÙ…â€ŒØ¨Ù†Ø¯ÛŒ Voronoi</td>
                            <td>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ´Ù‡â€ŒØ§ÛŒ</td>
                        </tr>
                        <tr>
                            <td><code>HILBERT</code></td>
                            <td>Ù…Ù†Ø­Ù†ÛŒ Ù¾Ø±Ú©Ù†Ù†Ø¯Ù‡ ÙØ¶Ø§ Hilbert</td>
                            <td>Ø­ÙØ¸ locality</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 3: Installation -->
        <section class="section" id="installation">
            <div class="section-header">
                <div class="section-icon">ğŸ“¦</div>
                <div class="section-title-group">
                    <div class="section-number">ÙØµÙ„ Ø³ÙˆÙ…</div>
                    <h2 class="section-title">Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ</h2>
                    <p class="section-subtitle">Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ù…Ø­ÛŒØ· ØªÙˆØ³Ø¹Ù‡ Apache Sedona</p>
                </div>
            </div>

            <h3>ğŸ Ù†ØµØ¨ Ø¨Ø§ Python (PySpark)</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon bash">$</div>
                        <span>Terminal</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-bash"># Ù†ØµØ¨ Apache Sedona Ø¨Ø§ pip
pip install apache-sedona

# Ù†ØµØ¨ Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Spark
pip install apache-sedona[spark]

# Ù†ØµØ¨ Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ØªØ¬Ø³Ù… (Kepler.gl)
pip install apache-sedona[kepler]

# Ù†ØµØ¨ Ú©Ø§Ù…Ù„ Ø¨Ø§ Ù‡Ù…Ù‡ dependencies
pip install apache-sedona[all]

# Ù†ØµØ¨ Ù†Ø³Ø®Ù‡ Ø®Ø§Øµ
pip install apache-sedona==1.5.1</code></pre>
                </div>
            </div>

            <h3>âš¡ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ SparkSession Ø¨Ø§ Sedona</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>Python - sedona_setup.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">from sedona.spark import *

# Ø§ÛŒØ¬Ø§Ø¯ SparkSession Ø¨Ø§ Sedona
config = SedonaContext.builder() \
    .appName("Sedona Tutorial") \
    .master("local[*]") \
    .config("spark.serializer", "org.apache.spark.serializer.KryoSerializer") \
    .config("spark.kryo.registrator", "org.apache.sedona.core.serde.SedonaKryoRegistrator") \
    .config("spark.sql.extensions", "org.apache.sedona.viz.sql.SedonaVizExtensions,org.apache.sedona.sql.SedonaSqlExtensions") \
    .getOrCreate()

sedona = SedonaContext.create(config)

# Ø¨Ø±Ø±Ø³ÛŒ Ù†Ø³Ø®Ù‡
print(f"Spark Version: {sedona.version}")
print("Sedona is ready!")

# ØªØ³Øª Ø³Ø§Ø¯Ù‡
sedona.sql("SELECT ST_Point(51.3890, 35.6892) as tehran").show()

# Ø®Ø±ÙˆØ¬ÛŒ:
# +--------------------+
# |              tehran|
# +--------------------+
# |POINT (51.389 35....|
# +--------------------+</code></pre>
                </div>
            </div>

            <h3>ğŸ¯ Ù†ØµØ¨ Ø¨Ø§ Scala/SBT</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon scala">S</div>
                        <span>build.sbt</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-scala">// build.sbt
name := "sedona-project"
version := "1.0"
scalaVersion := "2.12.15"

val sparkVersion = "3.4.0"
val sedonaVersion = "1.5.1"

libraryDependencies ++= Seq(
  // Apache Spark
  "org.apache.spark" %% "spark-core" % sparkVersion,
  "org.apache.spark" %% "spark-sql" % sparkVersion,
  
  // Apache Sedona
  "org.apache.sedona" %% "sedona-spark-shaded-3.4" % sedonaVersion,
  "org.apache.sedona" % "sedona-viz-3.4_2.12" % sedonaVersion,
  
  // GeoTools for CRS transformations
  "org.datasyslab" % "geotools-wrapper" % "1.5.1-28.2"
)</code></pre>
                </div>
            </div>

            <h3>ğŸ³ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø¨Ø§ Docker</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon bash">ğŸ³</div>
                        <span>docker-compose.yml</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-yaml">version: '3.8'

services:
  spark-master:
    image: apache/sedona:latest
    container_name: sedona-master
    environment:
      - SPARK_MODE=master
      - SPARK_MASTER_HOST=spark-master
    ports:
      - "8080:8080"
      - "7077:7077"
      - "4040:4040"
    volumes:
      - ./data:/opt/spark/data
      - ./notebooks:/opt/spark/notebooks

  spark-worker:
    image: apache/sedona:latest
    container_name: sedona-worker
    environment:
      - SPARK_MODE=worker
      - SPARK_MASTER_URL=spark://spark-master:7077
      - SPARK_WORKER_MEMORY=4G
      - SPARK_WORKER_CORES=2
    depends_on:
      - spark-master
    volumes:
      - ./data:/opt/spark/data

  jupyter:
    image: apache/sedona:latest
    container_name: sedona-jupyter
    command: jupyter lab --ip=0.0.0.0 --port=8888 --allow-root --no-browser
    ports:
      - "8888:8888"
    environment:
      - SPARK_MASTER=spark://spark-master:7077
    volumes:
      - ./notebooks:/home/jovyan/work
      - ./data:/home/jovyan/data
    depends_on:
      - spark-master</code></pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon bash">$</div>
                        <span>Ø§Ø¬Ø±Ø§ÛŒ Docker</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-bash"># Ø§Ø¬Ø±Ø§ÛŒ Ú©Ù„Ø§Ø³ØªØ±
docker-compose up -d

# Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª
docker-compose ps

# Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„Ø§Ú¯â€ŒÙ‡Ø§
docker-compose logs -f spark-master

# Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Spark UI
# http://localhost:8080

# Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Jupyter
# http://localhost:8888</code></pre>
                </div>
            </div>

            <h3>â˜ï¸ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø±ÙˆÛŒ Databricks</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>Databricks Notebook</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># Ù†ØµØ¨ Sedona Ø±ÙˆÛŒ Databricks
# Ø¯Ø± Cluster Settings -> Libraries -> Install New -> PyPI:
# apache-sedona[spark]

# ÛŒØ§ Ø¨Ø§ dbutils
%pip install apache-sedona[spark]

# Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Sedona
from sedona.spark import *
from sedona.utils import SedonaKryoRegistrator, KryoSerializer

# Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² SparkSession Ù…ÙˆØ¬ÙˆØ¯ Databricks
sedona = SedonaContext.create(spark)

# Ø«Ø¨Øª ØªÙˆØ§Ø¨Ø¹ SQL
sedona.sql("SELECT ST_GeomFromWKT('POINT(51.389 35.689)') as geom").show()

# ØªØ³Øª Ø¹Ù…Ù„Ú©Ø±Ø¯
sedona.sql("""
    SELECT 
        ST_Distance(
            ST_Point(51.3890, 35.6892),
            ST_Point(51.4215, 35.6761)
        ) as distance_degrees
""").show()</code></pre>
                </div>
            </div>

            <h3>âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡ Spark</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>advanced_config.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">from sedona.spark import *
from pyspark.sql import SparkSession

def create_optimized_sedona_session(
    app_name: str = "Sedona App",
    master: str = "local[*]",
    memory: str = "8g",
    cores: int = 4
) -> SparkSession:
    """
    Ø§ÛŒØ¬Ø§Ø¯ SparkSession Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Sedona
    """
    
    config = SedonaContext.builder() \
        .appName(app_name) \
        .master(master) \
        \
        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø­Ø§ÙØ¸Ù‡ */ \
        .config("spark.driver.memory", memory) \
        .config("spark.executor.memory", memory) \
        .config("spark.memory.fraction", "0.8") \
        .config("spark.memory.storageFraction", "0.3") \
        \
        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø³Ø±ÛŒØ§Ù„â€ŒØ³Ø§Ø²ÛŒ */ \
        .config("spark.serializer", "org.apache.spark.serializer.KryoSerializer") \
        .config("spark.kryo.registrator", "org.apache.sedona.core.serde.SedonaKryoRegistrator") \
        .config("spark.kryoserializer.buffer.max", "512m") \
        \
        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª Sedona */ \
        .config("spark.sql.extensions", 
                "org.apache.sedona.viz.sql.SedonaVizExtensions,"
                "org.apache.sedona.sql.SedonaSqlExtensions") \
        \
        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø´Ø§Ø®Øµ Ù…Ú©Ø§Ù†ÛŒ */ \
        .config("sedona.global.index", "true") \
        .config("sedona.global.indextype", "rtree") \
        .config("sedona.join.gridtype", "kdbtree") \
        .config("sedona.join.numpartition", str(cores * 4)) \
        \
        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª Adaptive Query Execution */ \
        .config("spark.sql.adaptive.enabled", "true") \
        .config("spark.sql.adaptive.coalescePartitions.enabled", "true") \
        \
        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª I/O */ \
        .config("spark.sql.files.maxPartitionBytes", "128m") \
        .config("spark.sql.shuffle.partitions", str(cores * 4)) \
        \
        .getOrCreate()
    
    return SedonaContext.create(config)


# Ø§Ø³ØªÙØ§Ø¯Ù‡
sedona = create_optimized_sedona_session(
    app_name="GeoAnalysis",
    memory="16g",
    cores=8
)

print("âœ… Sedona Session Created Successfully!")</code></pre>
                </div>
            </div>

            <div class="info-box warning">
                <div class="info-box-title">
                    <span>âš ï¸</span>
                    Ù†Ú©Ø§Øª Ù…Ù‡Ù… Ù†ØµØ¨
                </div>
                <div class="info-box-content">
                    <ul>
                        <li>Ù†Ø³Ø®Ù‡ Sedona Ø¨Ø§ÛŒØ¯ Ø¨Ø§ Ù†Ø³Ø®Ù‡ Spark Ø³Ø§Ø²Ú¯Ø§Ø± Ø¨Ø§Ø´Ø¯ (Ù…Ø«Ù„Ø§Ù‹ Sedona 1.5.x Ø¨Ø§ Spark 3.4.x)</li>
                        <li>Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ØªØ¨Ø¯ÛŒÙ„ CRSØŒ Ø¨Ø§ÛŒØ¯ <code>geotools-wrapper</code> Ù†ØµØ¨ Ø´ÙˆØ¯</li>
                        <li>Ø¯Ø± Ù…Ø­ÛŒØ·â€ŒÙ‡Ø§ÛŒ ØªÙˆØ²ÛŒØ¹â€ŒØ´Ø¯Ù‡ØŒ JAR ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø¨Ø§ÛŒØ¯ Ø±ÙˆÛŒ Ù‡Ù…Ù‡ Ù†ÙˆØ¯Ù‡Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ø´Ù†Ø¯</li>
                        <li>Ø­Ø§ÙØ¸Ù‡ Kryo buffer Ø¨Ø§ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø²Ø±Ú¯ Ø§ÙØ²Ø§ÛŒØ´ ÛŒØ§Ø¨Ø¯</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Section 4: Data Types -->
        <section class="section" id="data-types">
            <div class="section-header">
                <div class="section-icon">ğŸ“</div>
                <div class="section-title-group">
                    <div class="section-number">ÙØµÙ„ Ú†Ù‡Ø§Ø±Ù…</div>
                    <h2 class="section-title">Ø§Ù†ÙˆØ§Ø¹ Ø¯Ø§Ø¯Ù‡ Ù…Ú©Ø§Ù†ÛŒ</h2>
                    <p class="section-subtitle">Geometry Types Ø¯Ø± Apache Sedona</p>
                </div>
            </div>

            <h3>ğŸ”· Ø§Ù†ÙˆØ§Ø¹ Ù‡Ù†Ø¯Ø³ÛŒ Ù¾Ø§ÛŒÙ‡</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Ù†ÙˆØ¹</th>
                            <th>ØªÙˆØ¶ÛŒØ­</th>
                            <th>Ù…Ø«Ø§Ù„ WKT</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>Point</code></td>
                            <td>ÛŒÚ© Ù†Ù‚Ø·Ù‡ Ø¯Ø± ÙØ¶Ø§</td>
                            <td><code>POINT(51.389 35.689)</code></td>
                        </tr>
                        <tr>
                            <td><code>LineString</code></td>
                            <td>Ø®Ø· Ù…ØªØ´Ú©Ù„ Ø§Ø² Ú†Ù†Ø¯ Ù†Ù‚Ø·Ù‡</td>
                            <td><code>LINESTRING(0 0, 1 1, 2 1)</code></td>
                        </tr>
                        <tr>
                            <td><code>Polygon</code></td>
                            <td>Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ Ø¨Ø³ØªÙ‡</td>
                            <td><code>POLYGON((0 0, 1 0, 1 1, 0 1, 0 0))</code></td>
                        </tr>
                        <tr>
                            <td><code>MultiPoint</code></td>
                            <td>Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ Ø§Ø² Ù†Ù‚Ø§Ø·</td>
                            <td><code>MULTIPOINT((0 0), (1 1))</code></td>
                        </tr>
                        <tr>
                            <td><code>MultiLineString</code></td>
                            <td>Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ Ø§Ø² Ø®Ø·ÙˆØ·</td>
                            <td><code>MULTILINESTRING((0 0, 1 1), (2 2, 3 3))</code></td>
                        </tr>
                        <tr>
                            <td><code>MultiPolygon</code></td>
                            <td>Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ Ø§Ø² Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒâ€ŒÙ‡Ø§</td>
                            <td><code>MULTIPOLYGON(((0 0, 1 0, 1 1, 0 0)))</code></td>
                        </tr>
                        <tr>
                            <td><code>GeometryCollection</code></td>
                            <td>Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ Ø§Ø² Ø§Ù†ÙˆØ§Ø¹ Ù…Ø®ØªÙ„Ù</td>
                            <td><code>GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1, 2 2))</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>ğŸ”¨ Ø§ÛŒØ¬Ø§Ø¯ Geometry</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>create_geometries.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">from sedona.spark import *

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§ÛŒØ¬Ø§Ø¯ Geometry Ø§Ø² WKT (Well-Known Text)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù†Ù‚Ø·Ù‡
sedona.sql("""
    SELECT ST_GeomFromWKT('POINT(51.3890 35.6892)') as tehran
""").show(truncate=False)

# Ø®Ø·
sedona.sql("""
    SELECT ST_GeomFromWKT('LINESTRING(51.33 35.70, 51.42 35.68, 51.45 35.75)') as road
""").show(truncate=False)

# Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ
sedona.sql("""
    SELECT ST_GeomFromWKT('POLYGON((
        51.35 35.65,
        51.45 35.65,
        51.45 35.75,
        51.35 35.75,
        51.35 35.65
    ))') as district
""").show(truncate=False)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§ÛŒØ¬Ø§Ø¯ Geometry Ø§Ø² Ù…Ø®ØªØµØ§Øª
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù†Ù‚Ø·Ù‡ Ø§Ø² Ù…Ø®ØªØµØ§Øª
sedona.sql("""
    SELECT ST_Point(51.3890, 35.6892) as point
""").show()

# Ù†Ù‚Ø·Ù‡ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ
sedona.sql("""
    SELECT ST_PointZ(51.3890, 35.6892, 1200) as point_3d
""").show()

# Ø®Ø· Ø§Ø² Ù†Ù‚Ø§Ø·
sedona.sql("""
    SELECT ST_MakeLine(
        ST_Point(51.33, 35.70),
        ST_Point(51.42, 35.68)
    ) as line
""").show()

# Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ Ø§Ø² Ø®Ø· Ø¨Ø³ØªÙ‡
sedona.sql("""
    SELECT ST_MakePolygon(
        ST_GeomFromWKT('LINESTRING(0 0, 1 0, 1 1, 0 1, 0 0)')
    ) as polygon
""").show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§ÛŒØ¬Ø§Ø¯ Geometry Ø§Ø² GeoJSON
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

sedona.sql("""
    SELECT ST_GeomFromGeoJSON('{
        "type": "Polygon",
        "coordinates": [[[51.35, 35.65], [51.45, 35.65], [51.45, 35.75], [51.35, 35.75], [51.35, 35.65]]]
    }') as geojson_polygon
""").show(truncate=False)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§ÛŒØ¬Ø§Ø¯ Geometry Ø§Ø² WKB (Well-Known Binary)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

sedona.sql("""
    SELECT ST_GeomFromWKB(
        ST_AsBinary(ST_Point(51.389, 35.689))
    ) as from_wkb
""").show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§ÛŒØ¬Ø§Ø¯ DataFrame Ø¨Ø§ Ø³ØªÙˆÙ† Geometry
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

from pyspark.sql.types import StructType, StructField, StringType, DoubleType

# Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡
data = [
    ("ØªÙ‡Ø±Ø§Ù†", 51.3890, 35.6892),
    ("Ø§ØµÙÙ‡Ø§Ù†", 51.6550, 32.6546),
    ("Ø´ÛŒØ±Ø§Ø²", 52.5836, 29.5918),
    ("ØªØ¨Ø±ÛŒØ²", 46.2919, 38.0800),
    ("Ù…Ø´Ù‡Ø¯", 59.5794, 36.2605)
]

schema = StructType([
    StructField("city", StringType(), True),
    StructField("longitude", DoubleType(), True),
    StructField("latitude", DoubleType(), True)
])

df = sedona.createDataFrame(data, schema)

# Ø§ÙØ²ÙˆØ¯Ù† Ø³ØªÙˆÙ† Geometry
cities_df = df.selectExpr(
    "city",
    "ST_Point(longitude, latitude) as location"
)

cities_df.show()
cities_df.printSchema()

# Ø®Ø±ÙˆØ¬ÛŒ:
# +-------+--------------------+
# |   city|            location|
# +-------+--------------------+
# | ØªÙ‡Ø±Ø§Ù†|POINT (51.389 35...|
# |Ø§ØµÙÙ‡Ø§Ù†|POINT (51.655 32...|
# | Ø´ÛŒØ±Ø§Ø²|POINT (52.5836 2...|
# | ØªØ¨Ø±ÛŒØ²|POINT (46.2919 3...|
# |  Ù…Ø´Ù‡Ø¯|POINT (59.5794 3...|
# +-------+--------------------+</code></pre>
                </div>
            </div>

            <h3>ğŸ“ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø² Geometry</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>geometry_properties.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø®ØªØµØ§Øª
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

sedona.sql("""
    SELECT 
        ST_X(ST_Point(51.389, 35.689)) as longitude,
        ST_Y(ST_Point(51.389, 35.689)) as latitude
""").show()

# Ø¨Ø±Ø§ÛŒ Ù†Ù‚Ø§Ø· Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ
sedona.sql("""
    SELECT 
        ST_Z(ST_PointZ(51.389, 35.689, 1200)) as elevation
""").show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù‡Ù†Ø¯Ø³ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

sedona.sql("""
    WITH polygon AS (
        SELECT ST_GeomFromWKT('POLYGON((0 0, 10 0, 10 10, 0 10, 0 0))') as geom
    )
    SELECT 
        ST_Area(geom) as area,
        ST_Perimeter(geom) as perimeter,
        ST_Centroid(geom) as centroid,
        ST_Envelope(geom) as bounding_box,
        ST_NumPoints(geom) as num_points,
        ST_GeometryType(geom) as geom_type,
        ST_IsValid(geom) as is_valid,
        ST_IsSimple(geom) as is_simple,
        ST_IsClosed(ST_ExteriorRing(geom)) as is_closed
    FROM polygon
""").show(truncate=False)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ØªØ¨Ø¯ÛŒÙ„ ÙØ±Ù…Øª
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

sedona.sql("""
    WITH point AS (
        SELECT ST_Point(51.389, 35.689) as geom
    )
    SELECT 
        ST_AsText(geom) as wkt,
        ST_AsGeoJSON(geom) as geojson,
        ST_AsEWKT(geom) as ewkt
    FROM point
""").show(truncate=False)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Bounding Box
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

sedona.sql("""
    WITH line AS (
        SELECT ST_GeomFromWKT('LINESTRING(0 0, 5 5, 10 0)') as geom
    )
    SELECT 
        ST_XMin(geom) as x_min,
        ST_XMax(geom) as x_max,
        ST_YMin(geom) as y_min,
        ST_YMax(geom) as y_max
    FROM line
""").show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§Ø¬Ø²Ø§ÛŒ Geometry
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù†Ù‚Ø§Ø· Ø§Ø² Ø®Ø·
sedona.sql("""
    WITH line AS (
        SELECT ST_GeomFromWKT('LINESTRING(0 0, 5 5, 10 0)') as geom
    )
    SELECT 
        ST_StartPoint(geom) as start_point,
        ST_EndPoint(geom) as end_point,
        ST_PointN(geom, 2) as second_point,
        ST_NumPoints(geom) as total_points
    FROM line
""").show()

# Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø­Ù„Ù‚Ù‡â€ŒÙ‡Ø§ Ø§Ø² Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ
sedona.sql("""
    WITH polygon AS (
        SELECT ST_GeomFromWKT('POLYGON((0 0, 10 0, 10 10, 0 10, 0 0), (2 2, 8 2, 8 8, 2 8, 2 2))') as geom
    )
    SELECT 
        ST_ExteriorRing(geom) as exterior,
        ST_NumInteriorRings(geom) as num_holes,
        ST_InteriorRingN(geom, 1) as first_hole
    FROM polygon
""").show(truncate=False)</code></pre>
                </div>
            </div>

            <h3>ğŸ–¼ï¸ Ø§Ù†ÙˆØ§Ø¹ Ø¯Ø§Ø¯Ù‡ Raster</h3>
            <div class="info-box info">
                <div class="info-box-title">
                    <span>ğŸ–¼ï¸</span>
                    Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Raster Ø¯Ø± Sedona
                </div>
                <div class="info-box-content">
                    Apache Sedona Ø§Ø² Ù†Ø³Ø®Ù‡ 1.4 Ø¨Ù‡ Ø¨Ø¹Ø¯ Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Raster Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯:
                    <ul>
                        <li><strong>GeoTIFF:</strong> ÙØ±Ù…Øª Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ ØªØµØ§ÙˆÛŒØ± Ù…Ø§Ù‡ÙˆØ§Ø±Ù‡â€ŒØ§ÛŒ</li>
                        <li><strong>NetCDF:</strong> Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¢Ø¨ Ùˆ Ù‡ÙˆØ§ÛŒÛŒ</li>
                        <li><strong>ArcGrid:</strong> ÙØ±Ù…Øª ESRI</li>
                        <li><strong>RS_* Functions:</strong> ØªÙˆØ§Ø¨Ø¹ Ù¾Ø±Ø¯Ø§Ø²Ø´ Raster</li>
                    </ul>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>raster_basics.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># Ø®ÙˆØ§Ù†Ø¯Ù† ÙØ§ÛŒÙ„ GeoTIFF
raster_df = sedona.read.format("binaryFile") \
    .load("path/to/satellite_image.tif") \
    .selectExpr("RS_FromGeoTiff(content) as raster")

# Ø§Ø·Ù„Ø§Ø¹Ø§Øª Raster
raster_df.selectExpr(
    "RS_NumBands(raster) as num_bands",
    "RS_Width(raster) as width",
    "RS_Height(raster) as height",
    "RS_Envelope(raster) as extent",
    "RS_SRID(raster) as srid"
).show()

# Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ù‚Ø¯Ø§Ø± Ù¾ÛŒÚ©Ø³Ù„
sedona.sql("""
    SELECT RS_Value(raster, 100, 100) as pixel_value
    FROM raster_table
""").show()

# ØªØ¨Ø¯ÛŒÙ„ Raster Ø¨Ù‡ Vector (Polygonize)
sedona.sql("""
    SELECT RS_AsPolygon(raster, 1) as polygons
    FROM raster_table
""").show()</code></pre>
                </div>
            </div>
        </section>

        <!-- Section 5: I/O -->
        <section class="section" id="io">
            <div class="section-header">
                <div class="section-icon">ğŸ“</div>
                <div class="section-title-group">
                    <div class="section-number">ÙØµÙ„ Ù¾Ù†Ø¬Ù…</div>
                    <h2 class="section-title">Ø®ÙˆØ§Ù†Ø¯Ù† Ùˆ Ù†ÙˆØ´ØªÙ† Ø¯Ø§Ø¯Ù‡</h2>
                    <p class="section-subtitle">ÙØ±Ù…Øªâ€ŒÙ‡Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ Ùˆ Ø®Ø±ÙˆØ¬ÛŒ Ø¯Ø± Sedona</p>
                </div>
            </div>

            <h3>ğŸ“‚ ÙØ±Ù…Øªâ€ŒÙ‡Ø§ÛŒ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø´Ø¯Ù‡</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>ÙØ±Ù…Øª</th>
                            <th>Ø®ÙˆØ§Ù†Ø¯Ù†</th>
                            <th>Ù†ÙˆØ´ØªÙ†</th>
                            <th>ØªÙˆØ¶ÛŒØ­</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>GeoParquet</code></td>
                            <td>âœ…</td>
                            <td>âœ…</td>
                            <td>ÙØ±Ù…Øª Ø¨Ù‡ÛŒÙ†Ù‡ Ø¨Ø±Ø§ÛŒ Big Data (ØªÙˆØµÛŒÙ‡ Ø´Ø¯Ù‡)</td>
                        </tr>
                        <tr>
                            <td><code>Shapefile</code></td>
                            <td>âœ…</td>
                            <td>âœ…</td>
                            <td>ÙØ±Ù…Øª Ú©Ù„Ø§Ø³ÛŒÚ© GIS</td>
                        </tr>
                        <tr>
                            <td><code>GeoJSON</code></td>
                            <td>âœ…</td>
                            <td>âœ…</td>
                            <td>ÙØ±Ù…Øª Ù…ØªÙ†ÛŒ JSON</td>
                        </tr>
                        <tr>
                            <td><code>WKT/WKB</code></td>
                            <td>âœ…</td>
                            <td>âœ…</td>
                            <td>ÙØ±Ù…Øª Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ OGC</td>
                        </tr>
                        <tr>
                            <td><code>GeoTIFF</code></td>
                            <td>âœ…</td>
                            <td>âœ…</td>
                            <td>ØªØµØ§ÙˆÛŒØ± Raster</td>
                        </tr>
                        <tr>
                            <td><code>CSV Ø¨Ø§ WKT</code></td>
                            <td>âœ…</td>
                            <td>âœ…</td>
                            <td>CSV Ø¨Ø§ Ø³ØªÙˆÙ† Ù‡Ù†Ø¯Ø³ÛŒ</td>
                        </tr>
                        <tr>
                            <td><code>NetCDF</code></td>
                            <td>âœ…</td>
                            <td>âŒ</td>
                            <td>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù„Ù…ÛŒ</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>ğŸ“– Ø®ÙˆØ§Ù†Ø¯Ù† Shapefile</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>read_shapefile.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">from sedona.spark import *

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø®ÙˆØ§Ù†Ø¯Ù† Shapefile
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø±ÙˆØ´ 1: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ShapefileReader
from sedona.core.formatMapper.shapefileParser import ShapefileReader

shapefile_rdd = ShapefileReader.readToGeometryRDD(
    sedona.sparkContext,
    "path/to/shapefile_folder"
)

# ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ DataFrame
shapefile_df = sedona.createDataFrame(
    shapefile_rdd.rawSpatialRDD.map(lambda x: (x.geom, x.getUserData())),
    ["geometry", "attributes"]
)

# Ø±ÙˆØ´ 2: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Spark DataSource
shapefile_df = sedona.read.format("shapefile") \
    .load("path/to/shapefile_folder")

shapefile_df.show()
shapefile_df.printSchema()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø®ÙˆØ§Ù†Ø¯Ù† Ú†Ù†Ø¯ÛŒÙ† Shapefile
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø®ÙˆØ§Ù†Ø¯Ù† Ù‡Ù…Ù‡ shapefiles Ø§Ø² ÛŒÚ© Ø¯Ø§ÛŒØ±Ú©ØªÙˆØ±ÛŒ
all_shapefiles = sedona.read.format("shapefile") \
    .option("recursiveFileLookup", "true") \
    .load("path/to/shapefiles_directory/")

print(f"Total records: {all_shapefiles.count()}")</code></pre>
                </div>
            </div>

            <h3>ğŸ“– Ø®ÙˆØ§Ù†Ø¯Ù† GeoJSON</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>read_geojson.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø®ÙˆØ§Ù†Ø¯Ù† GeoJSON
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø±ÙˆØ´ 1: Ø®ÙˆØ§Ù†Ø¯Ù† Ù…Ø³ØªÙ‚ÛŒÙ…
geojson_df = sedona.read.format("geojson") \
    .load("path/to/data.geojson")

# Ø±ÙˆØ´ 2: Ø®ÙˆØ§Ù†Ø¯Ù† JSON Ùˆ ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Geometry
json_df = sedona.read.json("path/to/data.geojson")

# Ø§Ø³ØªØ®Ø±Ø§Ø¬ features
features_df = json_df.selectExpr(
    "explode(features) as feature"
).selectExpr(
    "ST_GeomFromGeoJSON(to_json(feature.geometry)) as geometry",
    "feature.properties.*"
)

features_df.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø®ÙˆØ§Ù†Ø¯Ù† GeoJSON Ø§Ø² URL
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

import requests

# Ø¯Ø§Ù†Ù„ÙˆØ¯ GeoJSON
url = "https://example.com/data.geojson"
response = requests.get(url)

# Ø°Ø®ÛŒØ±Ù‡ Ù…ÙˆÙ‚Øª
with open("/tmp/data.geojson", "w") as f:
    f.write(response.text)

# Ø®ÙˆØ§Ù†Ø¯Ù†
geojson_df = sedona.read.format("geojson") \
    .load("/tmp/data.geojson")</code></pre>
                </div>
            </div>

            <h3>ğŸ“– Ø®ÙˆØ§Ù†Ø¯Ù† GeoParquet (ØªÙˆØµÛŒÙ‡ Ø´Ø¯Ù‡)</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>read_geoparquet.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø®ÙˆØ§Ù†Ø¯Ù† GeoParquet
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# GeoParquet Ø¨Ù‡ØªØ±ÛŒÙ† ÙØ±Ù…Øª Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø²Ø±Ú¯ Ø§Ø³Øª
geoparquet_df = sedona.read.format("geoparquet") \
    .load("path/to/data.parquet")

# Ø®ÙˆØ§Ù†Ø¯Ù† Ø§Ø² S3
s3_df = sedona.read.format("geoparquet") \
    .load("s3a://bucket/path/to/data.parquet")

# Ø®ÙˆØ§Ù†Ø¯Ù† Ø§Ø² HDFS
hdfs_df = sedona.read.format("geoparquet") \
    .load("hdfs://namenode:8020/path/to/data.parquet")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø®ÙˆØ§Ù†Ø¯Ù† Ø¨Ø§ ÙÛŒÙ„ØªØ± (Predicate Pushdown)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ÙÛŒÙ„ØªØ± Ù…Ú©Ø§Ù†ÛŒ Ø¯Ø± Ø³Ø·Ø­ Ø®ÙˆØ§Ù†Ø¯Ù† - Ø¨Ø³ÛŒØ§Ø± Ø³Ø±ÛŒØ¹!
filtered_df = sedona.read.format("geoparquet") \
    .load("path/to/large_data.parquet") \
    .filter("ST_Within(geometry, ST_GeomFromWKT('POLYGON((51 35, 52 35, 52 36, 51 36, 51 35))'))")

print(f"Filtered records: {filtered_df.count()}")</code></pre>
                </div>
            </div>

            <h3>ğŸ“– Ø®ÙˆØ§Ù†Ø¯Ù† CSV Ø¨Ø§ Ù…Ø®ØªØµØ§Øª</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>read_csv.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø®ÙˆØ§Ù†Ø¯Ù† CSV Ø¨Ø§ Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ lat/lon
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

csv_df = sedona.read.csv("path/to/points.csv", header=True, inferSchema=True)

# ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Geometry
points_df = csv_df.selectExpr(
    "*",
    "ST_Point(CAST(longitude AS DOUBLE), CAST(latitude AS DOUBLE)) as geometry"
)

points_df.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø®ÙˆØ§Ù†Ø¯Ù† CSV Ø¨Ø§ Ø³ØªÙˆÙ† WKT
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

wkt_csv_df = sedona.read.csv("path/to/polygons.csv", header=True)

polygons_df = wkt_csv_df.selectExpr(
    "*",
    "ST_GeomFromWKT(wkt_column) as geometry"
)

polygons_df.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø®ÙˆØ§Ù†Ø¯Ù† CSV Ø¨Ø²Ø±Ú¯ Ø¨Ø§ Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

large_csv_df = sedona.read \
    .option("header", "true") \
    .option("inferSchema", "true") \
    .csv("path/to/large_file.csv") \
    .repartition(100)  # Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…ÙˆØ§Ø²ÛŒ

# ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Geometry Ùˆ Ú©Ø´ Ú©Ø±Ø¯Ù†
large_points_df = large_csv_df.selectExpr(
    "*",
    "ST_Point(longitude, latitude) as geometry"
).cache()

print(f"Total points: {large_points_df.count()}")</code></pre>
                </div>
            </div>

            <h3>ğŸ’¾ Ù†ÙˆØ´ØªÙ† Ø¯Ø§Ø¯Ù‡</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>write_data.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù†ÙˆØ´ØªÙ† GeoParquet (ØªÙˆØµÛŒÙ‡ Ø´Ø¯Ù‡)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

df.write.format("geoparquet") \
    .mode("overwrite") \
    .save("path/to/output.parquet")

# Ø¨Ø§ ÙØ´Ø±Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ
df.write.format("geoparquet") \
    .option("compression", "zstd") \
    .mode("overwrite") \
    .save("path/to/output_compressed.parquet")

# Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø³ØªÙˆÙ†
df.write.format("geoparquet") \
    .partitionBy("province", "city") \
    .mode("overwrite") \
    .save("path/to/partitioned_output/")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù†ÙˆØ´ØªÙ† GeoJSON
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ØªØ¨Ø¯ÛŒÙ„ Geometry Ø¨Ù‡ GeoJSON string
geojson_df = df.selectExpr(
    "ST_AsGeoJSON(geometry) as geometry",
    "* EXCEPT geometry"
)

geojson_df.write.json("path/to/output.geojson")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù†ÙˆØ´ØªÙ† Shapefile
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

df.write.format("shapefile") \
    .mode("overwrite") \
    .save("path/to/output_shapefile/")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù†ÙˆØ´ØªÙ† CSV Ø¨Ø§ WKT
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

csv_output_df = df.selectExpr(
    "ST_AsText(geometry) as wkt",
    "* EXCEPT geometry"
)

csv_output_df.write \
    .option("header", "true") \
    .csv("path/to/output.csv")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù†ÙˆØ´ØªÙ† Ø¨Ù‡ Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# PostgreSQL/PostGIS
df.selectExpr(
    "ST_AsText(geometry) as geom_wkt",
    "* EXCEPT geometry"
).write \
    .format("jdbc") \
    .option("url", "jdbc:postgresql://localhost:5432/gisdb") \
    .option("dbtable", "spatial_data") \
    .option("user", "postgres") \
    .option("password", "password") \
    .mode("overwrite") \
    .save()</code></pre>
                </div>
            </div>

            <div class="info-box success">
                <div class="info-box-title">
                    <span>ğŸ’¡</span>
                    Ø¨Ù‡ØªØ±ÛŒÙ† Ø´ÛŒÙˆÙ‡â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ I/O
                </div>
                <div class="info-box-content">
                    <ul>
                        <li><strong>GeoParquet Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯:</strong> Ø³Ø±ÛŒØ¹â€ŒØªØ±ÛŒÙ† ÙØ±Ù…Øª Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù†/Ù†ÙˆØ´ØªÙ† Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² predicate pushdown</li>
                        <li><strong>Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ:</strong> Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø²Ø±Ú¯ Ø±Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ù†Ø·Ù‚Ù‡ Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒ Ù¾Ø§Ø±ØªÛŒØ´Ù† Ú©Ù†ÛŒØ¯</li>
                        <li><strong>ÙØ´Ø±Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ:</strong> Ø§Ø² Zstd ÛŒØ§ Snappy Ø¨Ø±Ø§ÛŒ Ú©Ø§Ù‡Ø´ Ø­Ø¬Ù… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                        <li><strong>Ú©Ø´ Ú©Ø±Ø¯Ù†:</strong> DataFrame Ù‡Ø§ÛŒ Ù¾Ø±Ú©Ø§Ø±Ø¨Ø±Ø¯ Ø±Ø§ cache Ú©Ù†ÛŒØ¯</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Section 6: Spatial SQL -->
        <section class="section" id="sql">
            <div class="section-header">
                <div class="section-icon">ğŸ—„ï¸</div>
                <div class="section-title-group">
                    <div class="section-number">ÙØµÙ„ Ø´Ø´Ù…</div>
                    <h2 class="section-title">Spatial SQL</h2>
                    <p class="section-subtitle">Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø¨Ø§ SQL Ø¯Ø± Sedona</p>
                </div>
            </div>

            <h3>ğŸ“‹ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ ØªÙˆØ§Ø¨Ø¹ SQL</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">ğŸ”¨</div>
                    <div class="feature-title">Constructor Functions</div>
                    <div class="feature-desc">
                        Ø§ÛŒØ¬Ø§Ø¯ Geometry: ST_Point, ST_Polygon, 
                        ST_GeomFromWKT, ST_GeomFromGeoJSON
                    </div>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">ğŸ“</div>
                    <div class="feature-title">Measurement Functions</div>
                    <div class="feature-desc">
                        Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒ: ST_Area, ST_Length, 
                        ST_Distance, ST_Perimeter
                    </div>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">ğŸ”—</div>
                    <div class="feature-title">Relationship Functions</div>
                    <div class="feature-desc">
                        Ø±ÙˆØ§Ø¨Ø·: ST_Contains, ST_Within, 
                        ST_Intersects, ST_Touches
                    </div>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">âœ‚ï¸</div>
                    <div class="feature-title">Processing Functions</div>
                    <div class="feature-desc">
                        Ù¾Ø±Ø¯Ø§Ø²Ø´: ST_Buffer, ST_Union, 
                        ST_Intersection, ST_Difference
                    </div>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">ğŸ”„</div>
                    <div class="feature-title">Transformation Functions</div>
                    <div class="feature-desc">
                        ØªØ¨Ø¯ÛŒÙ„: ST_Transform, ST_Simplify, 
                        ST_ConvexHull, ST_Centroid
                    </div>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">ğŸ“Š</div>
                    <div class="feature-title">Aggregate Functions</div>
                    <div class="feature-desc">
                        ØªØ¬Ù…ÛŒØ¹: ST_Union_Aggr, ST_Envelope_Aggr, 
                        ST_Collect
                    </div>
                </div>
            </div>

            <h3>ğŸ“ ØªÙˆØ§Ø¨Ø¹ Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒ</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon sql">SQL</div>
                        <span>measurement_functions.sql</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-sql">-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙØ§ØµÙ„Ù‡
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- ÙØ§ØµÙ„Ù‡ Ø§Ù‚Ù„ÛŒØ¯Ø³ÛŒ (Ø¯Ø±Ø¬Ù‡)
SELECT ST_Distance(
    ST_Point(51.3890, 35.6892),  -- ØªÙ‡Ø±Ø§Ù†
    ST_Point(51.6550, 32.6546)   -- Ø§ØµÙÙ‡Ø§Ù†
) as distance_degrees;

-- ÙØ§ØµÙ„Ù‡ Ø¨Ø§ ØªØ¨Ø¯ÛŒÙ„ CRS (Ù…ØªØ±)
SELECT ST_Distance(
    ST_Transform(ST_Point(51.3890, 35.6892), 'EPSG:4326', 'EPSG:32639'),
    ST_Transform(ST_Point(51.6550, 32.6546), 'EPSG:4326', 'EPSG:32639')
) as distance_meters;

-- ÙØ§ØµÙ„Ù‡ Ú©Ø±ÙˆÛŒ (Ù…ØªØ±) - Ø¯Ù‚ÛŒÙ‚â€ŒØªØ± Ø¨Ø±Ø§ÛŒ Ù…Ø³Ø§ÙØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ù„Ù†Ø¯
SELECT ST_DistanceSphere(
    ST_Point(51.3890, 35.6892),
    ST_Point(51.6550, 32.6546)
) as distance_sphere_meters;

-- ÙØ§ØµÙ„Ù‡ Ø¨Ø§ Spheroid (Ø¯Ù‚ÛŒÙ‚â€ŒØªØ±ÛŒÙ†)
SELECT ST_DistanceSpheroid(
    ST_Point(51.3890, 35.6892),
    ST_Point(51.6550, 32.6546)
) as distance_spheroid_meters;

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø³Ø§Ø­Øª
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Ù…Ø³Ø§Ø­Øª (Ø¯Ø± ÙˆØ§Ø­Ø¯ CRS)
SELECT ST_Area(
    ST_GeomFromWKT('POLYGON((51.3 35.6, 51.5 35.6, 51.5 35.8, 51.3 35.8, 51.3 35.6))')
) as area_degrees;

-- Ù…Ø³Ø§Ø­Øª Ø¨Ù‡ Ù…ØªØ± Ù…Ø±Ø¨Ø¹ (Ø¨Ø§ ØªØ¨Ø¯ÛŒÙ„ CRS)
SELECT ST_Area(
    ST_Transform(
        ST_GeomFromWKT('POLYGON((51.3 35.6, 51.5 35.6, 51.5 35.8, 51.3 35.8, 51.3 35.6))'),
        'EPSG:4326',
        'EPSG:32639'
    )
) / 1000000 as area_km2;

-- Ù…Ø³Ø§Ø­Øª Ú©Ø±ÙˆÛŒ
SELECT ST_AreaSpheroid(
    ST_GeomFromWKT('POLYGON((51.3 35.6, 51.5 35.6, 51.5 35.8, 51.3 35.8, 51.3 35.6))')
) / 1000000 as area_spheroid_km2;

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø·ÙˆÙ„
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Ø·ÙˆÙ„ Ø®Ø·
SELECT ST_Length(
    ST_GeomFromWKT('LINESTRING(51.3 35.6, 51.4 35.7, 51.5 35.65)')
) as length_degrees;

-- Ø·ÙˆÙ„ Ú©Ø±ÙˆÛŒ (Ù…ØªØ±)
SELECT ST_LengthSphere(
    ST_GeomFromWKT('LINESTRING(51.3 35.6, 51.4 35.7, 51.5 35.65)')
) / 1000 as length_km;

-- Ù…Ø­ÛŒØ· Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ
SELECT ST_Perimeter(
    ST_GeomFromWKT('POLYGON((51.3 35.6, 51.5 35.6, 51.5 35.8, 51.3 35.8, 51.3 35.6))')
) as perimeter;</code></pre>
                </div>
            </div>

            <h3>ğŸ”— ØªÙˆØ§Ø¨Ø¹ Ø±Ø§Ø¨Ø·Ù‡â€ŒØ§ÛŒ (Predicates)</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon sql">SQL</div>
                        <span>relationship_functions.sql</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-sql">-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Ø¨Ø±Ø±Ø³ÛŒ Ø±ÙˆØ§Ø¨Ø· Ù…Ú©Ø§Ù†ÛŒ
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Ø¢ÛŒØ§ Ù†Ù‚Ø·Ù‡ Ø¯Ø§Ø®Ù„ Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ Ø§Ø³ØªØŸ
SELECT ST_Contains(
    ST_GeomFromWKT('POLYGON((51.3 35.6, 51.5 35.6, 51.5 35.8, 51.3 35.8, 51.3 35.6))'),
    ST_Point(51.4, 35.7)
) as point_inside;
-- Ù†ØªÛŒØ¬Ù‡: true

-- Ø¢ÛŒØ§ Ù†Ù‚Ø·Ù‡ Ø¯Ø§Ø®Ù„ Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ Ø§Ø³ØªØŸ (Ù…Ø¹Ú©ÙˆØ³ Contains)
SELECT ST_Within(
    ST_Point(51.4, 35.7),
    ST_GeomFromWKT('POLYGON((51.3 35.6, 51.5 35.6, 51.5 35.8, 51.3 35.8, 51.3 35.6))')
) as point_within;

-- Ø¢ÛŒØ§ Ø¯Ùˆ Ù‡Ù†Ø¯Ø³Ù‡ ØªÙ‚Ø§Ø·Ø¹ Ø¯Ø§Ø±Ù†Ø¯ØŸ
SELECT ST_Intersects(
    ST_GeomFromWKT('POLYGON((0 0, 2 0, 2 2, 0 2, 0 0))'),
    ST_GeomFromWKT('POLYGON((1 1, 3 1, 3 3, 1 3, 1 1))')
) as do_intersect;
-- Ù†ØªÛŒØ¬Ù‡: true

-- Ø¢ÛŒØ§ Ø¯Ùˆ Ù‡Ù†Ø¯Ø³Ù‡ Ù…Ù…Ø§Ø³ Ù‡Ø³ØªÙ†Ø¯ØŸ
SELECT ST_Touches(
    ST_GeomFromWKT('POLYGON((0 0, 1 0, 1 1, 0 1, 0 0))'),
    ST_GeomFromWKT('POLYGON((1 0, 2 0, 2 1, 1 1, 1 0))')
) as do_touch;
-- Ù†ØªÛŒØ¬Ù‡: true

-- Ø¢ÛŒØ§ Ø¯Ùˆ Ù‡Ù†Ø¯Ø³Ù‡ Ù‡Ù…Ù¾ÙˆØ´Ø§Ù†ÛŒ Ø¯Ø§Ø±Ù†Ø¯ØŸ
SELECT ST_Overlaps(
    ST_GeomFromWKT('POLYGON((0 0, 2 0, 2 2, 0 2, 0 0))'),
    ST_GeomFromWKT('POLYGON((1 1, 3 1, 3 3, 1 3, 1 1))')
) as do_overlap;

-- Ø¢ÛŒØ§ Ø¯Ùˆ Ù‡Ù†Ø¯Ø³Ù‡ Ø§Ø² Ù‡Ù… Ø¬Ø¯Ø§ Ù‡Ø³ØªÙ†Ø¯ØŸ
SELECT ST_Disjoint(
    ST_GeomFromWKT('POLYGON((0 0, 1 0, 1 1, 0 1, 0 0))'),
    ST_GeomFromWKT('POLYGON((5 5, 6 5, 6 6, 5 6, 5 5))')
) as are_disjoint;
-- Ù†ØªÛŒØ¬Ù‡: true

-- Ø¢ÛŒØ§ Ø¯Ùˆ Ù‡Ù†Ø¯Ø³Ù‡ Ø¨Ø±Ø§Ø¨Ø± Ù‡Ø³ØªÙ†Ø¯ØŸ
SELECT ST_Equals(
    ST_GeomFromWKT('POINT(1 1)'),
    ST_GeomFromWKT('POINT(1.0 1.0)')
) as are_equal;

-- Ø¢ÛŒØ§ Ø¯Ùˆ Ù‡Ù†Ø¯Ø³Ù‡ Ø¹Ø¨ÙˆØ± Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯ Ø§Ø² Ù‡Ù…ØŸ
SELECT ST_Crosses(
    ST_GeomFromWKT('LINESTRING(0 0, 2 2)'),
    ST_GeomFromWKT('LINESTRING(0 2, 2 0)')
) as do_cross;
-- Ù†ØªÛŒØ¬Ù‡: true

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø± Ø§Ø³Ø§Ø³ ÙØ§ØµÙ„Ù‡
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Ø¢ÛŒØ§ Ø¯Ø± ÙØ§ØµÙ„Ù‡ Ù…Ø´Ø®Øµ Ø§Ø³ØªØŸ
SELECT ST_DWithin(
    ST_Point(51.389, 35.689),
    ST_Point(51.390, 35.690),
    0.01  -- 0.01 Ø¯Ø±Ø¬Ù‡ ØªÙ‚Ø±ÛŒØ¨Ø§Ù‹ 1 Ú©ÛŒÙ„ÙˆÙ…ØªØ±
) as within_distance;

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÛŒ: Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ù†Ù‚Ø§Ø· Ø¯Ø§Ø®Ù„ Ù…Ù†Ø·Ù‚Ù‡
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

WITH cities AS (
    SELECT 'ØªÙ‡Ø±Ø§Ù†' as name, ST_Point(51.389, 35.689) as location
    UNION ALL
    SELECT 'Ú©Ø±Ø¬', ST_Point(50.991, 35.835)
    UNION ALL
    SELECT 'Ù‚Ù…', ST_Point(50.876, 34.639)
    UNION ALL
    SELECT 'Ø§ØµÙÙ‡Ø§Ù†', ST_Point(51.655, 32.654)
),
tehran_province AS (
    SELECT ST_GeomFromWKT('POLYGON((50.5 35, 52 35, 52 36.5, 50.5 36.5, 50.5 35))') as boundary
)
SELECT 
    c.name,
    ST_Within(c.location, p.boundary) as is_in_tehran_province
FROM cities c, tehran_province p;</code></pre>
                </div>
            </div>

            <h3>âœ‚ï¸ ØªÙˆØ§Ø¨Ø¹ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù‡Ù†Ø¯Ø³ÛŒ</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon sql">SQL</div>
                        <span>processing_functions.sql</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-sql">-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Buffer (Ø­Ø§Ø´ÛŒÙ‡)
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Ø§ÛŒØ¬Ø§Ø¯ Ø¨Ø§ÙØ± Ø¯ÙˆØ± Ù†Ù‚Ø·Ù‡
SELECT ST_Buffer(
    ST_Point(51.389, 35.689),
    0.01  -- Ø´Ø¹Ø§Ø¹ 0.01 Ø¯Ø±Ø¬Ù‡
) as point_buffer;

-- Ø¨Ø§ÙØ± Ø¨Ø§ ØªØ¹Ø¯Ø§Ø¯ segment Ù…Ø´Ø®Øµ
SELECT ST_Buffer(
    ST_Point(51.389, 35.689),
    0.01,
    'quad_segs=16'  -- Ø¯Ù‚Øª Ø¨ÛŒØ´ØªØ±
) as smooth_buffer;

-- Ø¨Ø§ÙØ± ÛŒÚ©â€ŒØ·Ø±ÙÙ‡ Ø¨Ø±Ø§ÛŒ Ø®Ø·
SELECT ST_Buffer(
    ST_GeomFromWKT('LINESTRING(0 0, 10 0)'),
    1,
    'side=left'
) as left_buffer;

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Ø¹Ù…Ù„ÛŒØ§Øª Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Ø§Ø´ØªØ±Ø§Ú© (Intersection)
SELECT ST_Intersection(
    ST_GeomFromWKT('POLYGON((0 0, 2 0, 2 2, 0 2, 0 0))'),
    ST_GeomFromWKT('POLYGON((1 1, 3 1, 3 3, 1 3, 1 1))')
) as intersection;

-- Ø§Ø¬ØªÙ…Ø§Ø¹ (Union)
SELECT ST_Union(
    ST_GeomFromWKT('POLYGON((0 0, 2 0, 2 2, 0 2, 0 0))'),
    ST_GeomFromWKT('POLYGON((1 1, 3 1, 3 3, 1 3, 1 1))')
) as union_result;

-- ØªÙØ§Ø¶Ù„ (Difference)
SELECT ST_Difference(
    ST_GeomFromWKT('POLYGON((0 0, 2 0, 2 2, 0 2, 0 0))'),
    ST_GeomFromWKT('POLYGON((1 1, 3 1, 3 3, 1 3, 1 1))')
) as difference;

-- ØªÙØ§Ø¶Ù„ Ù…ØªÙ‚Ø§Ø±Ù† (SymDifference)
SELECT ST_SymDifference(
    ST_GeomFromWKT('POLYGON((0 0, 2 0, 2 2, 0 2, 0 0))'),
    ST_GeomFromWKT('POLYGON((1 1, 3 1, 3 3, 1 3, 1 1))')
) as sym_difference;

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Ø³Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ùˆ ØªØ¨Ø¯ÛŒÙ„
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Ø³Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù‡Ù†Ø¯Ø³Ù‡ (Douglas-Peucker)
SELECT ST_Simplify(
    ST_GeomFromWKT('LINESTRING(0 0, 1 0.1, 2 0, 3 0.1, 4 0)'),
    0.2  -- ØªÙ„Ø±Ø§Ù†Ø³
) as simplified;

-- Ø³Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Ø­ÙØ¸ ØªÙˆÙ¾ÙˆÙ„ÙˆÚ˜ÛŒ
SELECT ST_SimplifyPreserveTopology(
    complex_polygon,
    0.001
) as simplified_polygon
FROM polygons;

-- Ù¾ÙˆØ³ØªÙ‡ Ù…Ø­Ø¯Ø¨ (Convex Hull)
SELECT ST_ConvexHull(
    ST_GeomFromWKT('MULTIPOINT((0 0), (1 1), (0 2), (2 1), (1 0))')
) as convex_hull;

-- Ù…Ø±Ú©Ø² Ù‡Ù†Ø¯Ø³ÛŒ
SELECT ST_Centroid(
    ST_GeomFromWKT('POLYGON((0 0, 4 0, 4 4, 0 4, 0 0))')
) as centroid;

-- Ù†Ù‚Ø·Ù‡ Ø±ÙˆÛŒ Ø³Ø·Ø­ (Ù‡Ù…ÛŒØ´Ù‡ Ø¯Ø§Ø®Ù„ Ù‡Ù†Ø¯Ø³Ù‡)
SELECT ST_PointOnSurface(
    ST_GeomFromWKT('POLYGON((0 0, 4 0, 4 4, 2 2, 0 4, 0 0))')
) as point_on_surface;

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ØªØ¨Ø¯ÛŒÙ„ CRS
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- ØªØ¨Ø¯ÛŒÙ„ Ø§Ø² WGS84 Ø¨Ù‡ UTM Zone 39N
SELECT ST_Transform(
    ST_Point(51.389, 35.689),
    'EPSG:4326',
    'EPSG:32639'
) as utm_point;

-- ØªÙ†Ø¸ÛŒÙ… SRID
SELECT ST_SetSRID(
    ST_Point(51.389, 35.689),
    4326
) as point_with_srid;</code></pre>
                </div>
            </div>

            <h3>ğŸ“Š ØªÙˆØ§Ø¨Ø¹ ØªØ¬Ù…ÛŒØ¹ÛŒ</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon sql">SQL</div>
                        <span>aggregate_functions.sql</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-sql">-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ØªØ¬Ù…ÛŒØ¹ Ù‡Ù†Ø¯Ø³Ù‡â€ŒÙ‡Ø§
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Ø§Ø¬ØªÙ…Ø§Ø¹ Ù‡Ù…Ù‡ Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒâ€ŒÙ‡Ø§
SELECT 
    province,
    ST_Union_Aggr(geometry) as merged_geometry
FROM districts
GROUP BY province;

-- Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ù‡Ù…Ù‡ Ù†Ù‚Ø§Ø· Ø¯Ø± ÛŒÚ© MultiPoint
SELECT 
    category,
    ST_Collect(geometry) as all_points
FROM points
GROUP BY category;

-- Bounding Box Ù‡Ù…Ù‡ Ù‡Ù†Ø¯Ø³Ù‡â€ŒÙ‡Ø§
SELECT 
    ST_Envelope_Aggr(geometry) as total_extent
FROM all_geometries;

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÛŒ: Ø§Ø¯ØºØ§Ù… Ù…Ù†Ø§Ø·Ù‚ Ø´Ù‡Ø±ÛŒ
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

WITH urban_areas AS (
    SELECT 
        city,
        ST_Buffer(location, 0.05) as urban_zone
    FROM cities
    WHERE population > 100000
)
SELECT 
    ST_Union_Aggr(urban_zone) as total_urban_area
FROM urban_areas;

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¢Ù…Ø§Ø±ÛŒ Ù…Ú©Ø§Ù†ÛŒ
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SELECT 
    region,
    COUNT(*) as num_points,
    SUM(ST_Area(geometry)) as total_area,
    AVG(ST_Area(geometry)) as avg_area,
    ST_Envelope_Aggr(geometry) as bounding_box
FROM polygons
GROUP BY region;</code></pre>
                </div>
            </div>
        </section>

        <!-- Section 7: Spatial Operations -->
        <section class="section" id="operations">
            <div class="section-header">
                <div class="section-icon">âš™ï¸</div>
                <div class="section-title-group">
                    <div class="section-number">ÙØµÙ„ Ù‡ÙØªÙ…</div>
                    <h2 class="section-title">Ø¹Ù…Ù„ÛŒØ§Øª Ù…Ú©Ø§Ù†ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</h2>
                    <p class="section-subtitle">Spatial Join, KNN, Range Query</p>
                </div>
            </div>

            <h3>ğŸ”— Spatial Join</h3>
            <div class="info-box spark">
                <div class="info-box-title">
                    <span>âš¡</span>
                    Spatial Join Ú†ÛŒØ³ØªØŸ
                </div>
                <div class="info-box-content">
                    Spatial Join Ø¹Ù…Ù„ÛŒØ§Øª ØªØ±Ú©ÛŒØ¨ Ø¯Ùˆ Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø¯Ø§Ø¯Ù‡ Ù…Ú©Ø§Ù†ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø±Ø§Ø¨Ø·Ù‡ ÙØ¶Ø§ÛŒÛŒ (Ù…Ø§Ù†Ù†Ø¯ ØªÙ‚Ø§Ø·Ø¹ØŒ Ø´Ø§Ù…Ù„ Ø¨ÙˆØ¯Ù†ØŒ ÙØ§ØµÙ„Ù‡) Ø§Ø³Øª.
                    Ø§ÛŒÙ† ÛŒÚ©ÛŒ Ø§Ø² Ù¾Ø±Ú©Ø§Ø±Ø¨Ø±Ø¯ØªØ±ÛŒÙ† Ùˆ Ø³Ù†Ú¯ÛŒÙ†â€ŒØªØ±ÛŒÙ† Ø¹Ù…Ù„ÛŒØ§Øª Ø¯Ø± ØªØ­Ù„ÛŒÙ„ Ù…Ú©Ø§Ù†ÛŒ Ø§Ø³Øª Ú©Ù‡ Sedona Ø¨Ù‡ ØµÙˆØ±Øª Ø¨Ù‡ÛŒÙ†Ù‡ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ø±Ø¯Ù‡.
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>spatial_join.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">from sedona.spark import *

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø§ÛŒØ¬Ø§Ø¯ DataFrame Ù†Ù‚Ø§Ø· (Ù…Ø«Ù„Ø§Ù‹ Ù…Ú©Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ú©Ø³Ø¨â€ŒÙˆÚ©Ø§Ø±)
points_data = [
    ("restaurant_1", 51.38, 35.70),
    ("restaurant_2", 51.42, 35.68),
    ("shop_1", 51.40, 35.72),
    ("shop_2", 51.35, 35.65),
    ("cafe_1", 51.44, 35.69),
]

points_df = sedona.createDataFrame(points_data, ["name", "lon", "lat"]) \
    .selectExpr("name", "ST_Point(lon, lat) as location")

points_df.createOrReplaceTempView("businesses")

# Ø§ÛŒØ¬Ø§Ø¯ DataFrame Ù…Ù†Ø§Ø·Ù‚ (Ù…Ø«Ù„Ø§Ù‹ Ù…Ø­Ù„Ù‡â€ŒÙ‡Ø§)
districts_data = [
    ("district_north", "POLYGON((51.35 35.68, 51.45 35.68, 51.45 35.75, 51.35 35.75, 51.35 35.68))"),
    ("district_south", "POLYGON((51.35 35.60, 51.45 35.60, 51.45 35.68, 51.35 35.68, 51.35 35.60))"),
    ("district_center", "POLYGON((51.38 35.65, 51.42 35.65, 51.42 35.72, 51.38 35.72, 51.38 35.65))"),
]

districts_df = sedona.createDataFrame(districts_data, ["district_name", "wkt"]) \
    .selectExpr("district_name", "ST_GeomFromWKT(wkt) as boundary")

districts_df.createOrReplaceTempView("districts")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Spatial Join Ø¨Ø§ SQL
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Join Ø¨Ø± Ø§Ø³Ø§Ø³ Contains (Ù†Ù‚Ø§Ø· Ø¯Ø§Ø®Ù„ Ù…Ù†Ø§Ø·Ù‚)
result = sedona.sql("""
    SELECT 
        d.district_name,
        b.name as business_name,
        b.location
    FROM districts d, businesses b
    WHERE ST_Contains(d.boundary, b.location)
""")

result.show()

# Ø®Ø±ÙˆØ¬ÛŒ:
# +---------------+-------------+--------------------+
# |  district_name|business_name|            location|
# +---------------+-------------+--------------------+
# | district_north| restaurant_1|POINT (51.38 35.7...|
# | district_north|       shop_1|POINT (51.4 35.72...|
# |district_center| restaurant_1|POINT (51.38 35.7...|
# +---------------+-------------+--------------------+

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Spatial Join Ø¨Ø§ DataFrame API
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

from sedona.sql import st_functions as ST
from pyspark.sql import functions as F

# Join Ø¨Ø§ crossJoin Ùˆ ÙÛŒÙ„ØªØ±
joined_df = districts_df.crossJoin(points_df) \
    .filter(ST.ST_Contains("boundary", "location")) \
    .select("district_name", "name", "location")

joined_df.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§Ù†ÙˆØ§Ø¹ Spatial Join
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# 1. Join Ø¨Ø± Ø§Ø³Ø§Ø³ Intersects
intersects_join = sedona.sql("""
    SELECT d.district_name, b.name
    FROM districts d, businesses b
    WHERE ST_Intersects(d.boundary, b.location)
""")

# 2. Join Ø¨Ø± Ø§Ø³Ø§Ø³ ÙØ§ØµÙ„Ù‡ (Distance Join)
distance_join = sedona.sql("""
    SELECT 
        b1.name as business1,
        b2.name as business2,
        ST_Distance(b1.location, b2.location) as distance
    FROM businesses b1, businesses b2
    WHERE b1.name < b2.name
      AND ST_DWithin(b1.location, b2.location, 0.05)
    ORDER BY distance
""")

distance_join.show()

# 3. Join Ø¨Ø± Ø§Ø³Ø§Ø³ Buffer
buffer_join = sedona.sql("""
    SELECT 
        d.district_name,
        COUNT(b.name) as nearby_businesses
    FROM districts d, businesses b
    WHERE ST_Intersects(ST_Buffer(d.boundary, 0.02), b.location)
    GROUP BY d.district_name
""")

buffer_join.show()</code></pre>
                </div>
            </div>

            <h3>ğŸ¯ KNN (K-Nearest Neighbors)</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>knn_query.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† K Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ±ÛŒÙ† Ù‡Ù…Ø³Ø§ÛŒÙ‡
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù†Ù‚Ø·Ù‡ Ù…Ø±Ø¬Ø¹
reference_point = "ST_Point(51.40, 35.70)"

# Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† 5 Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ±ÛŒÙ† Ú©Ø³Ø¨â€ŒÙˆÚ©Ø§Ø±
knn_result = sedona.sql(f"""
    SELECT 
        name,
        location,
        ST_Distance(location, {reference_point}) as distance
    FROM businesses
    ORDER BY ST_Distance(location, {reference_point})
    LIMIT 5
""")

knn_result.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# KNN Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ù†Ù‚Ø·Ù‡ (Self-Join)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† 3 Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ±ÛŒÙ† Ù‡Ù…Ø³Ø§ÛŒÙ‡ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ú©Ø³Ø¨â€ŒÙˆÚ©Ø§Ø±
knn_self_join = sedona.sql("""
    WITH ranked AS (
        SELECT 
            b1.name as business,
            b2.name as neighbor,
            ST_Distance(b1.location, b2.location) as distance,
            ROW_NUMBER() OVER (
                PARTITION BY b1.name 
                ORDER BY ST_Distance(b1.location, b2.location)
            ) as rank
        FROM businesses b1, businesses b2
        WHERE b1.name != b2.name
    )
    SELECT business, neighbor, distance
    FROM ranked
    WHERE rank <= 3
    ORDER BY business, distance
""")

knn_self_join.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# KNN Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² RDD API (Ú©Ø§Ø±Ø§ÛŒÛŒ Ø¨Ø§Ù„Ø§ØªØ±)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

from sedona.core.spatialOperator import KNNQuery
from sedona.core.enums import IndexType
from shapely.geometry import Point

# ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Spatial RDD
from sedona.utils.adapter import Adapter

points_rdd = Adapter.toSpatialRdd(points_df, "location")

# Ø³Ø§Ø®Øª Ø´Ø§Ø®Øµ
points_rdd.buildIndex(IndexType.RTREE, True)

# Ø§Ø¬Ø±Ø§ÛŒ KNN Query
query_point = Point(51.40, 35.70)
k = 5

knn_results = KNNQuery.SpatialKnnQuery(
    points_rdd,
    query_point,
    k,
    True  # Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø´Ø§Ø®Øµ
)

for geom in knn_results:
    print(f"Found: {geom.geom}, Distance: {query_point.distance(geom.geom)}")</code></pre>
                </div>
            </div>

            <h3>ğŸ“ Range Query</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>range_query.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Range Query - Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± ÛŒÚ© Ù…Ø­Ø¯ÙˆØ¯Ù‡
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ØªØ¹Ø±ÛŒÙ Ù…Ø­Ø¯ÙˆØ¯Ù‡ Ø¬Ø³ØªØ¬Ùˆ
search_area = """
    ST_GeomFromWKT('POLYGON((51.35 35.65, 51.45 35.65, 51.45 35.75, 51.35 35.75, 51.35 35.65))')
"""

# Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ Ù†Ù‚Ø§Ø· Ø¯Ø± Ù…Ø­Ø¯ÙˆØ¯Ù‡
range_result = sedona.sql(f"""
    SELECT name, location
    FROM businesses
    WHERE ST_Within(location, {search_area})
""")

range_result.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Range Query Ø¨Ø§ Ø´Ø¹Ø§Ø¹ (Circle)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

center_point = "ST_Point(51.40, 35.70)"
radius = 0.05  # Ø¯Ø±Ø¬Ù‡

circle_range = sedona.sql(f"""
    SELECT 
        name, 
        location,
        ST_Distance(location, {center_point}) as distance
    FROM businesses
    WHERE ST_DWithin(location, {center_point}, {radius})
    ORDER BY distance
""")

circle_range.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Range Query Ø¨Ø§ Bounding Box
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

bbox_query = sedona.sql("""
    SELECT name, location
    FROM businesses
    WHERE ST_X(location) BETWEEN 51.35 AND 51.45
      AND ST_Y(location) BETWEEN 35.65 AND 35.75
""")

bbox_query.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Range Query Ø¨Ø§ RDD API
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

from sedona.core.spatialOperator import RangeQuery
from sedona.core.enums import IndexType
from shapely.geometry import box

# Ø³Ø§Ø®Øª Ø´Ø§Ø®Øµ
points_rdd.buildIndex(IndexType.RTREE, True)

# ØªØ¹Ø±ÛŒÙ Ù…Ø­Ø¯ÙˆØ¯Ù‡
query_envelope = box(51.35, 35.65, 51.45, 35.75)

# Ø§Ø¬Ø±Ø§ÛŒ Range Query
range_results = RangeQuery.SpatialRangeQuery(
    points_rdd,
    query_envelope,
    True,  # Consider boundary
    True   # Use index
)

print(f"Found {range_results.count()} points in range")</code></pre>
                </div>
            </div>

            <h3>ğŸ”„ Ø¹Ù…Ù„ÛŒØ§Øª Overlay</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>overlay_operations.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Polygon Overlay Operations
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡
land_use = sedona.sql("""
    SELECT 'residential' as type, 
           ST_GeomFromWKT('POLYGON((0 0, 5 0, 5 5, 0 5, 0 0))') as geometry
    UNION ALL
    SELECT 'commercial',
           ST_GeomFromWKT('POLYGON((3 3, 8 3, 8 8, 3 8, 3 3))')
    UNION ALL
    SELECT 'industrial',
           ST_GeomFromWKT('POLYGON((6 0, 10 0, 10 4, 6 4, 6 0))')
""")
land_use.createOrReplaceTempView("land_use")

flood_zone = sedona.sql("""
    SELECT ST_GeomFromWKT('POLYGON((2 2, 7 2, 7 6, 2 6, 2 2))') as geometry
""")
flood_zone.createOrReplaceTempView("flood_zone")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Intersection Overlay
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

intersection_overlay = sedona.sql("""
    SELECT 
        l.type,
        ST_Intersection(l.geometry, f.geometry) as flooded_area,
        ST_Area(ST_Intersection(l.geometry, f.geometry)) as flooded_area_size,
        ST_Area(l.geometry) as total_area,
        ST_Area(ST_Intersection(l.geometry, f.geometry)) / ST_Area(l.geometry) * 100 as flood_percentage
    FROM land_use l, flood_zone f
    WHERE ST_Intersects(l.geometry, f.geometry)
""")

intersection_overlay.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Union Overlay
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø§Ø¯ØºØ§Ù… Ù‡Ù…Ù‡ Ù…Ù†Ø§Ø·Ù‚ Ù…Ø³Ú©ÙˆÙ†ÛŒ
merged_residential = sedona.sql("""
    SELECT ST_Union_Aggr(geometry) as merged_geometry
    FROM land_use
    WHERE type = 'residential'
""")

merged_residential.show(truncate=False)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Difference Overlay
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù…Ù†Ø§Ø·Ù‚ÛŒ Ú©Ù‡ Ø¯Ø± Ø³ÛŒÙ„â€ŒØ®ÛŒØ² Ù†ÛŒØ³ØªÙ†Ø¯
safe_areas = sedona.sql("""
    SELECT 
        l.type,
        ST_Difference(l.geometry, f.geometry) as safe_area
    FROM land_use l, flood_zone f
    WHERE ST_Intersects(l.geometry, f.geometry)
""")

safe_areas.show(truncate=False)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Identity Overlay (Split by another layer)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

identity_overlay = sedona.sql("""
    SELECT 
        l.type,
        CASE 
            WHEN ST_Intersects(l.geometry, f.geometry) THEN 'in_flood_zone'
            ELSE 'safe'
        END as flood_status,
        CASE 
            WHEN ST_Intersects(l.geometry, f.geometry) 
            THEN ST_Intersection(l.geometry, f.geometry)
            ELSE l.geometry
        END as geometry
    FROM land_use l
    LEFT JOIN flood_zone f ON ST_Intersects(l.geometry, f.geometry)
""")

identity_overlay.show()</code></pre>
                </div>
            </div>

            <h3>ğŸ“Š ØªØ¬Ù…ÛŒØ¹ Ù…Ú©Ø§Ù†ÛŒ</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>spatial_aggregation.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Grid-based Aggregation
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù‚Ø·Ù‡â€ŒØ§ÛŒ ØªØµØ§Ø¯ÙÛŒ
import random

points_data = [
    (f"point_{i}", 51.3 + random.random() * 0.2, 35.6 + random.random() * 0.2, random.randint(1, 100))
    for i in range(1000)
]

points_df = sedona.createDataFrame(points_data, ["id", "lon", "lat", "value"]) \
    .selectExpr("id", "ST_Point(lon, lat) as location", "value")

points_df.createOrReplaceTempView("random_points")

# ØªØ¬Ù…ÛŒØ¹ Ø¯Ø± Grid
grid_aggregation = sedona.sql("""
    SELECT 
        FLOOR(ST_X(location) * 100) / 100 as grid_x,
        FLOOR(ST_Y(location) * 100) / 100 as grid_y,
        COUNT(*) as point_count,
        SUM(value) as total_value,
        AVG(value) as avg_value,
        ST_Centroid(ST_Collect(location)) as grid_center
    FROM random_points
    GROUP BY 
        FLOOR(ST_X(location) * 100) / 100,
        FLOOR(ST_Y(location) * 100) / 100
    ORDER BY point_count DESC
""")

grid_aggregation.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# H3 Hexagon Aggregation
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² H3 Ø¨Ø±Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹ Ø´Ø´â€ŒØ¶Ù„Ø¹ÛŒ
# Ù†ÛŒØ§Ø² Ø¨Ù‡ Ù†ØµØ¨ h3-pyspark Ø¯Ø§Ø±Ø¯

h3_aggregation = sedona.sql("""
    SELECT 
        -- ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ H3 index (Ø§Ú¯Ø± UDF ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ø¯)
        -- h3_geo_to_h3(ST_Y(location), ST_X(location), 8) as h3_index,
        COUNT(*) as point_count,
        AVG(value) as avg_value
    FROM random_points
    GROUP BY 
        FLOOR(ST_X(location) * 50) / 50,
        FLOOR(ST_Y(location) * 50) / 50
""")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Polygon-based Aggregation
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ØªØ¬Ù…ÛŒØ¹ Ù†Ù‚Ø§Ø· Ø¯Ø± Ù…Ù†Ø§Ø·Ù‚
polygon_aggregation = sedona.sql("""
    SELECT 
        d.district_name,
        COUNT(p.id) as point_count,
        COALESCE(SUM(p.value), 0) as total_value,
        COALESCE(AVG(p.value), 0) as avg_value
    FROM districts d
    LEFT JOIN random_points p ON ST_Contains(d.boundary, p.location)
    GROUP BY d.district_name
    ORDER BY point_count DESC
""")

polygon_aggregation.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Density Calculation
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

density_calculation = sedona.sql("""
    SELECT 
        d.district_name,
        COUNT(p.id) as point_count,
        ST_Area(ST_Transform(d.boundary, 'EPSG:4326', 'EPSG:32639')) / 1000000 as area_km2,
        COUNT(p.id) / (ST_Area(ST_Transform(d.boundary, 'EPSG:4326', 'EPSG:32639')) / 1000000) as density_per_km2
    FROM districts d
    LEFT JOIN random_points p ON ST_Contains(d.boundary, p.location)
    GROUP BY d.district_name, d.boundary
    ORDER BY density_per_km2 DESC
""")

density_calculation.show()</code></pre>
                </div>
            </div>
        </section>

        <!-- Section 8: Raster Processing -->
        <section class="section" id="raster">
            <div class="section-header">
                <div class="section-icon">ğŸ–¼ï¸</div>
                <div class="section-title-group">
                    <div class="section-number">ÙØµÙ„ Ù‡Ø´ØªÙ…</div>
                    <h2 class="section-title">Ù¾Ø±Ø¯Ø§Ø²Ø´ Raster</h2>
                    <p class="section-subtitle">ØªØµØ§ÙˆÛŒØ± Ù…Ø§Ù‡ÙˆØ§Ø±Ù‡â€ŒØ§ÛŒ Ùˆ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Grid</p>
                </div>
            </div>

            <div class="info-box info">
                <div class="info-box-title">
                    <span>ğŸ›°ï¸</span>
                    Ù¾Ø±Ø¯Ø§Ø²Ø´ Raster Ø¯Ø± Sedona
                </div>
                <div class="info-box-content">
                    Ø§Ø² Ù†Ø³Ø®Ù‡ 1.4ØŒ Apache Sedona Ø§Ø² Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Raster Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯:
                    <ul>
                        <li>Ø®ÙˆØ§Ù†Ø¯Ù† GeoTIFF, NetCDF, ArcGrid</li>
                        <li>Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ø§Ù†Ø¯ÛŒ Ùˆ Ù¾ÛŒÚ©Ø³Ù„ÛŒ</li>
                        <li>ØªØ¨Ø¯ÛŒÙ„ Ø¨ÛŒÙ† Raster Ùˆ Vector</li>
                        <li>Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¢Ù…Ø§Ø±ÛŒ Ø±ÙˆÛŒ ØªØµØ§ÙˆÛŒØ±</li>
                    </ul>
                </div>
            </div>

            <h3>ğŸ“– Ø®ÙˆØ§Ù†Ø¯Ù† Raster</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>read_raster.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø®ÙˆØ§Ù†Ø¯Ù† ÙØ§ÛŒÙ„ GeoTIFF
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø±ÙˆØ´ 1: Ø®ÙˆØ§Ù†Ø¯Ù† Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Binary Ùˆ ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Raster
raster_df = sedona.read.format("binaryFile") \
    .option("pathGlobFilter", "*.tif") \
    .load("path/to/satellite_images/") \
    .selectExpr(
        "path",
        "RS_FromGeoTiff(content) as raster"
    )

raster_df.show()

# Ø±ÙˆØ´ 2: Ø®ÙˆØ§Ù†Ø¯Ù† Ù…Ø³ØªÙ‚ÛŒÙ… (Sedona 1.5+)
raster_df = sedona.read.format("geotiff") \
    .option("dropInvalid", "true") \
    .load("path/to/image.tif")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§Ø·Ù„Ø§Ø¹Ø§Øª Raster
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

raster_info = raster_df.selectExpr(
    "path",
    "RS_NumBands(raster) as num_bands",
    "RS_Width(raster) as width",
    "RS_Height(raster) as height",
    "RS_PixelType(raster) as pixel_type",
    "RS_SRID(raster) as srid",
    "RS_GeoReference(raster) as georeference",
    "RS_Envelope(raster) as extent"
)

raster_info.show(truncate=False)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø®ÙˆØ§Ù†Ø¯Ù† Ú†Ù†Ø¯ÛŒÙ† ØªØµÙˆÛŒØ±
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø®ÙˆØ§Ù†Ø¯Ù† Ù‡Ù…Ù‡ ØªØµØ§ÙˆÛŒØ± Landsat Ø§Ø² ÛŒÚ© Ø¯Ø§ÛŒØ±Ú©ØªÙˆØ±ÛŒ
landsat_df = sedona.read.format("binaryFile") \
    .option("pathGlobFilter", "*.tif") \
    .option("recursiveFileLookup", "true") \
    .load("s3://bucket/landsat/") \
    .selectExpr(
        "path",
        "RS_FromGeoTiff(content) as raster"
    )

print(f"Loaded {landsat_df.count()} raster files")</code></pre>
                </div>
            </div>

            <h3>ğŸ”§ Ø¹Ù…Ù„ÛŒØ§Øª Raster</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>raster_operations.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ù‚Ø§Ø¯ÛŒØ± Ù¾ÛŒÚ©Ø³Ù„
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù…Ù‚Ø¯Ø§Ø± Ù¾ÛŒÚ©Ø³Ù„ Ø¯Ø± Ù…Ø®ØªØµØ§Øª Ø®Ø§Øµ
pixel_values = sedona.sql("""
    SELECT 
        path,
        RS_Value(raster, 100, 100) as pixel_value,
        RS_Values(raster, 100, 100, 110, 110) as pixel_array
    FROM raster_table
""")

pixel_values.show()

# Ù…Ù‚Ø¯Ø§Ø± Ù¾ÛŒÚ©Ø³Ù„ Ø¯Ø± Ù†Ù‚Ø·Ù‡ Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒ
point_value = sedona.sql("""
    SELECT 
        RS_Value(raster, ST_Point(51.389, 35.689)) as value_at_point
    FROM raster_table
""")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ø§Ù†Ø¯ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¨Ø§Ù†Ø¯ Ø®Ø§Øµ
band_extraction = sedona.sql("""
    SELECT 
        path,
        RS_Band(raster, 1) as red_band,
        RS_Band(raster, 2) as green_band,
        RS_Band(raster, 3) as blue_band,
        RS_Band(raster, 4) as nir_band
    FROM raster_table
""")

# ØªØ±Ú©ÛŒØ¨ Ø¨Ø§Ù†Ø¯Ù‡Ø§
band_combination = sedona.sql("""
    SELECT 
        RS_AddBand(
            RS_AddBand(RS_Band(raster, 4), RS_Band(raster, 3)),
            RS_Band(raster, 2)
        ) as false_color
    FROM raster_table
""")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø´Ø§Ø®Øµâ€ŒÙ‡Ø§ÛŒ Ø·ÛŒÙÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù…Ø­Ø§Ø³Ø¨Ù‡ NDVI (Normalized Difference Vegetation Index)
ndvi_calculation = sedona.sql("""
    SELECT 
        path,
        RS_NormalizedDifference(
            RS_Band(raster, 4),  -- NIR band
            RS_Band(raster, 3)   -- Red band
        ) as ndvi
    FROM raster_table
""")

# Ù…Ø­Ø§Ø³Ø¨Ù‡ NDWI (Water Index)
ndwi_calculation = sedona.sql("""
    SELECT 
        path,
        RS_NormalizedDifference(
            RS_Band(raster, 2),  -- Green band
            RS_Band(raster, 4)   -- NIR band
        ) as ndwi
    FROM raster_table
""")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø¢Ù…Ø§Ø± Raster
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

raster_stats = sedona.sql("""
    SELECT 
        path,
        RS_SummaryStats(raster, 1) as band1_stats,
        RS_Mean(raster, 1) as mean_value,
        RS_StdDev(raster, 1) as std_dev,
        RS_Min(raster, 1) as min_value,
        RS_Max(raster, 1) as max_value
    FROM raster_table
""")

raster_stats.show(truncate=False)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø¹Ù…Ù„ÛŒØ§Øª Ø±ÛŒØ§Ø¶ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø¬Ù…Ø¹ Ø¯Ùˆ raster
raster_add = sedona.sql("""
    SELECT RS_Add(raster1, raster2) as sum_raster
    FROM raster_pairs
""")

# Ø¶Ø±Ø¨ Ø¯Ø± Ø¹Ø¯Ø¯ Ø«Ø§Ø¨Øª
raster_multiply = sedona.sql("""
    SELECT RS_MultiplyFactor(raster, 0.0001) as scaled_raster
    FROM raster_table
""")

# Ø§Ø¹Ù…Ø§Ù„ Ø´Ø±Ø·
raster_conditional = sedona.sql("""
    SELECT RS_GreaterThan(ndvi_raster, 0.3) as vegetation_mask
    FROM ndvi_table
""")</code></pre>
                </div>
            </div>

            <h3>ğŸ”„ ØªØ¨Ø¯ÛŒÙ„ Raster Ø¨Ù‡ Vector</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>raster_to_vector.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Polygonize - ØªØ¨Ø¯ÛŒÙ„ Raster Ø¨Ù‡ Polygon
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ØªØ¨Ø¯ÛŒÙ„ Ù…Ù†Ø§Ø·Ù‚ Ø¨Ø§ Ù…Ù‚Ø¯Ø§Ø± ÛŒÚ©Ø³Ø§Ù† Ø¨Ù‡ polygon
polygonized = sedona.sql("""
    SELECT 
        RS_AsPolygon(raster, 1) as polygons
    FROM classification_raster
""")

# Explode Ø¨Ø±Ø§ÛŒ Ø¬Ø¯Ø§ Ú©Ø±Ø¯Ù† Ù‡Ø± polygon
individual_polygons = sedona.sql("""
    SELECT 
        explode(RS_AsPolygon(raster, 1)) as polygon
    FROM classification_raster
""")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Contour Lines
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø®Ø·ÙˆØ· ØªØ±Ø§Ø² (Contour)
contours = sedona.sql("""
    SELECT 
        RS_Contour(dem_raster, ARRAY(100, 200, 300, 400, 500)) as contour_lines
    FROM elevation_data
""")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù†Ù…ÙˆÙ†Ù‡â€ŒØ¨Ø±Ø¯Ø§Ø±ÛŒ Ù†Ù‚Ø·Ù‡â€ŒØ§ÛŒ Ø§Ø² Raster
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ù‚Ø§Ø¯ÛŒØ± Ø¯Ø± Ù†Ù‚Ø§Ø· Ù…Ø´Ø®Øµ
sampled_values = sedona.sql("""
    SELECT 
        p.id,
        p.location,
        RS_Value(r.raster, p.location) as raster_value
    FROM points p, raster_table r
    WHERE ST_Intersects(RS_Envelope(r.raster), p.location)
""")

sampled_values.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Zonal Statistics
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø¢Ù…Ø§Ø± Raster Ø¯Ø± Ù‡Ø± Ù…Ù†Ø·Ù‚Ù‡
zonal_stats = sedona.sql("""
    SELECT 
        z.zone_id,
        z.zone_name,
        RS_ZonalStats(r.raster, z.geometry, 'mean') as mean_value,
        RS_ZonalStats(r.raster, z.geometry, 'sum') as sum_value,
        RS_ZonalStats(r.raster, z.geometry, 'count') as pixel_count
    FROM zones z, raster_table r
    WHERE ST_Intersects(RS_Envelope(r.raster), z.geometry)
""")

zonal_stats.show()</code></pre>
                </div>
            </div>

            <h3>ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ Raster</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>save_raster.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø°Ø®ÛŒØ±Ù‡ Ø¨Ù‡ ÙØ±Ù…Øª GeoTIFF
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ binary Ùˆ Ø°Ø®ÛŒØ±Ù‡
output_df = sedona.sql("""
    SELECT 
        'output.tif' as filename,
        RS_AsGeoTiff(raster) as geotiff_binary
    FROM processed_raster
""")

# Ø°Ø®ÛŒØ±Ù‡ Ø¨Ù‡ ÙØ§ÛŒÙ„
output_df.selectExpr("geotiff_binary") \
    .write.format("binaryFile") \
    .save("path/to/output/")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø°Ø®ÛŒØ±Ù‡ Ø¨Ù‡ PNG (Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

png_output = sedona.sql("""
    SELECT 
        RS_AsPNG(raster) as png_binary
    FROM raster_table
""")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø°Ø®ÛŒØ±Ù‡ metadata
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

metadata_df = sedona.sql("""
    SELECT 
        path,
        RS_NumBands(raster) as bands,
        RS_Width(raster) as width,
        RS_Height(raster) as height,
        RS_SRID(raster) as srid,
        ST_AsText(RS_Envelope(raster)) as extent_wkt
    FROM raster_table
""")

metadata_df.write.json("path/to/metadata/")</code></pre>
                </div>
            </div>
        </section>

        <!-- Section 9: Visualization -->
        <section class="section" id="visualization">
            <div class="section-header">
                <div class="section-icon">ğŸ¨</div>
                <div class="section-title-group">
                    <div class="section-number">ÙØµÙ„ Ù†Ù‡Ù…</div>
                    <h2 class="section-title">ØªØ¬Ø³Ù… Ø¯Ø§Ø¯Ù‡</h2>
                    <p class="section-subtitle">Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬ Ø¨Ø§ Kepler.gl Ùˆ Folium</p>
                </div>
            </div>

            <h3>ğŸ—ºï¸ SedonaKepler</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>sedona_kepler.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">from sedona.maps.SedonaKepler import SedonaKepler

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù‚Ø´Ù‡ Ø³Ø§Ø¯Ù‡
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù‚Ø´Ù‡ Kepler
map_kepler = SedonaKepler.create_map()

# Ø§ÙØ²ÙˆØ¯Ù† DataFrame Ø¨Ù‡ Ù†Ù‚Ø´Ù‡
SedonaKepler.add_df(map_kepler, points_df, name="Points")
SedonaKepler.add_df(map_kepler, districts_df, name="Districts")

# Ù†Ù…Ø§ÛŒØ´ Ù†Ù‚Ø´Ù‡ (Ø¯Ø± Jupyter)
map_kepler

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù†Ù‚Ø´Ù‡
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÙˆÙ„ÛŒÙ‡ Ù†Ù‚Ø´Ù‡
config = {
    'version': 'v1',
    'config': {
        'mapState': {
            'latitude': 35.6892,
            'longitude': 51.3890,
            'zoom': 10
        },
        'mapStyle': {
            'styleType': 'dark'
        }
    }
}

map_with_config = SedonaKepler.create_map(config=config)
SedonaKepler.add_df(map_with_config, points_df, name="Locations")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø°Ø®ÛŒØ±Ù‡ Ù†Ù‚Ø´Ù‡ Ø¨Ù‡ HTML
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

map_kepler.save_to_html(file_name="my_map.html")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬ ØªØ­Ù„ÛŒÙ„
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù†Ù…Ø§ÛŒØ´ Ù†ØªÛŒØ¬Ù‡ Spatial Join
join_result = sedona.sql("""
    SELECT 
        d.district_name,
        COUNT(b.name) as business_count,
        d.boundary
    FROM districts d
    LEFT JOIN businesses b ON ST_Contains(d.boundary, b.location)
    GROUP BY d.district_name, d.boundary
""")

map_analysis = SedonaKepler.create_map()
SedonaKepler.add_df(map_analysis, join_result, name="Business Density")
map_analysis</code></pre>
                </div>
            </div>

            <h3>ğŸƒ Folium Integration</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>folium_visualization.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">import folium
from folium.plugins import HeatMap, MarkerCluster
import json

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ØªØ¨Ø¯ÛŒÙ„ Sedona DataFrame Ø¨Ù‡ GeoJSON
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def sedona_to_geojson(df, geometry_col="geometry"):
    """ØªØ¨Ø¯ÛŒÙ„ Sedona DataFrame Ø¨Ù‡ GeoJSON"""
    
    # ØªØ¨Ø¯ÛŒÙ„ geometry Ø¨Ù‡ GeoJSON string
    geojson_df = df.selectExpr(
        f"ST_AsGeoJSON({geometry_col}) as geometry",
        f"* EXCEPT {geometry_col}"
    )
    
    # Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø¨Ù‡ driver
    rows = geojson_df.collect()
    
    features = []
    for row in rows:
        feature = {
            "type": "Feature",
            "geometry": json.loads(row.geometry),
            "properties": {k: v for k, v in row.asDict().items() if k != "geometry"}
        }
        features.append(feature)
    
    return {
        "type": "FeatureCollection",
        "features": features
    }

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù‚Ø´Ù‡ Folium
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù‚Ø´Ù‡ Ù¾Ø§ÛŒÙ‡
m = folium.Map(
    location=[35.6892, 51.3890],
    zoom_start=11,
    tiles='cartodbdark_matter'
)

# ØªØ¨Ø¯ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
points_geojson = sedona_to_geojson(points_df, "location")
districts_geojson = sedona_to_geojson(districts_df, "boundary")

# Ø§ÙØ²ÙˆØ¯Ù† Ù„Ø§ÛŒÙ‡ Ù…Ù†Ø§Ø·Ù‚
folium.GeoJson(
    districts_geojson,
    name="Districts",
    style_function=lambda x: {
        'fillColor': '#3388ff',
        'color': '#ffffff',
        'weight': 2,
        'fillOpacity': 0.3
    },
    tooltip=folium.GeoJsonTooltip(fields=['district_name'])
).add_to(m)

# Ø§ÙØ²ÙˆØ¯Ù† Ù†Ù‚Ø§Ø· Ø¨Ø§ Marker Cluster
marker_cluster = MarkerCluster(name="Businesses").add_to(m)

for feature in points_geojson['features']:
    coords = feature['geometry']['coordinates']
    folium.Marker(
        location=[coords[1], coords[0]],
        popup=feature['properties'].get('name', 'Unknown'),
        icon=folium.Icon(color='red', icon='info-sign')
    ).add_to(marker_cluster)

# Ø§ÙØ²ÙˆØ¯Ù† Ú©Ù†ØªØ±Ù„ Ù„Ø§ÛŒÙ‡â€ŒÙ‡Ø§
folium.LayerControl().add_to(m)

# Ø°Ø®ÛŒØ±Ù‡
m.save("sedona_folium_map.html")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ (Heatmap)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø®ØªØµØ§Øª Ø¨Ø±Ø§ÛŒ heatmap
heat_data = points_df.selectExpr(
    "ST_Y(location) as lat",
    "ST_X(location) as lon",
    "value as weight"
).collect()

heat_points = [[row.lat, row.lon, row.weight] for row in heat_data]

# Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ
m_heat = folium.Map(location=[35.6892, 51.3890], zoom_start=11)
HeatMap(heat_points, radius=15).add_to(m_heat)
m_heat.save("heatmap.html")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Choropleth Map
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹ÛŒ
aggregated = sedona.sql("""
    SELECT 
        d.district_name,
        COUNT(p.id) as count,
        d.boundary
    FROM districts d
    LEFT JOIN random_points p ON ST_Contains(d.boundary, p.location)
    GROUP BY d.district_name, d.boundary
""")

agg_geojson = sedona_to_geojson(aggregated, "boundary")

m_choropleth = folium.Map(location=[35.6892, 51.3890], zoom_start=11)

folium.Choropleth(
    geo_data=agg_geojson,
    data=aggregated.toPandas(),
    columns=['district_name', 'count'],
    key_on='feature.properties.district_name',
    fill_color='YlOrRd',
    fill_opacity=0.7,
    line_opacity=0.2,
    legend_name='Point Count'
).add_to(m_choropleth)

m_choropleth.save("choropleth.html")</code></pre>
                </div>
            </div>

            <h3>ğŸ“Š Sedona Viz (Ø±Ù†Ø¯Ø± ØªÙˆØ²ÛŒØ¹â€ŒØ´Ø¯Ù‡)</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>sedona_viz.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø±Ù†Ø¯Ø± ØªÙˆØ²ÛŒØ¹â€ŒØ´Ø¯Ù‡ Ø¨Ø§ Sedona Viz
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø³ÛŒØ§Ø± Ø¨Ø²Ø±Ú¯ Ú©Ù‡ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ø¨Ù‡ client Ù…Ù†ØªÙ‚Ù„ Ú©Ø±Ø¯

# ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø±Ù†Ø¯Ø±
sedona.sql("""
    SET sedona.viz.imageWidth = 1000
""")
sedona.sql("""
    SET sedona.viz.imageHeight = 1000
""")

# Ø±Ù†Ø¯Ø± Ù†Ù‚Ø§Ø· Ø¨Ù‡ ØªØµÙˆÛŒØ±
image_df = sedona.sql("""
    SELECT ST_Render(
        location,
        800,   -- width
        600,   -- height
        ST_GeomFromWKT('POLYGON((51.3 35.6, 51.5 35.6, 51.5 35.8, 51.3 35.8, 51.3 35.6))')  -- extent
    ) as image
    FROM businesses
""")

# Ø°Ø®ÛŒØ±Ù‡ ØªØµÙˆÛŒØ±
image_bytes = image_df.collect()[0].image
with open("rendered_map.png", "wb") as f:
    f.write(image_bytes)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø±Ù†Ø¯Ø± Heatmap ØªÙˆØ²ÛŒØ¹â€ŒØ´Ø¯Ù‡
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

heatmap_image = sedona.sql("""
    SELECT ST_RenderHeatmap(
        location,
        value,
        800,
        600,
        ST_GeomFromWKT('POLYGON((51.3 35.6, 51.5 35.6, 51.5 35.8, 51.3 35.8, 51.3 35.6))'),
        'YlOrRd'  -- color ramp
    ) as heatmap
    FROM random_points
""")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø±Ù†Ø¯Ø± Choropleth ØªÙˆØ²ÛŒØ¹â€ŒØ´Ø¯Ù‡
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

choropleth_image = sedona.sql("""
    SELECT ST_RenderChoropleth(
        boundary,
        point_count,
        800,
        600,
        'Viridis'
    ) as choropleth
    FROM district_stats
""")</code></pre>
                </div>
            </div>
        </section>

        <!-- Section 10: Optimization -->
        <section class="section" id="optimization">
            <div class="section-header">
                <div class="section-icon">âš¡</div>
                <div class="section-title-group">
                    <div class="section-number">ÙØµÙ„ Ø¯Ù‡Ù…</div>
                    <h2 class="section-title">Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯</h2>
                    <p class="section-subtitle">ØªÚ©Ù†ÛŒÚ©â€ŒÙ‡Ø§ÛŒ Ø§ÙØ²Ø§ÛŒØ´ Ú©Ø§Ø±Ø§ÛŒÛŒ Ø¯Ø± Sedona</p>
                </div>
            </div>

            <h3>ğŸŒ² Ø´Ø§Ø®Øµâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù…Ú©Ø§Ù†ÛŒ</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>spatial_indexing.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">from sedona.core.enums import IndexType, GridType
from sedona.utils.adapter import Adapter

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø³Ø§Ø®Øª Ø´Ø§Ø®Øµ Ù…Ú©Ø§Ù†ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ØªØ¨Ø¯ÛŒÙ„ DataFrame Ø¨Ù‡ Spatial RDD
points_rdd = Adapter.toSpatialRdd(points_df, "location")

# Ø³Ø§Ø®Øª Ø´Ø§Ø®Øµ R-Tree
points_rdd.buildIndex(IndexType.RTREE, True)  # True = build on indexed RDD

# ÛŒØ§ Quad-Tree
points_rdd.buildIndex(IndexType.QUADTREE, True)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ú©Ø§Ù†ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ØªØ­Ù„ÛŒÙ„ ØªÙˆØ²ÛŒØ¹ Ø¯Ø§Ø¯Ù‡
points_rdd.analyze()

# Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø§ KDB-Tree (Ø¨Ù‡ØªØ±ÛŒÙ† Ø¨Ø±Ø§ÛŒ ØªÙˆØ²ÛŒØ¹ Ù†Ø§Ù…ØªÙˆØ§Ø²Ù†)
points_rdd.spatialPartitioning(GridType.KDBTREE)

# ÛŒØ§ Ø¨Ø§ Quad-Tree
points_rdd.spatialPartitioning(GridType.QUADTREE, 100)  # 100 Ù¾Ø§Ø±ØªÛŒØ´Ù†

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø´Ø§Ø®Øµ Ø¯Ø± SQL
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø´Ø§Ø®Øµ Ø³Ø±Ø§Ø³Ø±ÛŒ
sedona.sql("SET sedona.global.index = true")
sedona.sql("SET sedona.global.indextype = rtree")

# ØªÙ†Ø¸ÛŒÙ… Ù†ÙˆØ¹ grid Ø¨Ø±Ø§ÛŒ join
sedona.sql("SET sedona.join.gridtype = kdbtree")
sedona.sql("SET sedona.join.numpartition = 200")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Broadcast Join Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ú©ÙˆÚ†Ú©
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

from pyspark.sql.functions import broadcast

# Ø§Ú¯Ø± ÛŒÚ©ÛŒ Ø§Ø² Ø¬Ø¯Ø§ÙˆÙ„ Ú©ÙˆÚ†Ú© Ø§Ø³ØªØŒ broadcast Ú©Ù†ÛŒØ¯
result = large_df.join(
    broadcast(small_df),
    large_df["location"].intersects(small_df["boundary"])
)</code></pre>
                </div>
            </div>

            <h3>ğŸ“¦ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>partitioning_optimization.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ØªÙ†Ø¸ÛŒÙ… ØªØ¹Ø¯Ø§Ø¯ Ù¾Ø§Ø±ØªÛŒØ´Ù† Ø¨Ù‡ÛŒÙ†Ù‡
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù‚Ø§Ù†ÙˆÙ† Ú©Ù„ÛŒ: 2-4 Ù¾Ø§Ø±ØªÛŒØ´Ù† Ø¨Ù‡ Ø§Ø²Ø§ÛŒ Ù‡Ø± core
num_cores = 16
optimal_partitions = num_cores * 4

# ØªÙ†Ø¸ÛŒÙ… Ù¾Ø§Ø±ØªÛŒØ´Ù† shuffle
sedona.conf.set("spark.sql.shuffle.partitions", str(optimal_partitions))

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Repartition Ø¨Ø± Ø§Ø³Ø§Ø³ ØªÙˆØ²ÛŒØ¹ Ù…Ú©Ø§Ù†ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ù†Ø·Ù‚Ù‡ Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒ
partitioned_df = points_df.withColumn(
    "region",
    F.concat(
        F.floor(F.expr("ST_X(location)")).cast("string"),
        F.lit("_"),
        F.floor(F.expr("ST_Y(location)")).cast("string")
    )
).repartition("region")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Coalesce Ø¨Ø±Ø§ÛŒ Ú©Ø§Ù‡Ø´ Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒÙ‡Ø§
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù¾Ø³ Ø§Ø² ÙÛŒÙ„ØªØ± Ú©Ø±Ø¯Ù†ØŒ Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒÙ‡Ø§ Ø±Ø§ Ú©Ø§Ù‡Ø´ Ø¯Ù‡ÛŒØ¯
filtered_df = large_df.filter("ST_Within(location, search_area)")
coalesced_df = filtered_df.coalesce(10)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø°Ø®ÛŒØ±Ù‡ Ø¨Ø§ Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ú©Ø§Ù†ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ H3 ÛŒØ§ Grid
df_with_partition = points_df.withColumn(
    "partition_key",
    F.concat(
        F.floor(F.expr("ST_X(location) * 10")).cast("string"),
        F.lit("_"),
        F.floor(F.expr("ST_Y(location) * 10")).cast("string")
    )
)

df_with_partition.write \
    .partitionBy("partition_key") \
    .format("geoparquet") \
    .save("partitioned_data/")</code></pre>
                </div>
            </div>

            <h3>ğŸ’¾ Ú©Ø´ Ùˆ Persist</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>caching_strategies.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">from pyspark import StorageLevel

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ú©Ø´ Ú©Ø±Ø¯Ù† DataFrame Ù‡Ø§ÛŒ Ù¾Ø±Ú©Ø§Ø±Ø¨Ø±Ø¯
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ú©Ø´ Ø³Ø§Ø¯Ù‡ (Ø¯Ø± Ø­Ø§ÙØ¸Ù‡)
points_df.cache()

# Ø´Ù…Ø§Ø±Ø´ Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø´
points_df.count()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Persist Ø¨Ø§ Ø³Ø·ÙˆØ­ Ù…Ø®ØªÙ„Ù
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ÙÙ‚Ø· Ø­Ø§ÙØ¸Ù‡
df.persist(StorageLevel.MEMORY_ONLY)

# Ø­Ø§ÙØ¸Ù‡ Ùˆ Ø¯ÛŒØ³Ú©
df.persist(StorageLevel.MEMORY_AND_DISK)

# Ø³Ø±ÛŒØ§Ù„â€ŒØ´Ø¯Ù‡ (Ú©Ù…ØªØ± Ø­Ø§ÙØ¸Ù‡ØŒ Ø¨ÛŒØ´ØªØ± CPU)
df.persist(StorageLevel.MEMORY_ONLY_SER)

# Ø¨Ø§ ØªÚ©Ø±Ø§Ø± (Ø¨Ø±Ø§ÛŒ fault tolerance)
df.persist(StorageLevel.MEMORY_AND_DISK_2)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú©Ø´
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÛŒÚ© DataFrame
df.unpersist()

# Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ Ú©Ø´â€ŒÙ‡Ø§
sedona.catalog.clearCache()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ú©Ø´ Ú©Ø±Ø¯Ù† Ø¬Ø¯ÙˆÙ„ Ù…ÙˆÙ‚Øª
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

points_df.createOrReplaceTempView("points_temp")
sedona.sql("CACHE TABLE points_temp")

# Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¬Ø¯ÙˆÙ„ Ú©Ø´â€ŒØ´Ø¯Ù‡
result = sedona.sql("""
    SELECT * FROM points_temp
    WHERE ST_Within(location, ST_GeomFromWKT('...'))
""")

# Ù¾Ø§Ú© Ú©Ø±Ø¯Ù†
sedona.sql("UNCACHE TABLE points_temp")</code></pre>
                </div>
            </div>

            <h3>ğŸ“Š Ù†Ú©Ø§Øª Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú©ÙˆØ¦Ø±ÛŒ</h3>
            <div class="info-box success">
                <div class="info-box-title">
                    <span>ğŸ’¡</span>
                    Ø¨Ù‡ØªØ±ÛŒÙ† Ø´ÛŒÙˆÙ‡â€ŒÙ‡Ø§ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ
                </div>
                <div class="info-box-content">
                    <ul>
                        <li><strong>ÙÛŒÙ„ØªØ± Ø²ÙˆØ¯Ù‡Ù†Ú¯Ø§Ù…:</strong> ÙÛŒÙ„ØªØ±Ù‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø±Ø§ Ø¯Ø± Ø§Ø¨ØªØ¯Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒ Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯</li>
                        <li><strong>Bounding Box Ø§ÙˆÙ„:</strong> Ù‚Ø¨Ù„ Ø§Ø² ST_Contains Ø§Ø² ST_Intersects Ø¨Ø§ envelope Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                        <li><strong>Broadcast Ú©ÙˆÚ†Ú©â€ŒÙ‡Ø§:</strong> Ø¬Ø¯Ø§ÙˆÙ„ Ú©ÙˆÚ†Ú© (< 10MB) Ø±Ø§ broadcast Ú©Ù†ÛŒØ¯</li>
                        <li><strong>GeoParquet:</strong> Ø§Ø² GeoParquet Ø¨Ø§ predicate pushdown Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                        <li><strong>Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ú©Ø§Ù†ÛŒ:</strong> Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ù†Ø·Ù‚Ù‡ Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒ Ù¾Ø§Ø±ØªÛŒØ´Ù† Ú©Ù†ÛŒØ¯</li>
                    </ul>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon sql">SQL</div>
                        <span>optimized_queries.sql</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-sql">-- âŒ Ú©ÙˆØ¦Ø±ÛŒ ØºÛŒØ±Ø¨Ù‡ÛŒÙ†Ù‡
SELECT *
FROM large_points p, complex_polygons poly
WHERE ST_Contains(poly.geometry, p.location);

-- âœ… Ú©ÙˆØ¦Ø±ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡ Ø¨Ø§ ÙÛŒÙ„ØªØ± Bounding Box
SELECT *
FROM large_points p, complex_polygons poly
WHERE ST_Intersects(ST_Envelope(poly.geometry), p.location)  -- ÙÛŒÙ„ØªØ± Ø³Ø±ÛŒØ¹
  AND ST_Contains(poly.geometry, p.location);                 -- ÙÛŒÙ„ØªØ± Ø¯Ù‚ÛŒÙ‚

-- âœ… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² CTE Ø¨Ø±Ø§ÛŒ Ú©Ø§Ù‡Ø´ Ù…Ø­Ø§Ø³Ø¨Ø§Øª ØªÚ©Ø±Ø§Ø±ÛŒ
WITH filtered_points AS (
    SELECT *
    FROM large_points
    WHERE ST_X(location) BETWEEN 51.0 AND 52.0
      AND ST_Y(location) BETWEEN 35.0 AND 36.0
)
SELECT 
    poly.name,
    COUNT(*) as point_count
FROM filtered_points p, polygons poly
WHERE ST_Contains(poly.geometry, p.location)
GROUP BY poly.name;

-- âœ… Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ù†ØªØ§ÛŒØ¬ Ø¯Ø± subquery
SELECT *
FROM (
    SELECT *, ROW_NUMBER() OVER (PARTITION BY region ORDER BY value DESC) as rn
    FROM large_points
    WHERE ST_Within(location, search_area)
) ranked
WHERE rn <= 100;</code></pre>
                </div>
            </div>

            <h3>ğŸ“ˆ Ù…Ø§Ù†ÛŒØªÙˆØ±ÛŒÙ†Ú¯ Ø¹Ù…Ù„Ú©Ø±Ø¯</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>performance_monitoring.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø¨Ø±Ø±Ø³ÛŒ Execution Plan
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù†Ù…Ø§ÛŒØ´ plan Ù…Ù†Ø·Ù‚ÛŒ Ùˆ ÙÛŒØ²ÛŒÚ©ÛŒ
df.explain(True)

# Ù†Ù…Ø§ÛŒØ´ plan Ø¨Ø§ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¨ÛŒØ´ØªØ±
df.explain("extended")

# Ù†Ù…Ø§ÛŒØ´ plan Ø¨Ø§ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
df.explain("cost")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒ Ø²Ù…Ø§Ù† Ø§Ø¬Ø±Ø§
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

import time

def measure_query(query_func, name="Query"):
    """Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒ Ø²Ù…Ø§Ù† Ø§Ø¬Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒ"""
    start = time.time()
    result = query_func()
    
    # Ø§Ø¬Ø±Ø§ÛŒ action Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ
    if hasattr(result, 'count'):
        count = result.count()
    else:
        count = result
    
    elapsed = time.time() - start
    print(f"â±ï¸ {name}: {elapsed:.2f}s, Records: {count}")
    return result, elapsed

# Ø§Ø³ØªÙØ§Ø¯Ù‡
result, time_taken = measure_query(
    lambda: sedona.sql("""
        SELECT d.name, COUNT(*) as cnt
        FROM districts d, points p
        WHERE ST_Contains(d.boundary, p.location)
        GROUP BY d.name
    """),
    "Spatial Join"
)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def compare_strategies():
    """Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù"""
    
    results = {}
    
    # Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ 1: Ø¨Ø¯ÙˆÙ† Ø´Ø§Ø®Øµ
    sedona.sql("SET sedona.global.index = false")
    _, time1 = measure_query(run_spatial_join, "Without Index")
    results["no_index"] = time1
    
    # Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ 2: Ø¨Ø§ R-Tree
    sedona.sql("SET sedona.global.index = true")
    sedona.sql("SET sedona.global.indextype = rtree")
    _, time2 = measure_query(run_spatial_join, "With R-Tree")
    results["rtree"] = time2
    
    # Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ 3: Ø¨Ø§ Quad-Tree
    sedona.sql("SET sedona.global.indextype = quadtree")
    _, time3 = measure_query(run_spatial_join, "With Quad-Tree")
    results["quadtree"] = time3
    
    # Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬
    print("\nğŸ“Š Performance Comparison:")
    for strategy, time_val in sorted(results.items(), key=lambda x: x[1]):
        print(f"  {strategy}: {time_val:.2f}s")
    
    return results

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù…Ø§Ù†ÛŒØªÙˆØ±ÛŒÙ†Ú¯ Ø­Ø§ÙØ¸Ù‡
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def get_memory_usage():
    """Ø¯Ø±ÛŒØ§ÙØª ÙˆØ¶Ø¹ÛŒØª Ø­Ø§ÙØ¸Ù‡"""
    
    # Ø§Ø·Ù„Ø§Ø¹Ø§Øª Storage
    storage_info = sedona.sparkContext._jsc.sc().getExecutorMemoryStatus()
    
    # Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø´
    cache_info = sedona.catalog.listTables()
    
    print("ğŸ’¾ Memory Status:")
    print(f"  Cached Tables: {len([t for t in cache_info if t.isTemporary])}")
    
    return storage_info

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Spark UI Metrics
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Spark UI
print(f"ğŸŒ Spark UI: http://localhost:4040")

# Ø¯Ø±ÛŒØ§ÙØª Ø¢Ù…Ø§Ø± jobs
sc = sedona.sparkContext
status_tracker = sc.statusTracker()

# Ù„ÛŒØ³Øª jobs ÙØ¹Ø§Ù„
active_jobs = status_tracker.getActiveJobIds()
print(f"Active Jobs: {active_jobs}")

# Ø§Ø·Ù„Ø§Ø¹Ø§Øª stage
for job_id in active_jobs:
    job_info = status_tracker.getJobInfo(job_id)
    if job_info:
        print(f"Job {job_id}: {job_info.status}")</code></pre>
                </div>
            </div>

            <h3>âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡ Spark</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>ØªÙ†Ø¸ÛŒÙ…</th>
                            <th>ØªÙˆØ¶ÛŒØ­</th>
                            <th>Ù…Ù‚Ø¯Ø§Ø± Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>spark.sql.shuffle.partitions</code></td>
                            <td>ØªØ¹Ø¯Ø§Ø¯ Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ shuffle</td>
                            <td>2-4x ØªØ¹Ø¯Ø§Ø¯ cores</td>
                        </tr>
                        <tr>
                            <td><code>spark.sql.adaptive.enabled</code></td>
                            <td>AQE Ø¨Ø±Ø§ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±</td>
                            <td>true</td>
                        </tr>
                        <tr>
                            <td><code>sedona.global.index</code></td>
                            <td>ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø´Ø§Ø®Øµ Ù…Ú©Ø§Ù†ÛŒ</td>
                            <td>true</td>
                        </tr>
                        <tr>
                            <td><code>sedona.global.indextype</code></td>
                            <td>Ù†ÙˆØ¹ Ø´Ø§Ø®Øµ</td>
                            <td>rtree</td>
                        </tr>
                        <tr>
                            <td><code>sedona.join.gridtype</code></td>
                            <td>Ù†ÙˆØ¹ grid Ø¨Ø±Ø§ÛŒ join</td>
                            <td>kdbtree</td>
                        </tr>
                        <tr>
                            <td><code>spark.memory.fraction</code></td>
                            <td>Ù†Ø³Ø¨Øª Ø­Ø§ÙØ¸Ù‡ Ø¨Ø±Ø§ÛŒ execution/storage</td>
                            <td>0.6-0.8</td>
                        </tr>
                        <tr>
                            <td><code>spark.kryoserializer.buffer.max</code></td>
                            <td>Ø­Ø¯Ø§Ú©Ø«Ø± Ø¨Ø§ÙØ± Kryo</td>
                            <td>512m</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 11: Machine Learning -->
        <section class="section" id="ml">
            <div class="section-header">
                <div class="section-icon">ğŸ¤–</div>
                <div class="section-title-group">
                    <div class="section-number">ÙØµÙ„ ÛŒØ§Ø²Ø¯Ù‡Ù…</div>
                    <h2 class="section-title">ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù…Ø§Ø´ÛŒÙ† Ù…Ú©Ø§Ù†ÛŒ</h2>
                    <p class="section-subtitle">ØªØ±Ú©ÛŒØ¨ Sedona Ø¨Ø§ Spark MLlib</p>
                </div>
            </div>

            <h3>ğŸ¯ Feature Engineering Ù…Ú©Ø§Ù†ÛŒ</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>spatial_features.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">from pyspark.ml.feature import VectorAssembler
from pyspark.ml.clustering import KMeans
from pyspark.ml.regression import RandomForestRegressor
from pyspark.sql import functions as F

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def extract_spatial_features(df, geometry_col="location"):
    """Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø§Ø² DataFrame"""
    
    return df.selectExpr(
        "*",
        # Ù…Ø®ØªØµØ§Øª
        f"ST_X({geometry_col}) as longitude",
        f"ST_Y({geometry_col}) as latitude",
        
        # ÙØ§ØµÙ„Ù‡ Ø§Ø² Ù…Ø±Ú©Ø² Ø´Ù‡Ø±
        f"""ST_Distance(
            {geometry_col}, 
            ST_Point(51.3890, 35.6892)
        ) as distance_from_center""",
        
        # ÙØ§ØµÙ„Ù‡ Ø§Ø² Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ±ÛŒÙ† Ø§ÛŒØ³ØªÚ¯Ø§Ù‡ Ù…ØªØ±Ùˆ (ÙØ±Ø¶ÛŒ)
        f"""ST_Distance(
            {geometry_col},
            ST_Point(51.4103, 35.7129)
        ) as distance_from_metro"""
    )

# Ø§Ø³ØªÙØ§Ø¯Ù‡
features_df = extract_spatial_features(points_df)
features_df.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ù‡Ù…Ø³Ø§ÛŒÚ¯ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def add_neighborhood_features(df, points_df, radius=0.01):
    """Ø§ÙØ²ÙˆØ¯Ù† ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù‡Ù…Ø³Ø§ÛŒÚ¯ÛŒ"""
    
    # Ø´Ù…Ø§Ø±Ø´ Ù†Ù‚Ø§Ø· Ø¯Ø± Ø´Ø¹Ø§Ø¹
    df.createOrReplaceTempView("main_points")
    points_df.createOrReplaceTempView("all_points")
    
    neighborhood_df = sedona.sql(f"""
        SELECT 
            m.*,
            COUNT(a.id) as neighbors_count,
            AVG(a.value) as neighbors_avg_value
        FROM main_points m
        LEFT JOIN all_points a 
            ON ST_DWithin(m.location, a.location, {radius})
            AND m.id != a.id
        GROUP BY m.id, m.location, m.value
    """)
    
    return neighborhood_df

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ù…Ù†Ø·Ù‚Ù‡
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def add_zone_features(points_df, zones_df):
    """Ø§ÙØ²ÙˆØ¯Ù† ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ù†Ø·Ù‚Ù‡â€ŒØ§ÛŒ"""
    
    points_df.createOrReplaceTempView("points")
    zones_df.createOrReplaceTempView("zones")
    
    zone_features = sedona.sql("""
        SELECT 
            p.*,
            z JOIN zones z ON ST_Contains(z.boundary, p.location)
    """)
    
    return zone_features

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø²Ù…Ø§Ù†ÛŒ-Ù…Ú©Ø§Ù†ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def add_spatiotemporal_features(df):
    """Ø§ÙØ²ÙˆØ¯Ù† ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø²Ù…Ø§Ù†ÛŒ-Ù…Ú©Ø§Ù†ÛŒ"""
    
    return df.withColumn(
        "hour_of_day", F.hour("timestamp")
    ).withColumn(
        "day_of_week", F.dayofweek("timestamp")
    ).withColumn(
        "is_weekend", F.when(F.dayofweek("timestamp").isin([1, 7]), 1).otherwise(0)
    ).withColumn(
        "is_rush_hour", F.when(
            F.hour("timestamp").between(7, 9) | F.hour("timestamp").between(17, 19), 
            1
        ).otherwise(0)
    )</code></pre>
                </div>
            </div>

            <h3>ğŸ“ Ø®ÙˆØ´Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ú©Ø§Ù†ÛŒ</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>spatial_clustering.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">from pyspark.ml.feature import VectorAssembler
from pyspark.ml.clustering import KMeans, BisectingKMeans, GaussianMixture

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# K-Means Clustering
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡
points_with_coords = points_df.selectExpr(
    "id",
    "ST_X(location) as x",
    "ST_Y(location) as y",
    "location"
)

# Ø§ÛŒØ¬Ø§Ø¯ Ø¨Ø±Ø¯Ø§Ø± ÙˆÛŒÚ˜Ú¯ÛŒ
assembler = VectorAssembler(
    inputCols=["x", "y"],
    outputCol="features"
)

features_df = assembler.transform(points_with_coords)

# Ø¢Ù…ÙˆØ²Ø´ Ù…Ø¯Ù„ K-Means
kmeans = KMeans(k=5, seed=42, featuresCol="features", predictionCol="cluster")
model = kmeans.fit(features_df)

# Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ
clustered_df = model.transform(features_df)
clustered_df.show()

# Ù…Ø±Ø§Ú©Ø² Ø®ÙˆØ´Ù‡â€ŒÙ‡Ø§
centers = model.clusterCenters()
print("Cluster Centers:")
for i, center in enumerate(centers):
    print(f"  Cluster {i}: ({center[0]:.4f}, {center[1]:.4f})")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ø®ÙˆØ´Ù‡â€ŒØ¨Ù†Ø¯ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

from pyspark.ml.evaluation import ClusteringEvaluator

evaluator = ClusteringEvaluator(
    featuresCol="features",
    predictionCol="cluster",
    metricName="silhouette"
)

silhouette = evaluator.evaluate(clustered_df)
print(f"Silhouette Score: {silhouette:.4f}")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† ØªØ¹Ø¯Ø§Ø¯ Ø¨Ù‡ÛŒÙ†Ù‡ Ø®ÙˆØ´Ù‡â€ŒÙ‡Ø§ (Elbow Method)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def find_optimal_k(df, max_k=10):
    """Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† ØªØ¹Ø¯Ø§Ø¯ Ø¨Ù‡ÛŒÙ†Ù‡ Ø®ÙˆØ´Ù‡â€ŒÙ‡Ø§"""
    
    costs = []
    silhouettes = []
    
    for k in range(2, max_k + 1):
        kmeans = KMeans(k=k, seed=42)
        model = kmeans.fit(df)
        
        # Ù‡Ø²ÛŒÙ†Ù‡ (WSSSE)
        cost = model.summary.trainingCost
        costs.append((k, cost))
        
        # Silhouette
        predictions = model.transform(df)
        silhouette = evaluator.evaluate(predictions)
        silhouettes.append((k, silhouette))
        
        print(f"k={k}: Cost={cost:.2f}, Silhouette={silhouette:.4f}")
    
    return costs, silhouettes

costs, silhouettes = find_optimal_k(features_df, max_k=10)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# DBSCAN-like Clustering Ø¨Ø§ Sedona
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def dbscan_like_clustering(df, eps=0.01, min_points=5):
    """Ø®ÙˆØ´Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ú†Ú¯Ø§Ù„ÛŒ"""
    
    df.createOrReplaceTempView("points")
    
    # Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ù‡Ù…Ø³Ø§ÛŒÙ‡â€ŒÙ‡Ø§
    neighbors = sedona.sql(f"""
        SELECT 
            p1.id as point_id,
            COUNT(p2.id) as neighbor_count,
            COLLECT_LIST(p2.id) as neighbors
        FROM points p1, points p2
        WHERE ST_DWithin(p1.location, p2.location, {eps})
          AND p1.id != p2.id
        GROUP BY p1.id
    """)
    
    # Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ core points
    core_points = neighbors.filter(f"neighbor_count >= {min_points}")
    
    return core_points

core_points = dbscan_like_clustering(points_df, eps=0.01, min_points=5)
core_points.show()</code></pre>
                </div>
            </div>

            <h3>ğŸ“ˆ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù…Ú©Ø§Ù†ÛŒ</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>spatial_prediction.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">from pyspark.ml.regression import RandomForestRegressor, GBTRegressor
from pyspark.ml.evaluation import RegressionEvaluator
from pyspark.ml import Pipeline

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù‚ÛŒÙ…Øª Ù…Ù„Ú© Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…ÙˆÙ‚Ø¹ÛŒØª
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡
property_data = sedona.sql("""
    SELECT 
        id,
        location,
        ST_X(location) as longitude,
        ST_Y(location) as latitude,
        ST_Distance(location, ST_Point(51.3890, 35.6892)) as dist_center,
        ST_Distance(location, ST_Point(51.4103, 35.7129)) as dist_metro,
        area_sqm,
        bedrooms,
        price
    FROM properties
""")

# Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§
feature_cols = [
    "longitude", "latitude", "dist_center", 
    "dist_metro", "area_sqm", "bedrooms"
]

assembler = VectorAssembler(inputCols=feature_cols, outputCol="features")

# ØªÙ‚Ø³ÛŒÙ… Ø¯Ø§Ø¯Ù‡
train_df, test_df = property_data.randomSplit([0.8, 0.2], seed=42)

# Ù…Ø¯Ù„ Random Forest
rf = RandomForestRegressor(
    featuresCol="features",
    labelCol="price",
    numTrees=100,
    maxDepth=10
)

# Pipeline
pipeline = Pipeline(stages=[assembler, rf])

# Ø¢Ù…ÙˆØ²Ø´
model = pipeline.fit(train_df)

# Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ
predictions = model.transform(test_df)
predictions.select("id", "price", "prediction").show()

# Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ
evaluator = RegressionEvaluator(
    labelCol="price",
    predictionCol="prediction",
    metricName="rmse"
)

rmse = evaluator.evaluate(predictions)
r2 = evaluator.evaluate(predictions, {evaluator.metricName: "r2"})

print(f"RMSE: {rmse:,.0f}")
print(f"RÂ²: {r2:.4f}")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§Ù‡Ù…ÛŒØª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

rf_model = model.stages[-1]
importances = rf_model.featureImportances

print("\nFeature Importances:")
for i, col in enumerate(feature_cols):
    print(f"  {col}: {importances[i]:.4f}")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù‚Ø§Ø· Ø¬Ø¯ÛŒØ¯
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

new_properties = sedona.sql("""
    SELECT 
        'new_1' as id,
        ST_Point(51.40, 35.70) as location,
        51.40 as longitude,
        35.70 as latitude,
        ST_Distance(ST_Point(51.40, 35.70), ST_Point(51.3890, 35.6892)) as dist_center,
        ST_Distance(ST_Point(51.40, 35.70), ST_Point(51.4103, 35.7129)) as dist_metro,
        120.0 as area_sqm,
        3 as bedrooms
""")

predicted_prices = model.transform(new_properties)
predicted_prices.select("id", "prediction").show()</code></pre>
                </div>
            </div>

            <h3>ğŸ”¥ ØªØ´Ø®ÛŒØµ Hotspot</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>hotspot_detection.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ØªØ´Ø®ÛŒØµ Hotspot Ø¨Ø§ ØªØ­Ù„ÛŒÙ„ Ú†Ú¯Ø§Ù„ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def detect_hotspots(df, grid_size=0.01, threshold_percentile=90):
    """ØªØ´Ø®ÛŒØµ Ù†Ù‚Ø§Ø· Ø¯Ø§Øº Ø¨Ø± Ø§Ø³Ø§Ø³ Ú†Ú¯Ø§Ù„ÛŒ"""
    
    df.createOrReplaceTempView("events")
    
    # ØªØ¬Ù…ÛŒØ¹ Ø¯Ø± grid
    grid_density = sedona.sql(f"""
        SELECT 
            FLOOR(ST_X(location) / {grid_size}) * {grid_size} as grid_x,
            FLOOR(ST_Y(location) / {grid_size}) * {grid_size} as grid_y,
            COUNT(*) as event_count,
            ST_Centroid(ST_Collect(location)) as grid_center
        FROM events
        GROUP BY 
            FLOOR(ST_X(location) / {grid_size}),
            FLOOR(ST_Y(location) / {grid_size})
    """)
    
    # Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¢Ø³ØªØ§Ù†Ù‡
    threshold = grid_density.approxQuantile("event_count", [threshold_percentile / 100], 0.01)[0]
    
    # ÙÛŒÙ„ØªØ± hotspots
    hotspots = grid_density.filter(f"event_count >= {threshold}")
    
    print(f"Threshold: {threshold}")
    print(f"Hotspots found: {hotspots.count()}")
    
    return hotspots

hotspots = detect_hotspots(events_df, grid_size=0.005, threshold_percentile=95)
hotspots.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Getis-Ord Gi* Statistic
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def getis_ord_gi_star(df, value_col, distance_threshold=0.01):
    """Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¢Ù…Ø§Ø±Ù‡ Getis-Ord Gi*"""
    
    df.createOrReplaceTempView("spatial_data")
    
    # Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ùˆ Ø§Ù†Ø­Ø±Ø§Ù Ù…Ø¹ÛŒØ§Ø± Ú©Ù„ÛŒ
    stats = df.agg(
        F.mean(value_col).alias("global_mean"),
        F.stddev(value_col).alias("global_std"),
        F.count("*").alias("n")
    ).collect()[0]
    
    global_mean = stats["global_mean"]
    global_std = stats["global_std"]
    n = stats["n"]
    
    # Ù…Ø­Ø§Ø³Ø¨Ù‡ Gi* Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ù†Ù‚Ø·Ù‡
    gi_star = sedona.sql(f"""
        WITH neighbors AS (
            SELECT 
                a.id,
                a.location,
                a.{value_col} as value,
                SUM(b.{value_col}) as sum_neighbors,
                COUNT(b.id) as num_neighbors
            FROM spatial_data a, spatial_data b
            WHERE ST_DWithin(a.location, b.location, {distance_threshold})
            GROUP BY a.id, a.location, a.{value_col}
        )
        SELECT 
            id,
            location,
            value,
            sum_neighbors,
            num_neighbors,
            (sum_neighbors - {global_mean} * num_neighbors) / 
            ({global_std} * SQRT((({n} * num_neighbors) - (num_neighbors * num_neighbors)) / ({n} - 1))) 
            as gi_star_score
        FROM neighbors
    """)
    
    # Gi* > 1.96 = hotspot (95% confidence)
    # Gi* < -1.96 = coldspot
    hotspots = gi_star.filter("gi_star_score > 1.96")
    coldspots = gi_star.filter("gi_star_score < -1.96")
    
    print(f"Hotspots (Gi* > 1.96): {hotspots.count()}")
    print(f"Coldspots (Gi* < -1.96): {coldspots.count()}")
    
    return gi_star

gi_results = getis_ord_gi_star(crime_df, "crime_count", distance_threshold=0.01)
gi_results.orderBy(F.desc("gi_star_score")).show(10)</code></pre>
                </div>
            </div>
        </section>

        <!-- Section 12: Projects -->
        <section class="section" id="projects">
            <div class="section-header">
                <div class="section-icon">ğŸš€</div>
                <div class="section-title-group">
                    <div class="section-number">ÙØµÙ„ Ø¯ÙˆØ§Ø²Ø¯Ù‡Ù…</div>
                    <h2 class="section-title">Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒ</h2>
                    <p class="section-subtitle">Ù†Ù…ÙˆÙ†Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒ Ø¨Ø§ Apache Sedona</p>
                </div>
            </div>

            <h3>ğŸš• Ù¾Ø±ÙˆÚ˜Ù‡ 1: ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ§Ú©Ø³ÛŒ</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>taxi_analysis.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">"""
Ù¾Ø±ÙˆÚ˜Ù‡ ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ§Ú©Ø³ÛŒ Ø´Ù‡Ø±ÛŒ
- ØªØ­Ù„ÛŒÙ„ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø³ÙØ±
- Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù…Ù†Ø§Ø·Ù‚ Ù¾Ø±ØªÙ‚Ø§Ø¶Ø§
- Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ ØªÙ‚Ø§Ø¶Ø§
"""

from sedona.spark import *
from pyspark.sql import functions as F
from pyspark.ml.feature import VectorAssembler
from pyspark.ml.clustering import KMeans

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 1. Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø®ÙˆØ§Ù†Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø³ÙØ± ØªØ§Ú©Ø³ÛŒ
taxi_df = sedona.read.parquet("s3://bucket/taxi_trips/") \
    .selectExpr(
        "trip_id",
        "ST_Point(pickup_longitude, pickup_latitude) as pickup_location",
        "ST_Point(dropoff_longitude, dropoff_latitude) as dropoff_location",
        "pickup_datetime",
        "dropoff_datetime",
        "passenger_count",
        "trip_distance",
        "fare_amount"
    )

# ÙÛŒÙ„ØªØ± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø±
taxi_df = taxi_df.filter("""
    ST_X(pickup_location) BETWEEN -74.3 AND -73.7
    AND ST_Y(pickup_location) BETWEEN 40.5 AND 41.0
    AND fare_amount > 0
    AND trip_distance > 0
""")

taxi_df.createOrReplaceTempView("taxi_trips")
print(f"Total trips: {taxi_df.count():,}")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 2. ØªØ­Ù„ÛŒÙ„ Ù…Ù†Ø§Ø·Ù‚ Ù¾Ø±ØªÙ‚Ø§Ø¶Ø§
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ØªØ¬Ù…ÛŒØ¹ Ø¨Ø± Ø§Ø³Ø§Ø³ grid
pickup_density = sedona.sql("""
    SELECT 
        FLOOR(ST_X(pickup_location) * 1000) / 1000 as grid_x,
        FLOOR(ST_Y(pickup_location) * 1000) / 1000 as grid_y,
        COUNT(*) as pickup_count,
        AVG(fare_amount) as avg_fare,
        AVG(trip_distance) as avg_distance,
        ST_Centroid(ST_Collect(pickup_location)) as grid_center
    FROM taxi_trips
    GROUP BY 
        FLOOR(ST_X(pickup_location) * 1000),
        FLOOR(ST_Y(pickup_location) * 1000)
    HAVING COUNT(*) > 100
    ORDER BY pickup_count DESC
""")

print("Top 10 Pickup Hotspots:")
pickup_density.show(10)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 3. ØªØ­Ù„ÛŒÙ„ Ø²Ù…Ø§Ù†ÛŒ-Ù…Ú©Ø§Ù†ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

hourly_patterns = sedona.sql("""
    SELECT 
        HOUR(pickup_datetime) as hour,
        DAYOFWEEK(pickup_datetime) as day_of_week,
        COUNT(*) as trip_count,
        AVG(fare_amount) as avg_fare,
        AVG(trip_distance) as avg_distance
    FROM taxi_trips
    GROUP BY HOUR(pickup_datetime), DAYOFWEEK(pickup_datetime)
    ORDER BY day_of_week, hour
""")

hourly_patterns.show(24)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 4. ØªØ­Ù„ÛŒÙ„ OD (Origin-Destination)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ù†Ø§Ø·Ù‚
zones_df = sedona.read.format("geojson") \
    .load("zones.geojson")
zones_df.createOrReplaceTempView("zones")

# Ù…Ø§ØªØ±ÛŒØ³ OD
od_matrix = sedona.sql("""
    SELECT 
        oz.zone_name as origin_zone,
        dz.zone_name as destination_zone,
        COUNT(*) as trip_count,
        AVG(fare_amount) as avg_fare,
        AVG(trip_distance) as avg_distance,
        AVG(UNIX_TIMESTAMP(dropoff_datetime) - UNIX_TIMESTAMP(pickup_datetime)) / 60 as avg_duration_min
    FROM taxi_trips t
    JOIN zones oz ON ST_Contains(oz.geometry, t.pickup_location)
    JOIN zones dz ON ST_Contains(dz.geometry, t.dropoff_location)
    GROUP BY oz.zone_name, dz.zone_name
    HAVING COUNT(*) > 50
    ORDER BY trip_count DESC
""")

print("Top OD Pairs:")
od_matrix.show(20)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 5. Ø®ÙˆØ´Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ù‚Ø§ØµØ¯
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø®ØªØµØ§Øª
dropoff_coords = taxi_df.selectExpr(
    "trip_id",
    "ST_X(dropoff_location) as x",
    "ST_Y(dropoff_location) as y"
).sample(0.1)  # Ù†Ù…ÙˆÙ†Ù‡ 10%

# Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø±Ø§ÛŒ ML
assembler = VectorAssembler(inputCols=["x", "y"], outputCol="features")
features_df = assembler.transform(dropoff_coords)

# K-Means
kmeans = KMeans(k=20, seed=42)
model = kmeans.fit(features_df)

# Ù†ØªØ§ÛŒØ¬
clustered = model.transform(features_df)
cluster_stats = clustered.groupBy("prediction").count().orderBy(F.desc("count"))
cluster_stats.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 6. Ø°Ø®ÛŒØ±Ù‡ Ù†ØªØ§ÛŒØ¬
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø°Ø®ÛŒØ±Ù‡ hotspots
pickup_density.write.format("geoparquet") \
    .mode("overwrite") \
    .save("output/pickup_hotspots/")

# Ø°Ø®ÛŒØ±Ù‡ OD matrix
od_matrix.write.parquet("output/od_matrix/")

print("âœ… Analysis complete!")</code></pre>
                </div>
            </div>

            <h3>ğŸ›°ï¸ Ù¾Ø±ÙˆÚ˜Ù‡ 2: Ù¾Ø±Ø¯Ø§Ø²Ø´ ØªØµØ§ÙˆÛŒØ± Ù…Ø§Ù‡ÙˆØ§Ø±Ù‡â€ŒØ§ÛŒ</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>satellite_analysis.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">"""
Ù¾Ø±ÙˆÚ˜Ù‡ Ù¾Ø±Ø¯Ø§Ø²Ø´ ØªØµØ§ÙˆÛŒØ± Ù…Ø§Ù‡ÙˆØ§Ø±Ù‡â€ŒØ§ÛŒ
- Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø´Ø§Ø®Øµâ€ŒÙ‡Ø§ÛŒ Ú¯ÛŒØ§Ù‡ÛŒ
- ØªØ´Ø®ÛŒØµ ØªØºÛŒÛŒØ±Ø§Øª
- ØªØ­Ù„ÛŒÙ„ Ù¾ÙˆØ´Ø´ Ø²Ù…ÛŒÙ†
"""

from sedona.spark import *

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 1. Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØµØ§ÙˆÛŒØ± Landsat
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø®ÙˆØ§Ù†Ø¯Ù† ØªØµØ§ÙˆÛŒØ±
landsat_df = sedona.read.format("binaryFile") \
    .option("pathGlobFilter", "*.tif") \
    .load("s3://bucket/landsat/") \
    .selectExpr(
        "path",
        "RS_FromGeoTiff(content) as raster"
    )

landsat_df.createOrReplaceTempView("landsat")

# Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªØµØ§ÙˆÛŒØ±
image_info = sedona.sql("""
    SELECT 
        path,
        RS_NumBands(raster) as bands,
        RS_Width(raster) as width,
        RS_Height(raster) as height,
        RS_Envelope(raster) as extent
    FROM landsat
""")

image_info.show(truncate=False)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 2. Ù…Ø­Ø§Ø³Ø¨Ù‡ NDVI
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ndvi_df = sedona.sql("""
    SELECT 
        path,
        RS_NormalizedDifference(
            RS_Band(raster, 5),  -- NIR (Band 5 in Landsat 8)
            RS_Band(raster, 4)   -- Red (Band 4)
        ) as ndvi,
        RS_Envelope(raster) as extent
    FROM landsat
""")

ndvi_df.createOrReplaceTempView("ndvi_images")

# Ø¢Ù…Ø§Ø± NDVI
ndvi_stats = sedona.sql("""
    SELECT 
        path,
        RS_Mean(ndvi, 1) as mean_ndvi,
        RS_StdDev(ndvi, 1) as std_ndvi,
        RS_Min(ndvi, 1) as min_ndvi,
        RS_Max(ndvi, 1) as max_ndvi
    FROM ndvi_images
""G(RS_ZonalStats(n.ndvi, r.geometry, 'mean')) as mean_ndvi,
        AVG(RS_ZonalStats(n.ndvi, r.geometry, 'std')) as std_ndvi,
        SUM(RS_ZonalStats(n.ndvi, r.geometry, 'count')) as pixel_count
    FROM regions r, ndvi_images n
    WHERE ST_Intersects(RS_Envelope(n.ndvi), r.geometry)
    GROUP BY r.region_name
    ORDER BY mean_ndvi DESC
""")

zonal_ndvi.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 5. ØªØ´Ø®ÛŒØµ ØªØºÛŒÛŒØ±Ø§Øª (Change Detection)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ÙØ±Ø¶: Ø¯Ùˆ ØªØµÙˆÛŒØ± Ø§Ø² Ø²Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù
change_detection = sedona.sql("""
    WITH time1 AS (
        SELECT ndvi as ndvi_t1 FROM ndvi_images WHERE path LIKE '%2023%'
    ),
    time2 AS (
        SELECT ndvi as ndvi_t2 FROM ndvi_images WHERE path LIKE '%2024%'
    )
    SELECT 
        RS_Subtract(t2.ndvi_t2, t1.ndvi_t1) as ndvi_change,
        RS_MapAlgebra(
            RS_Subtract(t2.ndvi_t2, t1.ndvi_t1), 1, 'D',
            'CASE 
                WHEN D < -0.2 THEN -1   -- Ú©Ø§Ù‡Ø´ Ø´Ø¯ÛŒØ¯
                WHEN D > 0.2 THEN 1     -- Ø§ÙØ²Ø§ÛŒØ´ Ø´Ø¯ÛŒØ¯
                ELSE 0                   -- Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ±
            END'
        ) as change_class
    FROM time1 t1, time2 t2
""")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 6. Ø°Ø®ÛŒØ±Ù‡ Ù†ØªØ§ÛŒØ¬
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø°Ø®ÛŒØ±Ù‡ NDVI Ø¨Ù‡ GeoTIFF
ndvi_output = sedona.sql("""
    SELECT RS_AsGeoTiff(ndvi) as geotiff
    FROM ndvi_images
    LIMIT 1
""").collect()[0].geotiff

with open("output/ndvi.tif", "wb") as f:
    f.write(ndvi_output)

print("âœ… Satellite analysis complete!")</code></pre>
                </div>
            </div>

            <h3>ğŸ™ï¸ Ù¾Ø±ÙˆÚ˜Ù‡ 3: ØªØ­Ù„ÛŒÙ„ Ø´Ù‡Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯</h3>
            <div class="code-block">
                <div class="code-header">
                    <div class="code-lang">
                        <div class="code-lang-icon python">ğŸ</div>
                        <span>smart_city_analysis.py</span>
                    </div>
                    <div class="code-actions">
                        <button class="code-btn" onclick="copyCode(this)">
                            <span>ğŸ“‹</span> Ú©Ù¾ÛŒ
                        </button>
                    </div>
                </div>
                <div class="code-body">
<pre><code class="language-python">"""
Ù¾Ø±ÙˆÚ˜Ù‡ ØªØ­Ù„ÛŒÙ„ Ø´Ù‡Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯
- ØªØ­Ù„ÛŒÙ„ ØªØ±Ø§ÙÛŒÚ©
- Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø®Ø¯Ù…Ø§Øª Ø´Ù‡Ø±ÛŒ
- ØªØ­Ù„ÛŒÙ„ Ø¯Ø³ØªØ±Ø³ÛŒ
"""

from sedona.spark import *
from pyspark.sql import functions as F

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 1. Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø´Ù‡Ø±ÛŒ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø´Ø¨Ú©Ù‡ Ù…Ø¹Ø§Ø¨Ø±
roads_df = sedona.read.format("geoparquet") \
    .load("roads.parquet")
roads_df.createOrReplaceTempView("roads")

# Ù†Ù‚Ø§Ø· POI
pois_df = sedona.read.format("geoparquet") \
    .load("pois.parquet")
pois_df.createOrReplaceTempView("pois")

# Ù…Ù†Ø§Ø·Ù‚ Ø´Ù‡Ø±ÛŒ
districts_df = sedona.read.format("geojson") \
    .load("districts.geojson")
districts_df.createOrReplaceTempView("districts")

# Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ù†Ø³ÙˆØ± ØªØ±Ø§ÙÛŒÚ©
traffic_df = sedona.read.parquet("traffic_sensors/")
traffic_df.createOrReplaceTempView("traffic")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 2. ØªØ­Ù„ÛŒÙ„ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø®Ø¯Ù…Ø§Øª
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ØªØ­Ù„ÛŒÙ„ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø¨ÛŒÙ…Ø§Ø±Ø³ØªØ§Ù†
hospital_access = sedona.sql("""
    WITH hospitals AS (
        SELECT * FROM pois WHERE category = 'hospital'
    ),
    population_grid AS (
        SELECT 
            grid_id,
            ST_Centroid(geometry) as center,
            population
        FROM population_data
    )
    SELECT 
        p.grid_id,
        p.population,
        MIN(ST_Distance(
            ST_Transform(p.center, 'EPSG:4326', 'EPSG:32639'),
            ST_Transform(h.location, 'EPSG:4326', 'EPSG:32639')
        )) as nearest_hospital_meters
    FROM population_grid p
    CROSS JOIN hospitals h
    GROUP BY p.grid_id, p.population
""")

# Ø¢Ù…Ø§Ø± Ø¯Ø³ØªØ±Ø³ÛŒ
access_stats = hospital_access.selectExpr(
    "SUM(CASE WHEN nearest_hospital_meters <= 1000 THEN population ELSE 0 END) as pop_within_1km",
    "SUM(CASE WHEN nearest_hospital_meters <= 2000 THEN population ELSE 0 END) as pop_within_2km",
    "SUM(population) as total_population"
).selectExpr(
    "pop_within_1km / total_population * 100 as pct_within_1km",
    "pop_within_2km / total_population * 100 as pct_within_2km"
)

access_stats.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 3. ØªØ­Ù„ÛŒÙ„ ØªØ±Ø§ÙÛŒÚ©
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø³Ø±Ø¹Øª Ø¯Ø± Ù‡Ø± segment
traffic_analysis = sedona.sql("""
    SELECT 
        r.road_id,
        r.road_name,
        r.geometry,
        AVG(t.speed) as avg_speed,
        AVG(t.volume) as avg_volume,
        STDDEV(t.speed) as speed_variability
    FROM roads r
    JOIN traffic t ON r.road_id = t.road_id
    WHERE t.timestamp >= current_date() - INTERVAL 7 DAYS
    GROUP BY r.road_id, r.road_name, r.geometry
""")

# Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ú¯Ù„ÙˆÚ¯Ø§Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ±Ø§ÙÛŒÚ©ÛŒ
bottlenecks = traffic_analysis.filter("""
    avg_speed < 20 AND avg_volume > 1000
""").orderBy(F.asc("avg_speed"))

print("Traffic
        -- Ø§Ù…ØªÛŒØ§Ø² walkability Ø³Ø§Ø¯Ù‡
        (restaurants * 2 + shops * 1.5 + parks * 3 + transit_stops * 4) / 
        (ST_Area(ST_Transform(geometry, 'EPSG:4326', 'EPSG:32639')) / 1000000) as walkability_score
    FROM amenities_count
    ORDER BY walkability_score DESC
""")

walkability_score.show()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 6. Ø°Ø®ÛŒØ±Ù‡ Ù†ØªØ§ÛŒØ¬
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø°Ø®ÛŒØ±Ù‡ Ø¨Ù‡ GeoParquet
traffic_analysis.write.format("geoparquet") \
    .mode("overwrite") \
    .save("output/traffic_analysis/")

walkability_score.write.parquet("output/walkability/")

print("âœ… Smart city analysis complete!")</code></pre>
                </div>
            </div>

            <h3>ğŸ“š Ù…Ù†Ø§Ø¨Ø¹ Ùˆ Ù…Ø±Ø§Ø¬Ø¹</h3>
            <div class="feature-grid">
                <a href="https://sedona.apache.org/latest/" target="_blank" class="feature-card" style="text-decoration: none;">
                    <div class="feature-icon">ğŸ“–</div>
                    <div class="feature-title">Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø±Ø³Ù…ÛŒ</div>
                    <div class="feature-desc">Apache Sedona Documentation</div>
                </a>
                
                <a href="https://github.com/apache/sedona" target="_blank" class="feature-card" style="text-decoration: none;">
                    <div class="feature-icon">ğŸ’»</div>
                    <div class="feature-title">GitHub Repository</div>
                    <div class="feature-desc">Ú©Ø¯ Ù…Ù†Ø¨Ø¹ Ùˆ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§</div>
                </a>
                
                <a href="https://sedona.apache.org/latest/api/sql/Overview/" target="_blank" class="feature-card" style="text-decoration: none;">
                    <div class="feature-icon">ğŸ—„ï¸</div>
                    <div class="feature-title">SQL Reference</div>
                    <div class="feature-desc">Ù„ÛŒØ³Øª Ú©Ø§Ù…Ù„ ØªÙˆØ§Ø¨Ø¹ SQL</div>
                </a>
                
                <a href="https://spark.apache.org/docs/latest/" target="_blank" class="feature-card" style="text-decoration: none;">
                    <div class="feature-icon">âš¡</div>
                    <div class="feature-title">Apache Spark Docs</div>
                    <div class="feature-desc">Ù…Ø³ØªÙ†Ø¯Ø§Øª Spark</div>
                </a>
            </div>

            <div class="info-box success">
                <div class="info-box-title">
                    <span>ğŸ¯</span>
                    Ø®Ù„Ø§ØµÙ‡ Ø¢Ù…ÙˆØ²Ø´
                </div>
                <div class="info-box-content">
                    Ø¯Ø± Ø§ÛŒÙ† Ø¢Ù…ÙˆØ²Ø´ Ø¨Ø§ Apache Sedona Ø¢Ø´Ù†Ø§ Ø´Ø¯ÛŒØ¯:
                    <ul>
                        <li><strong>Ù…Ø¹Ù…Ø§Ø±ÛŒ:</strong> Ø³Ø§Ø®ØªØ§Ø± Sedona Ø±ÙˆÛŒ Apache Spark</li>
                        <li><strong>Ø§Ù†ÙˆØ§Ø¹ Ø¯Ø§Ø¯Ù‡:</strong> Vector Ùˆ Raster</li>
                        <li><strong>Spatial SQL:</strong> Ø¨ÛŒØ´ Ø§Ø² 200 ØªØ§Ø¨Ø¹ Ù…Ú©Ø§Ù†ÛŒ</li>
                        <li><strong>Ø¹Ù…Ù„ÛŒØ§Øª:</strong> Join, KNN, Range Query</li>
                        <li><strong>Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ:</strong> Ø´Ø§Ø®Øµâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ùˆ Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ</li>
                        <li><strong>ML:</strong> ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù…Ø§Ø´ÛŒÙ† Ù…Ú©Ø§Ù†ÛŒ</li>
                        <li><strong>Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§:</strong> ØªØ§Ú©Ø³ÛŒØŒ Ù…Ø§Ù‡ÙˆØ§Ø±Ù‡ØŒ Ø´Ù‡Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯</li>
                    </ul>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>ğŸŒ Apache Sedona</h4>
                <p>Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø¯Ø± Ù…Ù‚ÛŒØ§Ø³ Ú©Ù„Ø§Ù†</p>
            </div>
            
            <div class="footer-section">
                <h4>Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ù…ÙÛŒØ¯</h4>
                <ul>
                    <li><a href="https://sedona.apache.org" target="_blank">Ø³Ø§ÛŒØª Ø±Ø³Ù…ÛŒ</a></li>
                    <li><a href="https://github.com/apache/sedona" target="_blank">GitHub</a></li>
                    <li><a href="https://spark.apache.org" target="_blank">Apache Spark</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4>ÙØµÙ„â€ŒÙ‡Ø§</h4>
                <ul>
                    <li><a href="#intro">Ù…Ø¹Ø±ÙÛŒ</a></li>
                    <li><a href="#sql">Spatial SQL</a></li>
                    <li><a href="#optimization">Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ</a></li>
                    <li><a href="#projects">Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§</a></li>
                </ul>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø¨Ø§ â¤ï¸ Ø¨Ø±Ø§ÛŒ Ø¬Ø§Ù…Ø¹Ù‡ GIS Ø§ÛŒØ±Ø§Ù†</p>
            <p>Â© 2025 - ØªÙ…Ø§Ù…ÛŒ Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/scala.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/yaml.min.js"></script>
    
    <script>
        // Initialize highlight.js
        document.addEventListener('DOMContentLoaded', () => {
            hljs.highlightAll();
        });
        
        // Copy code function
        function copyCode(button) {
            const codeBlock = button.closest('.code-block');
            const code = codeBlock.querySelector('code').textContent;
            
            navigator.clipboard.writeText(code).then(() => {
                const originalText = button.innerHTML;
                button.innerHTML = '<span>âœ…</span> Ú©Ù¾ÛŒ Ø´Ø¯!';
                button.style.background = 'rgba(76, 175, 80, 0.3)';
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.style.background = '';
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy:', err);
            });
        }
        
        // Scroll progress
        window.addEventListener('scroll', () => {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById('scrollProgress').style.width = scrolled + '%';
        });
        
        // Smooth scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
        
        // Active nav link
        const sections = document.querySelectorAll('.section');
        const navLinks = document.querySelectorAll('.nav-link');
        
        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (pageYOffset >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });
            
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        });
        
        console.log('ğŸŒ Apache Sedona Tutorial Loaded!');
        console.log('ğŸ“š Sections:', document.querySelectorAll('.section').length);
    </script>
</body>
</html>