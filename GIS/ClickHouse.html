<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¢Ù…ÙˆØ²Ø´ Ú©Ø§Ù…Ù„ ClickHouse Ø¨Ø±Ø§ÛŒ GIS | ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø¯Ø± Ù…Ù‚ÛŒØ§Ø³ Ø¨Ø²Ø±Ú¯</title>
    <meta name="description" content="Ø¢Ù…ÙˆØ²Ø´ Ø¬Ø§Ù…Ø¹ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ClickHouse Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ØŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ùˆ ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ùˆ Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒ">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           CSS VARIABLES
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        :root {
            --color-primary: #ffcc00;
            --color-primary-dark: #e6b800;
            --color-primary-light: #fff9e6;
            --color-secondary: #ff6600;
            --color-accent: #00d4aa;
            --color-dark: #1a1a2e;
            --color-darker: #16162a;
            --color-success: #10b981;
            --color-warning: #f59e0b;
            --color-danger: #ef4444;
            --color-info: #3b82f6;
            
            --color-gray-50: #f9fafb;
            --color-gray-100: #f3f4f6;
            --color-gray-200: #e5e7eb;
            --color-gray-300: #d1d5db;
            --color-gray-400: #9ca3af;
            --color-gray-500: #6b7280;
            --color-gray-600: #4b5563;
            --color-gray-700: #374151;
            --color-gray-800: #1f2937;
            --color-gray-900: #111827;
            
            --font-family: 'Vazirmatn', system-ui, -apple-system, sans-serif;
            --font-mono: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.15);
            --shadow-xl: 0 20px 50px rgba(0, 0, 0, 0.2);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 20px;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           RESET & BASE
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-family);
            font-size: 16px;
            line-height: 1.8;
            color: var(--color-gray-700);
            background: var(--color-gray-50);
        }

        img {
            max-width: 100%;
            height: auto;
        }

        a {
            color: var(--color-secondary);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        a:hover {
            color: var(--color-primary-dark);
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           HERO SECTION
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .hero {
            background: linear-gradient(135deg, var(--color-dark) 0%, var(--color-darker) 50%, #0f0f23 100%);
            color: white;
            padding: 80px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 204, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 102, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(0, 212, 170, 0.05) 0%, transparent 70%);
        }

        .hero::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffcc00' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.5;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 1000px;
            margin: 0 auto;
        }

        .hero-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .hero-icon {
            font-size: 4rem;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .clickhouse-logo {
            width: 80px;
            height: 80px;
            background: var(--color-primary);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--color-dark);
            box-shadow: 0 10px 40px rgba(255, 204, 0, 0.3);
        }

        .hero h1 {
            font-size: 3rem;
            font-weight: 900;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero-subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 30px;
            font-weight: 300;
        }

        .hero-badges {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 40px;
        }

        .hero-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 204, 0, 0.2);
            font-size: 0.9rem;
        }

        .hero-badge-icon {
            font-size: 1.2rem;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           TABLE OF CONTENTS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .toc {
            background: white;
            max-width: 900px;
            margin: -40px auto 40px;
            border-radius: var(--radius-lg);
            padding: 40px;
            box-shadow: var(--shadow-xl);
            position: relative;
            z-index: 10;
        }

        .toc h2 {
            font-size: 1.5rem;
            color: var(--color-dark);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .toc-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            background: var(--color-gray-50);
            border-radius: var(--radius-sm);
            color: var(--color-gray-700);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .toc-item:hover {
            background: var(--color-primary-light);
            border-color: var(--color-primary);
            color: var(--color-dark);
            transform: translateX(-5px);
        }

        .toc-number {
            width: 30px;
            height: 30px;
            background: var(--color-primary);
            color: var(--color-dark);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           MAIN CONTENT
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .main-content {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Section Styles */
        .section {
            background: white;
            border-radius: var(--radius-lg);
            padding: 50px;
            margin-bottom: 40px;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, var(--color-primary-light) 0%, transparent 70%);
            opacity: 0.5;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            position: relative;
            z-index: 1;
        }

        .section-number {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
            color: var(--color-dark);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 900;
            flex-shrink: 0;
            box-shadow: 0 5px 20px rgba(255, 204, 0, 0.3);
        }

        .section-title {
            font-size: 1.8rem;
            color: var(--color-dark);
            font-weight: 800;
        }

        .section-content {
            position: relative;
            z-index: 1;
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-dark);
            margin: 35px 0 15px;
            padding-right: 15px;
            border-right: 4px solid var(--color-primary);
        }

        h4 {
            font-size: 1.15rem;
            color: var(--color-gray-800);
            margin: 25px 0 10px;
        }

        p {
            margin-bottom: 15px;
            text-align: justify;
        }

        ul, ol {
            margin: 15px 0;
            padding-right: 25px;
        }

        li {
            margin-bottom: 10px;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           CODE BLOCKS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .code-block {
            background: var(--color-darker);
            border-radius: var(--radius-md);
            margin: 25px 0;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }

        .code-header {
            background: var(--color-dark);
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .code-lang {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--color-primary);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .code-dots {
            display: flex;
            gap: 6px;
        }

        .code-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .code-dot:nth-child(1) { background: #ff5f56; }
        .code-dot:nth-child(2) { background: #ffbd2e; }
        .code-dot:nth-child(3) { background: #27ca40; }

        .code-body {
            padding: 20px;
            overflow-x: auto;
        }

        pre {
            margin: 0;
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.6;
            color: #e2e8f0;
            direction: ltr;
            text-align: left;
        }

        code {
            font-family: var(--font-mono);
        }

        .inline-code {
            background: var(--color-gray-100);
            color: var(--color-secondary);
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.9em;
            font-family: var(--font-mono);
        }

        /* Syntax Highlighting */
        .keyword { color: #c792ea; }
        .function { color: #82aaff; }
        .string { color: #c3e88d; }
        .number { color: #f78c6c; }
        .comment { color: #546e7a; font-style: italic; }
        .type { color: #ffcb6b; }
        .operator { color: #89ddff; }
        .variable { color: #f07178; }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           INFO BOXES
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .box {
            padding: 25px 30px;
            border-radius: var(--radius-md);
            margin: 25px 0;
            position: relative;
        }

        .box-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 15px;
        }

        .box-tip {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border-right: 4px solid var(--color-success);
        }

        .box-tip .box-title { color: #065f46; }

        .box-warning {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-right: 4px solid var(--color-warning);
        }

        .box-warning .box-title { color: #92400e; }

        .box-info {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-right: 4px solid var(--color-info);
        }

        .box-info .box-title { color: #1e40af; }

        .box-danger {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border-right: 4px solid var(--color-danger);
        }

        .box-danger .box-title { color: #991b1b; }

        .box-clickhouse {
            background: linear-gradient(135deg, var(--color-primary-light) 0%, #fff5cc 100%);
            border-right: 4px solid var(--color-primary);
        }

        .box-clickhouse .box-title { color: var(--color-dark); }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           TABLES
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .table-wrapper {
            overflow-x: auto;
            margin: 25px 0;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-md);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th, td {
            padding: 15px 20px;
            text-align: right;
            border-bottom: 1px solid var(--color-gray-200);
        }

        th {
            background: linear-gradient(135deg, var(--color-dark) 0%, var(--color-darker) 100%);
            color: var(--color-primary);
            font-weight: 700;
        }

        tr:nth-child(even) {
            background: var(--color-gray-50);
        }

        tr:hover {
            background: var(--color-primary-light);
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           FEATURE CARDS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .feature-card {
            background: white;
            border-radius: var(--radius-md);
            padding: 30px;
            text-align: center;
            box-shadow: var(--shadow-md);
            border: 2px solid var(--color-gray-100);
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
            border-color: var(--color-primary);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .feature-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--color-dark);
            margin-bottom: 10px;
        }

        .feature-desc {
            color: var(--color-gray-600);
            font-size: 0.95rem;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           COMPARISON SECTION
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .comparison-table {
            margin: 30px 0;
        }

        .comparison-table th:first-child {
            background: var(--color-gray-700);
            color: white;
        }

        .check { color: var(--color-success); font-weight: bold; }
        .cross { color: var(--color-danger); }
        .partial { color: var(--color-warning); }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ARCHITECTURE DIAGRAM
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .architecture {
            background: var(--color-gray-50);
            border-radius: var(--radius-lg);
            padding: 40px;
            margin: 30px 0;
            text-align: center;
        }

        .architecture-title {
            font-size: 1.3rem;
            color: var(--color-dark);
            margin-bottom: 30px;
        }

        .architecture-flow {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .arch-box {
            background: white;
            padding: 20px 30px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-md);
            min-width: 150px;
        }

        .arch-box.source {
            border: 3px solid var(--color-info);
        }

        .arch-box.clickhouse {
            border: 3px solid var(--color-primary);
            background: var(--color-primary-light);
        }

        .arch-box.output {
            border: 3px solid var(--color-success);
        }

        .arch-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .arch-label {
            font-weight: 700;
            color: var(--color-dark);
        }

        .arch-arrow {
            font-size: 2rem;
            color: var(--color-gray-400);
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           STEPS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .steps {
            margin: 30px 0;
        }

        .step {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            align-items: flex-start;
        }

        .step-number {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
            color: var(--color-dark);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.1rem;
            flex-shrink: 0;
            box-shadow: 0 4px 15px rgba(255, 204, 0, 0.3);
        }

        .step-content {
            flex: 1;
            padding-top: 8px;
        }

        .step-content strong {
            color: var(--color-dark);
            display: block;
            margin-bottom: 5px;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           USE CASES
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .use-case {
            background: white;
            border-radius: var(--radius-md);
            padding: 25px;
            margin: 20px 0;
            border-right: 4px solid var(--color-secondary);
            box-shadow: var(--shadow-md);
        }

        .use-case-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .use-case-icon {
            font-size: 2rem;
        }

        .use-case-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--color-dark);
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           FOOTER
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .footer {
            background: linear-gradient(135deg, var(--color-dark) 0%, var(--color-darker) 100%);
            color: white;
            padding: 60px 20px;
            text-align: center;
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .footer h3 {
            color: var(--color-primary);
            margin-bottom: 20px;
            border: none;
        }

        .footer p {
            opacity: 0.8;
            margin-bottom: 10px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .footer-link {
            color: var(--color-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footer-link:hover {
            color: white;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           RESPONSIVE
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 1rem;
            }

            .section {
                padding: 30px 20px;
            }

            .section-header {
                flex-direction: column;
                text-align: center;
            }

            .section-title {
                font-size: 1.4rem;
            }

            .toc {
                padding: 25px;
                margin: -30px 15px 30px;
            }

            .architecture-flow {
                flex-direction: column;
            }

            .arch-arrow {
                transform: rotate(90deg);
            }

            .code-body {
                padding: 15px;
            }

            pre {
                font-size: 0.8rem;
            }
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           PRINT STYLES
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        @media print {
            .hero {
                background: var(--color-dark) !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .section {
                break-inside: avoid;
                box-shadow: none;
                border: 1px solid var(--color-gray-300);
            }

            .code-block {
                break-inside: avoid;
            }
        }
    </style>
</head>
<body>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         HERO SECTION
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <header class="hero">
        <div class="hero-content">
            <div class="hero-logo">
                <span class="hero-icon">ğŸŒ</span>
                <div class="clickhouse-logo">CH</div>
                <span class="hero-icon">ğŸ“Š</span>
            </div>
            <h1>ClickHouse Ø¨Ø±Ø§ÛŒ GIS</h1>
            <p class="hero-subtitle">
                ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø¯Ø± Ù…Ù‚ÛŒØ§Ø³ Ù…ÛŒÙ„ÛŒØ§Ø±Ø¯ÛŒ Ø¨Ø§ Ø³Ø±Ø¹Øª Ù†ÙˆØ±
            </p>
            
            <div class="hero-badges">
                <div class="hero-badge">
                    <span class="hero-badge-icon">âš¡</span>
                    <span>Ù…ÛŒÙ„ÛŒÙˆÙ†â€ŒÙ‡Ø§ Ø±Ø¯ÛŒÙ Ø¯Ø± Ø«Ø§Ù†ÛŒÙ‡</span>
                </div>
                <div class="hero-badge">
                    <span class="hero-badge-icon">ğŸ—ºï¸</span>
                    <span>ØªÙˆØ§Ø¨Ø¹ Ù…Ú©Ø§Ù†ÛŒ Ø¯Ø§Ø®Ù„ÛŒ</span>
                </div>
                <div class="hero-badge">
                    <span class="hero-badge-icon">ğŸ“¦</span>
                    <span>ÙØ´Ø±Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Û±Û°x</span>
                </div>
                <div class="hero-badge">
                    <span class="hero-badge-icon">ğŸ”“</span>
                    <span>Ù…ØªÙ†â€ŒØ¨Ø§Ø² Ùˆ Ø±Ø§ÛŒÚ¯Ø§Ù†</span>
                </div>
            </div>
        </div>
    </header>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         TABLE OF CONTENTS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <nav class="toc">
        <h2>ğŸ“‘ ÙÙ‡Ø±Ø³Øª Ù…Ø·Ø§Ù„Ø¨</h2>
        <div class="toc-grid">
            <a href="#intro" class="toc-item">
                <span class="toc-number">Û±</span>
                <span>ClickHouse Ú†ÛŒØ³ØªØŸ</span>
            </a>
            <a href="#why-gis" class="toc-item">
                <span class="toc-number">Û²</span>
                <span>Ú†Ø±Ø§ ClickHouse Ø¨Ø±Ø§ÛŒ GISØŸ</span>
            </a>
            <a href="#install" class="toc-item">
                <span class="toc-number">Û³</span>
                <span>Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ</span>
            </a>
            <a href="#geo-types" class="toc-item">
                <span class="toc-number">Û´</span>
                <span>Ø§Ù†ÙˆØ§Ø¹ Ø¯Ø§Ø¯Ù‡ Ù…Ú©Ø§Ù†ÛŒ</span>
            </a>
            <a href="#geo-functions" class="toc-item">
                <span class="toc-number">Ûµ</span>
                <span>ØªÙˆØ§Ø¨Ø¹ Ù…Ú©Ø§Ù†ÛŒ</span>
            </a>
            <a href="#h3" class="toc-item">
                <span class="toc-number">Û¶</span>
                <span>Ø³ÛŒØ³ØªÙ… H3</span>
            </a>
            <a href="#geohash" class="toc-item">
                <span class="toc-number">Û·</span>
                <span>Geohash</span>
            </a>
            <a href="#s2" class="toc-item">
                <span class="toc-number">Û¸</span>
                <span>S2 Geometry</span>
            </a>
            <a href="#optimization" class="toc-item">
                <span class="toc-number">Û¹</span>
                <span>Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§</span>
            </a>
            <a href="#real-world" class="toc-item">
                <span class="toc-number">Û±Û°</span>
                <span>Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒ</span>
            </a>
            <a href="#integration" class="toc-item">
                <span class="toc-number">Û±Û±</span>
                <span>ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ</span>
            </a>
            <a href="#best-practices" class="toc-item">
                <span class="toc-number">Û±Û²</span>
                <span>Ø¨Ù‡ØªØ±ÛŒÙ† Ø´ÛŒÙˆÙ‡â€ŒÙ‡Ø§</span>
            </a>
        </div>
    </nav>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         MAIN CONTENT
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <main class="main-content">

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 1: INTRODUCTION
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="intro">
            <div class="section-header">
                <div class="section-number">Û±</div>
                <h2 class="section-title">ClickHouse Ú†ÛŒØ³ØªØŸ</h2>
            </div>
            
            <div class="section-content">
                <p>
                    <strong>ClickHouse</strong> ÛŒÚ© Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ Ø³ØªÙˆÙ†ÛŒ (Columnar DBMS) 
                    Ù…ØªÙ†â€ŒØ¨Ø§Ø² Ø§Ø³Øª Ú©Ù‡ ØªÙˆØ³Ø· Ø´Ø±Ú©Øª <strong>Yandex</strong> ØªÙˆØ³Ø¹Ù‡ ÛŒØ§ÙØªÙ‡ Ùˆ Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ 
                    ØªØ­Ù„ÛŒÙ„ÛŒ Ø¢Ù†Ù„Ø§ÛŒÙ† (OLAP) Ø¯Ø± Ù…Ù‚ÛŒØ§Ø³ Ø¨Ø³ÛŒØ§Ø± Ø¨Ø²Ø±Ú¯ Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª.
                </p>

                <div class="box box-clickhouse">
                    <div class="box-title">
                        <span>âš¡</span>
                        Ø³Ø±Ø¹Øª Ø®ÛŒØ±Ù‡â€ŒÚ©Ù†Ù†Ø¯Ù‡
                    </div>
                    <p>
                        ClickHouse Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ <strong>Ù…ÛŒÙ„ÛŒØ§Ø±Ø¯Ù‡Ø§ Ø±Ø¯ÛŒÙ Ø±Ø§ Ø¯Ø± Ú©Ù…ØªØ± Ø§Ø² ÛŒÚ© Ø«Ø§Ù†ÛŒÙ‡</strong> 
                        Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú©Ù†Ø¯. Ø§ÛŒÙ† Ø³Ø±Ø¹Øª Ø¨Ù‡ Ø¯Ù„ÛŒÙ„ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ø³ØªÙˆÙ†ÛŒØŒ ÙØ´Ø±Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ØŒ 
                        Ùˆ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø³Ø·Ø­ CPU Ø§Ø³Øª.
                    </p>
                </div>

                <h3>ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ</h3>

                <div class="features-grid">
                    <div class="feature-card">
                        <span class="feature-icon">ğŸ“Š</span>
                        <div class="feature-title">Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø³ØªÙˆÙ†ÛŒ</div>
                        <div class="feature-desc">
                            Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø³ØªÙˆÙ†ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ÛŒ Ø¨Ø³ÛŒØ§Ø± Ø³Ø±ÛŒØ¹â€ŒØªØ± Ø§Ø³Øª
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">ğŸ—œï¸</span>
                        <div class="feature-title">ÙØ´Ø±Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§Ù„Ø§</div>
                        <div class="feature-desc">
                            Ù†Ø±Ø® ÙØ´Ø±Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Û±Û° ØªØ§ Û²Û° Ø¨Ø±Ø§Ø¨Ø± Ú©Ù‡ ÙØ¶Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø±Ø§ Ú©Ø§Ù‡Ø´ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">ğŸš€</span>
                        <div class="feature-title">Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…ÙˆØ§Ø²ÛŒ</div>
                        <div class="feature-desc">
                            Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ø§Ù…Ù„ Ø§Ø² ØªÙ…Ø§Ù… Ù‡Ø³ØªÙ‡â€ŒÙ‡Ø§ÛŒ CPU Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù‡Ù…Ø²Ù…Ø§Ù†
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">ğŸ“ˆ</span>
                        <div class="feature-title">Ù…Ù‚ÛŒØ§Ø³â€ŒÙ¾Ø°ÛŒØ±ÛŒ Ø®Ø·ÛŒ</div>
                        <div class="feature-desc">
                            Ø¨Ø§ Ø§ÙØ²ÙˆØ¯Ù† Ø³Ø±ÙˆØ±ØŒ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¨Ù‡ ØµÙˆØ±Øª Ø®Ø·ÛŒ Ø§ÙØ²Ø§ÛŒØ´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">ğŸ—ºï¸</span>
                        <div class="feature-title">Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ GIS</div>
                        <div class="feature-desc">
                            ØªÙˆØ§Ø¨Ø¹ Ù…Ú©Ø§Ù†ÛŒ Ø¯Ø§Ø®Ù„ÛŒ Ø´Ø§Ù…Ù„ H3ØŒ GeohashØŒ S2 Ùˆ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù‡Ù†Ø¯Ø³ÛŒ
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">ğŸ’¾</span>
                        <div class="feature-title">Real-time Ingestion</div>
                        <div class="feature-desc">
                            Ù‚Ø§Ø¨Ù„ÛŒØª Ø¯Ø±Ø¬ Ù…ÛŒÙ„ÛŒÙˆÙ†â€ŒÙ‡Ø§ Ø±Ø¯ÛŒÙ Ø¯Ø± Ø«Ø§Ù†ÛŒÙ‡
                        </div>
                    </div>
                </div>

                <h3>Ù…Ø¹Ù…Ø§Ø±ÛŒ Ø³ØªÙˆÙ†ÛŒ vs Ø³Ø·Ø±ÛŒ</h3>

                <div class="architecture">
                    <div class="architecture-title">Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ</div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; text-align: right;">
                        <div style="background: white; padding: 20px; border-radius: 12px; border: 2px solid var(--color-danger);">
                            <h4 style="color: var(--color-danger); margin-bottom: 15px;">ğŸ”´ Ø³Ø·Ø±ÛŒ (PostgreSQL, MySQL)</h4>
                            <div style="font-family: var(--font-mono); font-size: 0.85rem; direction: ltr; text-align: left; background: var(--color-gray-100); padding: 15px; border-radius: 8px;">
                                Row1: [id=1, lat=35.7, lon=51.4, city="Tehran"]<br>
                                Row2: [id=2, lat=32.6, lon=51.6, city="Isfahan"]<br>
                                Row3: [id=3, lat=29.6, lon=52.5, city="Shiraz"]
                            </div>
                            <p style="margin-top: 15px; font-size: 0.9rem; color: var(--color-gray-600);">
                                Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù† ÛŒÚ© Ø³ØªÙˆÙ†ØŒ Ø¨Ø§ÛŒØ¯ ØªÙ…Ø§Ù… Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§ Ø®ÙˆØ§Ù†Ø¯Ù‡ Ø´ÙˆÙ†Ø¯
                            </p>
                        </div>
                        
                        <div style="background: white; padding: 20px; border-radius: 12px; border: 2px solid var(--color-success);">
                            <h4 style="color: var(--color-success); margin-bottom: 15px;">ğŸŸ¢ Ø³ØªÙˆÙ†ÛŒ (ClickHouse)</h4>
                            <div style="font-family: var(--font-mono); font-size: 0.85rem; direction: ltr; text-align: left; background: var(--color-gray-100); padding: 15px; border-radius: 8px;">
                                id:   [1, 2, 3]<br>
                                lat:  [35.7, 32.6, 29.6]<br>
                                lon:  [51.4, 51.6, 52.5]<br>
                                city: ["Tehran", "Isfahan", "Shiraz"]
                            </div>
                            <p style="margin-top: 15px; font-size: 0.9rem; color: var(--color-gray-600);">
                                ÙÙ‚Ø· Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² Ø®ÙˆØ§Ù†Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 2: WHY CLICKHOUSE FOR GIS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="why-gis">
            <div class="section-header">
                <div class="section-number">Û²</div>
                <h2 class="section-title">Ú†Ø±Ø§ ClickHouse Ø¨Ø±Ø§ÛŒ GISØŸ</h2>
            </div>
            
            <div class="section-content">
                <p>
                    Ø¯Ø± Ø¯Ù†ÛŒØ§ÛŒ GIS Ù…Ø¯Ø±Ù†ØŒ Ø­Ø¬Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø¨Ù‡ Ø³Ø±Ø¹Øª Ø¯Ø± Ø­Ø§Ù„ Ø§ÙØ²Ø§ÛŒØ´ Ø§Ø³Øª. 
                    GPSØŒ IoTØŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ùˆ Ø³Ù†Ø³ÙˆØ±Ù‡Ø§ Ù…ÛŒÙ„ÛŒØ§Ø±Ø¯Ù‡Ø§ Ù†Ù‚Ø·Ù‡ Ø¯Ø§Ø¯Ù‡ ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯ Ú©Ù‡ 
                    Ù¾Ø§ÛŒÚ¯Ø§Ù‡â€ŒØ¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ù†ØªÛŒ Ù‚Ø§Ø¯Ø± Ø¨Ù‡ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø³Ø±ÛŒØ¹ Ø¢Ù†â€ŒÙ‡Ø§ Ù†ÛŒØ³ØªÙ†Ø¯.
                </p>

                <h3>Ú†Ø§Ù„Ø´â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø¨Ø²Ø±Ú¯</h3>

                <ul>
                    <li><strong>Ø­Ø¬Ù… Ø¨Ø§Ù„Ø§:</strong> Ù…ÛŒÙ„ÛŒØ§Ø±Ø¯Ù‡Ø§ Ù†Ù‚Ø·Ù‡ GPS Ø§Ø² Ù†Ø§ÙˆÚ¯Ø§Ù† Ø­Ù…Ù„â€ŒÙˆÙ†Ù‚Ù„</li>
                    <li><strong>Ø³Ø±Ø¹Øª ÙˆØ±ÙˆØ¯:</strong> Ù‡Ø²Ø§Ø±Ø§Ù† Ø±Ú©ÙˆØ±Ø¯ Ø¯Ø± Ø«Ø§Ù†ÛŒÙ‡ Ø§Ø² Ø³Ù†Ø³ÙˆØ±Ù‡Ø§</li>
                    <li><strong>Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒÚ†ÛŒØ¯Ù‡:</strong> ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ-Ø²Ù…Ø§Ù†ÛŒ</li>
                    <li><strong>Ù†ÛŒØ§Ø² Ø¨Ù‡ Real-time:</strong> Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯Ù‡Ø§ÛŒ Ø²Ù†Ø¯Ù‡</li>
                </ul>

                <h3>Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¨Ø§ Ø³Ø§ÛŒØ± Ù¾Ø§ÛŒÚ¯Ø§Ù‡â€ŒØ¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</h3>

                <div class="table-wrapper comparison-table">
                    <table>
                        <thead>
                            <tr>
                                <th>ÙˆÛŒÚ˜Ú¯ÛŒ</th>
                                <th>ClickHouse</th>
                                <th>PostGIS</th>
                                <th>MongoDB</th>
                                <th>BigQuery</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Ø³Ø±Ø¹Øª Ú©ÙˆØ¦Ø±ÛŒ ØªØ­Ù„ÛŒÙ„ÛŒ</strong></td>
                                <td><span class="check">âš¡ Ø¹Ø§Ù„ÛŒ</span></td>
                                <td><span class="partial">Ù…ØªÙˆØ³Ø·</span></td>
                                <td><span class="partial">Ù…ØªÙˆØ³Ø·</span></td>
                                <td><span class="check">Ø®ÙˆØ¨</span></td>
                            </tr>
                            <tr>
                                <td><strong>ØªÙˆØ§Ø¨Ø¹ Ù…Ú©Ø§Ù†ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</strong></td>
                                <td><span class="partial">Ù¾Ø§ÛŒÙ‡ + H3/S2</span></td>
                                <td><span class="check">âœ“ Ú©Ø§Ù…Ù„</span></td>
                                <td><span class="partial">Ù¾Ø§ÛŒÙ‡</span></td>
                                <td><span class="check">Ø®ÙˆØ¨</span></td>
                            </tr>
                            <tr>
                                <td><strong>Real-time Ingestion</strong></td>
                                <td><span class="check">âœ“ Ù…ÛŒÙ„ÛŒÙˆÙ†/Ø«Ø§Ù†ÛŒÙ‡</span></td>
                                <td><span class="cross">Ú©Ù†Ø¯</span></td>
                                <td><span class="check">âœ“ Ø®ÙˆØ¨</span></td>
                                <td><span class="partial">Streaming</span></td>
                            </tr>
                            <tr>
                                <td><strong>ÙØ´Ø±Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ</strong></td>
                                <td><span class="check">âœ“ Û±Û°-Û²Û°x</span></td>
                                <td><span class="cross">Ú©Ù…</span></td>
                                <td><span class="partial">Ù…ØªÙˆØ³Ø·</span></td>
                                <td><span class="check">âœ“ Ø®ÙˆØ¨</span></td>
                            </tr>
                            <tr>
                                <td><strong>Ù‡Ø²ÛŒÙ†Ù‡</strong></td>
                                <td><span class="check">âœ“ Ø±Ø§ÛŒÚ¯Ø§Ù†</span></td>
                                <td><span class="check">âœ“ Ø±Ø§ÛŒÚ¯Ø§Ù†</span></td>
                                <td><span class="partial">Ø±Ø§ÛŒÚ¯Ø§Ù†/Ù¾ÙˆÙ„ÛŒ</span></td>
                                <td><span class="cross">Ù¾ÙˆÙ„ÛŒ</span></td>
                            </tr>
                            <tr>
                                <td><strong>Ù…Ù‚ÛŒØ§Ø³â€ŒÙ¾Ø°ÛŒØ±ÛŒ</strong></td>
                                <td><span class="check">âœ“ PB-scale</span></td>
                                <td><span class="partial">TB-scale</span></td>
                                <td><span class="check">âœ“ Ø®ÙˆØ¨</span></td>
                                <td><span class="check">âœ“ PB-scale</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>Ù…ÙˆØ§Ø±Ø¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§ÛŒØ¯Ù‡â€ŒØ¢Ù„</h3>

                <div class="use-case">
                    <div class="use-case-header">
                        <span class="use-case-icon">ğŸš—</span>
                        <span class="use-case-title">Ø±Ø¯ÛŒØ§Ø¨ÛŒ Ù†Ø§ÙˆÚ¯Ø§Ù† Ùˆ Ø­Ù…Ù„â€ŒÙˆÙ†Ù‚Ù„</span>
                    </div>
                    <p>
                        ØªØ­Ù„ÛŒÙ„ Ù…ÛŒÙ„ÛŒØ§Ø±Ø¯Ù‡Ø§ Ù†Ù‚Ø·Ù‡ GPS Ø§Ø² Ø®ÙˆØ¯Ø±ÙˆÙ‡Ø§ØŒ ØªØ¹ÛŒÛŒÙ† Ù…Ø³ÛŒØ±Ù‡Ø§ÛŒ Ù¾Ø±ØªØ±Ø¯Ø¯ØŒ 
                        Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø²Ù…Ø§Ù† Ø³ÙØ± Ùˆ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ ØªØ±Ø§ÙÛŒÚ©ÛŒ.
                    </p>
                </div>

                <div class="use-case">
                    <div class="use-case-header">
                        <span class="use-case-icon">ğŸ“±</span>
                        <span class="use-case-title">ØªØ­Ù„ÛŒÙ„ Ù…ÙˆÙ‚Ø¹ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</span>
                    </div>
                    <p>
                        ØªØ­Ù„ÛŒÙ„ Ø±ÙØªØ§Ø± Ù…Ú©Ø§Ù†ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù†ØŒ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù†Ù‚Ø§Ø· Ù¾Ø±ØªØ±Ø¯Ø¯ØŒ 
                        Ùˆ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø®Ø¯Ù…Ø§Øª Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ù…ÙˆÙ‚Ø¹ÛŒØª.
                    </p>
                </div>

                <div class="use-case">
                    <div class="use-case-header">
                        <span class="use-case-icon">ğŸŒ¡ï¸</span>
                        <span class="use-case-title">Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ù†Ø³ÙˆØ± Ùˆ IoT</span>
                    </div>
                    <p>
                        Ø°Ø®ÛŒØ±Ù‡ Ùˆ ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ÛŒÙ„ÛŒÙˆÙ†â€ŒÙ‡Ø§ Ø³Ù†Ø³ÙˆØ± Ù…Ø­ÛŒØ·ÛŒØŒ 
                        Ø¢Ø¨â€ŒÙˆÙ‡ÙˆØ§ØŒ Ø¢Ù„ÙˆØ¯Ú¯ÛŒ Ùˆ Ú©Ø´Ø§ÙˆØ±Ø²ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯.
                    </p>
                </div>

                <div class="use-case">
                    <div class="use-case-header">
                        <span class="use-case-icon">ğŸ›’</span>
                        <span class="use-case-title">ØªØ­Ù„ÛŒÙ„ Ø®Ø±Ø¯Ù‡â€ŒÙØ±ÙˆØ´ÛŒ</span>
                    </div>
                    <p>
                        ØªØ­Ù„ÛŒÙ„ Ù…ÙˆÙ‚Ø¹ÛŒØª ÙØ±ÙˆØ´Ú¯Ø§Ù‡â€ŒÙ‡Ø§ØŒ Ù…Ù†Ø§Ø·Ù‚ Ø³Ø±ÙˆÛŒØ³â€ŒØ¯Ù‡ÛŒØŒ 
                        Ùˆ Ø±ÙØªØ§Ø± Ø®Ø±ÛŒØ¯ Ù…Ø´ØªØ±ÛŒØ§Ù† Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…ÙˆÙ‚Ø¹ÛŒØª.
                    </p>
                </div>

                <div class="box box-info">
                    <div class="box-title">
                        <span>ğŸ’¡</span>
                        Ú†Ù‡ Ø²Ù…Ø§Ù†ÛŒ Ø§Ø² ClickHouse Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†ÛŒÙ…ØŸ
                    </div>
                    <ul>
                        <li>ÙˆÙ‚ØªÛŒ Ø¨Ù‡ Ø¹Ù…Ù„ÛŒØ§Øª CRUD Ø³Ù†Ú¯ÛŒÙ† Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯ (UPDATE/DELETE Ø²ÛŒØ§Ø¯)</li>
                        <li>ÙˆÙ‚ØªÛŒ Ø¨Ù‡ ØªÙˆØ§Ø¨Ø¹ Ù…Ú©Ø§Ù†ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù…Ø«Ù„ ST_Buffer Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯</li>
                        <li>ÙˆÙ‚ØªÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ú©Ù… Ù‡Ø³ØªÙ†Ø¯ (Ø²ÛŒØ± Ú†Ù†Ø¯ Ù…ÛŒÙ„ÛŒÙˆÙ† Ø±Ø¯ÛŒÙ)</li>
                        <li>ÙˆÙ‚ØªÛŒ Ø¨Ù‡ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ ACID Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯</li>
                    </ul>
                    <p style="margin-top: 15px;">
                        <strong>Ø±Ø§Ù‡â€ŒØ­Ù„:</strong> Ø§Ø² Ù…Ø¹Ù…Ø§Ø±ÛŒ ØªØ±Ú©ÛŒØ¨ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ - 
                        PostGIS Ø¨Ø±Ø§ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª Ù¾ÛŒÚ†ÛŒØ¯Ù‡ Ù…Ú©Ø§Ù†ÛŒ Ùˆ ClickHouse Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø³Ø±ÛŒØ¹.
                    </p>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 3: INSTALLATION
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="install">
            <div class="section-header">
                <div class="section-number">Û³</div>
                <h2 class="section-title">Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ</h2>
            </div>
            
            <div class="section-content">
                <h3>Ù†ØµØ¨ Ø¨Ø§ Docker (ØªÙˆØµÛŒÙ‡ Ø´Ø¯Ù‡)</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ³</span>
                            Docker
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment"># Ø¯Ø§Ù†Ù„ÙˆØ¯ Ùˆ Ø§Ø¬Ø±Ø§ÛŒ ClickHouse</span>
docker run -d \
    --name clickhouse-server \
    -p 8123:8123 \
    -p 9000:9000 \
    -v clickhouse_data:/var/lib/clickhouse \
    -v clickhouse_logs:/var/log/clickhouse-server \
    clickhouse/clickhouse-server

<span class="comment"># Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ú©Ù„Ø§ÛŒÙ†Øª</span>
docker exec -it clickhouse-server clickhouse-client</pre>
                    </div>
                </div>

                <h3>Ù†ØµØ¨ Ø¨Ø§ Docker Compose</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“„</span>
                            docker-compose.yml
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="keyword">version</span>: <span class="string">'3.8'</span>

<span class="keyword">services</span>:
  <span class="type">clickhouse</span>:
    <span class="keyword">image</span>: clickhouse/clickhouse-server:latest
    <span class="keyword">container_name</span>: clickhouse-gis
    <span class="keyword">ports</span>:
      - <span class="string">"8123:8123"</span>   <span class="comment"># HTTP interface</span>
      - <span class="string">"9000:9000"</span>   <span class="comment"># Native interface</span>
      - <span class="string">"9009:9009"</span>   <span class="comment"># Interserver</span>
    <span class="keyword">volumes</span>:
      - clickhouse_data:/var/lib/clickhouse
      - clickhouse_logs:/var/log/clickhouse-server
      - ./config:/etc/clickhouse-server/config.d
    <span class="keyword">environment</span>:
      - CLICKHOUSE_USER=admin
      - CLICKHOUSE_PASSWORD=secret
      - CLICKHOUSE_DEFAULT_ACCESS_MANAGEMENT=1
    <span class="keyword">ulimits</span>:
      <span class="keyword">nofile</span>:
        soft: 262144
        hard: 262144

<span class="keyword">volumes</span>:
  clickhouse_data:
  clickhouse_logs:</pre>
                    </div>
                </div>

                <h3>Ù†ØµØ¨ Ø±ÙˆÛŒ Ubuntu/Debian</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ§</span>
                            Bash
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment"># Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø®Ø²Ù† ClickHouse</span>
sudo apt-get install -y apt-transport-https ca-certificates dirmngr
sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 \
    --recv 8919F6BD2B48D754

echo <span class="string">"deb https://packages.clickhouse.com/deb stable main"</span> | \
    sudo tee /etc/apt/sources.list.d/clickhouse.list

<span class="comment"># Ù†ØµØ¨ ClickHouse</span>
sudo apt-get update
sudo apt-get install -y clickhouse-server clickhouse-client

<span class="comment"># Ø´Ø±ÙˆØ¹ Ø³Ø±ÙˆÛŒØ³</span>
sudo systemctl start clickhouse-server
sudo systemctl enable clickhouse-server

<span class="comment"># Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª</span>
sudo systemctl status clickhouse-server

<span class="comment"># Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ú©Ù„Ø§ÛŒÙ†Øª</span>
clickhouse-client</pre>
                    </div>
                </div>

                <h3>ØªØ³Øª Ø§ØªØµØ§Ù„</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ”Œ</span>
                            SQL
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ø¨Ø±Ø±Ø³ÛŒ Ù†Ø³Ø®Ù‡</span>
<span class="keyword">SELECT</span> version();

<span class="comment">-- Ø¨Ø±Ø±Ø³ÛŒ ØªÙˆØ§Ø¨Ø¹ Ù…Ú©Ø§Ù†ÛŒ</span>
<span class="keyword">SELECT</span> <span class="function">geoToH3</span>(<span class="number">35.6892</span>, <span class="number">51.3890</span>, <span class="number">9</span>) <span class="keyword">AS</span> tehran_h3;

<span class="comment">-- Ù†ØªÛŒØ¬Ù‡: 891f5640127ffff</span></pre>
                    </div>
                </div>

                <div class="box box-tip">
                    <div class="box-title">
                        <span>ğŸ’¡</span>
                        Ù†Ú©ØªÙ‡: ClickHouse Cloud
                    </div>
                    <p>
                        Ø§Ú¯Ø± Ù†Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø²ÛŒØ±Ø³Ø§Ø®Øª Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†ÛŒØ¯ØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² 
                        <a href="https://clickhouse.cloud" target="_blank">ClickHouse Cloud</a> 
                        Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ Ú©Ù‡ Ø³Ø±ÙˆÛŒØ³ Ù…Ø¯ÛŒØ±ÛŒØªâ€ŒØ´Ø¯Ù‡ Ø¨Ø§ ØªØ§ÛŒØ± Ø±Ø§ÛŒÚ¯Ø§Ù† Ø§Ø±Ø§Ø¦Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.
                    </p>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 4: GEO DATA TYPES
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="geo-types">
            <div class="section-header">
                <div class="section-number">Û´</div>
                <h2 class="section-title">Ø§Ù†ÙˆØ§Ø¹ Ø¯Ø§Ø¯Ù‡ Ù…Ú©Ø§Ù†ÛŒ</h2>
            </div>
            
            <div class="section-content">
                <p>
                    ClickHouse Ú†Ù†Ø¯ÛŒÙ† Ø±ÙˆØ´ Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø§Ø±Ø§Ø¦Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯. 
                    Ø§Ù†ØªØ®Ø§Ø¨ Ø±ÙˆØ´ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ù‡ Ù†ÙˆØ¹ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ Ùˆ Ø­Ø¬Ù… Ø¯Ø§Ø¯Ù‡ Ø¨Ø³ØªÚ¯ÛŒ Ø¯Ø§Ø±Ø¯.
                </p>

                <h3>Û±. Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø³Ø§Ø¯Ù‡ (Float64)</h3>

                <p>
                    Ø³Ø§Ø¯Ù‡â€ŒØªØ±ÛŒÙ† Ø±ÙˆØ´ØŒ Ø°Ø®ÛŒØ±Ù‡ Ø·ÙˆÙ„ Ùˆ Ø¹Ø±Ø¶ Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒ Ø¨Ù‡ ØµÙˆØ±Øª Ø¯Ùˆ Ø³ØªÙˆÙ† Float64:
                </p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“Š</span>
                            SQL
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="keyword">CREATE TABLE</span> locations_simple
(
    id          <span class="type">UInt64</span>,
    name        <span class="type">String</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    timestamp   <span class="type">DateTime</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (timestamp, id);

<span class="comment">-- Ø¯Ø±Ø¬ Ø¯Ø§Ø¯Ù‡</span>
<span class="keyword">INSERT INTO</span> locations_simple <span class="keyword">VALUES</span>
    (<span class="number">1</span>, <span class="string">'Tehran'</span>, <span class="number">35.6892</span>, <span class="number">51.3890</span>, now()),
    (<span class="number">2</span>, <span class="string">'Isfahan'</span>, <span class="number">32.6546</span>, <span class="number">51.6680</span>, now()),
    (<span class="number">3</span>, <span class="string">'Shiraz'</span>, <span class="number">29.5918</span>, <span class="number">52.5837</span>, now());</pre>
                    </div>
                </div>

                <h3>Û². Ù†ÙˆØ¹ Point</h3>

                <p>
                    ClickHouse Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡ <span class="inline-code">Point</span> Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ù†Ù‚Ø§Ø· Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯:
                </p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“</span>
                            SQL
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="keyword">CREATE TABLE</span> locations_point
(
    id          <span class="type">UInt64</span>,
    name        <span class="type">String</span>,
    location    <span class="type">Point</span>,
    timestamp   <span class="type">DateTime</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (timestamp, id);

<span class="comment">-- Ø¯Ø±Ø¬ Ø¯Ø§Ø¯Ù‡ (ØªÙˆØ¬Ù‡: ØªØ±ØªÛŒØ¨ longitude, latitude Ø§Ø³Øª)</span>
<span class="keyword">INSERT INTO</span> locations_point <span class="keyword">VALUES</span>
    (<span class="number">1</span>, <span class="string">'Tehran'</span>, (<span class="number">51.3890</span>, <span class="number">35.6892</span>), now()),
    (<span class="number">2</span>, <span class="string">'Isfahan'</span>, (<span class="number">51.6680</span>, <span class="number">32.6546</span>), now());

<span class="comment">-- Ø®ÙˆØ§Ù†Ø¯Ù† Ù…Ø®ØªØµØ§Øª</span>
<span class="keyword">SELECT</span> 
    name,
    location.<span class="number">1</span> <span class="keyword">AS</span> lon,
    location.<span class="number">2</span> <span class="keyword">AS</span> lat
<span class="keyword">FROM</span> locations_point;</pre>
                    </div>
                </div>
                <h3>Û³. Ù†ÙˆØ¹ Ring Ùˆ Polygon</h3>

                <p>
                    Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒâ€ŒÙ‡Ø§ Ø§Ø² Ø§Ù†ÙˆØ§Ø¹ <span class="inline-code">Ring</span> Ùˆ 
                    <span class="inline-code">Polygon</span> Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯:
                </p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ”·</span>
                            SQL
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ring: ÛŒÚ© Ø­Ù„Ù‚Ù‡ Ø¨Ø³ØªÙ‡ Ø§Ø² Ù†Ù‚Ø§Ø·</span>
<span class="keyword">CREATE TABLE</span> areas_ring
(
    id          <span class="type">UInt64</span>,
    name        <span class="type">String</span>,
    boundary    <span class="type">Ring</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> id;

<span class="comment">-- Polygon: Ø´Ø§Ù…Ù„ ÛŒÚ© Ring Ø®Ø§Ø±Ø¬ÛŒ Ùˆ Ú†Ù†Ø¯ Ring Ø¯Ø§Ø®Ù„ÛŒ (Ø³ÙˆØ±Ø§Ø®â€ŒÙ‡Ø§)</span>
<span class="keyword">CREATE TABLE</span> areas_polygon
(
    id          <span class="type">UInt64</span>,
    name        <span class="type">String</span>,
    area        <span class="type">Polygon</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> id;

<span class="comment">-- Ø¯Ø±Ø¬ ÛŒÚ© Ù…Ø«Ù„Ø«</span>
<span class="keyword">INSERT INTO</span> areas_ring <span class="keyword">VALUES</span>
(
    <span class="number">1</span>, 
    <span class="string">'Triangle'</span>,
    [(<span class="number">0</span>, <span class="number">0</span>), (<span class="number">10</span>, <span class="number">0</span>), (<span class="number">5</span>, <span class="number">10</span>), (<span class="number">0</span>, <span class="number">0</span>)]
);

<span class="comment">-- Ø¯Ø±Ø¬ Ù¾Ù„ÛŒÚ¯ÙˆÙ† Ø¨Ø§ Ø³ÙˆØ±Ø§Ø®</span>
<span class="keyword">INSERT INTO</span> areas_polygon <span class="keyword">VALUES</span>
(
    <span class="number">1</span>,
    <span class="string">'Square with hole'</span>,
    [
        [(<span class="number">0</span>, <span class="number">0</span>), (<span class="number">10</span>, <span class="number">0</span>), (<span class="number">10</span>, <span class="number">10</span>), (<span class="number">0</span>, <span class="number">10</span>), (<span class="number">0</span>, <span class="number">0</span>)],  <span class="comment">-- Ø­Ù„Ù‚Ù‡ Ø®Ø§Ø±Ø¬ÛŒ</span>
        [(<span class="number">2</span>, <span class="number">2</span>), (<span class="number">8</span>, <span class="number">2</span>), (<span class="number">8</span>, <span class="number">8</span>), (<span class="number">2</span>, <span class="number">8</span>), (<span class="number">2</span>, <span class="number">2</span>)]   <span class="comment">-- Ø³ÙˆØ±Ø§Ø®</span>
    ]
);</pre>
                    </div>
                </div>

                <h3>Û´. Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ H3 Index</h3>

                <p>
                    Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø³Ø±ÛŒØ¹ Ù…Ú©Ø§Ù†ÛŒØŒ Ø°Ø®ÛŒØ±Ù‡ H3 Index Ø¨Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Ù…Ø®ØªØµØ§Øª ØªÙˆØµÛŒÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯:
                </p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>â¬¡</span>
                            SQL
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="keyword">CREATE TABLE</span> locations_h3
(
    id          <span class="type">UInt64</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    h3_index    <span class="type">UInt64</span>,  <span class="comment">-- H3 index Ø¯Ø± resolution 9</span>
    timestamp   <span class="type">DateTime</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (h3_index, timestamp);  <span class="comment">-- Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ H3 Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒ Ø³Ø±ÛŒØ¹</span>

<span class="comment">-- Ø¯Ø±Ø¬ Ø¨Ø§ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± H3</span>
<span class="keyword">INSERT INTO</span> locations_h3
<span class="keyword">SELECT</span>
    <span class="number">1</span> <span class="keyword">AS</span> id,
    <span class="number">35.6892</span> <span class="keyword">AS</span> latitude,
    <span class="number">51.3890</span> <span class="keyword">AS</span> longitude,
    <span class="function">geoToH3</span>(<span class="number">35.6892</span>, <span class="number">51.3890</span>, <span class="number">9</span>) <span class="keyword">AS</span> h3_index,
    now() <span class="keyword">AS</span> timestamp;</pre>
                    </div>
                </div>

                <h3>Ø®Ù„Ø§ØµÙ‡ Ø§Ù†ÙˆØ§Ø¹ Ø¯Ø§Ø¯Ù‡ Ù…Ú©Ø§Ù†ÛŒ</h3>

                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Ù†ÙˆØ¹</th>
                                <th>ØªÙˆØ¶ÛŒØ­</th>
                                <th>Ù…Ø«Ø§Ù„</th>
                                <th>Ú©Ø§Ø±Ø¨Ø±Ø¯</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="inline-code">Float64</span></td>
                                <td>Ø¯Ùˆ Ø³ØªÙˆÙ† Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡</td>
                                <td>lat=35.68, lon=51.38</td>
                                <td>Ø³Ø§Ø¯Ù‡â€ŒØªØ±ÛŒÙ† Ø±ÙˆØ´</td>
                            </tr>
                            <tr>
                                <td><span class="inline-code">Point</span></td>
                                <td>ØªØ§Ù¾Ù„ Ø¯Ùˆ Ø¹Ù†ØµØ±ÛŒ</td>
                                <td>(51.38, 35.68)</td>
                                <td>Ù†Ù‚Ø§Ø· Ù…Ù†ÙØ±Ø¯</td>
                            </tr>
                            <tr>
                                <td><span class="inline-code">Ring</span></td>
                                <td>Ø¢Ø±Ø§ÛŒÙ‡ Ø§Ø² Point</td>
                                <td>[(0,0), (1,0), (1,1), (0,0)]</td>
                                <td>Ø­Ù„Ù‚Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø³ØªÙ‡</td>
                            </tr>
                            <tr>
                                <td><span class="inline-code">Polygon</span></td>
                                <td>Ø¢Ø±Ø§ÛŒÙ‡ Ø§Ø² Ring</td>
                                <td>[[outer], [hole1], [hole2]]</td>
                                <td>Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ Ø¨Ø§ Ø³ÙˆØ±Ø§Ø®</td>
                            </tr>
                            <tr>
                                <td><span class="inline-code">MultiPolygon</span></td>
                                <td>Ø¢Ø±Ø§ÛŒÙ‡ Ø§Ø² Polygon</td>
                                <td>[polygon1, polygon2]</td>
                                <td>Ú†Ù†Ø¯ Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ</td>
                            </tr>
                            <tr>
                                <td><span class="inline-code">UInt64</span> (H3)</td>
                                <td>H3 Index</td>
                                <td>617733122422996991</td>
                                <td>Ø¬Ø³ØªØ¬ÙˆÛŒ Ø³Ø±ÛŒØ¹ Ù…Ú©Ø§Ù†ÛŒ</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="box box-warning">
                    <div class="box-title">
                        <span>âš ï¸</span>
                        ØªÙˆØ¬Ù‡: ØªØ±ØªÛŒØ¨ Ù…Ø®ØªØµØ§Øª
                    </div>
                    <p>
                        Ø¯Ø± ClickHouseØŒ ØªØ±ØªÛŒØ¨ Ù…Ø®ØªØµØ§Øª Ø¯Ø± Ù†ÙˆØ¹ <span class="inline-code">Point</span> 
                        Ø¨Ù‡ ØµÙˆØ±Øª <strong>(longitude, latitude)</strong> Ø§Ø³ØªØŒ Ù†Ù‡ (latitude, longitude). 
                        Ø§ÛŒÙ† Ù…Ø·Ø§Ø¨Ù‚ Ø¨Ø§ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ GeoJSON Ø§Ø³Øª Ø§Ù…Ø§ Ø¨Ø±Ø¹Ú©Ø³ Ø¨Ø³ÛŒØ§Ø±ÛŒ Ø§Ø² APIÙ‡Ø§.
                    </p>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 5: GEO FUNCTIONS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="geo-functions">
            <div class="section-header">
                <div class="section-number">Ûµ</div>
                <h2 class="section-title">ØªÙˆØ§Ø¨Ø¹ Ù…Ú©Ø§Ù†ÛŒ</h2>
            </div>
            
            <div class="section-content">
                <p>
                    ClickHouse Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ Ø§Ø² ØªÙˆØ§Ø¨Ø¹ Ù…Ú©Ø§Ù†ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒ Ø§Ø±Ø§Ø¦Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.
                </p>

                <h3>Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙØ§ØµÙ„Ù‡</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“</span>
                            SQL - Distance Functions
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- ÙØ§ØµÙ„Ù‡ Ø¨ÛŒÙ† ØªÙ‡Ø±Ø§Ù† Ùˆ Ø§ØµÙÙ‡Ø§Ù† (Ù…ØªØ±)</span>

<span class="comment">-- Û±. ÙØ§ØµÙ„Ù‡ Ú©Ø±ÙˆÛŒ Ø¨Ø²Ø±Ú¯ (Great Circle Distance)</span>
<span class="keyword">SELECT</span> <span class="function">greatCircleDistance</span>(
    <span class="number">35.6892</span>, <span class="number">51.3890</span>,  <span class="comment">-- ØªÙ‡Ø±Ø§Ù† (lat, lon)</span>
    <span class="number">32.6546</span>, <span class="number">51.6680</span>   <span class="comment">-- Ø§ØµÙÙ‡Ø§Ù† (lat, lon)</span>
) <span class="keyword">AS</span> distance_meters;
<span class="comment">-- Ù†ØªÛŒØ¬Ù‡: 340123.45 (Ø­Ø¯ÙˆØ¯ 340 Ú©ÛŒÙ„ÙˆÙ…ØªØ±)</span>

<span class="comment">-- Û². ÙØ§ØµÙ„Ù‡ Ø¨Ø§ ÙØ±Ù…ÙˆÙ„ Haversine (Ø¯Ù‚ÛŒÙ‚â€ŒØªØ± Ø¨Ø±Ø§ÛŒ ÙÙˆØ§ØµÙ„ Ú©ÙˆØªØ§Ù‡)</span>
<span class="keyword">SELECT</span> 
    <span class="number">2</span> * <span class="number">6371000</span> * <span class="function">asin</span>(<span class="function">sqrt</span>(
        <span class="function">pow</span>(<span class="function">sin</span>(<span class="function">radians</span>(<span class="number">32.6546</span> - <span class="number">35.6892</span>) / <span class="number">2</span>), <span class="number">2</span>) +
        <span class="function">cos</span>(<span class="function">radians</span>(<span class="number">35.6892</span>)) * <span class="function">cos</span>(<span class="function">radians</span>(<span class="number">32.6546</span>)) *
        <span class="function">pow</span>(<span class="function">sin</span>(<span class="function">radians</span>(<span class="number">51.6680</span> - <span class="number">51.3890</span>) / <span class="number">2</span>), <span class="number">2</span>)
    )) <span class="keyword">AS</span> haversine_distance;

<span class="comment">-- Û³. ÙØ§ØµÙ„Ù‡ Ø§Ù‚Ù„ÛŒØ¯Ø³ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù‚Ø§Ø· Point</span>
<span class="keyword">SELECT</span> <span class="function">L2Distance</span>(
    (<span class="number">51.3890</span>, <span class="number">35.6892</span>),
    (<span class="number">51.6680</span>, <span class="number">32.6546</span>)
) <span class="keyword">AS</span> euclidean_distance;</pre>
                    </div>
                </div>

                <h3>ÛŒØ§ÙØªÙ† Ù†Ù‚Ø§Ø· Ø¯Ø± Ø´Ø¹Ø§Ø¹</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ¯</span>
                            SQL - Points in Radius
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- ÛŒØ§ÙØªÙ† ØªÙ…Ø§Ù… Ù†Ù‚Ø§Ø· Ø¯Ø± Ø´Ø¹Ø§Ø¹ 50 Ú©ÛŒÙ„ÙˆÙ…ØªØ±ÛŒ ØªÙ‡Ø±Ø§Ù†</span>
<span class="keyword">SELECT</span> 
    id,
    name,
    latitude,
    longitude,
    <span class="function">greatCircleDistance</span>(
        latitude, longitude,
        <span class="number">35.6892</span>, <span class="number">51.3890</span>
    ) <span class="keyword">AS</span> distance_m
<span class="keyword">FROM</span> locations_simple
<span class="keyword">WHERE</span> <span class="function">greatCircleDistance</span>(
    latitude, longitude,
    <span class="number">35.6892</span>, <span class="number">51.3890</span>
) <= <span class="number">50000</span>  <span class="comment">-- 50 Ú©ÛŒÙ„ÙˆÙ…ØªØ±</span>
<span class="keyword">ORDER BY</span> distance_m;

<span class="comment">-- Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Bounding Box (Ø³Ø±ÛŒØ¹â€ŒØªØ±)</span>
<span class="keyword">SELECT</span> *
<span class="keyword">FROM</span> locations_simple
<span class="keyword">WHERE</span> 
    <span class="comment">-- Ø§Ø¨ØªØ¯Ø§ ÙÛŒÙ„ØªØ± Ø³Ø±ÛŒØ¹ Ø¨Ø§ Ù…Ø³ØªØ·ÛŒÙ„</span>
    latitude <span class="keyword">BETWEEN</span> <span class="number">35.6892</span> - <span class="number">0.45</span> <span class="keyword">AND</span> <span class="number">35.6892</span> + <span class="number">0.45</span>
    <span class="keyword">AND</span> longitude <span class="keyword">BETWEEN</span> <span class="number">51.3890</span> - <span class="number">0.55</span> <span class="keyword">AND</span> <span class="number">51.3890</span> + <span class="number">0.55</span>
    <span class="comment">-- Ø³Ù¾Ø³ ÙÛŒÙ„ØªØ± Ø¯Ù‚ÛŒÙ‚ Ø¨Ø§ ÙØ§ØµÙ„Ù‡</span>
    <span class="keyword">AND</span> <span class="function">greatCircleDistance</span>(latitude, longitude, <span class="number">35.6892</span>, <span class="number">51.3890</span>) <= <span class="number">50000</span>;</pre>
                    </div>
                </div>

                <h3>Ø¨Ø±Ø±Ø³ÛŒ Ù†Ù‚Ø·Ù‡ Ø¯Ø± Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“</span>
                            SQL - Point in Polygon
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- ØªØ¹Ø±ÛŒÙ ÛŒÚ© Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ (Ù…Ø«Ù„Ø§Ù‹ Ù…Ø­Ø¯ÙˆØ¯Ù‡ ÛŒÚ© Ø´Ù‡Ø±)</span>
<span class="keyword">WITH</span> tehran_boundary <span class="keyword">AS</span> (
    <span class="keyword">SELECT</span> [
        (<span class="number">51.2</span>, <span class="number">35.5</span>),
        (<span class="number">51.6</span>, <span class="number">35.5</span>),
        (<span class="number">51.6</span>, <span class="number">35.9</span>),
        (<span class="number">51.2</span>, <span class="number">35.9</span>),
        (<span class="number">51.2</span>, <span class="number">35.5</span>)
    ] <span class="keyword">AS</span> polygon
)
<span class="keyword">SELECT</span> 
    <span class="function">pointInPolygon</span>((<span class="number">51.3890</span>, <span class="number">35.6892</span>), polygon) <span class="keyword">AS</span> is_in_tehran
<span class="keyword">FROM</span> tehran_boundary;
<span class="comment">-- Ù†ØªÛŒØ¬Ù‡: 1 (Ø¯Ø§Ø®Ù„ Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ)</span>

<span class="comment">-- ÙÛŒÙ„ØªØ± Ù†Ù‚Ø§Ø· Ø¯Ø§Ø®Ù„ ÛŒÚ© Ù…Ù†Ø·Ù‚Ù‡</span>
<span class="keyword">SELECT</span> *
<span class="keyword">FROM</span> locations_simple
<span class="keyword">WHERE</span> <span class="function">pointInPolygon</span>(
    (longitude, latitude),
    [
        (<span class="number">51.2</span>, <span class="number">35.5</span>),
        (<span class="number">51.6</span>, <span class="number">35.5</span>),
        (<span class="number">51.6</span>, <span class="number">35.9</span>),
        (<span class="number">51.2</span>, <span class="number">35.9</span>),
        (<span class="number">51.2</span>, <span class="number">35.5</span>)
    ]
);</pre>
                    </div>
                </div>

                <h3>Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù‡Ù†Ø¯Ø³ÛŒ</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“</span>
                            SQL - Geometry Calculations
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø³Ø§Ø­Øª Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ (ÙˆØ§Ø­Ø¯: Ø¯Ø±Ø¬Ù‡ Ù…Ø±Ø¨Ø¹)</span>
<span class="keyword">SELECT</span> <span class="function">polygonAreaCartesian</span>([
    (<span class="number">0</span>, <span class="number">0</span>),
    (<span class="number">10</span>, <span class="number">0</span>),
    (<span class="number">10</span>, <span class="number">10</span>),
    (<span class="number">0</span>, <span class="number">10</span>),
    (<span class="number">0</span>, <span class="number">0</span>)
]) <span class="keyword">AS</span> area;
<span class="comment">-- Ù†ØªÛŒØ¬Ù‡: 100</span>

<span class="comment">-- Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø­ÛŒØ· Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ</span>
<span class="keyword">SELECT</span> <span class="function">polygonPerimeterCartesian</span>([
    (<span class="number">0</span>, <span class="number">0</span>),
    (<span class="number">10</span>, <span class="number">0</span>),
    (<span class="number">10</span>, <span class="number">10</span>),
    (<span class="number">0</span>, <span class="number">10</span>),
    (<span class="number">0</span>, <span class="number">0</span>)
]) <span class="keyword">AS</span> perimeter;
<span class="comment">-- Ù†ØªÛŒØ¬Ù‡: 40</span>

<span class="comment">-- Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø±Ú©Ø² Ø«Ù‚Ù„ (Centroid)</span>
<span class="keyword">SELECT</span> <span class="function">polygonConvexHullCartesian</span>([
    (<span class="number">0</span>, <span class="number">0</span>),
    (<span class="number">10</span>, <span class="number">0</span>),
    (<span class="number">5</span>, <span class="number">10</span>),
    (<span class="number">0</span>, <span class="number">0</span>)
]) <span class="keyword">AS</span> convex_hull;</pre>
                    </div>
                </div>

                <h3>Ù„ÛŒØ³Øª Ú©Ø§Ù…Ù„ ØªÙˆØ§Ø¨Ø¹ Ù…Ú©Ø§Ù†ÛŒ</h3>

                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>ØªØ§Ø¨Ø¹</th>
                                <th>ØªÙˆØ¶ÛŒØ­</th>
                                <th>Ù…Ø«Ø§Ù„</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="inline-code">greatCircleDistance</span></td>
                                <td>ÙØ§ØµÙ„Ù‡ Ú©Ø±ÙˆÛŒ Ø¨ÛŒÙ† Ø¯Ùˆ Ù†Ù‚Ø·Ù‡ (Ù…ØªØ±)</td>
                                <td>greatCircleDistance(lat1, lon1, lat2, lon2)</td>
                            </tr>
                            <tr>
                                <td><span class="inline-code">greatCircleAngle</span></td>
                                <td>Ø²Ø§ÙˆÛŒÙ‡ Ù…Ø±Ú©Ø²ÛŒ Ø¨ÛŒÙ† Ø¯Ùˆ Ù†Ù‚Ø·Ù‡</td>
                                <td>greatCircleAngle(lat1, lon1, lat2, lon2)</td>
                            </tr>
                            <tr>
                                <td><span class="inline-code">pointInPolygon</span></td>
                                <td>Ø¨Ø±Ø±Ø³ÛŒ Ù†Ù‚Ø·Ù‡ Ø¯Ø± Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ</td>
                                <td>pointInPolygon(point, polygon)</td>
                            </tr>
                            <tr>
                                <td><span class="inline-code">pointInEllipses</span></td>
                                <td>Ø¨Ø±Ø±Ø³ÛŒ Ù†Ù‚Ø·Ù‡ Ø¯Ø± Ø¨ÛŒØ¶ÛŒ</td>
                                <td>pointInEllipses(x, y, ...)</td>
                            </tr>
                            <tr>
                                <td><span class="inline-code">polygonAreaCartesian</span></td>
                                <td>Ù…Ø³Ø§Ø­Øª Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ (Ø¯Ú©Ø§Ø±ØªÛŒ)</td>
                                <td>polygonAreaCartesian(polygon)</td>
                            </tr>
                            <tr>
                                <td><span class="inline-code">polygonPerimeterCartesian</span></td>
                                <td>Ù…Ø­ÛŒØ· Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ</td>
                                <td>polygonPerimeterCartesian(polygon)</td>
                            </tr>
                            <tr>
                                <td><span class="inline-code">polygonConvexHullCartesian</span></td>
                                <td>Ù¾ÙˆØ´ Ù…Ø­Ø¯Ø¨</td>
                                <td>polygonConvexHullCartesian(polygon)</td>
                            </tr>
                            <tr>
                                <td><span class="inline-code">polygonsIntersectionCartesian</span></td>
                                <td>Ø§Ø´ØªØ±Ø§Ú© Ø¯Ùˆ Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ</td>
                                <td>polygonsIntersectionCartesian(p1, p2)</td>
                            </tr>
                            <tr>
                                <td><span class="inline-code">polygonsUnionCartesian</span></td>
                                <td>Ø§Ø¬ØªÙ…Ø§Ø¹ Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒâ€ŒÙ‡Ø§</td>
                                <td>polygonsUnionCartesian(p1, p2)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 6: H3
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="h3">
            <div class="section-header">
                <div class="section-number">Û¶</div>
                <h2 class="section-title">Ø³ÛŒØ³ØªÙ… H3</h2>
            </div>
            
            <div class="section-content">
                <p>
                    <strong>H3</strong> ÛŒÚ© Ø³ÛŒØ³ØªÙ… Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø´Ø´â€ŒØ¶Ù„Ø¹ÛŒ Ø§Ø³Øª Ú©Ù‡ ØªÙˆØ³Ø· Uber 
                    ØªÙˆØ³Ø¹Ù‡ ÛŒØ§ÙØªÙ‡. ClickHouse Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ú©Ø§Ù…Ù„ÛŒ Ø§Ø² H3 Ø¯Ø§Ø±Ø¯ Ú©Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ 
                    Ù…Ú©Ø§Ù†ÛŒ Ø³Ø±ÛŒØ¹ Ø¨Ø³ÛŒØ§Ø± Ù…ÙÛŒØ¯ Ø§Ø³Øª.
                </p>

                <div class="box box-clickhouse">
                    <div class="box-title">
                        <span>â¬¡</span>
                        Ú†Ø±Ø§ H3ØŸ
                    </div>
                    <ul>
                        <li><strong>Ù¾ÙˆØ´Ø´ ÛŒÚ©Ù†ÙˆØ§Ø®Øª:</strong> Ø´Ø´â€ŒØ¶Ù„Ø¹ÛŒâ€ŒÙ‡Ø§ ÙØ§ØµÙ„Ù‡ ÛŒÚ©Ø³Ø§Ù† Ø§Ø² Ù…Ø±Ú©Ø² ØªØ§ ØªÙ…Ø§Ù… Ù„Ø¨Ù‡â€ŒÙ‡Ø§ Ø¯Ø§Ø±Ù†Ø¯</li>
                        <li><strong>Ø³Ù„Ø³Ù„Ù‡â€ŒÙ…Ø±Ø§ØªØ¨ÛŒ:</strong> Û±Û¶ Ø³Ø·Ø­ Ø±Ø²ÙˆÙ„ÙˆØ´Ù† Ø§Ø² Ø³ÛŒØ§Ø±Ù‡ ØªØ§ Ú†Ù†Ø¯ Ù…ØªØ±</li>
                        <li><strong>Ø³Ø±ÛŒØ¹:</strong> ØªØ¨Ø¯ÛŒÙ„ Ù…Ø®ØªØµØ§Øª Ø¨Ù‡ H3 Ùˆ Ø¨Ø±Ø¹Ú©Ø³ O(1) Ø§Ø³Øª</li>
                        <li><strong>Ù‡Ù…Ø³Ø§ÛŒÚ¯ÛŒ:</strong> ÛŒØ§ÙØªÙ† Ù‡Ù…Ø³Ø§ÛŒÙ‡â€ŒÙ‡Ø§ Ø¨Ø³ÛŒØ§Ø± Ø³Ø±ÛŒØ¹ Ø§Ø³Øª</li>
                    </ul>
                </div>

                <h3>Ø±Ø²ÙˆÙ„ÙˆØ´Ù†â€ŒÙ‡Ø§ÛŒ H3</h3>

                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø±Ø²ÙˆÙ„ÙˆØ´Ù†</th>
                                <th>Ù…Ø³Ø§Ø­Øª ØªÙ‚Ø±ÛŒØ¨ÛŒ</th>
                                <th>Ø·ÙˆÙ„ Ø¶Ù„Ø¹</th>
                                <th>Ú©Ø§Ø±Ø¨Ø±Ø¯</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>0</td>
                                <td>4,250,547 kmÂ²</td>
                                <td>1,107 km</td>
                                <td>Ù‚Ø§Ø±Ù‡â€ŒÙ‡Ø§</td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>1,770 kmÂ²</td>
                                <td>22.6 km</td>
                                <td>Ø§Ø³ØªØ§Ù†â€ŒÙ‡Ø§</td>
                            </tr>
                            <tr>
                                <td>7</td>
                                <td>5.16 kmÂ²</td>
                                <td>1.22 km</td>
                                <td>Ø´Ù‡Ø±Ù‡Ø§</td>
                            </tr>
                            <tr>
                                <td>9</td>
                                <td>0.105 kmÂ²</td>
                                <td>174 m</td>
                                <td>Ù…Ø­Ù„Ù‡â€ŒÙ‡Ø§ â­</td>
                            </tr>
                            <tr>
                                <td>11</td>
                                <td>0.00215 kmÂ²</td>
                                <td>24.9 m</td>
                                <td>Ø³Ø§Ø®ØªÙ…Ø§Ù†â€ŒÙ‡Ø§</td>
                            </tr>
                            <tr>
                                <td>13</td>
                                <td>43.9 mÂ²</td>
                                <td>3.6 m</td>
                                <td>Ù¾Ø§Ø±Ú©ÛŒÙ†Ú¯</td>
                            </tr>
                            <tr>
                                <td>15</td>
                                <td>0.9 mÂ²</td>
                                <td>0.5 m</td>
                                <td>Ø¯Ù‚Øª Ø¨Ø§Ù„Ø§</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>ØªÙˆØ§Ø¨Ø¹ H3 Ø¯Ø± ClickHouse</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>â¬¡</span>
                            SQL - H3 Functions
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Û±. ØªØ¨Ø¯ÛŒÙ„ Ù…Ø®ØªØµØ§Øª Ø¨Ù‡ H3</span>
<span class="keyword">SELECT</span> <span class="function">geoToH3</span>(<span class="number">35.6892</span>, <span class="number">51.3890</span>, <span class="number">9</span>) <span class="keyword">AS</span> h3_index;
<span class="comment">-- Ù†ØªÛŒØ¬Ù‡: 617733122422996991</span>

<span class="comment">-- Ù†Ù…Ø§ÛŒØ´ Ø¨Ù‡ ØµÙˆØ±Øª Ù‡Ú¯Ø²</span>
<span class="keyword">SELECT</span> <span class="function">hex</span>(<span class="function">geoToH3</span>(<span class="number">35.6892</span>, <span class="number">51.3890</span>, <span class="number">9</span>)) <span class="keyword">AS</span> h3_hex;
<span class="comment">-- Ù†ØªÛŒØ¬Ù‡: 891f5640127ffff</span>

<span class="comment">-- Û². ØªØ¨Ø¯ÛŒÙ„ H3 Ø¨Ù‡ Ù…Ø®ØªØµØ§Øª (Ù…Ø±Ú©Ø² Ø³Ù„ÙˆÙ„)</span>
<span class="keyword">SELECT</span> 
    <span class="function">h3ToGeo</span>(<span class="number">617733122422996991</span>) <span class="keyword">AS</span> center_point,
    <span class="function">h3ToGeo</span>(<span class="number">617733122422996991</span>).<span class="number">1</span> <span class="keyword">AS</span> center_lon,
    <span class="function">h3ToGeo</span>(<span class="number">617733122422996991</span>).<span class="number">2</span> <span class="keyword">AS</span> center_lat;

<span class="comment">-- Û³. Ø¯Ø±ÛŒØ§ÙØª Ù…Ø±Ø² Ø³Ù„ÙˆÙ„ (Ø¨Ø±Ø§ÛŒ Ø±Ø³Ù… Ø±ÙˆÛŒ Ù†Ù‚Ø´Ù‡)</span>
<span class="keyword">SELECT</span> <span class="function">h3ToGeoBoundary</span>(<span class="number">617733122422996991</span>) <span class="keyword">AS</span> boundary;

<span class="comment">-- Û´. ØªØºÛŒÛŒØ± Ø±Ø²ÙˆÙ„ÙˆØ´Ù†</span>
<span class="keyword">SELECT</span> 
    <span class="function">h3ToParent</span>(<span class="number">617733122422996991</span>, <span class="number">7</span>) <span class="keyword">AS</span> parent_h3,  <span class="comment">-- Ø±Ø²ÙˆÙ„ÙˆØ´Ù† Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ±</span>
    <span class="function">h3ToChildren</span>(<span class="number">617733122422996991</span>, <span class="number">10</span>) <span class="keyword">AS</span> children_h3; <span class="comment">-- Ø±Ø²ÙˆÙ„ÙˆØ´Ù† Ø¨Ø§Ù„Ø§ØªØ±</span>

<span class="comment">-- Ûµ. ÛŒØ§ÙØªÙ† Ù‡Ù…Ø³Ø§ÛŒÙ‡â€ŒÙ‡Ø§</span>
<span class="keyword">SELECT</span> <span class="function">h3kRing</span>(<span class="number">617733122422996991</span>, <span class="number">1</span>) <span class="keyword">AS</span> neighbors;
<span class="comment">-- Ø­Ù„Ù‚Ù‡ Ø§ÙˆÙ„ Ù‡Ù…Ø³Ø§ÛŒÚ¯ÛŒ (6 Ø³Ù„ÙˆÙ„)</span>

<span class="keyword">SELECT</span> <span class="function">h3kRing</span>(<span class="number">617733122422996991</span>, <span class="number">2</span>) <span class="keyword">AS</span> ring_2;
<span class="comment">-- Ø­Ù„Ù‚Ù‡ Ø¯ÙˆÙ… Ù‡Ù…Ø³Ø§ÛŒÚ¯ÛŒ (12 Ø³Ù„ÙˆÙ„)</span>

<span class="comment">-- Û¶. ÙØ§ØµÙ„Ù‡ Ø¨ÛŒÙ† Ø¯Ùˆ Ø³Ù„ÙˆÙ„ (ØªØ¹Ø¯Ø§Ø¯ Ø³Ù„ÙˆÙ„)</span>
<span class="keyword">SELECT</span> <span class="function">h3Distance</span>(
    <span class="function">geoToH3</span>(<span class="number">35.6892</span>, <span class="number">51.3890</span>, <span class="number">9</span>),
    <span class="function">geoToH3</span>(<span class="number">35.7000</span>, <span class="number">51.4000</span>, <span class="number">9</span>)
) <span class="keyword">AS</span> cell_distance;

<span class="comment">-- Û·. Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø¹ØªØ¨Ø± Ø¨ÙˆØ¯Ù† H3</span>
<span class="keyword">SELECT</span> <span class="function">h3IsValid</span>(<span class="number">617733122422996991</span>) <span class="keyword">AS</span> is_valid;

<span class="comment">-- Û¸. Ø¯Ø±ÛŒØ§ÙØª Ø±Ø²ÙˆÙ„ÙˆØ´Ù†</span>
<span class="keyword">SELECT</span> <span class="function">h3GetResolution</span>(<span class="number">617733122422996991</span>) <span class="keyword">AS</span> resolution;
<span class="comment">-- Ù†ØªÛŒØ¬Ù‡: 9</span></pre>
                    </div>
                </div>

                <h3>Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÛŒ: ØªØ­Ù„ÛŒÙ„ ØªØ±Ø§Ú©Ù… Ø¨Ø§ H3</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“Š</span>
                            SQL - Density Analysis
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ Ø¨Ø§ H3</span>
<span class="keyword">CREATE TABLE</span> gps_tracks
(
    device_id   <span class="type">UInt32</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    h3_9        <span class="type">UInt64</span>,
    timestamp   <span class="type">DateTime</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (h3_9, timestamp);

<span class="comment">-- Ø¯Ø±Ø¬ Ø¯Ø§Ø¯Ù‡ Ø¨Ø§ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± H3</span>
<span class="keyword">INSERT INTO</span> gps_tracks
<span class="keyword">SELECT</span>
    rand() % <span class="number">1000</span> <span class="keyword">AS</span> device_id,
    <span class="number">35.6</span> + (rand() % <span class="number">1000</span>) / <span class="number">10000</span> <span class="keyword">AS</span> latitude,
    <span class="number">51.3</span> + (rand() % <span class="number">1000</span>) / <span class="number">10000</span> <span class="keyword">AS</span> longitude,
    <span class="function">geoToH3</span>(
        <span class="number">35.6</span> + (rand() % <span class="number">1000</span>) / <span class="number">10000</span>,
        <span class="number">51.3</span> + (rand() % <span class="number">1000</span>) / <span class="number">10000</span>,
        <span class="number">9</span>
    ) <span class="keyword">AS</span> h3_9,
    now() - <span class="function">toIntervalSecond</span>(rand() % <span class="number">86400</span>) <span class="keyword">AS</span> timestamp
<span class="keyword">FROM</span> numbers(<span class="number">10000000</span>);  <span class="comment">-- 10 Ù…ÛŒÙ„ÛŒÙˆÙ† Ø±Ú©ÙˆØ±Ø¯</span>

<span class="comment">-- ØªØ­Ù„ÛŒÙ„ ØªØ±Ø§Ú©Ù…: ØªØ¹Ø¯Ø§Ø¯ Ù†Ù‚Ø§Ø· Ø¯Ø± Ù‡Ø± Ø³Ù„ÙˆÙ„ H3</span>
<span class="keyword">SELECT</span>
    h3_9,
    <span class="function">h3ToGeo</span>(h3_9).<span class="number">1</span> <span class="keyword">AS</span> center_lon,
    <span class="function">h3ToGeo</span>(h3_9).<span class="number">2</span> <span class="keyword">AS</span> center_lat,
    <span class="function">count</span>() <span class="keyword">AS</span> point_count,
    <span class="function">uniqExact</span>(device_id) <span class="keyword">AS</span> unique_devices
<span class="keyword">FROM</span> gps_tracks
<span class="keyword">WHERE</span> timestamp >= now() - <span class="function">toIntervalHour</span>(<span class="number">1</span>)
<span class="keyword">GROUP BY</span> h3_9
<span class="keyword">ORDER BY</span> point_count <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">20</span>;

<span class="comment">-- Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ: ØªØ¬Ù…ÛŒØ¹ Ø¯Ø± Ø±Ø²ÙˆÙ„ÙˆØ´Ù† Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ±</span>
<span class="keyword">SELECT</span>
    <span class="function">h3ToParent</span>(h3_9, <span class="number">7</span>) <span class="keyword">AS</span> h3_7,
    <span class="function">count</span>() <span class="keyword">AS</span> total_points,
    <span class="function">uniqExact</span>(device_id) <span class="keyword">AS</span> unique_devices,
    <span class="function">avg</span>(latitude) <span class="keyword">AS</span> avg_lat,
    <span class="function">avg</span>(longitude) <span class="keyword">AS</span> avg_lon
<span class="keyword">FROM</span> gps_tracks
<span class="keyword">GROUP BY</span> h3_7
<span class="keyword">ORDER BY</span> total_points <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">100</span>;</pre>
                    </div>
                </div>

                <h3>Ø¬Ø³ØªØ¬ÙˆÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø³Ø±ÛŒØ¹ Ø¨Ø§ H3</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ”</span>
                            SQL - Fast Spatial Search
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- ÛŒØ§ÙØªÙ† Ù†Ù‚Ø§Ø· Ø¯Ø± Ø´Ø¹Ø§Ø¹ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² H3 (Ø¨Ø³ÛŒØ§Ø± Ø³Ø±ÛŒØ¹â€ŒØªØ±)</span>
<span class="keyword">WITH</span>
    <span class="number">35.6892</span> <span class="keyword">AS</span> center_lat,
    <span class="number">51.3890</span> <span class="keyword">AS</span> center_lon,
    <span class="number">9</span> <span class="keyword">AS</span> h3_resolution,
    <span class="number">2</span> <span class="keyword">AS</span> ring_size  <span class="comment">-- ØªØ¹Ø¯Ø§Ø¯ Ø­Ù„Ù‚Ù‡â€ŒÙ‡Ø§ÛŒ Ù‡Ù…Ø³Ø§ÛŒÚ¯ÛŒ</span>
<span class="keyword">SELECT</span> *
<span class="keyword">FROM</span> gps_tracks
<span class="keyword">WHERE</span> h3_9 <span class="keyword">IN</span> (
    <span class="keyword">SELECT</span> <span class="function">arrayJoin</span>(
        <span class="function">arrayConcat</span>(
            [<span class="function">geoToH3</span>(center_lat, center_lon, h3_resolution)],
            <span class="function">h3kRing</span>(<span class="function">geoToH3</span>(center_lat, center_lon, h3_resolution), <span class="number">1</span>),
            <span class="function">h3kRing</span>(<span class="function">geoToH3</span>(center_lat, center_lon, h3_resolution), <span class="number">2</span>)
        )
    )
)
<span class="keyword">LIMIT</span> <span class="number">1000</span>;

<span class="comment">-- Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø³Ø±Ø¹Øª:</span>
<span class="comment">-- Ø¨Ø¯ÙˆÙ† H3: Ø§Ø³Ú©Ù† Ú©Ø§Ù…Ù„ Ø¬Ø¯ÙˆÙ„ â†’ Ú†Ù†Ø¯ Ø«Ø§Ù†ÛŒÙ‡ Ø¨Ø±Ø§ÛŒ Ù…ÛŒÙ„ÛŒÙˆÙ†â€ŒÙ‡Ø§ Ø±Ø¯ÛŒÙ</span>
<span class="comment">-- Ø¨Ø§ H3: ÙÛŒÙ„ØªØ± Ø±ÙˆÛŒ Ø§ÛŒÙ†Ø¯Ú©Ø³ â†’ Ù…ÛŒÙ„ÛŒâ€ŒØ«Ø§Ù†ÛŒÙ‡</span></pre>
                    </div>
                </div>

                <div class="box box-tip">
                    <div class="box-title">
                        <span>ğŸ’¡</span>
                        Ø¨Ù‡ØªØ±ÛŒÙ† Ø´ÛŒÙˆÙ‡â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ H3
                    </div>
                    <ul>
                        <li>H3 Ø±Ø§ Ø¯Ø± <span class="inline-code">ORDER BY</span> Ø¬Ø¯ÙˆÙ„ Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯</li>
                        <li>Ø±Ø²ÙˆÙ„ÙˆØ´Ù† Û¹ Ø¨Ø±Ø§ÛŒ Ø§Ú©Ø«Ø± Ú©Ø§Ø±Ø¨Ø±Ø¯Ù‡Ø§ÛŒ Ø´Ù‡Ø±ÛŒ Ù…Ù†Ø§Ø³Ø¨ Ø§Ø³Øª</li>
                        <li>Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„ÙØŒ Ú†Ù†Ø¯ Ø±Ø²ÙˆÙ„ÙˆØ´Ù† Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯</li>
                        <li>Ø§Ø² <span class="inline-code">h3ToParent</span> Ø¨Ø±Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹ Ø³Ù„Ø³Ù„Ù‡â€ŒÙ…Ø±Ø§ØªØ¨ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 7: GEOHASH
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="geohash">
            <div class="section-header">
                <div class="section-number">Û·</div>
                <h2 class="section-title">Geohash</h2>
            </div>
            
            <div class="section-content">
                <p>
                    <strong>Geohash</strong> ÛŒÚ© Ø³ÛŒØ³ØªÙ… Ú©Ø¯Ú¯Ø°Ø§Ø±ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø§Ø³Øª Ú©Ù‡ Ù…Ø®ØªØµØ§Øª Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒ 
                    Ø±Ø§ Ø¨Ù‡ ÛŒÚ© Ø±Ø´ØªÙ‡ Ú©ÙˆØªØ§Ù‡ ØªØ¨Ø¯ÛŒÙ„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯. Ù†Ù‚Ø§Ø· Ù†Ø²Ø¯ÛŒÚ© Ø¨Ù‡ Ù‡Ù…ØŒ Geohash Ù…Ø´Ø§Ø¨Ù‡ÛŒ Ø¯Ø§Ø±Ù†Ø¯.
                </p>

                <h3>ØªÙˆØ§Ø¨Ø¹ Geohash</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>#ï¸âƒ£</span>
                            SQL - Geohash Functions
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Û±. ØªØ¨Ø¯ÛŒÙ„ Ù…Ø®ØªØµØ§Øª Ø¨Ù‡ Geohash</span>
<span class="keyword">SELECT</span> <span class="function">geohashEncode</span>(<span class="number">51.3890</span>, <span class="number">35.6892</span>, <span class="number">9</span>) <span class="keyword">AS</span> geohash;
<span class="comment">-- Ù†ØªÛŒØ¬Ù‡: 'tp7zr3yxk'</span>

<span class="comment">-- Ø¨Ø§ Ø¯Ù‚Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù</span>
<span class="keyword">SELECT</span>
    <span class="function">geohashEncode</span>(<span class="number">51.3890</span>, <span class="number">35.6892</span>, <span class="number">4</span>) <span class="keyword">AS</span> precision_4,  <span class="comment">-- ~39km</span>
    <span class="function">geohashEncode</span>(<span class="number">51.3890</span>, <span class="number">35.6892</span>, <span class="number">6</span>) <span class="keyword">AS</span> precision_6,  <span class="comment">-- ~610m</span>
    <span class="function">geohashEncode</span>(<span class="number">51.3890</span>, <span class="number">35.6892</span>, <span class="number">8</span>) <span class="keyword">AS</span> precision_8,  <span class="comment">-- ~38m</span>
    <span class="function">geohashEncode</span>(<span class="number">51.3890</span>, <span class="number">35.6892</span>, <span class="number">12</span>) <span class="keyword">AS</span> precision_12; <span class="comment">-- ~3.7cm</span>

<span class="comment">-- Û². ØªØ¨Ø¯ÛŒÙ„ Geohash Ø¨Ù‡ Ù…Ø®ØªØµØ§Øª</span>
<span class="keyword">SELECT</span> <span class="function">geohashDecode</span>(<span class="string">'tp7zr3yxk'</span>) <span class="keyword">AS</span> coordinates;
<span class="comment">-- Ù†ØªÛŒØ¬Ù‡: (51.38899..., 35.68919...)</span>

<span class="comment">-- Û³. ÛŒØ§ÙØªÙ† Ù‡Ù…Ø³Ø§ÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Geohash</span>
<span class="keyword">SELECT</span> <span class="function">geohashesInBox</span>(
    <span class="number">51.3</span>, <span class="number">35.6</span>,   <span class="comment">-- Ú¯ÙˆØ´Ù‡ Ù¾Ø§ÛŒÛŒÙ†-Ú†Ù¾ (lon, lat)</span>
    <span class="number">51.5</span>, <span class="number">35.8</span>,   <span class="comment">-- Ú¯ÙˆØ´Ù‡ Ø¨Ø§Ù„Ø§-Ø±Ø§Ø³Øª (lon, lat)</span>
    <span class="number">6</span>              <span class="comment">-- Ø¯Ù‚Øª</span>
) <span class="keyword">AS</span> geohashes_in_area;</pre>
                    </div>
                </div>

                <h3>Ø¯Ù‚Øª Geohash</h3>

                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø·ÙˆÙ„</th>
                                <th>Ø¹Ø±Ø¶ Ø³Ù„ÙˆÙ„</th>
                                <th>Ø§Ø±ØªÙØ§Ø¹ Ø³Ù„ÙˆÙ„</th>
                                <th>Ú©Ø§Ø±Ø¨Ø±Ø¯</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>5,000 km</td>
                                <td>5,000 km</td>
                                <td>Ù‚Ø§Ø±Ù‡</td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>39 km</td>
                                <td>19.5 km</td>
                                <td>Ø´Ù‡Ø± Ø¨Ø²Ø±Ú¯</td>
                            </tr>
                            <tr>
                                <td>6</td>
                                <td>1.2 km</td>
                                <td>610 m</td>
                                <td>Ù…Ø­Ù„Ù‡</td>
                            </tr>
                            <tr>
                                <td>8</td>
                                <td>38 m</td>
                                <td>19 m</td>
                                <td>Ø®ÛŒØ§Ø¨Ø§Ù†</td>
                            </tr>
                            <tr>
                                <td>10</td>
                                <td>1.2 m</td>
                                <td>0.6 m</td>
                                <td>Ø³Ø§Ø®ØªÙ…Ø§Ù†</td>
                            </tr>
                            <tr>
                                <td>12</td>
                                <td>3.7 cm</td>
                                <td>1.8 cm</td>
                                <td>Ø¯Ù‚Øª Ø¨Ø§Ù„Ø§</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>Ù…Ø«Ø§Ù„: Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø§ Geohash</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ”</span>
                            SQL - Geohash Search
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ Ø¨Ø§ Geohash</span>
<span class="keyword">CREATE TABLE</span> locations_geohash
(
    id          <span class="type">UInt64</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    geohash_8   <span class="type">String</span>,
    timestamp   <span class="type">DateTime</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (geohash_8, timestamp);

<span class="comment">-- Ø¬Ø³ØªØ¬ÙˆÛŒ Ù†Ù‚Ø§Ø· Ø¯Ø± ÛŒÚ© Ù†Ø§Ø­ÛŒÙ‡ Ø¨Ø§ prefix matching</span>
<span class="keyword">SELECT</span> *
<span class="keyword">FROM</span> locations_geohash
<span class="keyword">WHERE</span> geohash_8 <span class="keyword">LIKE</span> <span class="string">'tp7zr%'</span>  <span class="comment">-- Ù‡Ù…Ù‡ Ù†Ù‚Ø§Ø· Ø¨Ø§ prefix Ù…Ø´ØªØ±Ú©</span>
<span class="keyword">LIMIT</span> <span class="number">100</span>;

<span class="comment">-- Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ú†Ù†Ø¯ Geohash Ù‡Ù…Ø³Ø§ÛŒÙ‡</span>
<span class="keyword">SELECT</span> *
<span class="keyword">FROM</span> locations_geohash
<span class="keyword">WHERE</span> <span class="function">substring</span>(geohash_8, <span class="number">1</span>, <span class="number">5</span>) <span class="keyword">IN</span> (
    <span class="string">'tp7zr'</span>, <span class="string">'tp7zq'</span>, <span class="string">'tp7zp'</span>,
    <span class="string">'tp7zx'</span>, <span class="string">'tp7zw'</span>, <span class="string">'tp7zn'</span>
);</pre>
                    </div>
                </div>

                <div class="box box-info">
                    <div class="box-title">
                        <span>ğŸ’¡</span>
                        H3 vs Geohash
                    </div>
                    <div class="table-wrapper" style="margin-top: 15px;">
                        <table>
                            <thead>
                                <tr>
                                    <th>ÙˆÛŒÚ˜Ú¯ÛŒ</th>
                                    <th>H3</th>
                                    <th>Geohash</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Ø´Ú©Ù„ Ø³Ù„ÙˆÙ„</td>
                                    <td>Ø´Ø´â€ŒØ¶Ù„Ø¹ÛŒ</td>
                                    <td>Ù…Ø³ØªØ·ÛŒÙ„</td>
                                </tr>
                                <tr>
                                    <td>ÙØ§ØµÙ„Ù‡ Ø§Ø² Ù…Ø±Ú©Ø²</td>
                                    <td>ÛŒÚ©Ù†ÙˆØ§Ø®Øª</td>
                                    <td>Ù…ØªØºÛŒØ±</td>
                                </tr>
                                <tr>
                                    <td>Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡</td>
                                    <td>UInt64</td>
                                    <td>String</td>
                                </tr>
                                <tr>
                                    <td>Ù‡Ù…Ø³Ø§ÛŒÚ¯ÛŒ</td>
                                    <td>Ø¯Ù‚ÛŒÙ‚ (6 Ù‡Ù…Ø³Ø§ÛŒÙ‡)</td>
                                    <td>Ù…Ø´Ú©Ù„ Ø¯Ø± Ù…Ø±Ø²Ù‡Ø§</td>
                                </tr>
                                <tr>
                                    <td>Ø³Ø±Ø¹Øª Ù…Ù‚Ø§ÛŒØ³Ù‡</td>
                                    <td>Ø³Ø±ÛŒØ¹â€ŒØªØ± (Ø¹Ø¯Ø¯ÛŒ)</td>
                                    <td>Ú©Ù†Ø¯ØªØ± (Ø±Ø´ØªÙ‡â€ŒØ§ÛŒ)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <p style="margin-top: 15px;">
                        <strong>ØªÙˆØµÛŒÙ‡:</strong> Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø§Ø² H3 Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ Ù…Ú¯Ø± Ø§ÛŒÙ†Ú©Ù‡ 
                        Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Ø¨Ø§ Ø³ÛŒØ³ØªÙ…â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯.
                    </p>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 8: S2
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="s2">
            <div class="section-header">
                <div class="section-number">Û¸</div>
                <h2 class="section-title">S2 Geometry</h2>
            </div>
            
            <div class="section-content">
                <p>
                    <strong>S2</strong> ÛŒÚ© Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ù‡Ù†Ø¯Ø³Ù‡ Ú©Ø±ÙˆÛŒ Ø§Ø³Øª Ú©Ù‡ ØªÙˆØ³Ø· Google ØªÙˆØ³Ø¹Ù‡ ÛŒØ§ÙØªÙ‡. 
                    Ø²Ù…ÛŒÙ† Ø±Ø§ Ø¨Ù‡ Ø³Ù„ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ø³Ù„Ø³Ù„Ù‡â€ŒÙ…Ø±Ø§ØªØ¨ÛŒ ØªÙ‚Ø³ÛŒÙ… Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ùˆ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù…Ú©Ø§Ù†ÛŒ 
                    Ø¯Ø± Google Maps Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.
                </p>

                <h3>ØªÙˆØ§Ø¨Ø¹ S2 Ø¯Ø± ClickHouse</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸŒ</span>
                            SQL - S2 Functions
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Û±. ØªØ¨Ø¯ÛŒÙ„ Ù…Ø®ØªØµØ§Øª Ø¨Ù‡ S2 Cell ID</span>
<span class="keyword">SELECT</span> <span class="function">geoToS2</span>(<span class="number">51.3890</span>, <span class="number">35.6892</span>) <span class="keyword">AS</span> s2_cell_id;

<span class="comment">-- Û². ØªØ¨Ø¯ÛŒÙ„ S2 Ø¨Ù‡ Ù…Ø®ØªØµØ§Øª</span>
<span class="keyword">SELECT</span> <span class="function">s2ToGeo</span>(<span class="number">4590216723844964352</span>) <span class="keyword">AS</span> coordinates;

<span class="comment">-- Û³. Ø¯Ø±ÛŒØ§ÙØª Ù‡Ù…Ø³Ø§ÛŒÙ‡â€ŒÙ‡Ø§</span>
<span class="keyword">SELECT</span> <span class="function">s2GetNeighbors</span>(<span class="number">4590216723844964352</span>) <span class="keyword">AS</span> neighbors;

<span class="comment">-- Û´. Ø¨Ø±Ø±Ø³ÛŒ Ø´Ø§Ù…Ù„ Ø¨ÙˆØ¯Ù†</span>
<span class="keyword">SELECT</span> <span class="function">s2CellsIntersect</span>(
    <span class="function">geoToS2</span>(<span class="number">51.3890</span>, <span class="number">35.6892</span>),
    <span class="function">geoToS2</span>(<span class="number">51.3891</span>, <span class="number">35.6893</span>)
) <span class="keyword">AS</span> do_intersect;

<span class="comment">-- Ûµ. Ù¾ÙˆØ´Ø´ ÛŒÚ© Ù…Ø³ØªØ·ÛŒÙ„ Ø¨Ø§ Ø³Ù„ÙˆÙ„â€ŒÙ‡Ø§ÛŒ S2</span>
<span class="keyword">SELECT</span> <span class="function">s2RectAdd</span>(
    <span class="function">s2RectAdd</span>(
        <span class="function">s2RectEmpty</span>(),
        <span class="function">geoToS2</span>(<span class="number">51.3</span>, <span class="number">35.6</span>)
    ),
    <span class="function">geoToS2</span>(<span class="number">51.5</span>, <span class="number">35.8</span>)
) <span class="keyword">AS</span> bounding_rect;</pre>
                    </div>
                </div>

                <div class="box box-tip">
                    <div class="box-title">
                        <span>ğŸ’¡</span>
                        Ú©ÛŒ Ø§Ø² S2 Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒÙ…ØŸ
                    </div>
                    <ul>
                        <li>ÙˆÙ‚ØªÛŒ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Ø¨Ø§ Ø³ÛŒØ³ØªÙ…â€ŒÙ‡Ø§ÛŒ Google Ø¯Ø§Ø±ÛŒØ¯</li>
                        <li>Ø¨Ø±Ø§ÛŒ Ù¾ÙˆØ´Ø´ Ø¯Ù‚ÛŒÙ‚ Ù…Ù†Ø§Ø·Ù‚ Ø¨Ø§ Ø´Ú©Ù„â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒÚ†ÛŒØ¯Ù‡</li>
                        <li>ÙˆÙ‚ØªÛŒ Ù†ÛŒØ§Ø² Ø¨Ù‡ Û³Û° Ø³Ø·Ø­ Ø±Ø²ÙˆÙ„ÙˆØ´Ù† Ø¯Ø§Ø±ÛŒØ¯ (Ø¨ÛŒØ´ØªØ± Ø§Ø² H3)</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 9: OPTIMIZATION
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="optimization">
            <div class="section-header">
                <div class="section-number">Û¹</div>
                <h2 class="section-title">Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ</h2>
            </div>
            
            <div class="section-content">
                <h3>Û±. Ø§Ù†ØªØ®Ø§Ø¨ ORDER BY Ù…Ù†Ø§Ø³Ø¨</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>âš¡</span>
                            SQL - Optimal ORDER BY
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- âŒ Ù†Ø§Ù…Ù†Ø§Ø³Ø¨: Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø²Ù…Ø§Ù†</span>
<span class="keyword">CREATE TABLE</span> bad_design
(
    ...
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> timestamp;  <span class="comment">-- Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ú©Ù†Ø¯ Ø®ÙˆØ§Ù‡Ù†Ø¯ Ø¨ÙˆØ¯</span>

<span class="comment">-- âœ… Ù…Ù†Ø§Ø³Ø¨: Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ H3 Ø³Ù¾Ø³ Ø²Ù…Ø§Ù†</span>
<span class="keyword">CREATE TABLE</span> good_design
(
   h3_index    <span class="type">UInt64</span>,
    timestamp   <span class="type">DateTime</span>,
    ...
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (h3_index, timestamp);  <span class="comment">-- Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø³Ø±ÛŒØ¹</span>

<span class="comment">-- âœ… Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ ØªØ±Ú©ÛŒØ¨ÛŒ Ù…Ú©Ø§Ù†ÛŒ-Ø²Ù…Ø§Ù†ÛŒ</span>
<span class="keyword">CREATE TABLE</span> optimal_design
(
    h3_index    <span class="type">UInt64</span>,
    date        <span class="type">Date</span>,
    timestamp   <span class="type">DateTime</span>,
    ...
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">PARTITION BY</span> toYYYYMM(date)  <span class="comment">-- Ù¾Ø§Ø±ØªÛŒØ´Ù† Ù…Ø§Ù‡Ø§Ù†Ù‡</span>
<span class="keyword">ORDER BY</span> (h3_index, timestamp);</pre>
                    </div>
                </div>

                <h3>Û². Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Projection</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“Š</span>
                            SQL - Projections
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ Ø¨Ø§ Projection Ø¨Ø±Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹ Ø³Ø±ÛŒØ¹</span>
<span class="keyword">CREATE TABLE</span> gps_data
(
    device_id   <span class="type">UInt32</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    h3_9        <span class="type">UInt64</span>,
    h3_7        <span class="type">UInt64</span>,
    speed       <span class="type">Float32</span>,
    timestamp   <span class="type">DateTime</span>,
    
    <span class="comment">-- Projection Ø¨Ø±Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹ Ø¨Ø± Ø§Ø³Ø§Ø³ H3 Ø±Ø²ÙˆÙ„ÙˆØ´Ù† 7</span>
    <span class="keyword">PROJECTION</span> h3_7_agg
    (
        <span class="keyword">SELECT</span>
            h3_7,
            <span class="function">toStartOfHour</span>(timestamp) <span class="keyword">AS</span> hour,
            <span class="function">count</span>() <span class="keyword">AS</span> cnt,
            <span class="function">avg</span>(speed) <span class="keyword">AS</span> avg_speed,
            <span class="function">uniqExact</span>(device_id) <span class="keyword">AS</span> unique_devices
        <span class="keyword">GROUP BY</span> h3_7, hour
    )
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">PARTITION BY</span> toYYYYMM(timestamp)
<span class="keyword">ORDER BY</span> (h3_9, timestamp);

<span class="comment">-- Ú©ÙˆØ¦Ø±ÛŒ Ú©Ù‡ Ø§Ø² Projection Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ (Ø®ÙˆØ¯Ú©Ø§Ø±)</span>
<span class="keyword">SELECT</span>
    h3_7,
    <span class="function">toStartOfHour</span>(timestamp) <span class="keyword">AS</span> hour,
    <span class="function">count</span>() <span class="keyword">AS</span> cnt,
    <span class="function">avg</span>(speed) <span class="keyword">AS</span> avg_speed
<span class="keyword">FROM</span> gps_data
<span class="keyword">WHERE</span> timestamp >= now() - <span class="function">toIntervalDay</span>(<span class="number">7</span>)
<span class="keyword">GROUP BY</span> h3_7, hour;</pre>
                    </div>
                </div>

                <h3>Û³. Materialized View Ø¨Ø±Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹ Real-time</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ”„</span>
                            SQL - Materialized Views
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ø¬Ø¯ÙˆÙ„ Ø®Ø§Ù… GPS</span>
<span class="keyword">CREATE TABLE</span> gps_raw
(
    device_id   <span class="type">UInt32</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    speed       <span class="type">Float32</span>,
    timestamp   <span class="type">DateTime</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (device_id, timestamp);

<span class="comment">-- Ø¬Ø¯ÙˆÙ„ ØªØ¬Ù…ÛŒØ¹ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ</span>
<span class="keyword">CREATE TABLE</span> heatmap_hourly
(
    h3_7        <span class="type">UInt64</span>,
    hour        <span class="type">DateTime</span>,
    point_count <span class="type">UInt64</span>,
    avg_speed   <span class="type">Float64</span>,
    device_count <span class="type">UInt64</span>
)
<span class="keyword">ENGINE</span> = SummingMergeTree()
<span class="keyword">ORDER BY</span> (h3_7, hour);

<span class="comment">-- Materialized View Ø¨Ø±Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹ Ø®ÙˆØ¯Ú©Ø§Ø±</span>
<span class="keyword">CREATE MATERIALIZED VIEW</span> heatmap_mv
<span class="keyword">TO</span> heatmap_hourly
<span class="keyword">AS</span>
<span class="keyword">SELECT</span>
    <span class="function">geoToH3</span>(latitude, longitude, <span class="number">7</span>) <span class="keyword">AS</span> h3_7,
    <span class="function">toStartOfHour</span>(timestamp) <span class="keyword">AS</span> hour,
    <span class="function">count</span>() <span class="keyword">AS</span> point_count,
    <span class="function">avg</span>(speed) <span class="keyword">AS</span> avg_speed,
    <span class="function">uniqExact</span>(device_id) <span class="keyword">AS</span> device_count
<span class="keyword">FROM</span> gps_raw
<span class="keyword">GROUP BY</span> h3_7, hour;

<span class="comment">-- Ø­Ø§Ù„Ø§ Ø¨Ø§ Ù‡Ø± INSERT Ø¨Ù‡ gps_rawØŒ Ø¬Ø¯ÙˆÙ„ heatmap_hourly Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù‡â€ŒØ±ÙˆØ² Ù…ÛŒâ€ŒØ´ÙˆØ¯</span></pre>
                    </div>
                </div>

                <h3>Û´. ØªÚ©Ù†ÛŒÚ©â€ŒÙ‡Ø§ÛŒ ÙÛŒÙ„ØªØ± Ø³Ø±ÛŒØ¹</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸš€</span>
                            SQL - Fast Filtering
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- âŒ Ú©Ù†Ø¯: Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙØ§ØµÙ„Ù‡ Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§</span>
<span class="keyword">SELECT</span> *
<span class="keyword">FROM</span> locations
<span class="keyword">WHERE</span> <span class="function">greatCircleDistance</span>(lat, lon, <span class="number">35.6892</span>, <span class="number">51.3890</span>) < <span class="number">5000</span>;

<span class="comment">-- âœ… Ø³Ø±ÛŒØ¹: Ø§Ø¨ØªØ¯Ø§ Bounding Box Ø³Ù¾Ø³ ÙØ§ØµÙ„Ù‡ Ø¯Ù‚ÛŒÙ‚</span>
<span class="keyword">SELECT</span> *
<span class="keyword">FROM</span> locations
<span class="keyword">WHERE</span> 
    <span class="comment">-- Ù…Ø±Ø­Ù„Ù‡ Û±: ÙÛŒÙ„ØªØ± Ø³Ø±ÛŒØ¹ Ø¨Ø§ Ù…Ø³ØªØ·ÛŒÙ„ (Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ†Ø¯Ú©Ø³)</span>
    lat <span class="keyword">BETWEEN</span> <span class="number">35.6892</span> - <span class="number">0.045</span> <span class="keyword">AND</span> <span class="number">35.6892</span> + <span class="number">0.045</span>
    <span class="keyword">AND</span> lon <span class="keyword">BETWEEN</span> <span class="number">51.3890</span> - <span class="number">0.055</span> <span class="keyword">AND</span> <span class="number">51.3890</span> + <span class="number">0.055</span>
    <span class="comment">-- Ù…Ø±Ø­Ù„Ù‡ Û²: ÙÛŒÙ„ØªØ± Ø¯Ù‚ÛŒÙ‚ (ÙÙ‚Ø· Ø±ÙˆÛŒ Ù†ØªØ§ÛŒØ¬ ÙÛŒÙ„ØªØ± Ø´Ø¯Ù‡)</span>
    <span class="keyword">AND</span> <span class="function">greatCircleDistance</span>(lat, lon, <span class="number">35.6892</span>, <span class="number">51.3890</span>) < <span class="number">5000</span>;

<span class="comment">-- âœ…âœ… Ø³Ø±ÛŒØ¹â€ŒØªØ±ÛŒÙ†: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² H3</span>
<span class="keyword">WITH</span> target_cells <span class="keyword">AS</span> (
    <span class="keyword">SELECT</span> <span class="function">arrayJoin</span>(
        <span class="function">h3kRing</span>(<span class="function">geoToH3</span>(<span class="number">35.6892</span>, <span class="number">51.3890</span>, <span class="number">9</span>), <span class="number">3</span>)
    ) <span class="keyword">AS</span> h3_cell
)
<span class="keyword">SELECT</span> l.*
<span class="keyword">FROM</span> locations l
<span class="keyword">WHERE</span> l.h3_9 <span class="keyword">IN</span> (<span class="keyword">SELECT</span> h3_cell <span class="keyword">FROM</span> target_cells);</pre>
                    </div>
                </div>

                <h3>Ûµ. ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ù‡Ù…</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>âš™ï¸</span>
                            SQL - Settings
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ø§ÙØ²Ø§ÛŒØ´ Ø­Ø§ÙØ¸Ù‡ Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø³Ù†Ú¯ÛŒÙ†</span>
<span class="keyword">SET</span> max_memory_usage = <span class="number">20000000000</span>;  <span class="comment">-- 20GB</span>

<span class="comment">-- ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…ÙˆØ§Ø²ÛŒ</span>
<span class="keyword">SET</span> max_threads = <span class="number">16</span>;

<span class="comment">-- Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ØªÙ…Ø§Ù… Ù‡Ø³ØªÙ‡â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù†</span>
<span class="keyword">SET</span> max_parallel_replicas = <span class="number">3</span>;

<span class="comment">-- Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ JOIN</span>
<span class="keyword">SET</span> join_algorithm = <span class="string">'hash'</span>;

<span class="comment">-- ÙØ´Ø±Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù†ØªØ§ÛŒØ¬ Ù…ÛŒØ§Ù†ÛŒ</span>
<span class="keyword">SET</span> enable_compress_block_on_insert = <span class="number">1</span>;</pre>
                    </div>
                </div>

                <div class="box box-warning">
                    <div class="box-title">
                        <span>âš ï¸</span>
                        Ù†Ú©Ø§Øª Ù…Ù‡Ù… Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ
                    </div>
                    <ul>
                        <li><strong>Ù‡Ù…ÛŒØ´Ù‡</strong> Ø§Ø² EXPLAIN Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒ Ù¾Ù„Ù† Ú©ÙˆØ¦Ø±ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                        <li>Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ H3/Geohash Ø±Ø§ Ø¯Ø± ORDER BY Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯</li>
                        <li>Ø§Ø² Projection Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ ØªÚ©Ø±Ø§Ø±ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                        <li>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ§Ø±ÛŒØ® Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ú©Ù†ÛŒØ¯</li>
                        <li>Ø§Ø² LowCardinality Ø¨Ø±Ø§ÛŒ Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ø¨Ø§ Ù…Ù‚Ø§Ø¯ÛŒØ± ØªÚ©Ø±Ø§Ø±ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 10: REAL WORLD PROJECTS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="real-world">
            <div class="section-header">
                <div class="section-number">Û±Û°</div>
                <h2 class="section-title">Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒ</h2>
            </div>
            
            <div class="section-content">
                <h3>Ù¾Ø±ÙˆÚ˜Ù‡ Û±: Ø³ÛŒØ³ØªÙ… Ø±Ø¯ÛŒØ§Ø¨ÛŒ Ù†Ø§ÙˆÚ¯Ø§Ù†</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸš—</span>
                            SQL - Fleet Tracking System
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Û±. Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ Ø§ØµÙ„ÛŒ</span>
<span class="keyword">CREATE TABLE</span> fleet_tracking
(
    vehicle_id      <span class="type">UInt32</span>,
    driver_id       <span class="type">UInt32</span>,
    latitude        <span class="type">Float64</span>,
    longitude       <span class="type">Float64</span>,
    h3_9            <span class="type">UInt64</span>,
    h3_7            <span class="type">UInt64</span>,
    speed           <span class="type">Float32</span>,
    heading         <span class="type">Float32</span>,
    fuel_level      <span class="type">UInt8</span>,
    engine_status   <span class="type">Enum8</span>(<span class="string">'off'</span>=<span class="number">0</span>, <span class="string">'idle'</span>=<span class="number">1</span>, <span class="string">'running'</span>=<span class="number">2</span>),
    timestamp       <span class="type">DateTime64</span>(<span class="number">3</span>),
    date            <span class="type">Date</span> <span class="keyword">DEFAULT</span> <span class="function">toDate</span>(timestamp)
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">PARTITION BY</span> toYYYYMM(date)
<span class="keyword">ORDER BY</span> (vehicle_id, h3_9, timestamp)
<span class="keyword">TTL</span> date + <span class="keyword">INTERVAL</span> <span class="number">90</span> <span class="keyword">DAY</span>;  <span class="comment">-- Ø­Ø°Ù Ø®ÙˆØ¯Ú©Ø§Ø± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ</span>

<span class="comment">-- Û². Ø¬Ø¯ÙˆÙ„ Ø¢Ø®Ø±ÛŒÙ† Ù…ÙˆÙ‚Ø¹ÛŒØª (Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø²Ù†Ø¯Ù‡)</span>
<span class="keyword">CREATE TABLE</span> fleet_last_position
(
    vehicle_id      <span class="type">UInt32</span>,
    latitude        <span class="type">Float64</span>,
    longitude       <span class="type">Float64</span>,
    speed           <span class="type">Float32</span>,
    timestamp       <span class="type">DateTime64</span>(<span class="number">3</span>)
)
<span class="keyword">ENGINE</span> = ReplacingMergeTree(timestamp)
<span class="keyword">ORDER BY</span> vehicle_id;

<span class="comment">-- Û³. Materialized View Ø¨Ø±Ø§ÛŒ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ø®Ø±ÛŒÙ† Ù…ÙˆÙ‚Ø¹ÛŒØª</span>
<span class="keyword">CREATE MATERIALIZED VIEW</span> fleet_last_position_mv
<span class="keyword">TO</span> fleet_last_position
<span class="keyword">AS</span>
<span class="keyword">SELECT</span>
    vehicle_id,
    <span class="function">argMax</span>(latitude, timestamp) <span class="keyword">AS</span> latitude,
    <span class="function">argMax</span>(longitude, timestamp) <span class="keyword">AS</span> longitude,
    <span class="function">argMax</span>(speed, timestamp) <span class="keyword">AS</span> speed,
    <span class="function">max</span>(timestamp) <span class="keyword">AS</span> timestamp
<span class="keyword">FROM</span> fleet_tracking
<span class="keyword">GROUP BY</span> vehicle_id;

<span class="comment">-- Û´. Ú©ÙˆØ¦Ø±ÛŒ: Ø®ÙˆØ¯Ø±ÙˆÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„ Ø¯Ø± ÛŒÚ© Ù…Ù†Ø·Ù‚Ù‡</span>
<span class="keyword">SELECT</span>
    vehicle_id,
    latitude,
    longitude,
    speed,
    timestamp
<span class="keyword">FROM</span> fleet_last_position <span class="keyword">FINAL</span>
<span class="keyword">WHERE</span> 
    timestamp >= now() - <span class="function">toIntervalMinute</span>(<span class="number">5</span>)
    <span class="keyword">AND</span> <span class="function">greatCircleDistance</span>(latitude, longitude, <span class="number">35.6892</span>, <span class="number">51.3890</span>) < <span class="number">10000</span>;

<span class="comment">-- Ûµ. Ú©ÙˆØ¦Ø±ÛŒ: Ù…Ø³ÛŒØ± ÛŒÚ© Ø®ÙˆØ¯Ø±Ùˆ Ø¯Ø± Û²Û´ Ø³Ø§Ø¹Øª Ú¯Ø°Ø´ØªÙ‡</span>
<span class="keyword">SELECT</span>
    timestamp,
    latitude,
    longitude,
    speed
<span class="keyword">FROM</span> fleet_tracking
<span class="keyword">WHERE</span> 
    vehicle_id = <span class="number">12345</span>
    <span class="keyword">AND</span> timestamp >= now() - <span class="function">toIntervalHour</span>(<span class="number">24</span>)
<span class="keyword">ORDER BY</span> timestamp;

<span class="comment">-- Û¶. Ú©ÙˆØ¦Ø±ÛŒ: ØªØ­Ù„ÛŒÙ„ Ø³Ø±Ø¹Øª Ø¯Ø± Ù…Ù†Ø§Ø·Ù‚ Ù…Ø®ØªÙ„Ù</span>
<span class="keyword">SELECT</span>
    h3_7,
    <span class="function">h3ToGeo</span>(h3_7).<span class="number">1</span> <span class="keyword">AS</span> center_lon,
    <span class="function">h3ToGeo</span>(h3_7).<span class="number">2</span> <span class="keyword">AS</span> center_lat,
    <span class="function">avg</span>(speed) <span class="keyword">AS</span> avg_speed,
    <span class="function">max</span>(speed) <span class="keyword">AS</span> max_speed,
    <span class="function">count</span>() <span class="keyword">AS</span> sample_count
<span class="keyword">FROM</span> fleet_tracking
<span class="keyword">WHERE</span> 
    date = today()
    <span class="keyword">AND</span> speed > <span class="number">0</span>
<span class="keyword">GROUP BY</span> h3_7
<span class="keyword">HAVING</span> sample_count > <span class="number">100</span>
<span class="keyword">ORDER BY</span> avg_speed <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">50</span>;</pre>
                    </div>
                </div>

                <h3>Ù¾Ø±ÙˆÚ˜Ù‡ Û²: Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ Real-time</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ”¥</span>
                            SQL - Real-time Heatmap
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Û±. Ø¬Ø¯ÙˆÙ„ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</span>
<span class="keyword">CREATE TABLE</span> user_events
(
    user_id         <span class="type">UInt64</span>,
    event_type      <span class="type">LowCardinality</span>(<span class="type">String</span>),
    latitude        <span class="type">Float64</span>,
    longitude       <span class="type">Float64</span>,
    h3_8            <span class="type">UInt64</span> <span class="keyword">MATERIALIZED</span> <span class="function">geoToH3</span>(latitude, longitude, <span class="number">8</span>),
    h3_6            <span class="type">UInt64</span> <span class="keyword">MATERIALIZED</span> <span class="function">geoToH3</span>(latitude, longitude, <span class="number">6</span>),
    timestamp       <span class="type">DateTime</span>,
    date            <span class="type">Date</span> <span class="keyword">MATERIALIZED</span> <span class="function">toDate</span>(timestamp)
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">PARTITION BY</span> toYYYYMM(date)
<span class="keyword">ORDER BY</span> (h3_8, timestamp);

<span class="comment">-- Û². Ø¬Ø¯ÙˆÙ„ ØªØ¬Ù…ÛŒØ¹ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ</span>
<span class="keyword">CREATE TABLE</span> heatmap_5min
(
    h3_8            <span class="type">UInt64</span>,
    time_bucket     <span class="type">DateTime</span>,
    event_count     <span class="type">UInt64</span>,
    unique_users    <span class="type">UInt64</span>
)
<span class="keyword">ENGINE</span> = SummingMergeTree()
<span class="keyword">ORDER BY</span> (time_bucket, h3_8);

<span class="comment">-- Û³. Materialized View Ø¨Ø±Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹ Ûµ Ø¯Ù‚ÛŒÙ‚Ù‡â€ŒØ§ÛŒ</span>
<span class="keyword">CREATE MATERIALIZED VIEW</span> heatmap_5min_mv
<span class="keyword">TO</span> heatmap_5min
<span class="keyword">AS</span>
<span class="keyword">SELECT</span>
    h3_8,
    <span class="function">toStartOfFiveMinutes</span>(timestamp) <span class="keyword">AS</span> time_bucket,
    <span class="function">count</span>() <span class="keyword">AS</span> event_count,
    <span class="function">uniqExact</span>(user_id) <span class="keyword">AS</span> unique_users
<span class="keyword">FROM</span> user_events
<span class="keyword">GROUP BY</span> h3_8, time_bucket;

<span class="comment">-- Û´. Ú©ÙˆØ¦Ø±ÛŒ API Ø¨Ø±Ø§ÛŒ Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ</span>
<span class="keyword">SELECT</span>
    h3_8,
    <span class="function">h3ToGeo</span>(h3_8).<span class="number">1</span> <span class="keyword">AS</span> lon,
    <span class="function</span> max_temp
<span class="keyword">FROM</span> weather_sensors
<span class="keyword">WHERE</span> timestamp >= now() - <span class="keyword">INTERVAL</span> <span class="number">24</span> <span class="keyword">HOUR</span>
<span class="keyword">GROUP BY</span> h3_7;

<span class="comment">-- Û³. Ø±ÙˆÙ†Ø¯ Ø¯Ù…Ø§ Ø¯Ø± ÛŒÚ© Ù‡ÙØªÙ‡ Ø§Ø®ÛŒØ±</span>
<span class="keyword">SELECT</span>
    <span class="function">toStartOfHour</span>(timestamp) <span class="keyword">AS</span> hour,
    <span class="function">avg</span>(temperature) <span class="keyword">AS</span> avg_temp,
    <span class="function">avg</span>(humidity) <span class="keyword">AS</span> avg_humidity
<span class="keyword">FROM</span> weather_sensors
<span class="keyword">WHERE</span> timestamp >= now() - <span class="keyword">INTERVAL</span> <span class="number">7</span> <span class="keyword">DAY</span>
<span class="keyword">GROUP BY</span> hour
<span class="keyword">ORDER BY</span> hour;

<span class="comment">-- Û´. Ø¯Ø±ÙˆÙ†â€ŒÛŒØ§Ø¨ÛŒ Ø¯Ù…Ø§ Ø¨Ø±Ø§ÛŒ ÛŒÚ© Ù†Ù‚Ø·Ù‡ Ø¯Ù„Ø®ÙˆØ§Ù‡</span>
<span class="comment">-- (Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† ÙˆØ²Ù†ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ ÙØ§ØµÙ„Ù‡ Ø§Ø² Ø§ÛŒØ³ØªÚ¯Ø§Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ø²Ø¯ÛŒÚ©)</span>
<span class="keyword">WITH</span>
    <span class="number">35.7</span> <span class="keyword">AS</span> target_lat,
    <span class="number">51.4</span> <span class="keyword">AS</span> target_lon
<span class="keyword">SELECT</span>
    <span class="function">sum</span>(temperature / <span class="function">greatest</span>(distance, <span class="number">0.001</span>)) / 
    <span class="function">sum</span>(<span class="number">1</span> / <span class="function">greatest</span>(distance, <span class="number">0.001</span>)) <span class="keyword">AS</span> interpolated_temp
<span class="keyword">FROM</span> (
    <span class="keyword">SELECT</span>
        temperature,
        <span class="function">greatCircleDistance</span>(latitude, longitude, target_lat, target_lon) / <span class="number">1000</span> <span class="keyword">AS</span> distance
    <span class="keyword">FROM</span> weather_sensors
    <span class="keyword">WHERE</span> timestamp >= now() - <span class="keyword">INTERVAL</span> <span class="number">1</span> <span class="keyword">HOUR</span>
    <span class="keyword">ORDER BY</span> distance
    <span class="keyword">LIMIT</span> <span class="number">5</span>
);</pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 11: INTEGRATION
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="integration">
            <div class="section-header">
                <div class="section-number">Û±Û±</div>
                <h2 class="section-title">ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ</h2>
            </div>
            
            <div class="section-content">
                <h3>Ø§ØªØµØ§Ù„ Ø¨Ø§ Python</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ</span>
                            Python - clickhouse-driver
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment"># Ù†ØµØ¨</span>
<span class="comment"># pip install clickhouse-driver</span>

<span class="keyword">from</span> clickhouse_driver <span class="keyword">import</span> Client
<span class="keyword">import</span> h3

<span class="comment"># Ø§ØªØµØ§Ù„ Ø¨Ù‡ ClickHouse</span>
client = Client(
    host=<span class="string">'localhost'</span>,
    port=<span class="number">9000</span>,
    user=<span class="string">'default'</span>,
    password=<span class="string">''</span>,
    database=<span class="string">'default'</span>
)

<span class="comment"># Ú©ÙˆØ¦Ø±ÛŒ Ø³Ø§Ø¯Ù‡</span>
result = client.execute(<span class="string">'SELECT version()'</span>)
<span class="keyword">print</span>(f<span class="string">"ClickHouse version: {result[0][0]}"</span>)

<span class="comment"># Ø¯Ø±Ø¬ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ</span>
<span class="keyword">def</span> <span class="function">insert_location</span>(lat, lon, name):
    h3_index = h3.geo_to_h3(lat, lon, <span class="number">9</span>)
    client.execute(
        <span class="string">'''
        INSERT INTO locations (name, latitude, longitude, h3_9, timestamp)
        VALUES
        '''</span>,
        [(name, lat, lon, h3_index, <span class="string">'now()'</span>)]
    )

<span class="comment"># Ú©ÙˆØ¦Ø±ÛŒ Ù†Ù‚Ø§Ø· Ø¯Ø± Ø´Ø¹Ø§Ø¹</span>
<span class="keyword">def</span> <span class="function">find_nearby</span>(lat, lon, radius_km):
    center_h3 = h3.geo_to_h3(lat, lon, <span class="number">9</span>)
    <span class="comment"># Ù…Ø­Ø§Ø³Ø¨Ù‡ ØªØ¹Ø¯Ø§Ø¯ Ø­Ù„Ù‚Ù‡â€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø´Ø¹Ø§Ø¹</span>
    rings = <span class="function">int</span>(radius_km / <span class="number">0.5</span>) + <span class="number">1</span>
    
    nearby_cells = [center_h3]
    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="function">range</span>(<span class="number">1</span>, rings + <span class="number">1</span>):
        nearby_cells.extend(h3.k_ring(center_h3, k))
    
    query = <span class="string">f'''
        SELECT name, latitude, longitude,
               greatCircleDistance(latitude, longitude, {lat}, {lon}) AS distance
        FROM locations
        WHERE h3_9 IN ({','.join(map(str, nearby_cells))})
          AND greatCircleDistance(latitude, longitude, {lat}, {lon}) <= {radius_km * 1000}
        ORDER BY distance
    '''</span>
    
    <span class="keyword">return</span> client.execute(query)

<span class="comment"># Ø§Ø³ØªÙØ§Ø¯Ù‡</span>
nearby = find_nearby(<span class="number">35.6892</span>, <span class="number">51.3890</span>, <span class="number">5</span>)
<span class="keyword">for</span> row <span class="keyword">in</span> nearby:
    <span class="keyword">print</span>(f<span class="string">"{row[0]}: {row[3]:.0f}m"</span>)</pre>
                    </div>
                </div>

                <h3>Ø§ØªØµØ§Ù„ Ø¨Ø§ pandas</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ¼</span>
                            Python - pandas Integration
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">from</span> clickhouse_driver <span class="keyword">import</span> Client

client = Client(<span class="string">'localhost'</span>)

<span class="comment"># Ø®ÙˆØ§Ù†Ø¯Ù† Ø¯Ø§Ø¯Ù‡ Ø¨Ù‡ DataFrame</span>
query = <span class="string">'''
    SELECT 
        h3ToParent(h3_9, 7) AS h3_7,
        count() AS point_count,
        avg(speed) AS avg_speed
    FROM gps_data
    WHERE timestamp >= today()
    GROUP BY h3_7
'''</span>

<span class="comment"># Ø±ÙˆØ´ Û±: Ø¨Ø§ execute Ùˆ ØªØ¨Ø¯ÛŒÙ„ Ø¯Ø³ØªÛŒ</span>
result = client.execute(query, with_column_types=<span class="keyword">True</span>)
df = pd.DataFrame(result[<span class="number">0</span>], columns=[col[<span class="number">0</span>] <span class="keyword">for</span> col <span class="keyword">in</span> result[<span class="number">1</span>]])

<span class="comment"># Ø±ÙˆØ´ Û²: Ø¨Ø§ query_dataframe (Ù†ÛŒØ§Ø² Ø¨Ù‡ pandahouse)</span>
<span class="comment"># pip install pandahouse</span>
<span class="keyword">from</span> pandahouse <span class="keyword">import</span> read_clickhouse

connection = {
    <span class="string">'host'</span>: <span class="string">'http://localhost:8123'</span>,
    <span class="string">'database'</span>: <span class="string">'default'</span>
}
df = read_clickhouse(query, connection=connection)

<span class="comment"># Ù†ÙˆØ´ØªÙ† DataFrame Ø¨Ù‡ ClickHouse</span>
<span class="keyword">from</span> pandahouse <span class="keyword">import</span> to_clickhouse

df_to_insert = pd.DataFrame({
    <span class="string">'latitude'</span>: [<span class="number">35.6</span>, <span class="number">35.7</span>, <span class="number">35.8</span>],
    <span class="string">'longitude'</span>: [<span class="number">51.3</span>, <span class="number">51.4</span>, <span class="number">51.5</span>],
    <span class="string">'value'</span>: [<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>]
})

to_clickhouse(df_to_insert, <span class="string">'my_table'</span>, connection=connection, index=<span class="keyword">False</span>)</pre>
                    </div>
                </div>

                <h3>ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Grafana</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“Š</span>
                            SQL - Grafana Queries
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ú©ÙˆØ¦Ø±ÛŒ Ø¨Ø±Ø§ÛŒ Time Series Panel</span>
<span class="keyword">SELECT</span>
    <span class="variable">$__timeInterval</span>(timestamp) <span class="keyword">AS</span> time,
    <span class="function">count</span>() <span class="keyword">AS</span> events,
    <span class="function">avg</span>(speed) <span class="keyword">AS</span> avg_speed
<span class="keyword">FROM</span> gps_data
<span class="keyword">WHERE</span> timestamp <span class="keyword">BETWEEN</span> <span class="variable">$__fromTime</span> <span class="keyword">AND</span> <span class="variable">$__toTime</span>
<span class="keyword">GROUP BY</span> time
<span class="keyword">ORDER BY</span> time;

<span class="comment">-- Ú©ÙˆØ¦Ø±ÛŒ Ø¨Ø±Ø§ÛŒ Geomap Panel</span>
<span class="keyword">SELECT</span>
    <span class="function">h3ToGeo</span>(h3_9).<span class="number">2</span> <span class="keyword">AS</span> latitude,
    <span class="function">h3ToGeo</span>(h3_9).<span class="number">1</span> <span class="keyword">AS</span> longitude,
    <span class="function">count</span>() <span class="keyword">AS</span> metric
<span class="keyword">FROM</span> gps_data
<span class="keyword">WHERE</span> timestamp <span class="keyword">BETWEEN</span> <span class="variable">$__fromTime</span> <span class="keyword">AND</span> <span class="variable">$__toTime</span>
<span class="keyword">GROUP BY</span> h3_9
<span class="keyword">ORDER BY</span> metric <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">1000</span>;

<span class="comment">-- Ú©ÙˆØ¦Ø±ÛŒ Ø¨Ø±Ø§ÛŒ Table Panel Ø¨Ø§ ÙÛŒÙ„ØªØ± Ù…Ù†Ø·Ù‚Ù‡</span>
<span class="keyword">SELECT</span>
    vehicle_id,
    <span class="function">max</span>(timestamp) <span class="keyword">AS</span> last_seen,
    <span class="function">argMax</span>(speed, timestamp) <span class="keyword">AS</span> current_speed,
    <span class="function">argMax</span>(latitude, timestamp) <span class="keyword">AS</span> lat,
    <span class="function">argMax</span>(longitude, timestamp) <span class="keyword">AS</span> lon
<span class="keyword">FROM</span> gps_data
<span class="keyword">WHERE</span> timestamp >= now() - <span class="keyword">INTERVAL</span> <span class="number">1</span> <span class="keyword">HOUR</span>
    <span class="keyword">AND</span> h3_9 <span class="keyword">IN</span> (<span class="variable">$h3_cells</span>)  <span class="comment">-- Ù…ØªØºÛŒØ± Grafana</span>
<span class="keyword">GROUP BY</span> vehicle_id
<span class="keyword">ORDER BY</span> last_seen <span class="keyword">DESC</span>;</pre>
                    </div>
                </div>

                <h3>Export Ø¨Ù‡ GeoJSON</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ—ºï¸</span>
                            Python - GeoJSON Export
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="keyword">import</span> json
<span class="keyword">from</span> clickhouse_driver <span class="keyword">import</span> Client
<span class="keyword">import</span> h3

client = Client(<span class="string">'localhost'</span>)

<span class="keyword">def</span> <span class="function">export_h3_heatmap_geojson</span>(query):
    <span class="string">"""ØªØ¨Ø¯ÛŒÙ„ Ù†ØªØ§ÛŒØ¬ Ú©ÙˆØ¦Ø±ÛŒ H3 Ø¨Ù‡ GeoJSON Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ù†Ù‚Ø´Ù‡"""</span>
    
    result = client.execute(query)
    
    features = []
    <span class="keyword">for</span> row <span class="keyword">in</span> result:
        h3_index, value = row[<span class="number">0</span>], row[<span class="number">1</span>]
        
        <span class="comment"># Ø¯Ø±ÛŒØ§ÙØª Ù…Ø±Ø² Ø´Ø´â€ŒØ¶Ù„Ø¹ÛŒ</span>
        boundary = h3.h3_to_geo_boundary(h3_index, geo_json=<span class="keyword">True</span>)
        
        feature = {
            <span class="string">"type"</span>: <span class="string">"Feature"</span>,
            <span class="string">"geometry"</span>: {
                <span class="string">"type"</span>: <span class="string">"Polygon"</span>,
                <span class="string">"coordinates"</span>: [boundary]
            },
            <span class="string">"properties"</span>: {
                <span class="string">"h3"</span>: <span class="function">hex</span>(h3_index),
                <span class="string">"value"</span>: value
            }
        }
        features.append(feature)
    
    geojson = {
        <span class="string">"type"</span>: <span class="string">"FeatureCollection"</span>,
        <span class="string">"features"</span>: features
    }
    
    <span class="keyword">return</span> geojson

<span class="keyword">CREATE TABLE</span> good_design
(
    h3_index    <span class="type">UInt64</span>,
    timestamp   <span class="type">DateTime</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    data        <span class="type">String</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (h3_index, timestamp);  <span class="comment">-- Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø³Ø±ÛŒØ¹</span>

<span class="comment">-- âœ… Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø²Ù…Ø§Ù†ÛŒ-Ù…Ú©Ø§Ù†ÛŒ</span>
<span class="keyword">CREATE TABLE</span> time_space_optimized
(
    date        <span class="type">Date</span>,
    h3_index    <span class="type">UInt64</span>,
    timestamp   <span class="type">DateTime</span>,
    ...
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">PARTITION BY</span> toYYYYMM(date)
<span class="keyword">ORDER BY</span> (h3_index, timestamp);</pre>
                    </div>
                </div>

                <h3>Û². Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Materialized Views</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“Š</span>
                            SQL - Materialized Views
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ø¬Ø¯ÙˆÙ„ Ø®Ø§Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ GPS</span>
<span class="keyword">CREATE TABLE</span> gps_raw
(
    device_id   <span class="type">UInt32</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    speed       <span class="type">Float32</span>,
    timestamp   <span class="type">DateTime</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (device_id, timestamp);

<span class="comment">-- Ø¬Ø¯ÙˆÙ„ ØªØ¬Ù…ÛŒØ¹ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ ØªØ±Ø§Ú©Ù…</span>
<span class="keyword">CREATE TABLE</span> gps_density_hourly
(
    hour        <span class="type">DateTime</span>,
    h3_9        <span class="type">UInt64</span>,
    point_count <span class="type">UInt64</span>,
    unique_devices <span class="type">UInt32</span>,
    avg_speed   <span class="type">Float32</span>
)
<span class="keyword">ENGINE</span> = SummingMergeTree()
<span class="keyword">ORDER BY</span> (hour, h3_9);

<span class="comment">-- Materialized View Ø¨Ø±Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹ Ø®ÙˆØ¯Ú©Ø§Ø±</span>
<span class="keyword">CREATE MATERIALIZED VIEW</span> gps_density_mv
<span class="keyword">TO</span> gps_density_hourly
<span class="keyword">AS SELECT</span>
    <span class="function">toStartOfHour</span>(timestamp) <span class="keyword">AS</span> hour,
    <span class="function">geoToH3</span>(latitude, longitude, <span class="number">9</span>) <span class="keyword">AS</span> h3_9,
    <span class="function">count</span>() <span class="keyword">AS</span> point_count,
    <span class="function">uniqExact</span>(device_id) <span class="keyword">AS</span> unique_devices,
    <span class="function">avg</span>(speed) <span class="keyword">AS</span> avg_speed
<span class="keyword">FROM</span> gps_raw
<span class="keyword">GROUP BY</span> hour, h3_9;

<span class="comment">-- Ø­Ø§Ù„Ø§ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ ØªØ±Ø§Ú©Ù… ÙÙˆÙ‚â€ŒØ§Ù„Ø¹Ø§Ø¯Ù‡ Ø³Ø±ÛŒØ¹ Ù‡Ø³ØªÙ†Ø¯!</span>
<span class="keyword">SELECT</span>
    h3_9,
    <span class="function">sum</span>(point_count) <span class="keyword">AS</span> total_points,
    <span class="function">max</span>(unique_devices) <span class="keyword">AS</span> max_devices
<span class="keyword">FROM</span> gps_density_hourly
<span class="keyword">WHERE</span> hour >= now() - <span class="function">toIntervalDay</span>(<span class="number">7</span>)
<span class="keyword">GROUP BY</span> h3_9
<span class="keyword">ORDER BY</span> total_points <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">100</span>;</pre>
                    </div>
                </div>

                <h3>Û³. Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“</span>
                            SQL - Partitioning
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø§Ù‡</span>
<span class="keyword">CREATE TABLE</span> geo_events
(
    event_date  <span class="type">Date</span>,
    event_time  <span class="type">DateTime</span>,
    h3_index    <span class="type">UInt64</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    event_type  <span class="type">LowCardinality</span>(<span class="type">String</span>),
    payload     <span class="type">String</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">PARTITION BY</span> toYYYYMM(event_date)
<span class="keyword">ORDER BY</span> (h3_index, event_time)
<span class="keyword">TTL</span> event_date + <span class="function">toIntervalMonth</span>(<span class="number">12</span>)  <span class="comment">-- Ø­Ø°Ù Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ø¹Ø¯ Ø§Ø² 12 Ù…Ø§Ù‡</span>
<span class="keyword">SETTINGS</span> index_granularity = <span class="number">8192</span>;

<span class="comment">-- Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ ØªØ±Ú©ÛŒØ¨ÛŒ (Ù…Ù†Ø·Ù‚Ù‡ + Ø²Ù…Ø§Ù†)</span>
<span class="keyword">CREATE TABLE</span> geo_events_regional
(
    region_id   <span class="type">UInt8</span>,  <span class="comment">-- Ú©Ø¯ Ù…Ù†Ø·Ù‚Ù‡ (1-255)</span>
    event_date  <span class="type">Date</span>,
    h3_index    <span class="type">UInt64</span>,
    ...
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">PARTITION BY</span> (region_id, toYYYYMM(event_date))
<span class="keyword">ORDER BY</span> (h3_index, event_date);</pre>
                    </div>
                </div>

                <h3>Û´. ÙÛŒÙ„ØªØ± Ø¯Ùˆ Ù…Ø±Ø­Ù„Ù‡â€ŒØ§ÛŒ</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ”</span>
                            SQL - Two-Stage Filter
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- âŒ Ú©Ù†Ø¯: ÙÙ‚Ø· ÙØ§ØµÙ„Ù‡ Ø¯Ù‚ÛŒÙ‚</span>
<span class="keyword">SELECT</span> *
<span class="keyword">FROM</span> locations
<span class="keyword">WHERE</span> <span class="function">greatCircleDistance</span>(lat, lon, <span class="number">35.6892</span>, <span class="number">51.3890</span>) < <span class="number">5000</span>;

<span class="comment">-- âœ… Ø³Ø±ÛŒØ¹: ÙÛŒÙ„ØªØ± H3 + ÙØ§ØµÙ„Ù‡ Ø¯Ù‚ÛŒÙ‚</span>
<span class="keyword">WITH</span>
    <span class="number">35.6892</span> <span class="keyword">AS</span> center_lat,
    <span class="number">51.3890</span> <span class="keyword">AS</span> center_lon,
    <span class="number">5000</span> <span class="keyword">AS</span> radius_m,
    <span class="function">geoToH3</span>(center_lat, center_lon, <span class="number">9</span>) <span class="keyword">AS</span> center_h3
<span class="keyword">SELECT</span> *
<span class="keyword">FROM</span> locations
<span class="keyword">WHERE</span> 
    <span class="comment">-- Ù…Ø±Ø­Ù„Ù‡ Û±: ÙÛŒÙ„ØªØ± Ø³Ø±ÛŒØ¹ Ø¨Ø§ H3 (Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ†Ø¯Ú©Ø³)</span>
    h3_index <span class="keyword">IN</span> (
        <span class="keyword">SELECT</span> <span class="function">arrayJoin</span>(
            <span class="function">arrayConcat</span>(
                [center_h3],
                <span class="function">h3kRing</span>(center_h3, <span class="number">1</span>),
                <span class="function">h3kRing</span>(center_h3, <span class="number">2</span>),
                <span class="function">h3kRing</span>(center_h3, <span class="number">3</span>)
            )
        )
    )
    <span class="comment">-- Ù…Ø±Ø­Ù„Ù‡ Û²: ÙÛŒÙ„ØªØ± Ø¯Ù‚ÛŒÙ‚ Ø¨Ø§ ÙØ§ØµÙ„Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ</span>
    <span class="keyword">AND</span> <span class="function">greatCircleDistance</span>(lat, lon, center_lat, center_lon) < radius_m;</pre>
                    </div>
                </div>

                <h3>Ûµ. Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Projection</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“</span>
                            SQL - Projections
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ø¬Ø¯ÙˆÙ„ Ø¨Ø§ Projection Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù</span>
<span class="keyword">CREATE TABLE</span> geo_events_with_projections
(
    event_id    <span class="type">UInt64</span>,
    h3_9        <span class="type">UInt64</span>,
    h3_7        <span class="type">UInt64</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    event_type  <span class="type">LowCardinality</span>(<span class="type">String</span>),
    timestamp   <span class="type">DateTime</span>,
    
    <span class="comment">-- Projection Ø¨Ø±Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†ÙˆØ¹ Ø±ÙˆÛŒØ¯Ø§Ø¯</span>
    <span class="keyword">PROJECTION</span> by_event_type (
        <span class="keyword">SELECT</span>
            event_type,
            h3_7,
            <span class="function">count</span>() <span class="keyword">AS</span> cnt
        <span class="keyword">GROUP BY</span> event_type, h3_7
    ),
    
    <span class="comment">-- Projection Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ø²Ù…Ø§Ù†ÛŒ</span>
    <span class="keyword">PROJECTION</span> by_hour (
        <span class="keyword">SELECT</span>
            <span class="function">toStartOfHour</span>(timestamp) <span class="keyword">AS</span> hour,
            h3_9,
            <span class="function">count</span>() <span class="keyword">AS</span> cnt
        <span class="keyword">GROUP BY</span> hour, h3_9
    )
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (h3_9, timestamp);

<span class="comment">-- Ú©ÙˆØ¦Ø±ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø² Projection Ù…Ù†Ø§Ø³Ø¨ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯</span>
<span class="keyword">SELECT</span> event_type, h3_7, <span class="function">count</span>()
<span class="keyword">FROM</span> geo_events_with_projections
<span class="keyword">GROUP BY</span> event_type, h3_7;</pre>
                    </div>
                </div>

                <h3>Ø®Ù„Ø§ØµÙ‡ ØªÚ©Ù†ÛŒÚ©â€ŒÙ‡Ø§ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ</h3>

                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>ØªÚ©Ù†ÛŒÚ©</th>
                                <th>Ú©Ø§Ø±Ø¨Ø±Ø¯</th>
                                <th>ØªØ£Ø«ÛŒØ±</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>ORDER BY H3</strong></td>
                                <td>Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ</td>
                                <td>Û±Û°x-Û±Û°Û°x Ø³Ø±ÛŒØ¹â€ŒØªØ±</td>
                            </tr>
                            <tr>
                                <td><strong>Materialized Views</strong></td>
                                <td>ØªØ¬Ù…ÛŒØ¹â€ŒÙ‡Ø§ÛŒ ØªÚ©Ø±Ø§Ø±ÛŒ</td>
                                <td>Û±Û°Û°x-Û±Û°Û°Û°x Ø³Ø±ÛŒØ¹â€ŒØªØ±</td>
                            </tr>
                            <tr>
                                <td><strong>Partitioning</strong></td>
                                <td>ÙÛŒÙ„ØªØ± Ø²Ù…Ø§Ù†ÛŒ/Ù…Ù†Ø·Ù‚Ù‡â€ŒØ§ÛŒ</td>
                                <td>Ú©Ø§Ù‡Ø´ Ø¯Ø§Ø¯Ù‡ Ø§Ø³Ú©Ù†â€ŒØ´Ø¯Ù‡</td>
                            </tr>
                            <tr>
                                <td><strong>Two-Stage Filter</strong></td>
                                <td>Ø¬Ø³ØªØ¬ÙˆÛŒ Ø´Ø¹Ø§Ø¹ÛŒ</td>
                                <td>Û±Û°x-ÛµÛ°x Ø³Ø±ÛŒØ¹â€ŒØªØ±</td>
                            </tr>
                            <tr>
                                <td><strong>Projections</strong></td>
                                <td>Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…ØªÙ†ÙˆØ¹</td>
                                <td>Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±</td>
                            </tr>
                            <tr>
                                <td><strong>LowCardinality</strong></td>
                                <td>Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ú©Ù…â€ŒØªÙ†ÙˆØ¹</td>
                                <td>Ú©Ø§Ù‡Ø´ Ø­Ø§ÙØ¸Ù‡ Ùˆ Ø³Ø±Ø¹Øª</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="box box-warning">
                    <div class="box-title">
                        <span>âš ï¸</span>
                        Ù†Ú©Ø§Øª Ù…Ù‡Ù… Ø¹Ù…Ù„Ú©Ø±Ø¯
                    </div>
                    <ul>
                        <li>Ù‡Ù…ÛŒØ´Ù‡ <span class="inline-code">EXPLAIN</span> Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒ Ù¾Ù„Ù† Ú©ÙˆØ¦Ø±ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                        <li>Ø§Ø² <span class="inline-code">LIMIT</span> Ø¯Ø± Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ ØªØ³Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                        <li>Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ ØºÛŒØ±Ø¶Ø±ÙˆØ±ÛŒ Ø±Ø§ <span class="inline-code">SELECT</span> Ù†Ú©Ù†ÛŒØ¯</li>
                        <li>Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ØªÙ†ÛŒ ØªÚ©Ø±Ø§Ø±ÛŒ Ø§Ø² <span class="inline-code">LowCardinality</span> Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 10: REAL WORLD PROJECTS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="real-world">
            <div class="section-header">
                <div class="section-number">Û±Û°</div>
                <h2 class="section-title">Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒ</h2>
            </div>
            
            <div class="section-content">
                <h3>Ù¾Ø±ÙˆÚ˜Ù‡ Û±: Ø³ÛŒØ³ØªÙ… Ø±Ø¯ÛŒØ§Ø¨ÛŒ Ù†Ø§ÙˆÚ¯Ø§Ù†</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸš—</span>
                            SQL - Fleet Tracking System
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Û±. Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ Ø§ØµÙ„ÛŒ</span>
<span class="keyword">CREATE TABLE</span> fleet_tracking
(
    vehicle_id      <span class="type">UInt32</span>,
    driver_id       <span class="type">UInt32</span>,
    latitude        <span class="type">Float64</span>,
    longitude       <span class="type">Float64</span>,
    h3_9            <span class="type">UInt64</span>,
    speed           <span class="type">Float32</span>,
    heading         <span class="type">UInt16</span>,
    fuel_level      <span class="type">UInt8</span>,
    engine_status   <span class="type">Enum8</span>(<span class="string">'off'</span>=<span class="number">0</span>, <span class="string">'idle'</span>=<span class="number">1</span>, <span class="string">'running'</span>=<span class="number">2</span>),
    timestamp       <span class="type">DateTime64</span>(<span class="number">3</span>),
    event_date      <span class="type">Date</span> <span class="keyword">DEFAULT</span> <span class="function">toDate</span>(timestamp)
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">PARTITION BY</span> toYYYYMM(event_date)
<span class="keyword">ORDER BY</span> (vehicle_id, timestamp)
<span class="keyword">TTL</span> event_date + <span class="function">toIntervalMonth</span>(<span class="number">6</span>);

<span class="comment">-- Û². Ø¬Ø¯ÙˆÙ„ ØªØ¬Ù…ÛŒØ¹ÛŒ Ø¨Ø±Ø§ÛŒ Ø¢Ù…Ø§Ø± Ø±ÙˆØ²Ø§Ù†Ù‡</span>
<span class="keyword">CREATE TABLE</span> fleet_daily_stats
(
    date            <span class="type">Date</span>,
    vehicle_id      <span class="type">UInt32</span>,
    total_distance  <span class="type">Float64</span>,
    max_speed       <span class="type">Float32</span>,
    avg_speed       <span class="type">Float32</span>,
    total_idle_time <span class="type">UInt32</span>,
    fuel_consumed   <span class="type">Float32</span>,
    unique_h3_cells <span class="type">UInt32</span>
)
<span class="keyword">ENGINE</span> = SummingMergeTree()
<span class="keyword">ORDER BY</span> (date, vehicle_id);

<span class="comment">-- Û³. Materialized View Ø¨Ø±Ø§ÛŒ Ø¢Ù…Ø§Ø±</span>
<span class="keyword">CREATE MATERIALIZED VIEW</span> fleet_daily_stats_mv
<span class="keyword">TO</span> fleet_daily_stats
<span class="keyword">AS SELECT</span>
    <span class="function">toDate</span>(timestamp) <span class="keyword">AS</span> date,
    vehicle_id,
    <span class="function">sum</span>(speed * <span class="number">0.001</span>) <span class="keyword">AS</span> total_distance,  <span class="comment">-- ØªÙ‚Ø±ÛŒØ¨ÛŒ</span>
    <span class="function">max</span>(speed) <span class="keyword">AS</span> max_speed,
    <span class="function">avg</span>(speed) <span class="keyword">AS</span> avg_speed,
    <span class="function">countIf</span>(engine_status = <span class="string">'idle'</span>) <span class="keyword">AS</span> total_idle_time,
    <span class="function">max</span>(fuel_level) - <span class="function">min</span>(fuel_level) <span class="keyword">AS</span> fuel_consumed,
    <span class="function">uniqExact</span>(h3_9) <span class="keyword">AS</span> unique_h3_cells
<span class="keyword">FROM</span> fleet_tracking
<span class="keyword">GROUP BY</span> date, vehicle_id;

<span class="comment">-- Û´. Ú©ÙˆØ¦Ø±ÛŒ: Ø¢Ø®Ø±ÛŒÙ† Ù…ÙˆÙ‚Ø¹ÛŒØª Ù‡Ø± Ø®ÙˆØ¯Ø±Ùˆ</span>
<span class="keyword">SELECT</span>
    vehicle_id,
    <span class="function">argMax</span>(latitude, timestamp) <span class="keyword">AS</span> last_lat,
    <span class="function">argMax</span>(longitude, timestamp) <span class="keyword">AS</span> last_lon,
    <span class="function">argMax</span>(speed, timestamp) <span class="keyword">AS</span> current_speed,
    <span class="function">max</span>(timestamp) <span class="keyword">AS</span> last_update
<span class="keyword">FROM</span> fleet_tracking
<span class="keyword">WHERE</span> timestamp >= now() - <span class="function">toIntervalHour</span>(<span class="number">1</span>)
<span class="keyword">GROUP BY</span> vehicle_id;

<span class="comment">-- Ûµ. Ú©ÙˆØ¦Ø±ÛŒ: Ø®ÙˆØ¯Ø±ÙˆÙ‡Ø§ÛŒ Ø¯Ø± ÛŒÚ© Ù…Ù†Ø·Ù‚Ù‡</span>
<span class="keyword">WITH</span> <span class="function">geoToH3</span>(<span class="number">35.6892</span>, <span class="number">51.3890</span>, <span class="number">9</span>) <span class="keyword">AS</span> center_h3
<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> vehicle_id
<span class="keyword">FROM</span> fleet_tracking
<span class="keyword">WHERE</span> 
    timestamp >= now() - <span class="function">toIntervalMinute</span>(<span class="number">5</span>)
    <span class="keyword">AND</span> h3_9 <span class="keyword">IN</span> (
        <span class="keyword">SELECT</span> <span class="function">arrayJoin</span>(<span class="function">h3kRing</span>(center_h3, <span class="number">2</span>))
    );</pre>
                    </div>
                </div>

                <h3>Ù¾Ø±ÙˆÚ˜Ù‡ Û²: Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ”¥</span>
                            SQL - Heatmap System
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Û±. Ø¬Ø¯ÙˆÙ„ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§</span>
<span class="keyword">CREATE TABLE</span> app_events
(
    user_id         <span class="type">UInt64</span>,
    event_type      <span class="type">LowCardinality</span>(<span class="type">String</span>),
    latitude        <span class="type">Float64</span>,
    longitude       <span class="type">Float64</span>,
    h3_7            <span class="type">UInt64</span>,
    h3_9            <span class="type">UInt64</span>,
    timestamp       <span class="type">DateTime</span>,
    properties      <span class="type">String</span>  <span class="comment">-- JSON</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">PARTITION BY</span> toYYYYMMDD(timestamp)
<span class="keyword">ORDER BY</span> (h3_9, timestamp);

<span class="comment">-- Û². ØªÙˆÙ„ÛŒØ¯ Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ Ø¨Ø§ H3 Ø±Ø²ÙˆÙ„ÙˆØ´Ù† Û·</span>
<span class="keyword">SELECT</span>
    h3_7,
    <span class="function">h3ToGeo</span>(h3_7).<span class="number">1</span> <span class="keyword">AS</span> center_lon,
    <span class="function">h3ToGeo</span>(h3_7).<span class="number">2</span> <span class="keyword">AS</span> center_lat,
    <span class="function">count</span>() <span class="keyword">AS</span> event_count,
    <span class="function">uniqExact</span>(user_id) <span class="keyword">AS</span> unique_users,
    <span class="function">round</span>(<span class="function">count</span>() / <span class="function">uniqExact</span>(user_id), <span class="number">2</span>) <span class="keyword">AS</span> events_per_user
<span class="keyword">FROM</span> app_events
<span class="keyword">WHERE</span> 
    timestamp >= now() - <span class="function">toIntervalDay</span>(<span class="number">7</span>)
    <span class="keyword">AND</span> event_type = <span class="string">'purchase'</span>
<span class="keyword">GROUP BY</span> h3_7
<span class="keyword">HAVING</span> event_count >= <span class="number">10</span>
<span class="keyword">ORDER BY</span> event_count <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">1000</span>;

<span class="comment">-- Û³. Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ Ø¨Ø§ Ù…Ø±Ø² Ø³Ù„ÙˆÙ„â€ŒÙ‡Ø§ (Ø¨Ø±Ø§ÛŒ Ø±Ø³Ù…)</span>
<span class="keyword">SELECT</span>
    h3_7,
    <span class="function">h3ToGeoBoundary</span>(h3_7) <span class="keyword">AS</span> boundary,
    <span class="function">count</span>() <span class="keyword">AS</span> intensity
<span class="keyword">FROM</span> app_events
<span class="keyword">WHERE</span> timestamp >= now() - <span class="function">toIntervalDay</span>(<span class="number">1</span>)
<span class="keyword">GROUP BY</span> h3_7
<span class="keyword">ORDER BY</span> intensity <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">500</span>;

<span class="comment">-- Û´. Ù…Ù‚Ø§ÛŒØ³Ù‡ Ù…Ù†Ø§Ø·Ù‚ Ø¯Ø± Ø¯Ùˆ Ø¨Ø§Ø²Ù‡ Ø²Ù…Ø§Ù†ÛŒ</span>
<span class="keyword">SELECT</span>
    h3_7,
    <span class="function">countIf</span>(timestamp >= now() - <span class="function">toIntervalDay</span>(<span class="number">7</span>)) <span class="keyword">AS</span> this_week,
    <span class="function">countIf</span>(timestamp < now() - <span class="function">toIntervalDay</span>(<span class="number">7</span>) 
        <span class="keyword">AND</span> timestamp >= now() - <span class="function">toIntervalDay</span>(<span class="number">14</span>)) <span class="keyword">AS</span> last_week,
    <span class="function">round</span>((this_week - last_week) / last_week * <span class="number">100</span>, <span class="number">2</span>) <span class="keyword">AS</span> growth_percent
<span class="keyword">FROM</span> app_events
<span class="keyword">WHERE</span> timestamp >= now() - <span class="function">toIntervalDay</span>(<span class="number">14</span>)
<span class="keyword">GROUP BY</span> h3_7
<span class="keyword">HAVING</span> last_week > <span class="number">0</span>
<span class="keyword">ORDER BY</span> growth_percent <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">50</span>;</pre>
                    </div>
                </div>

                <h3>Ù¾Ø±ÙˆÚ˜Ù‡ Û³: ØªØ­Ù„ÛŒÙ„ Ø³ÙØ± (Trip Analysis)</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ›£ï¸</span>
                            SQL - Trip Analysis
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Û±. Ø¬Ø¯ÙˆÙ„ Ø³ÙØ±Ù‡Ø§</span>
<span class="keyword">CREATE TABLE</span> trips
(
    trip_id         <span class="type">UInt64</span>,
    user_id         <span class="type">UInt64</span>,
    start_lat       <span class="type">Float64</span>,
    start_lon       <span class="type">Float64</span>,
    end_lat         <span class="type">Float64</span>,
    end_lon         <span class="type">Float64</span>,
    start_h3        <span class="type">UInt64</span>,
    end_h3          <span class="type">UInt64</span>,
    start_time      <span class="type">DateTime</span>,
    end_time        <span class="type">DateTime</span>,
    distance_m      <span class="type">Float32</span>,
    duration_s      <span class="type">UInt32</span>,
    fare            <span class="type">Decimal</span>(<span class="number">10</span>, <span class="number">2</span>)
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">PARTITION BY</span> toYYYYMM(start_time)
<span class="keyword">ORDER BY</span> (start_h3, start_time);

<span class="comment">-- Û². Ù…Ø­Ø¨ÙˆØ¨â€ŒØªØ±ÛŒÙ† Ù…Ø³ÛŒØ±Ù‡Ø§ (Ù…Ø¨Ø¯Ø£-Ù…Ù‚ØµØ¯)</span>
<span class="keyword">SELECT</span>
    <span class="function">h3ToParent</span>(start_h3, <span class="number">7</span>) <span class="keyword">AS</span> origin_h3_7,
    <span class="function">h3ToParent</span>(end_h3, <span class="number">7</span>) <span class="keyword">AS</span> dest_h3_7,
    <span class="function">count</span>() <span class="keyword">AS</span> trip_count,
    <span class="function">avg</span>(distance_m) <span class="keyword">AS</span> avg_distance,
    <span class="function">avg</span>(duration_s) / <span class="number">60</span> <span class="keyword">AS</span> avg_duration_min,
    <span class="function">avg</span>(fare) <span class="keyword">AS</span> avg_fare
<span class="keyword">FROM</span> trips
<span class="keyword">WHERE</span> start_time >= now() - <span class="function">toIntervalDay</span>(<span class="number">30</span>)
<span class="keyword">GROUP BY</span> origin_h3_7, dest_h3_7
<span class="keyword">ORDER BY</span> trip_count <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">100</span>;

<span class="comment">-- Û³. ØªØ­Ù„ÛŒÙ„ Ø³Ø§Ø¹Ø§Øª Ø§ÙˆØ¬</span>
<span class="keyword">SELECT</span>
    <span class="function">toHour</span>(start_time) <span class="keyword">AS</span> hour,
    <span class="function">toDayOfWeek</span>(start_time) <span class="keyword">AS</span> day_of_week,
    <span class="function">count</span>() <span class="keyword">AS</span> trips,
    <span class="function">avg</span>(duration_s) / <span class="number">60</span> <span class="keyword">AS</span> avg_duration_min
<span class="keyword">FROM</span> trips
<span class="keyword">WHERE</span> start_time >= now() - <span class="function">toIntervalDay</span>(<span class="number">30</span>)
<span class="keyword">GROUP BY</span> hour, day_of_week
<span class="keyword">ORDER BY</span> day_of_week, hour;

<span class="comment">-- Û´. Ù…Ù†Ø§Ø·Ù‚ Ø¨Ø§ Ø¨ÛŒØ´ØªØ±ÛŒÙ† ØªÙ‚Ø§Ø¶Ø§ Ø¯Ø± Ø³Ø§Ø¹Øª Ø§ÙˆØ¬</span>
<span class="keyword">SELECT</span>
    <span class="function">h3ToParent</span>(start_h3, <span class="number">8</span>) <span class="keyword">AS</span> area_h3,
    <span class="function">h3ToGeo</span>(<span class="function">h3ToParent</span>(start_h3, <span class="number">8</span>)).<span class="number">1</span> <span class="keyword">AS</span> center_lon,
    <span class="function">h3ToGeo</span>(<span class="function">h3ToParent</span>(start_h3, <span class="number">8</span>)).<span class="number">2</span> <span class="keyword">AS</span> center_lat,
    <span class="function">count</span>() <span class="keyword">AS</span> demand
<span class="keyword">FROM</span> trips
<span class="keyword">WHERE</span> 
    start_time >= now() - <span class="function">toIntervalDay</span>(<span class="number">7</span>)
    <span class="keyword">AND</span> <span class="function">toHour</span>(start_time) <span class="keyword">BETWEEN</span> <span class="number">7</span> <span class="keyword">AND</span> <span class="number">9</span>  <span class="comment">-- Ø³Ø§Ø¹Øª Ø§ÙˆØ¬ ØµØ¨Ø­</span>
<span class="keyword">GROUP BY</span> area_h3
<span class="keyword">ORDER BY</span> demand <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">50</span>;</pre>
                    </div>
                </div>

                <h3>Ù¾Ø±ÙˆÚ˜Ù‡ Û´: ØªØ­Ù„ÛŒÙ„ POI (Ù†Ù‚Ø§Ø· Ù…ÙˆØ±Ø¯ Ø¹Ù„Ø§Ù‚Ù‡)</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“</span>
                            SQL - POI Analysis
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Û±. Ø¬Ø¯ÙˆÙ„ POI</span>
<span class="keyword">CREATE TABLE</span> pois
(
    poi_id          <span class="type">UInt64</span>,
    name            <span class="type">String</span>,
    category        <span class="type">LowCardinality</span>(<span class="type">String</span>),
    latitude        <span class="type">Float64</span>,
    longitude       <span class="type">Float64</span>,
    h3_9            <span class="type">UInt64</span>,
    h3_11           <span class="type">UInt64</span>,
    rating          <span class="type">Float32</span>,
    review_count    <span class="type">UInt32</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (category, h3_9);

<span class="comment">-- Û². ÛŒØ§ÙØªÙ† Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ±ÛŒÙ† Ø±Ø³ØªÙˆØ±Ø§Ù†â€ŒÙ‡Ø§</span>
<span class="keyword">WITH</span>
    <span class="number">35.6892</span> <span class="keyword">AS</span> my_lat,
    <span class="number">51.3890</span> <span class="keyword">AS</span> my_lon,
    <span class="function">geoToH3</span>(my_lat, my_lon, <span class="number">9</span>) <span class="keyword">AS</span> my_h3
<span class="keyword">SELECT</span>
    name,
    category,
    rating,
    <span class="function">greatCircleDistance</span>(latitude, longitude, my_lat, my_lon) <span class="keyword">AS</span> distance_m
<span class="keyword">FROM</span> pois
<span class="keyword">WHERE</span>
    category = <span class="string">'restaurant'</span>
    <span class="keyword">AND</span> h3_9 <span class="keyword">IN</span> (
        <span class="keyword">SELECT</span> <span class="function">arrayJoin</span>(
            <span class="function">arrayConcat</span>([my_h3], <span class="function">h3kRing</span>(my_h3, <span class="number">1</span>), <span class="function">h3kRing</span>(my_h3, <span class="number">2</span>))
        )
    )
<span class="keyword">ORDER BY</span> distance_m
<span class="keyword">LIMIT</span> <span class="number">10</span>;

<span class="comment">-- Û³. ØªØ±Ø§Ú©Ù… POI Ø¯Ø± Ù‡Ø± Ù…Ù†Ø·Ù‚Ù‡</span>
<span class="keyword">SELECT</span>
    <span class="function">h3ToParent</span>(h3_9, <span class="number">7</span>) <span class="keyword">AS</span> area_h3,
    category,
    <span class="function">count</span>() <span class="keyword">AS</span> poi_count,
    <span class="function">avg</span>(rating) <span class="keyword">AS</span> avg_rating
<span class="keyword">FROM</span> pois
<span class="keyword">GROUP BY</span> area_h3, category
<span class="keyword">ORDER BY</span> poi_count <span class="keyword">DESC</span>;

<span class="comment">-- Û´. ÛŒØ§ÙØªÙ† Ù…Ù†Ø§Ø·Ù‚ Ø¨Ø§ Ú©Ù…Ø¨ÙˆØ¯ ÛŒÚ© Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</span>
<span class="keyword">SELECT</span>
    h3_7,
    <span class="function">countIf</span>(category = <span class="string">'pharmacy'</span>) <span class="keyword">AS</span> pharmacy_count,
    <span class="function">countIf</span>(category = <span class="string">'restaurant'</span>) <span class="keyword">AS</span> restaurant_count,
    <span class="function">count</span>() <span class="keyword">AS</span> total_pois
<span class="keyword">FROM</span> pois
<span class="keyword">GROUP BY</span> <span class="function">h3ToParent</span>(h3_9, <span class="number">7</span>) <span class="keyword">AS</span> h3_7
<span class="keyword">HAVING</span> total_pois > <span class="number">10</span> <span class="keyword">AND</span> pharmacy_count = <span class="number">0</span>
<span class="keyword">ORDER BY</span> total_pois <span class="keyword">DESC</span>;</pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 11: INTEGRATION
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="integration">
            <div class="section-header">
                <div class="section-number">Û±Û±</div>
                <h2 class="section-title">ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ</h2>
            </div>
            
            <div class="section-content">
                <h3>Ø§ØªØµØ§Ù„ Ø¨Ø§ Python</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ</span>
                            Python - clickhouse-driver
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment"># Ù†ØµØ¨</span>
<span class="comment"># pip install clickhouse-driver</span>

<span class="keyword">from</span> clickhouse_driver <span class="keyword">import</span> Client
<span class="keyword">import</span> h3

<span class="comment"># Ø§ØªØµØ§Ù„</span>
client = Client(
    host=<span class="string">'localhost'</span>,
    port=<span class="number">9000</span>,
    user=<span class="string">'default'</span>,
    password=<span class="string">''</span>,
    database=<span class="string">'default'</span>
)

<span class="comment"># Ø¯Ø±Ø¬ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ GPS</span>
<span class="keyword">def</span> <span class="function">insert_gps_data</span>(records):
    <span class="string">"""
    records: list of (device_id, lat, lon, speed, timestamp)
    """</span>
    data = []
    <span class="keyword">for</span> device_id, lat, lon, speed, ts <span class="keyword">in</span> records:
        h3_index = h3.geo_to_h3(lat, lon, <span class="number">9</span>)
        data.append((device_id, lat, lon, h3_index, speed, ts))
    
    client.execute(
        <span class="string">'''
        INSERT INTO gps_tracks 
        (device_id, latitude, longitude, h3_9, speed, timestamp)
        VALUES
        '''</span>,
        data
    )

<span class="comment"># Ú©ÙˆØ¦Ø±ÛŒ Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ</span>
<span class="keyword">def</span> <span class="function">get_heatmap</span>(center_lat, center_lon, radius_km, hours=<span class="number">24</span>):
    center_h3 = h3.geo_to_h3(center_lat, center_lon, <span class="number">7</span>)
    rings = h3.k_ring(center_h3, <span class="keyword">int</span>(radius_km / <span class="number">1.2</span>))  <span class="comment"># ØªÙ‚Ø±ÛŒØ¨</span>
    
    query = <span class="string">f'''
        SELECT
            h3ToParent(h3_9, 7) AS h3_7,
            h3ToGeo(h3ToParent(h3_9, 7)).1 AS lon,
            h3ToGeo(h3ToParent(h3_9, 7)).2 AS lat,
            count() AS intensity
        FROM gps_tracks
        WHERE 
            timestamp >= now() - toIntervalHour({hours})
            AND h3ToParent(h3_9, 7) IN {tuple(rings)}
        GROUP BY h3_7
        ORDER BY intensity DESC
    '''</span>
    
    <span class="keyword">return</span> client.execute(query)

<span class="comment"># Ø§Ø³ØªÙØ§Ø¯Ù‡</span>
heatmap = get_heatmap(<span class="number">35.6892</span>, <span class="number">51.3890</span>, radius_km=<span class="number">10</span>)
<span class="keyword">for</span> h3_id, lon, lat, intensity <span class="keyword">in</span> heatmap:
    <span class="keyword">print</span>(<span class="string">f"H3: {h3_id}, Center: ({lat}, {lon}), Intensity: {intensity}"</span>)</pre>
                    </div>
                </div>

                <h3>Ø§ØªØµØ§Ù„ Ø¨Ø§ FastAPI</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>âš¡</span>
                            Python - FastAPI + ClickHouse
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Query
<span class="keyword">from</span> clickhouse_driver <span class="keyword">import</span> Client
<span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel
<span class="keyword">from</span> typing <span class="keyword">import</span> List
<span class="keyword">import</span> h3

app = FastAPI(title=<span class="string">"GIS API with ClickHouse"</span>)
client = Client(host=<span class="string">'localhost'</span>)

<span class="keyword">class</span> <span class="type">HeatmapCell</span>(BaseModel):
    h3_index: <span class="type">str</span>
    lat: <span class="type">float</span>
    lon: <span class="type">float</span>
    intensity: <span class="type">int</span>
    boundary: List[List[<span class="type">float</span>]]

<span class="keyword">class</span> <span class="type">NearbyLocation</span>(BaseModel):
    id: <span class="type">int</span>
    name: <span class="type">str</span>
    lat: <span class="type">float</span>
    lon: <span class="type">float</span>
    distance_m: <span class="type">float</span>

<span class="variable">@app.get</span>(<span class="string">"/heatmap"</span>, response_model=List[HeatmapCell])
<span class="keyword">async def</span> <span class="function">get_heatmap</span>(
    lat: <span class="type">float</span> = Query(..., ge=-<span class="number">90</span>, le=<span class="number">90</span>),
    lon: <span class="type">float</span> = Query(..., ge=-<span class="number">180</span>, le=<span class="number">180</span>),
    radius_km: <span class="type">float</span> = Query(<span class="number">5</span>, ge=<span class="number">1</span>, le=<span class="number">50</span>),
    hours: <span class="type">int</span> = Query(<span class="number">24</span>, ge=<span class="number">1</span>, le=<span class="number">168</span>)
):
    center_h3 = h3.geo_to_h3(lat, lon, <span class="number">7</span>)
    k = <span class="keyword">int</span>(radius_km / <span class="number">1.2</span>) + <span class="number">1</span>
    rings = <span class="keyword">list</span>(h3.k_ring(center_h3, k))
    
    query = <span class="string">f'''
        SELECT
            h3ToParent(h3_9, 7) AS h3_7,
            h3ToGeo(h3ToParent(h3_9, 7)).2 AS lat,
            h3ToGeo(h3ToParent(h3_9, 7)).1 AS lon,
            count() AS intensity
        FROM gps_tracks
        WHERE 
            timestamp >= now() - toIntervalHour({hours})
            AND h3ToParent(h3_9, 7) IN ({",".join(map(str, rings))})
        GROUP BY h3_7
        ORDER BY intensity DESC
        LIMIT 500
    '''</span>
    
    results = client.execute(query)
    
    <span class="keyword">return</span> [
        HeatmapCell(
            h3_index=<span class="function">hex</span>(row[<span class="number">0</span>]),
            lat=row[<span class="number">1</span>],
            lon=row[<span class="number">2</span>],
            intensity=row[<span class="number">3</span>],
            boundary=h3.h3_to_geo_boundary(row[<span class="number">0</span>], geo_json=<span class="keyword">True</span>)
        )
        <span class="keyword">for</span> row <span class="keyword">in</span> results
    ]

<span class="variable">@app.get</span>(<span class="string">"/nearby"</span>, response_model=List[NearbyLocation])
<span class="keyword">async def</span> <span class="function">get_nearby</span>(
    lat: <span class="type">float</span> = Query(...),
    lon: <span class="type">float</span> = Query(...),
    radius_m: <span class="type">int</span> = Query(<span class="number">1000</span>, ge=<span class="number">100</span>, le=<span class="number">10000</span>),
    category: <span class="type">str</span> = Query(<span class="keyword">None</span>)
):
    center_h3 = h3.geo_to_h3(lat, lon, <span class="number">9</span>)
    k = <span class="keyword">int</span>(radius_m / <span class="number">150</span>) + <span class="number">1</span>  <span class="comment"># ØªÙ‚Ø±ÛŒØ¨ Ø¨Ø±Ø§ÛŒ res 9</span>
    rings = <span class="keyword">list</span>(h3.k_ring(center_h3, k))
    
    category_filter = <span class="string">f"AND category = '{category}'"</span> <span class="keyword">if</span> category <span class="keyword">else</span> <span class="string">""</span>
    
    query = <span class="string">f'''
        SELECT
            poi_id,
            name,
            latitude,
            longitude,
            greatCircleDistance(latitude, longitude, {lat}, {lon}) AS distance_m
        FROM pois
        WHERE 
            h3_9 IN ({",".join(map(str, rings))})
            {category_filter}
            AND greatCircleDistance(latitude, longitude, {lat}, {lon}) <= {radius_m}
        ORDER BY distance_m
        LIMIT 50
    '''</span>
    
    results = client.execute(query)
    
    <span class="keyword">return</span> [
        NearbyLocation(
            id=row[<span class="number">0</span>],
            name=row[<span class="number">1</span>],
            lat=row[<span class="number">2</span>],
            lon=row[<span class="number">3</span>],
            distance_m=row[<span class="number">4</span>]
        )
        <span class="keyword">for</span> row <span class="keyword">in</span> results
    ]</pre>
                    </div>
                </div>

                <h3>Ø§ØªØµØ§Ù„ Ø¨Ø§ Grafana</h3>

                <div class="box box-info">
                    <div class="box-title">
                        <span>ğŸ“Š</span>
                        Grafana + ClickHouse
                    </div>
                    <ol>
                        <li>Ù¾Ù„Ø§Ú¯ÛŒÙ† <strong>Altinity ClickHouse Datasource</strong> Ø±Ø§ Ù†ØµØ¨ Ú©Ù†ÛŒØ¯</li>
                        <li>Data Source Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§ØªØµØ§Ù„ ClickHouse Ø¨Ø³Ø§Ø²ÛŒØ¯</li>
                        <li>Ø§Ø² Ù¾Ù†Ù„ <strong>Geomap</strong> Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù†Ù‚Ø´Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                    </ol>
                    
                    <div class="code-block" style="margin-top: 15px;">
                        <div class="code-header">
                            <span class="code-lang">Grafana Query</span>
                            <div class="code-dots">
                                <span class="code-dot"></span>
                                <span class="code-dot"></span>
                                <span class="code-dot"></span>
                            </div>
                        </div>
                        <div class="code-body">
<pre><span class="keyword">SELECT</span>
    <span class="function">toUnixTimestamp</span>(timestamp) * <span class="number">1000</span> <span class="keyword">AS</span> time,
    <span class="function">h3ToGeo</span>(h3_9).<span class="number">2</span> <span class="keyword">AS</span> latitude,
    <span class="function">h3ToGeo</span>(h3_9).<span class="number">1</span> <span class="keyword">AS</span> longitude,
    <span class="function">count</span>() <span class="keyword">AS</span> value
<span class="keyword">FROM</span> gps_tracks
<span class="keyword">WHERE</span> timestamp >= <span class="variable">$__fromTime</span> <span class="keyword">AND</span> timestamp <= <span class="variable">$__toTime</span>
<span class="keyword">GROUP BY</span> time, h3_9
<span class="keyword">ORDER BY</span> time</pre>
                        </div>
                    </div>
                </div>

                <h3>Ø§ØªØµØ§Ù„ Ø¨Ø§ Apache Kafka</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“¨</span>
                            SQL - Kafka Integration
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Û±. Ø¬Ø¯ÙˆÙ„ Kafka Engine</span>
<span class="keyword">CREATE TABLE</span> gps_kafka
(
    device_id   <span class="type">UInt32</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    speed       <span class="type">Float32</span>,
    timestamp   <span class="type">DateTime</span>
)
<span class="keyword">ENGINE</span> = Kafka
<span class="keyword">SETTINGS</span>
    kafka_broker_list = <span class="string">'kafka:9092'</span>,
    kafka_topic_list = <span class="string">'gps-events'</span>,
    kafka_group_name = <span class="string">'clickhouse-consumer'</span>,
    kafka_format = <span class="string">'JSONEachRow'</span>;

<span class="comment">-- Û². Ø¬Ø¯ÙˆÙ„ Ù†Ù‡Ø§ÛŒÛŒ</span>
<span class="keyword">CREATE TABLE</span> gps_data
(
    device_id   <span class="type">UInt32</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    h3_9        <span class="type">UInt64</span>,
    speed       <span class="type">Float32</span>,
    timestamp   <span class="type">DateTime</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (h3_9, timestamp);

<span class="comment">-- Û³. Materialized View Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„ Ø®ÙˆØ¯Ú©Ø§Ø±</span>
<span class="keyword">CREATE MATERIALIZED VIEW</span> gps_consumer <span class="keyword">TO</span> gps_data
<span class="keyword">AS SELECT</span>
    device_id,
    latitude,
    longitude,
    <span class="function">geoToH3</span>(latitude, longitude, <span class="number">9</span>) <span class="keyword">AS</span> h3_9,
    speed,
    timestamp
<span class="keyword">FROM</span> gps_kafka;</pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 12: BEST PRACTICES
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="best-practices">
            <div class="section-header">
                <div class="section-number">Û±Û²</div>
                <h2 class="section-title">Ø¨Ù‡ØªØ±ÛŒÙ† Ø´ÛŒÙˆÙ‡â€ŒÙ‡Ø§</h2>
            </div>
            
            <div class="section-content">
                <h3>Ø·Ø±Ø§Ø­ÛŒ Ø¬Ø¯ÙˆÙ„</h3>

                <ul class="checklist" style="list-style: none; padding: 0;">
                    <li style="display: flex; gap: 15px; padding: 15px; background: var(--color-gray-50); border-radius: 8px; margin-bottom: 10px;">
                        <span style="color: var(--color-success);">âœ…</span>
                        <div>
                            <strong>Ù‡Ù…ÛŒØ´Ù‡ H3 Index Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯</strong>
                            <p style="margin: 5px 0 0; color: var(--color-gray-600);">
                                Ø­ØªÛŒ Ø§Ú¯Ø± lat/lon Ø¯Ø§Ø±ÛŒØ¯ØŒ H3 Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø³Ø±ÛŒØ¹ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯
                            </p>
                        </div>
                    </li>
                    <li style="display: flex; gap: 15px; padding: 15px; background: var(--color-gray-50); border-radius: 8px; margin-bottom: 10px;">
                        <span style="color: var(--color-success);">âœ…</span>
                        <div>
                            <strong>ORDER BY Ù…Ù†Ø§Ø³Ø¨ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</strong>
                            <p style="margin: 5px 0 0; color: var(--color-gray-600);">
                                Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù„Ú¯ÙˆÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§: (h3_index, timestamp) ÛŒØ§ (region, h3_index)
                            </p>
                        </div>
                    </li>
                    <li style="display: flex; gap: 15px; padding: 15px; background: var(--color-gray-50); border-radius: 8px; margin-bottom: 10px;">
                        <span style="color: var(--color-success);">âœ…</span>
                        <div>
                            <strong>Ø§Ø² LowCardinality Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</strong>
                            <p style="margin: 5px 0 0; color: var(--color-gray-600);">
                                Ø¨Ø±Ø§ÛŒ Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒÛŒ Ù…Ø«Ù„ category, event_type, status
                            </p>
                        </div>
                    </li>
                    <li style="display: flex; gap: 15px; padding: 15px; background: var(--color-gray-50); border-radius: 8px; margin-bottom: 10px;">
                        <span style="color: var(--color-success);">âœ…</span>
                        <div>
                            <strong>Ù¾Ø§Ø±ØªÛŒØ´Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø²Ù…Ø§Ù†ÛŒ</strong>
                            <p style="margin: 5px 0 0; color: var(--color-gray-600);">
                                PARTITION BY toYYYYMM(date) Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ù‡ØªØ± Ø¯Ø§Ø¯Ù‡
                            </p>
                        </div>
                    </li>
                    <li style="display: flex; gap: 15px; padding: 15px; background: var(--color-gray-50); border-radius: 8px; margin-bottom: 10px;">
                        <span style="color: var(--color-success);">âœ…</span>
                        <div>
                            <strong>Ø§Ø¯Ø§Ù…Ù‡ ÙØ§ÛŒÙ„ HTML Ø¢Ù…ÙˆØ²Ø´ ClickHouse Ø¨Ø±Ø§ÛŒ GIS:

```html
<span class="keyword">CREATE TABLE</span> good_design
(
    h3_index    <span class="type">UInt64</span>,
    timestamp   <span class="type">DateTime</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    device_id   <span class="type">UInt32</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (h3_index, timestamp);  <span class="comment">-- Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø³Ø±ÛŒØ¹</span>

<span class="comment">-- âœ… Ø¹Ø§Ù„ÛŒ: Ú†Ù†Ø¯ Ø³Ø·Ø­ H3 Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù</span>
<span class="keyword">CREATE TABLE</span> optimal_design
(
    h3_7        <span class="type">UInt64</span>,  <span class="comment">-- Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ú©Ù„Ø§Ù†</span>
    h3_9        <span class="type">UInt64</span>,  <span class="comment">-- Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ù„Ù‡â€ŒØ§ÛŒ</span>
    timestamp   <span class="type">DateTime</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    device_id   <span class="type">UInt32</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (h3_7, h3_9, timestamp);</pre>
                    </div>
                </div>

                <h3>Û². Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Projection</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“Š</span>
                            SQL - Projections
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ Ø¨Ø§ Projection Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù</span>
<span class="keyword">CREATE TABLE</span> gps_data
(
    device_id   <span class="type">UInt32</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    h3_9        <span class="type">UInt64</span>,
    timestamp   <span class="type">DateTime</span>,
    speed       <span class="type">Float32</span>,
    
    <span class="comment">-- Projection Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø²Ù…Ø§Ù†ÛŒ</span>
    <span class="keyword">PROJECTION</span> by_time (
        <span class="keyword">SELECT</span> *
        <span class="keyword">ORDER BY</span> (device_id, timestamp)
    ),
    
    <span class="comment">-- Projection Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ</span>
    <span class="keyword">PROJECTION</span> by_location (
        <span class="keyword">SELECT</span> *
        <span class="keyword">ORDER BY</span> (h3_9, timestamp)
    ),
    
    <span class="comment">-- Projection Ø¨Ø±Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹ Ø±ÙˆØ²Ø§Ù†Ù‡</span>
    <span class="keyword">PROJECTION</span> daily_stats (
        <span class="keyword">SELECT</span>
            h3_9,
            <span class="function">toDate</span>(timestamp) <span class="keyword">AS</span> date,
            <span class="function">count</span>() <span class="keyword">AS</span> cnt,
            <span class="function">avg</span>(speed) <span class="keyword">AS</span> avg_speed,
            <span class="function">uniqExact</span>(device_id) <span class="keyword">AS</span> unique_devices
        <span class="keyword">GROUP BY</span> h3_9, <span class="function">toDate</span>(timestamp)
    )
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (h3_9, timestamp);

<span class="comment">-- ClickHouse Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Projection Ù…Ù†Ø§Ø³Ø¨ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒâ€ŒÚ©Ù†Ø¯</span></pre>
                    </div>
                </div>

                <h3>Û³. Materialized View Ø¨Ø±Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ”„</span>
                            SQL - Materialized Views
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ø¬Ø¯ÙˆÙ„ Ø®Ø§Ù… GPS</span>
<span class="keyword">CREATE TABLE</span> gps_raw
(
    device_id   <span class="type">UInt32</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    timestamp   <span class="type">DateTime</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (device_id, timestamp);

<span class="comment">-- Ø¬Ø¯ÙˆÙ„ ØªØ¬Ù…ÛŒØ¹ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ</span>
<span class="keyword">CREATE TABLE</span> heatmap_hourly
(
    h3_9        <span class="type">UInt64</span>,
    hour        <span class="type">DateTime</span>,
    point_count <span class="type">UInt64</span>,
    unique_devices <span class="type">UInt32</span>
)
<span class="keyword">ENGINE</span> = SummingMergeTree()
<span class="keyword">ORDER BY</span> (h3_9, hour);

<span class="comment">-- Materialized View Ø¨Ø±Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹ Ø®ÙˆØ¯Ú©Ø§Ø±</span>
<span class="keyword">CREATE MATERIALIZED VIEW</span> heatmap_mv
<span class="keyword">TO</span> heatmap_hourly
<span class="keyword">AS</span>
<span class="keyword">SELECT</span>
    <span class="function">geoToH3</span>(latitude, longitude, <span class="number">9</span>) <span class="keyword">AS</span> h3_9,
    <span class="function">toStartOfHour</span>(timestamp) <span class="keyword">AS</span> hour,
    <span class="function">count</span>() <span class="keyword">AS</span> point_count,
    <span class="function">uniqExact</span>(device_id) <span class="keyword">AS</span> unique_devices
<span class="keyword">FROM</span> gps_raw
<span class="keyword">GROUP BY</span> h3_9, hour;

<span class="comment">-- Ø­Ø§Ù„Ø§ Ù‡Ø± INSERT Ø¯Ø± gps_raw Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± heatmap Ø±Ø§ Ø¨Ù‡â€ŒØ±ÙˆØ² Ù…ÛŒâ€ŒÚ©Ù†Ø¯</span>
<span class="comment">-- Ú©ÙˆØ¦Ø±ÛŒ Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ ÙÙˆÙ‚â€ŒØ§Ù„Ø¹Ø§Ø¯Ù‡ Ø³Ø±ÛŒØ¹ Ù…ÛŒâ€ŒØ´ÙˆØ¯:</span>
<span class="keyword">SELECT</span>
    h3_9,
    <span class="function">h3ToGeo</span>(h3_9) <span class="keyword">AS</span> center,
    <span class="function">sum</span>(point_count) <span class="keyword">AS</span> total_points
<span class="keyword">FROM</span> heatmap_hourly
<span class="keyword">WHERE</span> hour >= now() - <span class="function">toIntervalDay</span>(<span class="number">7</span>)
<span class="keyword">GROUP BY</span> h3_9
<span class="keyword">ORDER BY</span> total_points <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">1000</span>;</pre>
                    </div>
                </div>

                <h3>Û´. Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú©ÙˆØ¦Ø±ÛŒ Ø´Ø¹Ø§Ø¹</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ¯</span>
                            SQL - Optimized Radius Query
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- âŒ Ú©Ù†Ø¯: Ø§Ø³Ú©Ù† Ú©Ø§Ù…Ù„ Ø¬Ø¯ÙˆÙ„</span>
<span class="keyword">SELECT</span> *
<span class="keyword">FROM</span> gps_data
<span class="keyword">WHERE</span> <span class="function">greatCircleDistance</span>(latitude, longitude, <span class="number">35.6892</span>, <span class="number">51.3890</span>) < <span class="number">5000</span>;

<span class="comment">-- âœ… Ø³Ø±ÛŒØ¹: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² H3 Ø¨Ø±Ø§ÛŒ ÙÛŒÙ„ØªØ± Ø§ÙˆÙ„ÛŒÙ‡</span>
<span class="keyword">WITH</span>
    <span class="number">35.6892</span> <span class="keyword">AS</span> center_lat,
    <span class="number">51.3890</span> <span class="keyword">AS</span> center_lon,
    <span class="number">5000</span> <span class="keyword">AS</span> radius_m,
    <span class="function">geoToH3</span>(center_lat, center_lon, <span class="number">9</span>) <span class="keyword">AS</span> center_h3
<span class="keyword">SELECT</span> *
<span class="keyword">FROM</span> gps_data
<span class="keyword">WHERE</span> 
    <span class="comment">-- Ù…Ø±Ø­Ù„Ù‡ Û±: ÙÛŒÙ„ØªØ± Ø³Ø±ÛŒØ¹ Ø¨Ø§ H3 (Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ†Ø¯Ú©Ø³)</span>
    h3_9 <span class="keyword">IN</span> (
        <span class="keyword">SELECT</span> <span class="function">arrayJoin</span>(
            <span class="function">arrayConcat</span>(
                [center_h3],
                <span class="function">h3kRing</span>(center_h3, <span class="number">1</span>),
                <span class="function">h3kRing</span>(center_h3, <span class="number">2</span>),
                <span class="function">h3kRing</span>(center_h3, <span class="number">3</span>)
            )
        )
    )
    <span class="comment">-- Ù…Ø±Ø­Ù„Ù‡ Û²: ÙÛŒÙ„ØªØ± Ø¯Ù‚ÛŒÙ‚ Ø¨Ø§ ÙØ§ØµÙ„Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ</span>
    <span class="keyword">AND</span> <span class="function">greatCircleDistance</span>(latitude, longitude, center_lat, center_lon) < radius_m;

<span class="comment">-- âœ…âœ… Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ: ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ ØªØ¹Ø¯Ø§Ø¯ Ø­Ù„Ù‚Ù‡â€ŒÙ‡Ø§ÛŒ H3 Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²</span>
<span class="keyword">WITH</span>
    <span class="number">35.6892</span> <span class="keyword">AS</span> center_lat,
    <span class="number">51.3890</span> <span class="keyword">AS</span> center_lon,
    <span class="number">5000</span> <span class="keyword">AS</span> radius_m,
    <span class="number">9</span> <span class="keyword">AS</span> h3_res,
    <span class="function">geoToH3</span>(center_lat, center_lon, h3_res) <span class="keyword">AS</span> center_h3,
    <span class="comment">-- Ù…Ø­Ø§Ø³Ø¨Ù‡ ØªØ¹Ø¯Ø§Ø¯ Ø­Ù„Ù‚Ù‡â€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø´Ø¹Ø§Ø¹ Ùˆ Ø±Ø²ÙˆÙ„ÙˆØ´Ù†</span>
    <span class="function">ceil</span>(radius_m / <span class="number">174</span>) <span class="keyword">AS</span> num_rings  <span class="comment">-- 174m = Ø·ÙˆÙ„ Ø¶Ù„Ø¹ H3 res 9</span>
<span class="keyword">SELECT</span> 
    device_id,
    latitude,
    longitude,
    <span class="function">greatCircleDistance</span>(latitude, longitude, center_lat, center_lon) <span class="keyword">AS</span> distance_m
<span class="keyword">FROM</span> gps_data
<span class="keyword">WHERE</span> h3_9 <span class="keyword">IN</span> (
    <span class="keyword">SELECT</span> <span class="function">arrayJoin</span>(<span class="function">h3kRing</span>(center_h3, <span class="function">toUInt8</span>(num_rings)))
)
<span class="keyword">AND</span> <span class="function">greatCircleDistance</span>(latitude, longitude, center_lat, center_lon) < radius_m
<span class="keyword">ORDER BY</span> distance_m
<span class="keyword">LIMIT</span> <span class="number">100</span>;</pre>
                    </div>
                </div>

                <h3>Ûµ. ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>âš™ï¸</span>
                            SQL - Advanced Settings
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ø§ÙØ²Ø§ÛŒØ´ Ø­Ø§ÙØ¸Ù‡ Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø³Ù†Ú¯ÛŒÙ†</span>
<span class="keyword">SET</span> max_memory_usage = <span class="number">20000000000</span>;  <span class="comment">-- 20GB</span>

<span class="comment">-- Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù‡Ù…Ù‡ Ù‡Ø³ØªÙ‡â€ŒÙ‡Ø§ÛŒ CPU</span>
<span class="keyword">SET</span> max_threads = <span class="number">16</span>;

<span class="comment">-- ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† ÙØ´Ø±Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„ Ø¯Ø§Ø¯Ù‡</span>
<span class="keyword">SET</span> enable_http_compression = <span class="number">1</span>;

<span class="comment">-- Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ JOIN Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ</span>
<span class="keyword">SET</span> join_algorithm = <span class="string">'hash'</span>;

<span class="comment">-- ØªÙ†Ø¸ÛŒÙ… Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹ÛŒ Ø¨Ø²Ø±Ú¯</span>
<span class="keyword">SET</span> group_by_two_level_threshold = <span class="number">100000</span>;
<span class="keyword">SET</span> group_by_two_level_threshold_bytes = <span class="number">50000000</span>;</pre>
                    </div>
                </div>

                <div class="box box-tip">
                    <div class="box-title">
                        <span>ğŸ’¡</span>
                        Ú†Ú©â€ŒÙ„ÛŒØ³Øª Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ
                    </div>
                    <ul>
                        <li>âœ… H3 ÛŒØ§ Geohash Ø±Ø§ Ø¯Ø± <span class="inline-code">ORDER BY</span> Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯</li>
                        <li>âœ… Ø§Ø² Materialized View Ø¨Ø±Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹â€ŒÙ‡Ø§ÛŒ Ù¾Ø±ØªÚ©Ø±Ø§Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                        <li>âœ… Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒ Ø´Ø¹Ø§Ø¹ØŒ Ø§Ø¨ØªØ¯Ø§ Ø¨Ø§ H3 ÙÛŒÙ„ØªØ± Ú©Ù†ÛŒØ¯</li>
                        <li>âœ… Ø§Ø² Projection Ø¨Ø±Ø§ÛŒ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒ Ù…Ø®ØªÙ„Ù Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                        <li>âœ… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ§Ø±ÛŒØ®ÛŒ Ø±Ø§ Partition Ø¨Ù†Ø¯ÛŒ Ú©Ù†ÛŒØ¯</li>
                        <li>âœ… Ø§Ø² TTL Ø¨Ø±Ø§ÛŒ Ø­Ø°Ù Ø®ÙˆØ¯Ú©Ø§Ø± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 10: REAL WORLD PROJECTS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="real-world">
            <div class="section-header">
                <div class="section-number">Û±Û°</div>
                <h2 class="section-title">Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒ</h2>
            </div>
            
            <div class="section-content">
                <h3>Ù¾Ø±ÙˆÚ˜Ù‡ Û±: Ø³ÛŒØ³ØªÙ… Ø±Ø¯ÛŒØ§Ø¨ÛŒ Ù†Ø§ÙˆÚ¯Ø§Ù†</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸš—</span>
                            SQL - Fleet Tracking System
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Û±. Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ Ø§ØµÙ„ÛŒ</span>
<span class="keyword">CREATE TABLE</span> fleet_tracking
(
    vehicle_id      <span class="type">UInt32</span>,
    driver_id       <span class="type">UInt32</span>,
    latitude        <span class="type">Float64</span>,
    longitude       <span class="type">Float64</span>,
    h3_9            <span class="type">UInt64</span>,
    speed           <span class="type">Float32</span>,
    heading         <span class="type">UInt16</span>,
    fuel_level      <span class="type">UInt8</span>,
    engine_status   <span class="type">Enum8</span>(<span class="string">'off'</span>=<span class="number">0</span>, <span class="string">'idle'</span>=<span class="number">1</span>, <span class="string">'running'</span>=<span class="number">2</span>),
    timestamp       <span class="type">DateTime</span>,
    date            <span class="type">Date</span> <span class="keyword">MATERIALIZED</span> <span class="function">toDate</span>(timestamp)
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">PARTITION BY</span> <span class="function">toYYYYMM</span>(date)
<span class="keyword">ORDER BY</span> (h3_9, vehicle_id, timestamp)
<span class="keyword">TTL</span> date + <span class="keyword">INTERVAL</span> <span class="number">90</span> <span class="keyword">DAY</span>;  <span class="comment">-- Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ Û¹Û° Ø±ÙˆØ²</span>

<span class="comment">-- Û². Ø¬Ø¯ÙˆÙ„ ØªØ¬Ù…ÛŒØ¹ Ø¨Ø±Ø§ÛŒ Ø¢Ù…Ø§Ø± Ø±ÙˆØ²Ø§Ù†Ù‡</span>
<span class="keyword">CREATE TABLE</span> fleet_daily_stats
(
    vehicle_id      <span class="type">UInt32</span>,
    date            <span class="type">Date</span>,
    total_distance  <span class="type">Float64</span>,
    total_time      <span class="type">UInt32</span>,
    avg_speed       <span class="type">Float32</span>,
    max_speed       <span class="type">Float32</span>,
    fuel_consumed   <span class="type">Float32</span>,
    trip_count      <span class="type">UInt16</span>
)
<span class="keyword">ENGINE</span> = SummingMergeTree()
<span class="keyword">ORDER BY</span> (vehicle_id, date);

<span class="comment">-- Û³. Ú©ÙˆØ¦Ø±ÛŒ: Ù…ÙˆÙ‚Ø¹ÛŒØª ÙØ¹Ù„ÛŒ Ù‡Ù…Ù‡ Ø®ÙˆØ¯Ø±ÙˆÙ‡Ø§</span>
<span class="keyword">SELECT</span>
    vehicle_id,
    <span class="function">argMax</span>(latitude, timestamp) <span class="keyword">AS</span> last_lat,
    <span class="function">argMax</span>(longitude, timestamp) <span class="keyword">AS</span> last_lon,
    <span class="function">argMax</span>(speed, timestamp) <span class="keyword">AS</span> current_speed,
    <span class="function">max</span>(timestamp) <span class="keyword">AS</span> last_update
<span class="keyword">FROM</span> fleet_tracking
<span class="keyword">WHERE</span> timestamp >= now() - <span class="function">toIntervalMinute</span>(<span class="number">10</span>)
<span class="keyword">GROUP BY</span> vehicle_id;

<span class="comment">-- Û´. Ú©ÙˆØ¦Ø±ÛŒ: Ø®ÙˆØ¯Ø±ÙˆÙ‡Ø§ÛŒ Ù†Ø²Ø¯ÛŒÚ© ÛŒÚ© Ù†Ù‚Ø·Ù‡</span>
<span class="keyword">WITH</span>
    <span class="number">35.6892</span> <span class="keyword">AS</span> target_lat,
    <span class="number">51.3890</span> <span class="keyword">AS</span> target_lon,
    <span class="function">geoToH3</span>(target_lat, target_lon, <span class="number">9</span>) <span class="keyword">AS</span> target_h3
<span class="keyword">SELECT</span>
    vehicle_id,
    latitude,
    longitude,
    <span class="function">greatCircleDistance</span>(latitude, longitude, target_lat, target_lon) <span class="keyword">AS</span> distance_m
<span class="keyword">FROM</span> fleet_tracking
<span class="keyword">WHERE</span> 
    timestamp >= now() - <span class="function">toIntervalMinute</span>(<span class="number">5</span>)
    <span class="keyword">AND</span> h3_9 <span class="keyword">IN</span> (
        <span class="keyword">SELECT</span> <span class="function">arrayJoin</span>(<span class="function">arrayConcat</span>(
            [target_h3],
            <span class="function">h3kRing</span>(target_h3, <span class="number">1</span>),
            <span class="function">h3kRing</span>(target_h3, <span class="number">2</span>)
        ))
    )
<span class="keyword">ORDER BY</span> distance_m
<span class="keyword">LIMIT</span> <span class="number">10</span>;

<span class="comment">-- Ûµ. Ú©ÙˆØ¦Ø±ÛŒ: Ù…Ø³ÛŒØ± Ø­Ø±Ú©Øª ÛŒÚ© Ø®ÙˆØ¯Ø±Ùˆ</span>
<span class="keyword">SELECT</span>
    timestamp,
    latitude,
    longitude,
    speed
<span class="keyword">FROM</span> fleet_tracking
<span class="keyword">WHERE</span> 
    vehicle_id = <span class="number">123</span>
    <span class="keyword">AND</span> date = today()
<span class="keyword">ORDER BY</span> timestamp;</pre>
                    </div>
                </div>

                <h3>Ù¾Ø±ÙˆÚ˜Ù‡ Û²: Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ Real-time</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ”¥</span>
                            SQL - Real-time Heatmap
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Û±. Ø¬Ø¯ÙˆÙ„ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</span>
<span class="keyword">CREATE TABLE</span> user_events
(
    user_id     <span class="type">UInt64</span>,
    event_type  <span class="type">LowCardinality</span>(<span class="type">String</span>),
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    h3_8        <span class="type">UInt64</span>,
    h3_9        <span class="type">UInt64</span>,
    timestamp   <span class="type">DateTime</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">PARTITION BY</span> <span class="function">toYYYYMMDD</span>(timestamp)
<span class="keyword">ORDER BY</span> (h3_8, h3_9, timestamp);

<span class="comment">-- Û². Materialized View Ø¨Ø±Ø§ÛŒ Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ</span>
<span class="keyword">CREATE TABLE</span> heatmap_5min
(
    h3_9            <span class="type">UInt64</span>,
    time_bucket     <span class="type">DateTime</span>,
    event_count     <span class="type">UInt64</span>,
    unique_users    <span class="type">UInt32</span>
)
<span class="keyword">ENGINE</span> = SummingMergeTree()
<span class="keyword">ORDER BY</span> (time_bucket, h3_9)
<span class="keyword">TTL</span> time_bucket + <span class="keyword">INTERVAL</span> <span class="number">24</span> <span class="keyword">HOUR</span>;

<span class="keyword">CREATE MATERIALIZED VIEW</span> heatmap_5min_mv
<span class="keyword">TO</span> heatmap_5min
<span class="keyword">AS</span>
<span class="keyword">SELECT</span>
    h3_9,
    <span class="function">toStartOfFiveMinutes</span>(timestamp) <span class="keyword">AS</span> time_bucket,
    <span class="function">count</span>() <span class="keyword">AS</span> event_count,
    <span class="function">uniqExact</span>(user_id) <span class="keyword">AS</span> unique_users
<span class="keyword">FROM</span> user_events
<span class="keyword">GROUP BY</span> h3_9, time_bucket;

<span class="comment">-- Û³. Ú©ÙˆØ¦Ø±ÛŒ Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± ÙØ±Ø§Ù†Øªâ€ŒØ§Ù†Ø¯</span>
<span class="keyword">SELECT</span>
    h3_9,
    <span class="function">h3ToGeo</span>(h3_9).<span class="number">1</span> <span class="keyword">AS</span> lon,
    <span class="function">h3ToGeo</span>(h3_9).<span class="number">2</span> <span class="keyword">AS</span> lat,
    <span class="function">sum</span>(event_count) <span class="keyword">AS</span> intensity,
    <span class="function">sum</span>(unique_users) <span class="keyword">AS</span> users
<span class="keyword">FROM</span> heatmap_5min
<span class="keyword">WHERE</span> time_bucket >= now() - <span class="function">toIntervalHour</span>(<span class="number">1</span>)
<span class="keyword">GROUP BY</span> h3_9
<span class="keyword">HAVING</span> intensity > <span class="number">10</span>
<span class="keyword">ORDER BY</span> intensity <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">500</span>;

<span class="comment">-- Û´. Ø®Ø±ÙˆØ¬ÛŒ GeoJSON Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù…Ø³ØªÙ‚ÛŒÙ…</span>
<span class="keyword">SELECT</span>
    <span class="function">concat</span>(
        <span class="string">'{"type":"Feature","geometry":{"type":"Point","coordinates":['</span>,
        <span class="function">toString</span>(<span class="function">h3ToGeo</span>(h3_9).<span class="number">1</span>), <span class="string">','</span>, <span class="function">toString</span>(<span class="function">h3ToGeo</span>(h3_9).<span class="number">2</span>),
        <span class="string">']},"properties":{"intensity":'</span>, <span class="function">toString</span>(intensity), <span class="string">'}}'</span>
    ) <span class="keyword">AS</span> geojson_feature
<span class="keyword">FROM</span> (
    <span class="keyword">SELECT</span> h3_9, <span class="function">sum</span>(event_count) <span class="keyword">AS</span> intensity
    <span class="keyword">FROM</span> heatmap_5min
    <span class="keyword">WHERE</span> time_bucket >= now() - <span class="function">toIntervalHour</span>(<span class="number">1</span>)
    <span class="keyword">GROUP BY</span> h3_9
);</pre>
                    </div>
                </div>

                <h3>Ù¾Ø±ÙˆÚ˜Ù‡ Û³: ØªØ­Ù„ÛŒÙ„ POI (Ù†Ù‚Ø§Ø· Ù…ÙˆØ±Ø¯ Ø¹Ù„Ø§Ù‚Ù‡)</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“</span>
                            SQL - POI Analysis
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Û±. Ø¬Ø¯ÙˆÙ„ POI</span>
<span class="keyword">CREATE TABLE</span> points_of_interest
(
    poi_id      <span class="type">UInt64</span>,
    name        <span class="type">String</span>,
    category    <span class="type">LowCardinality</span>(<span class="type">String</span>),
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    h3_9        <span class="type">UInt64</span>,
    city        <span class="type">LowCardinality</span>(<span class="type">String</span>),
    rating      <span class="type">Float32</span>,
    review_count <span class="type">UInt32</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (category, h3_9, poi_id);

<span class="comment">-- Û². Ø¬Ø¯ÙˆÙ„ Ø¨Ø§Ø²Ø¯ÛŒØ¯Ù‡Ø§</span>
<span class="keyword">CREATE TABLE</span> poi_visits
(
    user_id     <span class="type">UInt64</span>,
    poi_id      <span class="type">UInt64</span>,
    h3_9        <span class="type">UInt64</span>,
    visit_time  <span class="type">DateTime</span>,
    duration_sec <span class="type">UInt32</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (h3_9, poi_id, visit_time);

<span class="comment">-- Û³. ÛŒØ§ÙØªÙ† Ø±Ø³ØªÙˆØ±Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ù†Ø²Ø¯ÛŒÚ© Ø¨Ø§ Ø§Ù…ØªÛŒØ§Ø² Ø¨Ø§Ù„Ø§</span>
<span class="keyword">WITH</span>
    <span class="number">35.6892</span> <span class="keyword">AS</span> my_lat,
    <span class="number">51.3890</span> <span class="keyword">AS</span> my_lon,
    <span class="function">geoToH3</span>(my_lat, my_lon, <span class="number">9</span>) <span class="keyword">AS</span> my_h3
<span class="keyword">SELECT</span>
    poi_id,
    name,
    rating,
    review_count,
    <span class="function">greatCircleDistance</span>(latitude, longitude, my_lat, my_lon) <span class="keyword">AS</span> distance_m
<span class="keyword">FROM</span> points_of_interest
<span class="keyword">WHERE</span>
    category = <span class="string">'restaurant'</span>
    <span class="keyword">AND</span> h3_9 <span class="keyword">IN</span> (
        <span class="keyword">SELECT</span> <span class="function">arrayJoin</span>(<span class="function">arrayConcat</span>(
            [my_h3],
            <span class="function">h3kRing</span>(my_h3, <span class="number">1</span>),
            <span class="function">h3kRing</span>(my_h3, <span class="number">2</span>),
            <span class="function">h3kRing</span>(my_h3, <span class="number">3</span>)
        ))
    )
    <span class="keyword">AND</span> rating >= <span class="number">4.0</span>
<span class="keyword">ORDER BY</span> rating <span class="keyword">DESC</span>, distance_m <span class="keyword">ASC</span>
<span class="keyword">LIMIT</span> <span class="number">20</span>;

<span class="comment">-- Û´. ØªØ­Ù„ÛŒÙ„ ØªØ±Ø§Ú©Ù… POI Ø¯Ø± Ù‡Ø± Ù…Ù†Ø·Ù‚Ù‡</span>
<span class="keyword">SELECT</span>
    <span class="function">h3ToParent</span>(h3_9, <span class="number">7</span>) <span class="keyword">AS</span> h3_7,
    category,
    <span class="function">count</span>() <span class="keyword">AS</span> poi_count,
    <span class="function">avg</span>(rating) <span class="keyword">AS</span> avg_rating,
    <span class="function">sum</span>(review_count) <span class="keyword">AS</span> total_reviews
<span class="keyword">FROM</span> points_of_interest
<span class="keyword">WHERE</span> city = <span class="string">'Tehran'</span>
<span class="keyword">GROUP BY</span> h3_7, category
<span class="keyword">ORDER BY</span> poi_count <span class="keyword">DESC</span>;

<span class="comment">-- Ûµ. Ù…Ø­Ø¨ÙˆØ¨â€ŒØªØ±ÛŒÙ† POIÙ‡Ø§ Ø¯Ø± ÛŒÚ© Ù…Ø§Ù‡ Ú¯Ø°Ø´ØªÙ‡</span>
<span class="keyword">SELECT</span>
    p.name,
    p.category,
    <span class="function">count</span>() <span class="keyword">AS</span> visit_count,
    <span class="function">uniqExact</span>(v.user_id) <span class="keyword">AS</span> unique_visitors,
    <span class="function">avg</span>(v.duration_sec) / <span class="number">60</span> <span class="keyword">AS</span> avg_duration_min
<span class="keyword">FROM</span> poi_visits v
<span class="keyword">JOIN</span> points_of_interest p <span class="keyword">ON</span> v.poi_id = p.poi_id
<span class="keyword">WHERE</span> v.visit_time >= now() - <span class="function">toIntervalMonth</span>(<span class="number">1</span>)
<span class="keyword">GROUP BY</span> p.poi_id, p.name, p.category
<span class="keyword">ORDER BY</span> visit_count <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">50</span>;</pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 11: INTEGRATION
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="integration">
            <div class="section-header">
                <div class="section-number">Û±Û±</div>
                <h2 class="section-title">ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ GIS</h2>
            </div>
            
            <div class="section-content">
                <h3>Ø§ØªØµØ§Ù„ Ø¨Ø§ Python</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ</span>
                            Python - clickhouse-driver
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="keyword">from</span> clickhouse_driver <span class="keyword">import</span> Client
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">import</span> geopandas <span class="keyword">as</span> gpd
<span class="keyword">from</span> shapely.geometry <span class="keyword">import</span> Point

<span class="comment"># Ø§ØªØµØ§Ù„ Ø¨Ù‡ ClickHouse</span>
client = Client(
    host=<span class="string">'localhost'</span>,
    port=<span class="number">9000</span>,
    user=<span class="string">'default'</span>,
    password=<span class="string">''</span>,
    database=<span class="string">'default'</span>
)

<span class="comment"># Ú©ÙˆØ¦Ø±ÛŒ Ø³Ø§Ø¯Ù‡</span>
result = client.execute(<span class="string">'''
    SELECT 
        h3_9,
        h3ToGeo(h3_9).1 AS lon,
        h3ToGeo(h3_9).2 AS lat,
        count() AS point_count
    FROM gps_data
    WHERE timestamp >= now() - toIntervalHour(1)
    GROUP BY h3_9
    ORDER BY point_count DESC
    LIMIT 100
'''</span>)

<span class="comment"># ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ DataFrame</span>
df = pd.DataFrame(result, columns=[<span class="string">'h3_9'</span>, <span class="string">'lon'</span>, <span class="string">'lat'</span>, <span class="string">'count'</span>])

<span class="comment"># ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ GeoDataFrame Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ù…Ú©Ø§Ù†ÛŒ</span>
geometry = [Point(xy) <span class="keyword">for</span> xy <span class="keyword">in</span> <span class="function">zip</span>(df.lon, df.lat)]
gdf = gpd.GeoDataFrame(df, geometry=geometry, crs=<span class="string">"EPSG:4326"</span>)

<span class="comment"># Ø¯Ø±Ø¬ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯</span>
data = [
    (<span class="number">1</span>, <span class="number">35.6892</span>, <span class="number">51.3890</span>, <span class="number">617733122422996991</span>),
    (<span class="number">2</span>, <span class="number">35.7000</span>, <span class="number">51.4000</span>, <span class="number">617733122423996992</span>),
]
client.execute(
    <span class="string">'INSERT INTO locations (id, lat, lon, h3_9) VALUES'</span>,
    data
)

<span class="comment"># Ø¯Ø±Ø¬ Ø§Ø² DataFrame</span>
client.execute(
    <span class="string">'INSERT INTO locations (id, lat, lon, h3_9) VALUES'</span>,
    df.to_dict(<span class="string">'records'</span>)
)</pre>
                    </div>
                </div>

                <h3>Ø§ØªØµØ§Ù„ Ø¨Ø§ Node.js</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸŸ¢</span>
                            JavaScript - Node.js
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="keyword">const</span> { ClickHouse } = <span class="function">require</span>(<span class="string">'clickhouse'</span>);

<span class="comment">// Ø§ØªØµØ§Ù„ Ø¨Ù‡ ClickHouse</span>
<span class="keyword">const</span> clickhouse = <span class="keyword">new</span> ClickHouse({
    url: <span class="string">'http://localhost'</span>,
    port: <span class="number">8123</span>,
    debug: <span class="keyword">false</span>,
    basicAuth: {
        username: <span class="string">'default'</span>,
        password: <span class="string">''</span>,
    },
    format: <span class="string">'json'</span>
});

<span class="comment">// Ú©ÙˆØ¦Ø±ÛŒ Ù†Ù‚Ø´Ù‡ Ø­Ø±Ø§Ø±ØªÛŒ</span>
<span class="keyword">async</span> <span class="keyword">function</span> <span class="function">getHeatmapData</span>(centerLat, centerLon, radiusKm) {
    <span class="keyword">const</span> query = <span class="string">`
        WITH
            ${centerLat} AS center_lat,
            ${centerLon} AS center_lon,
            geoToH3(center_lat, center_lon, 9) AS center_h3
        SELECT
            h3_9,
            h3ToGeo(h3_9).1 AS lon,
            h3ToGeo(h3_9).2 AS lat,
            count() AS intensity
        FROM gps_data
        WHERE h3_9 IN (
            SELECT arrayJoin(arrayConcat(
                [center_h3],
                h3kRing(center_h3, 5)
            ))
        )
        GROUP BY h3_9
        FORMAT JSON
    `</span>;
    
    <span class="keyword">const</span> result = <span class="keyword">await</span> clickhouse.query(query).toPromise();
    <span class="keyword">return</span> result.data;
}

<span class="comment">// ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ GeoJSON</span>
<span class="keyword">function</span> <span class="function">toGeoJSON</span>(data) {
    <span class="keyword">return</span> {
        type: <span class="string">'FeatureCollection'</span>,
        features: data.<span class="function">map</span>(row => ({
            type: <span class="string">'Feature'</span>,
            geometry: {
                type: <span class="string">'Point'</span>,
                coordinates: [row.lon, row.lat]
            },
            properties: {
                h3: row.h3_9,
                intensity: row.intensity
            }
        }))
    };
}</pre>
                    </div>
                </div>

                <h3>ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Grafana</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“Š</span>
                            Grafana - Geomap Panel Query
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Ú©ÙˆØ¦Ø±ÛŒ Ø¨Ø±Ø§ÛŒ Grafana Geomap Panel</span>
<span class="keyword">SELECT</span>
    <span class="function">h3ToGeo</span>(h3_9).<span class="number">2</span> <span class="keyword">AS</span> latitude,
    <span class="function">h3ToGeo</span>(h3_9).<span class="number">1</span> <span class="keyword">AS</span> longitude,
    <span class="function">count</span>() <span class="keyword">AS</span> metric,
    <span class="function">formatDateTime</span>(<span class="function">toStartOfHour</span>(timestamp), <span class="string">'%Y-%m-%d %H:%M:%S'</span>) <span class="keyword">AS</span> time
<span class="keyword">FROM</span> gps_data
<span class="keyword">WHERE</span> 
    timestamp >= <span class="function">toDateTime</span>($__fromTime)
    <span class="keyword">AND</span> timestamp <= <span class="function">toDateTime</span>($__toTime)
<span class="keyword">GROUP BY</span> h3_9, <span class="function">toStartOfHour</span>(timestamp)
<span class="keyword">ORDER BY</span> time;</pre>
                    </div>
                </div>

                <h3>ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Apache Kafka</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">
                            <span>ğŸ“¨</span>
                            SQL - Kafka Integration
                        </span>
                        <div class="code-dots">
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                            <span class="code-dot"></span>
                        </div>
                    </div>
                    <div class="code-body">
<pre><span class="comment">-- Û±. Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ Kafka Engine</span>
<span class="keyword">CREATE TABLE</span> gps_kafka
(
    device_id   <span class="type">UInt32</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    timestamp   <span class="type">DateTime</span>
)
<span class="keyword">ENGINE</span> = Kafka
<span class="keyword">SETTINGS</span>
    kafka_broker_list = <span class="string">'kafka:9092'</span>,
    kafka_topic_list = <span class="string">'gps-events'</span>,
    kafka_group_name = <span class="string">'clickhouse-consumer'</span>,
    kafka_format = <span class="string">'JSONEachRow'</span>;

<span class="comment">-- Û². Ø¬Ø¯ÙˆÙ„ Ù…Ù‚ØµØ¯</span>
<span class="keyword">CREATE TABLE</span> gps_data
(
    device_id   <span class="type">UInt32</span>,
    latitude    <span class="type">Float64</span>,
    longitude   <span class="type">Float64</span>,
    h3_9        <span class="type">UInt64</span>,
    timestamp   <span class="type">DateTime</span>
)
<span class="keyword">ENGINE</span> = MergeTree()
<span class="keyword">ORDER BY</span> (h3_9, timestamp);

<span class="comment">-- Û³. Materialized View Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„ Ø®ÙˆØ¯Ú©Ø§Ø±</span>
<span class="keyword">CREATE MATERIALIZED VIEW</span> gps_kafka_mv
<span class="keyword">TO</span> gps_data
<span class="keyword">AS</span>
<span class="keyword">SELECT</span>
    device_id,
    latitude,
    longitude,
    <span class="function">geoToH3</span>(latitude, longitude, <span class="number">9</span>) <span class="keyword">AS</span> h3_9,
    timestamp
<span class="keyword">FROM</span> gps_kafka;

<span class="comment">-- Ø­Ø§Ù„Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø² Kafka Ø¨Ù‡ ClickHouse Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯</span></pre>
                    </div>
                </div>

                <h3>Ù…Ø¹Ù…Ø§Ø±ÛŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ</h3>

                <div class="architecture">
                    <div class="architecture-title">Ù…Ø¹Ù…Ø§Ø±ÛŒ Ø³ÛŒØ³ØªÙ… GIS Ø¨Ø§ ClickHouse</div>
                    <div class="architecture-flow">
                        <div class="arch-box source">
                            <div class="arch-icon">ğŸ“±</div>
                            <div class="arch-label">GPS/IoT</div>
                        </div>
                        <div class="arch-arrow">â†’</div>
                        <div class="arch-box source">
                            <div class="arch-icon">ğŸ“¨</div>
                            <div class="arch-label">Kafka</div>
                        </div>
                        <div class="arch-arrow">â†’</div>
                        <div class="arch-box clickhouse">
                            <div class="arch-icon">âš¡</div>
                            <div class="arch-label">ClickHouse</div>
                        </div>
                        <div class="arch-arrow">â†’</div>
                        <div class="arch-box output">
                            <div class="arch-icon">ğŸ—ºï¸</div>
                            <div class="arch-label">Map/Dashboard</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 12: BEST PRACTICES
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section class="section" id="best-practices">
            <div class="section-header">
                <div class="section-number">Û±Û²</div>
                <h2 class="section-title">Ø¨Ù‡ØªØ±ÛŒÙ† Ø´ÛŒÙˆÙ‡â€ŒÙ‡Ø§</h2>
            </div>
            
            <div class="section-content">
                <h3>Ø·Ø±Ø§Ø­ÛŒ Ø¬Ø¯ÙˆÙ„</h3>

                <div class="features-grid">
                    <div class="feature-card">
                        <span class="feature-icon">ğŸ“Š</span>
                        <div class="feature-title">ORDER BY Ù…Ù†Ø§Ø³Ø¨</div>
                        <div class="feature-desc">
                            H3 ÛŒØ§ Geohash Ø±Ø§ Ø¯Ø± Ø§Ø¨ØªØ¯Ø§ÛŒ ORDER BY Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯ 
                            ØªØ§ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø§Ø² Ø§ÛŒÙ†Ø¯Ú©Ø³ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†Ù†Ø¯
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">ğŸ“…</span>
                        <div class="feature-title">Partition Ø¨Ù†Ø¯ÛŒ</div>
                        <div class="feature-desc">
                            Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ§Ø±ÛŒØ® (Ù…Ø§Ù‡ ÛŒØ§ Ø±ÙˆØ²) Partition Ú©Ù†ÛŒØ¯ 
                            ØªØ§ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø²Ù…Ø§Ù†ÛŒ Ø³Ø±ÛŒØ¹â€ŒØªØ± Ø´ÙˆÙ†Ø¯
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">ğŸ—œï¸</span>
                        <div class="feature-title">Ø§Ù†ÙˆØ§Ø¹ Ø¯Ø§Ø¯Ù‡ Ø¨Ù‡ÛŒÙ†Ù‡</div>
                        <div class="feature-desc">
                            Ø§Ø² LowCardinality Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ Ùˆ 
                            Float32 Ø¨Ù‡ Ø¬Ø§ÛŒ Float64 Ø¯Ø± ØµÙˆØ±Øª Ø§Ù…Ú©Ø§Ù† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">â°</span>
                        <div class="feature-title">TTL ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ÛŒØ¯</div>
                        <div class="feature-desc">
                            Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ TTL ØªØ¹Ø±ÛŒÙ Ú©Ù†ÛŒØ¯ 
                            ØªØ§ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø­Ø°Ù Ø´ÙˆÙ†Ø¯
                        </div>
                    </div>
                </div>

                <h3>Ú©ÙˆØ¦Ø±ÛŒ Ù†ÙˆÛŒØ³ÛŒ</h3>

                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>âŒ Ù†Ø§Ù…Ù†Ø§Ø³Ø¨</th>
                                <th>âœ… Ø¨Ù‡ÛŒÙ†Ù‡</th>
                                <th>Ø¯Ù„ÛŒÙ„</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>SELECT *</code></td>
                                <td><code>SELECT col1, col2</code></td>
                                <td>ÙÙ‚Ø· Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²</td>
                            </tr>
                            <tr>
                                <td>ÙÛŒÙ„ØªØ± ÙØ§ØµÙ„Ù‡ Ù…Ø³ØªÙ‚ÛŒÙ…</td>
                                <td>ÙÛŒÙ„ØªØ± H3 + ÙØ§ØµÙ„Ù‡</td>
                                <td>Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ†Ø¯Ú©Ø³</td>
                            </tr>
                            <tr>
                                <td><code>count(DISTINCT x)</code></td>
                                <td><code>uniqExact(x)</code></td>
                                <td>ØªØ§Ø¨Ø¹ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ´Ø¯Ù‡</td>
                            </tr>
                            <tr>
                                <td><code>WHERE date = '2024-01-01'</code></td>
                                <td><code>WHERE date = toDate('2024-01-01')</code></td>
                                <td>Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡ ØµØ­ÛŒØ­</td>
                            </tr>
                            <tr>
                                <td>JOIN Ø¨Ø²Ø±Ú¯</td>
                                <td>Subquery + IN</td>
                                <td>Ù…ØµØ±Ù Ø­Ø§ÙØ¸Ù‡ Ú©Ù…ØªØ±</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>Ù†Ú©Ø§Øª Ø¹Ù…Ù„ÛŒØ§ØªÛŒ</h3>

                <div class="box box-tip">
                    <div class="box-title">
                        <span>âœ…</span>
                        Ú†Ú©â€ŒÙ„ÛŒØ³Øª Production
                    </div>
                    <ul>
                        <li>âœ… Ù…Ø§Ù†ÛŒØªÙˆØ±ÛŒÙ†Ú¯ Ø¨Ø§ Prometheus + Grafana Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ú©Ù†ÛŒØ¯</li>
                        <li>âœ… Backup Ù…Ù†Ø¸Ù… Ø¨Ø§ <code>clickhouse-backup</code> ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ÛŒØ¯</li>
                        <li>âœ… Replication Ø¨Ø±Ø§ÛŒ High Availability ÙØ¹Ø§Ù„ Ú©Ù†ÛŒØ¯</li>
                        <li>âœ… Resource limits Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ÛŒØ¯</li>
                        <li>âœ… Slow query log ÙØ¹Ø§Ù„ Ú©Ù†ÛŒØ¯</li>
                        <li>âœ… Mutation Ùˆ ALTER Ø±Ø§ Ø¯Ø± Ø³Ø§Ø¹Ø§Øª Ú©Ù…â€ŒØªØ±Ø§ÙÛŒÚ© Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡ÛŒØ¯</li>
                    </ul>
                </div>

                <h3>Ù…Ù‚Ø§ÛŒØ³Ù‡ Ù†Ù‡Ø§ÛŒÛŒ Ø³ÛŒØ³ØªÙ…â€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙ†Ø¯Ú©Ø³ Ù…Ú©Ø§Ù†ÛŒ</h3>

                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Ù…Ø¹ÛŒØ§Ø±</th>
                                <th>H3 â­</th>
                                <th>Geohash</th>
                                <th>S2</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Ø³Ø±Ø¹Øª Ú©ÙˆØ¦Ø±ÛŒ</strong></td>
                                <td>âš¡âš¡âš¡ Ø¹Ø§Ù„ÛŒ</td>
                                <td>âš¡âš¡ Ø®ÙˆØ¨</td>
                                <td>âš¡âš¡ Ø®ÙˆØ¨</td>
                            </tr>
                            <tr>
                                <td><strong>Ø¯Ù‚Øª Ù‡Ù…Ø³Ø§ÛŒÚ¯ÛŒ</strong></td>
                                <td>â­â­â­ Ø¹Ø§Ù„ÛŒ</td>
                                <td>â­ Ø¶Ø¹ÛŒÙ</td>
                                <td>â­â­â­ Ø¹Ø§Ù„ÛŒ</td>
                            </tr>
                            <tr>
                                <td><strong>Ø³Ø§Ø¯Ú¯ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡</strong></td>
                                <td>â­â­â­ Ø¢Ø³Ø§Ù†</td>
                                <td>â­â­â­ Ø¢Ø³Ø§Ù†</td>
                                <td>â­â­ Ù…ØªÙˆØ³Ø·</td>
                            </tr>
                            <tr>
                                <td><strong>Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ClickHouse</strong></td>
                                <td>âœ… Ú©Ø§Ù…Ù„</td>
                                <td>âœ… Ú©Ø§Ù…Ù„</td>
                                <td>âœ… Ú©Ø§Ù…Ù„</td>
                            </tr>
                            <tr>
                                <td><strong>ØªÙˆØµÛŒÙ‡ Ø¨Ø±Ø§ÛŒ</strong></td>
                                <td>Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯</td>
                                <td>Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ</td>
                                <td>Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Google</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="box box-clickhouse">
                    <div class="box-title">
                        <span>ğŸ¯</span>
                        Ø¬Ù…Ø¹â€ŒØ¨Ù†Ø¯ÛŒ
                    </div>
                    <p>
                        ClickHouse ÛŒÚ© Ø§Ù†ØªØ®Ø§Ø¨ Ø¹Ø§Ù„ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø¯Ø± Ù…Ù‚ÛŒØ§Ø³ Ø¨Ø²Ø±Ú¯ Ø§Ø³Øª. 
                        Ø¨Ø§ ØªØ±Ú©ÛŒØ¨ Ø³Ø±Ø¹Øª Ø¨Ø§Ù„Ø§ÛŒ ClickHouse Ùˆ Ø³ÛŒØ³ØªÙ… Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÚ¯Ø°Ø§Ø±ÛŒ H3ØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ 
                        Ù…ÛŒÙ„ÛŒØ§Ø±Ø¯Ù‡Ø§ Ù†Ù‚Ø·Ù‡ GPS Ø±Ø§ Ø¯Ø± Ù…ÛŒÙ„ÛŒâ€ŒØ«Ø§Ù†ÛŒÙ‡ ØªØ­Ù„ÛŒÙ„ Ú©Ù†ÛŒØ¯.
                    </p>
                    <p style="margin-top: 15px;">
                        <strong>Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹:</strong>
                    </p>
                    <ol>
                        <li>ClickHouse Ø±Ø§ Ø¨Ø§ Docker Ù†ØµØ¨ Ú©Ù†ÛŒØ¯</li>
                        <li>Ø¬Ø¯ÙˆÙ„ Ø¨Ø§ H3 Ø¯Ø± ORDER BY Ø¨Ø³Ø§Ø²ÛŒØ¯</li>
                        <li>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø¯Ø±Ø¬ Ú©Ù†ÛŒØ¯</li>
                        <li>Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø±Ø§ ØªØ³Øª Ú©Ù†ÛŒØ¯</li>
                        <li>Materialized View Ø¨Ø±Ø§ÛŒ ØªØ¬Ù…ÛŒØ¹ Ø¨Ø³Ø§Ø²ÛŒØ¯</li>
                    </ol>
                </div>
            </div>
        </section>

    </main>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         FOOTER
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <footer class="footer">
        <div class="footer-content">
            <h3>ğŸ“š Ù…Ù†Ø§Ø¨Ø¹ Ø¨ÛŒØ´ØªØ±</h3>
            
            <div class="footer-links">
                <a href="https://clickhouse.com/docs" target="_blank" class="footer-link">
                    <span>ğŸ“–</span>
                    <span>Ù…Ø³ØªÙ†Ø¯Ø§Øª ClickHouse</span>
                </a>
                <a href="https://h3geo.org" target="_blank" class="footer-link">
                    <span>â¬¡</span>
                    <span>H3 Documentation</span>
                </a>
                <a href="https://clickhouse.com/docs/en/sql-reference/functions/geo" target="_blank" class="footer-link">
                    <span>ğŸ—ºï¸</span>
                    <span>Geo Functions Reference</span>
                </a>
            </div>
            
            <p style="margin-top: 40px; opacity: 0.7;">
                âš¡ Ø¢Ù…ÙˆØ²Ø´ ClickHouse Ø¨Ø±Ø§ÛŒ GIS | ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒ Ø¯Ø± Ù…Ù‚ÛŒØ§Ø³ Ù…ÛŒÙ„ÛŒØ§Ø±Ø¯ÛŒ
                <br>
                ØªÙ‡ÛŒÙ‡ Ø´Ø¯Ù‡ Ø¨Ø§ â¤ï¸ Ø¨Ø±Ø§ÛŒ Ø¬Ø§Ù…Ø¹Ù‡ GIS ÙØ§Ø±Ø³ÛŒâ€ŒØ²Ø¨Ø§Ù†
            </p>
        </div>
    </footer>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         JAVASCRIPT
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <script>
        // Smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Back to top button
        const backToTop = document.createElement('button');
        backToTop.innerHTML = 'â†‘';
        backToTop.setAttribute('aria-label', 'Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¨Ø§Ù„Ø§');
        backToTop.style.cssText = `
            position: fixed;
            bottom: 30px;
            left: 30px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
            color: var(--color-dark);
            border: none;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(255, 204, 0, 0.4);
        `;
        document.body.appendChild(backToTop);

        window.addEventListener('scroll', () => {
            if (window.scrollY > 500) {
                backToTop.style.opacity = '1';
            } else {
                backToTop.style.opacity = '0';
            }
        });

        backToTop.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        backToTop.addEventListener('mouseenter', () => {
            backToTop.style.transform = 'scale(1.1)';
        });

        backToTop.addEventListener('mouseleave', () => {
            backToTop.style.transform = 'scale(1)';
        });

        // Progress bar
        const progressBar = document.createElement('div');
        progressBar.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--color-primary), var(--color-secondary), var(--color-accent));
            z-index: 9999;
            transition: width 0.1s;
        `;
        document.body.appendChild(progressBar);

        window.addEventListener('scroll', () => {
            const scrollTop = window.scrollY;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrollPercent = (scrollTop / docHeight) * 100;
            progressBar.style.width = scrollPercent + '%';
        });

        // Section animation on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        document.querySelectorAll('.section').forEach((section, index) => {
            if (index > 0) {
                section.style.opacity = '0';
                section.style.transform = 'translateY(30px)';
                section.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
            }
            observer.observe(section);
        });

        // Copy code functionality
        document.querySelectorAll('.code-block').forEach(block => {
            const copyBtn = document.createElement('button');
            copyBtn.innerHTML = 'ğŸ“‹';
            copyBtn.title = 'Ú©Ù¾ÛŒ Ú©Ø¯';
            copyBtn.style.cssText = `
                position: absolute;
                top: 50px;
                left: 10px;
                background: rgba(255, 255, 255, 0.1);
                border: none;
                border-radius: 5px;
                padding: 5px 10px;
                cursor: pointer;
                font-size: 1rem;
                transition: background 0.3s;
            `;
            
            copyBtn.addEventListener('mouseenter', () => {
                copyBtn.style.background = 'rgba(255, 255, 255, 0.2)';
            });
            
            copyBtn.addEventListener('mouseleave', () => {
                copyBtn.style.background = 'rgba(255, 255, 255, 0.1)';
            });
            
            copyBtn.addEventListener('click', () => {
                const code = block.querySelector('pre').textContent;
                navigator.clipboard.writeText(code).then(() => {
                    copyBtn.innerHTML = 'âœ…';
                    setTimeout(() => {
                        copyBtn.innerHTML = 'ğŸ“‹';
                    }, 2000);
                });
            });
            
            block.style.position = 'relative';
            block.appendChild(copyBtn);
        });

        // TOC active state
        const sections = document.querySelectorAll('.section');
        const tocItems = document.querySelectorAll('.toc-item');

        window.addEventListener('scroll', () => {
            let current = '';
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (scrollY >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            tocItems.forEach(item => {
                item.style.background = '';
                item.style.borderColor = 'transparent';
                if (item.getAttribute('href') === '#' + current) {
                    item.style.background = 'var(--color-primary-light)';
                    item.style.borderColor = 'var(--color-primary)';
                }
            });
        });

        // Print optimization
        window.addEventListener('beforeprint', () => {
            document.querySelectorAll('.section').forEach(section => {
                section.style.opacity = '1';
                section.style.transform = 'none';
            });
        });
    </script>

</body>
</html>