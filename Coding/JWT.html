<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” Ø¢Ù…ÙˆØ²Ø´ Ú©Ø§Ù…Ù„ JWT Ø¨Ø§ Django | Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø§Ù…Ù†</title>
    
    <style>
        :root {
            --primary-color: #092e20;
            --primary-light: #44b78b;
            --primary-dark: #051a12;
            --secondary-color: #0c4b33;
            --accent-color: #f0c14b;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --error-color: #dc3545;
            --info-color: #17a2b8;
            --bg-primary: #f8faf9;
            --bg-secondary: #e8f5e9;
            --bg-card: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #2c3e50;
            --text-muted: #6c757d;
            --border-color: #c8e6c9;
            --code-bg: #1e1e1e;
            --code-text: #d4d4d4;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
            --shadow-xl: 0 25px 50px -12px rgba(0,0,0,0.25);
            --gradient-django: linear-gradient(135deg, #092e20, #44b78b);
            --gradient-jwt: linear-gradient(135deg, #f0c14b, #ff6b6b);
            --gradient-dark: linear-gradient(135deg, #1a1a2e, #16213e);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.9;
            font-size: 16px;
        }

        /* Header */
        header {
            background: var(--gradient-django);
            color: white;
            padding: 70px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.06'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        header h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            position: relative;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header .subtitle {
            font-size: 1.3em;
            opacity: 0.95;
            position: relative;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.1em;
            opacity: 0.9;
            position: relative;
            max-width: 700px;
            margin: 0 auto;
        }

        .badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 25px;
            margin: 20px 5px 0;
            font-size: 0.95em;
            position: relative;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        /* Navigation */
        nav {
            background: var(--primary-dark);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-md);
        }

        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
            max-width: 1400px;
            margin: 0 auto;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 10px 16px;
            border-radius: 20px;
            transition: all 0.3s ease;
            font-size: 0.9em;
            white-space: nowrap;
        }

        nav a:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
        }

        /* Main Container */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* Slides/Sections */
        .slide {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 35px;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .slide::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 150px;
            height: 150px;
            background: var(--gradient-django);
            opacity: 0.05;
            border-radius: 0 16px 0 100%;
        }

        .slide-number {
            position: absolute;
            top: 15px;
            left: 15px;
            width: 45px;
            height: 45px;
            background: var(--gradient-django);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
            box-shadow: var(--shadow-md);
        }

        .slide h2 {
            color: var(--primary-color);
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 3px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .slide h3 {
            color: var(--text-secondary);
            font-size: 1.35em;
            margin: 30px 0 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .slide h4 {
            color: var(--text-secondary);
            font-size: 1.1em;
            margin: 20px 0 10px;
        }

        .slide p {
            margin-bottom: 12px;
            text-align: justify;
        }

        /* Code Blocks */
        .code-block {
            background: var(--code-bg);
            color: var(--code-text);
            padding: 20px;
            border-radius: 10px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin: 15px 0;
            direction: ltr;
            text-align: left;
            line-height: 1.6;
            position: relative;
        }

        .code-block::before {
            content: attr(data-lang);
            position: absolute;
            top: 8px;
            right: 12px;
            font-size: 0.75em;
            color: #888;
            background: #333;
            padding: 2px 8px;
            border-radius: 4px;
        }

        .code-block .comment { color: #6a9955; }
        .code-block .keyword { color: #569cd6; }
        .code-block .string { color: #ce9178; }
        .code-block .function { color: #dcdcaa; }
        .code-block .class { color: #4ec9b0; }
        .code-block .number { color: #b5cea8; }
        .code-block .decorator { color: #d7ba7d; }
        .code-block .builtin { color: #4fc1ff; }
        .code-block .operator { color: #d4d4d4; }

        .code-inline {
            background: #e8e8e8;
            color: #c7254e;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            font-size: 0.9em;
            direction: ltr;
        }

        /* Info Boxes */
        .info-box {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-right: 5px solid var(--info-color);
            padding: 18px 22px;
            border-radius: 0 10px 10px 0;
            margin: 18px 0;
        }

        .info-box h4 {
            color: #1565c0;
            margin-bottom: 8px;
            margin-top: 0;
        }

        .tip-box {
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            border-right: 5px solid var(--success-color);
            padding: 18px 22px;
            border-radius: 0 10px 10px 0;
            margin: 18px 0;
        }

        .tip-box h4 {
            color: #2e7d32;
            margin-bottom: 8px;
            margin-top: 0;
        }

        .warning-box {
            background: linear-gradient(135deg, #fff8e1, #ffecb3);
            border-right: 5px solid var(--warning-color);
            padding: 18px 22px;
            border-radius: 0 10px 10px 0;
            margin: 18px 0;
        }

        .warning-box h4 {
            color: #f57f17;
            margin-bottom: 8px;
            margin-top: 0;
        }

        .error-box {
            background: linear-gradient(135deg, #ffebee, #ffcdd2);
            border-right: 5px solid var(--error-color);
            padding: 18px 22px;
            border-radius: 0 10px 10px 0;
            margin: 18px 0;
        }

        .error-box h4 {
            color: #c62828;
            margin-bottom: 8px;
            margin-top: 0;
        }

        /* JWT Token Display */
        .jwt-token {
            background: var(--gradient-dark);
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            overflow-x: auto;
            direction: ltr;
        }

        .jwt-part {
            display: inline;
            font-family: 'Consolas', monospace;
            font-size: 0.85em;
            word-break: break-all;
        }

        .jwt-header { color: #ff6b6b; }
        .jwt-payload { color: #4ecdc4; }
        .jwt-signature { color: #a29bfe; }

        .jwt-dot {
            color: #ffffff;
            font-weight: bold;
        }

        /* Cards and Grids */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
            gap: 18px;
            margin: 25px 0;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }

        .card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 22px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .card .icon {
            font-size: 2.2em;
            margin-bottom: 12px;
        }

        .card h4 {
            color: var(--primary-color);
            margin-bottom: 8px;
            margin-top: 0;
        }

        /* Flow Diagram */
        .flow-diagram {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 25px 0;
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: 12px;
        }

        .flow-step {
            background: var(--gradient-django);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            text-align: center;
            min-width: 120px;
            box-shadow: var(--shadow-md);
        }

        .flow-arrow {
            font-size: 1.5em;
            color: var(--primary-color);
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        th, td {
            padding: 14px;
            text-align: right;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background: var(--gradient-django);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: var(--bg-secondary);
        }

        /* Lists */
        ul, ol {
            margin: 12px 0 12px 25px;
        }

        li {
            margin-bottom: 10px;
        }

        /* Step Cards */
        .step-card {
            display: flex;
            align-items: flex-start;
            gap: 18px;
            padding: 22px;
            background: white;
            border-radius: 12px;
            margin: 18px 0;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .step-card:hover {
            border-color: var(--primary-light);
            box-shadow: var(--shadow-md);
        }

        .step-number {
            width: 50px;
            height: 50px;
            background: var(--gradient-django);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.3em;
            flex-shrink: 0;
        }

        .step-content h4 {
            color: var(--primary-color);
            margin: 0 0 8px;
            font-size: 1.15em;
        }

        .step-content p {
            margin: 0;
            color: var(--text-secondary);
        }

        /* Highlight */
        .highlight {
            background: linear-gradient(180deg, transparent 60%, #c8e6c9 60%);
            padding: 0 4px;
        }

        /* API Endpoint */
        .api-endpoint {
            background: #2d2d2d;
            border-radius: 8px;
            padding: 15px 20px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 15px;
            direction: ltr;
        }

        .api-method {
            padding: 5px 12px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 0.85em;
            color: white;
        }

        .api-method.get { background: #61affe; }
        .api-method.post { background: #49cc90; }
        .api-method.put { background: #fca130; }
        .api-method.delete { background: #f93e3e; }

        .api-url {
            color: #e0e0e0;
            font-family: 'Consolas', monospace;
            font-size: 0.95em;
        }

        /* Footer */
        footer {
            background: var(--gradient-dark);
            color: white;
            padding: 45px 20px;
            text-align: center;
            margin-top: 40px;
        }

        footer h3 {
            margin-bottom: 18px;
            font-size: 1.4em;
        }

        footer a {
            color: var(--primary-light);
            text-decoration: none;
            margin: 0 12px;
            transition: color 0.3s ease;
        }

        footer a:hover {
            color: white;
        }

        /* Responsive */
        @media (max-width: 768px) {
            header h1 { font-size: 2em; }
            header .subtitle { font-size: 1.1em; }
            .slide { padding: 25px 18px; }
            .slide h2 { font-size: 1.5em; }
            nav ul { gap: 5px; }
            nav a { padding: 8px 12px; font-size: 0.8em; }
            .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; }
            .step-card { flex-direction: column; text-align: center; }
            .code-block { font-size: 0.8em; padding: 15px; }
            .flow-diagram { flex-direction: column; }
            .flow-arrow { transform: rotate(90deg); }
        }

        /* Print */
        @media print {
            nav, footer { display: none !important; }
            .slide { 
                break-inside: avoid; 
                box-shadow: none !important;
                border: 1px solid #ddd !important;
            }
        }

        /* Copy button */
        .code-wrapper {
            position: relative;
        }

        .copy-btn {
            position: absolute;
            top: 8px;
            left: 8px;
            background: #444;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75em;
            opacity: 0.7;
            transition: opacity 0.3s;
            z-index: 10;
        }

        .copy-btn:hover {
            opacity: 1;
        }

        /* Terminal style */
        .terminal {
            background: #0d1117;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            font-family: 'Consolas', monospace;
            direction: ltr;
            text-align: left;
        }

        .terminal-header {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
        }

        .terminal-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .terminal-dot.red { background: #ff5f56; }
        .terminal-dot.yellow { background: #ffbd2e; }
        .terminal-dot.green { background: #27ca40; }

        .terminal-content {
            color: #58a6ff;
            font-size: 0.9em;
            line-height: 1.8;
        }

        .terminal-content .prompt {
            color: #7ee787;
        }

        .terminal-content .command {
            color: #f0f6fc;
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header>
        <h1>ğŸ” JWT Ø¨Ø§ Django</h1>
        <div class="subtitle">Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø§Ù…Ù† Ø¨Ø§ JSON Web Token</div>
        <p>
            Ø¢Ù…ÙˆØ²Ø´ Ú©Ø§Ù…Ù„ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ JWT Ø¯Ø± Django REST Framework
        </p>
        <div>
            <span class="badge">ğŸ Django</span>
            <span class="badge">ğŸ”‘ JWT</span>
            <span class="badge">ğŸ›¡ï¸ Authentication</span>
            <span class="badge">ğŸ“¡ REST API</span>
        </div>
    </header>

    <!-- Navigation -->
    <nav>
        <ul>
            <li><a href="#intro">JWT Ú†ÛŒØ³ØªØŸ</a></li>
            <li><a href="#structure">Ø³Ø§Ø®ØªØ§Ø±</a></li>
            <li><a href="#setup">Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ</a></li>
            <li><a href="#config">Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ</a></li>
            <li><a href="#views">Views</a></li>
            <li><a href="#custom">Ø³ÙØ§Ø±Ø´ÛŒâ€ŒØ³Ø§Ø²ÛŒ</a></li>
            <li><a href="#frontend">Frontend</a></li>
            <li><a href="#security">Ø§Ù…Ù†ÛŒØª</a></li>
            <li><a href="#best-practices">Ø¨Ù‡ØªØ±ÛŒÙ† Ø±ÙˆØ´â€ŒÙ‡Ø§</a></li>
        </ul>
    </nav>

    <!-- Main Content -->
    <div class="container">

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 1: JWT Ú†ÛŒØ³ØªØŸ -->
        <div class="slide" id="intro">
            <div class="slide-number">1</div>
            <h2>ğŸ”‘ JWT Ú†ÛŒØ³ØªØŸ</h2>

            <p>
                <strong>JWT</strong> ÛŒØ§ <strong>JSON Web Token</strong> ÛŒÚ© Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ø¨Ø§Ø² 
                (<a href="https://tools.ietf.org/html/rfc7519" target="_blank">RFC 7519</a>) 
                Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù…Ù† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨ÛŒÙ† Ø¯Ùˆ Ø·Ø±Ù Ø¨Ù‡ ØµÙˆØ±Øª ÛŒÚ© Ø´ÛŒØ¡ JSON ÙØ´Ø±Ø¯Ù‡ Ùˆ Ø§Ù…Ø¶Ø§Ø´Ø¯Ù‡ Ø§Ø³Øª.
            </p>

            <div class="info-box">
                <h4>ğŸ“Œ ØªØ¹Ø±ÛŒÙ Ø³Ø§Ø¯Ù‡</h4>
                <p>
                    JWT ÛŒÚ© Ø±Ø´ØªÙ‡ Ø±Ù…Ø²Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª Ú©Ù‡ Ø­Ø§ÙˆÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± Ø§Ø³Øª Ùˆ Ø¨Ø±Ø§ÛŒ 
                    <strong>Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª</strong> (Authentication) Ùˆ <strong>Ù…Ø¬ÙˆØ²Ø¯Ù‡ÛŒ</strong> (Authorization) 
                    Ø¯Ø± APIÙ‡Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.
                </p>
            </div>

            <h3>ğŸ†š Ù…Ù‚Ø§ÛŒØ³Ù‡ JWT Ø¨Ø§ Session</h3>

            <table>
                <thead>
                    <tr>
                        <th>ÙˆÛŒÚ˜Ú¯ÛŒ</th>
                        <th>Session-Based</th>
                        <th>JWT (Token-Based)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ</td>
                        <td>Ø³Ø±ÙˆØ± (Database/Memory)</td>
                        <td>Ú©Ù„Ø§ÛŒÙ†Øª (LocalStorage/Cookie)</td>
                    </tr>
                    <tr>
                        <td>Stateful/Stateless</td>
                        <td>Stateful</td>
                        <td>Stateless</td>
                    </tr>
                    <tr>
                        <td>Ù…Ù‚ÛŒØ§Ø³â€ŒÙ¾Ø°ÛŒØ±ÛŒ</td>
                        <td>Ù†ÛŒØ§Ø² Ø¨Ù‡ Session Store Ù…Ø´ØªØ±Ú©</td>
                        <td>Ø¢Ø³Ø§Ù† (Ù‡Ø± Ø³Ø±ÙˆØ± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ verify Ú©Ù†Ø¯)</td>
                    </tr>
                    <tr>
                        <td>Ù…ÙˆØ¨Ø§ÛŒÙ„/SPA</td>
                        <td>Ù…Ø´Ú©Ù„â€ŒØ³Ø§Ø²</td>
                        <td>Ø§ÛŒØ¯Ù‡â€ŒØ¢Ù„</td>
                    </tr>
                    <tr>
                        <td>CORS</td>
                        <td>Ù…Ø´Ú©Ù„â€ŒØ³Ø§Ø²</td>
                        <td>Ø¨Ø¯ÙˆÙ† Ù…Ø´Ú©Ù„</td>
                    </tr>
                    <tr>
                        <td>Logout</td>
                        <td>Ø¢Ø³Ø§Ù† (Ø­Ø°Ù session)</td>
                        <td>Ù†ÛŒØ§Ø² Ø¨Ù‡ Blacklist</td>
                    </tr>
                </tbody>
            </table>

            <h3>âœ… Ù…Ø²Ø§ÛŒØ§ÛŒ JWT</h3>

            <div class="grid-3">
                <div class="card">
                    <div class="icon">ğŸš€</div>
                    <h4>Stateless</h4>
                    <p>Ù†ÛŒØ§Ø²ÛŒ Ø¨Ù‡ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Ø³Ø±ÙˆØ± Ù†ÛŒØ³Øª</p>
                </div>
                <div class="card">
                    <div class="icon">ğŸ“±</div>
                    <h4>Cross-Platform</h4>
                    <p>Ù…Ù†Ø§Ø³Ø¨ Ù…ÙˆØ¨Ø§ÛŒÙ„ØŒ ÙˆØ¨ Ùˆ Ø¯Ø³Ú©ØªØ§Ù¾</p>
                </div>
                <div class="card">
                    <div class="icon">âš¡</div>
                    <h4>Performance</h4>
                    <p>Ø¨Ø¯ÙˆÙ† Query Ø¨Ù‡ Ø¯ÛŒØªØ§Ø¨ÛŒØ³</p>
                </div>
                <div class="card">
                    <div class="icon">ğŸ”„</div>
                    <h4>Scalable</h4>
                    <p>Ù…Ù‚ÛŒØ§Ø³â€ŒÙ¾Ø°ÛŒØ±ÛŒ Ø§ÙÙ‚ÛŒ Ø¢Ø³Ø§Ù†</p>
                </div>
                <div class="card">
                    <div class="icon">ğŸŒ</div>
                    <h4>Microservices</h4>
                    <p>Ø§ÛŒØ¯Ù‡â€ŒØ¢Ù„ Ø¨Ø±Ø§ÛŒ Ù…Ø¹Ù…Ø§Ø±ÛŒ ØªÙˆØ²ÛŒØ¹â€ŒØ´Ø¯Ù‡</p>
                </div>
                <div class="card">
                    <div class="icon">ğŸ”’</div>
                    <h4>Self-Contained</h4>
                    <p>Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± ØªÙˆÚ©Ù†</p>
                </div>
            </div>

            <h3>ğŸ”„ ÙØ±Ø¢ÛŒÙ†Ø¯ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø¨Ø§ JWT</h3>

            <div class="flow-diagram">
                <div class="flow-step">
                    ğŸ‘¤ Ú©Ø§Ø±Ø¨Ø±<br>
                    <small>Ø§Ø±Ø³Ø§Ù„ credentials</small>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    ğŸ–¥ï¸ Ø³Ø±ÙˆØ±<br>
                    <small>ØªØ£ÛŒÛŒØ¯ Ùˆ ØªÙˆÙ„ÛŒØ¯ JWT</small>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    ğŸ”‘ ØªÙˆÚ©Ù†<br>
                    <small>Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ú©Ù„Ø§ÛŒÙ†Øª</small>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡<br>
                    <small>Ø¯Ø± Ú©Ù„Ø§ÛŒÙ†Øª</small>
                </div>
            </div>

            <div class="flow-diagram">
                <div class="flow-step">
                    ğŸ“¤ Ø¯Ø±Ø®ÙˆØ§Ø³Øª<br>
                    <small>Ø¨Ø§ Header: Bearer token</small>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    âœ… Verify<br>
                    <small>Ø¨Ø±Ø±Ø³ÛŒ Ø§Ù…Ø¶Ø§ Ùˆ Ø§Ù†Ù‚Ø¶Ø§</small>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    ğŸ“Š Ù¾Ø§Ø³Ø®<br>
                    <small>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ø§ÙØ¸Øªâ€ŒØ´Ø¯Ù‡</small>
                </div>
            </div>
        </div>

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 2: Ø³Ø§Ø®ØªØ§Ø± JWT -->
        <div class="slide" id="structure">
            <div class="slide-number">2</div>
            <h2>ğŸ§¬ Ø³Ø§Ø®ØªØ§Ø± JWT</h2>

            <p>
                ÛŒÚ© JWT Ø§Ø² Ø³Ù‡ Ø¨Ø®Ø´ ØªØ´Ú©ÛŒÙ„ Ø´Ø¯Ù‡ Ú©Ù‡ Ø¨Ø§ Ù†Ù‚Ø·Ù‡ (<code class="code-inline">.</code>) Ø§Ø² Ù‡Ù… Ø¬Ø¯Ø§ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯:
            </p>

            <div class="jwt-token">
                <span class="jwt-part jwt-header">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span><span class="jwt-dot">.</span><span class="jwt-part jwt-payload">eyJ1c2VyX2lkIjoxLCJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNzA0MDY3MjAwfQ</span><span class="jwt-dot">.</span><span class="jwt-part jwt-signature">SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</span>
            </div>

            <div class="grid-3">
                <div class="card" style="border-top: 4px solid #ff6b6b;">
                    <h4 style="color: #ff6b6b;">ğŸ”´ Header</h4>
                    <p>Ù†ÙˆØ¹ ØªÙˆÚ©Ù† Ùˆ Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… Ø§Ù…Ø¶Ø§</p>
                    <div class="code-block" data-lang="JSON" style="font-size: 0.8em;">
{
  "alg": "HS256",
  "typ": "JWT"
}
                    </div>
                </div>
                <div class="card" style="border-top: 4px solid #4ecdc4;">
                    <h4 style="color: #4ecdc4;">ğŸŸ¢ Payload</h4>
                    <p>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ùˆ Claims</p>
                    <div class="code-block" data-lang="JSON" style="font-size: 0.8em;">
{
  "user_id": 1,
  "username": "admin",
  "exp": 1704067200
}
                    </div>
                </div>
                <div class="card" style="border-top: 4px solid #a29bfe;">
                    <h4 style="color: #a29bfe;">ğŸŸ£ Signature</h4>
                    <p>Ø§Ù…Ø¶Ø§ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„</p>
                    <div class="code-block" data-lang="Text" style="font-size: 0.8em;">
HMACSHA256(
  base64(header) + "." +
  base64(payload),
  secret
)
                    </div>
                </div>
            </div>

            <h3>ğŸ“‹ Ø§Ù†ÙˆØ§Ø¹ Claims</h3>

            <table>
                <thead>
                    <tr>
                        <th>Claim</th>
                        <th>Ù†Ø§Ù… Ú©Ø§Ù…Ù„</th>
                        <th>ØªÙˆØ¶ÛŒØ­</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code class="code-inline">iss</code></td>
                        <td>Issuer</td>
                        <td>ØµØ§Ø¯Ø±Ú©Ù†Ù†Ø¯Ù‡ ØªÙˆÚ©Ù†</td>
                    </tr>
                    <tr>
                        <td><code class="code-inline">sub</code></td>
                        <td>Subject</td>
                        <td>Ù…ÙˆØ¶ÙˆØ¹ (Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ user ID)</td>
                    </tr>
                    <tr>
                        <td><code class="code-inline">aud</code></td>
                        <td>Audience</td>
                        <td>Ù…Ø®Ø§Ø·Ø¨ ØªÙˆÚ©Ù†</td>
                    </tr>
                    <tr>
                        <td><code class="code-inline">exp</code></td>
                        <td>Expiration Time</td>
                        <td>Ø²Ù…Ø§Ù† Ø§Ù†Ù‚Ø¶Ø§ (Unix timestamp)</td>
                    </tr>
                    <tr>
                        <td><code class="code-inline">nbf</code></td>
                        <td>Not Before</td>
                        <td>Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª Ù‚Ø¨Ù„ Ø§Ø² Ø§ÛŒÙ† Ø²Ù…Ø§Ù†</td>
                    </tr>
                    <tr>
                        <td><code class="code-inline">iat</code></td>
                        <td>Issued At</td>
                        <td>Ø²Ù…Ø§Ù† ØµØ¯ÙˆØ±</td>
                    </tr>
                    <tr>
                        <td><code class="code-inline">jti</code></td>
                        <td>JWT ID</td>
                        <td>Ø´Ù†Ø§Ø³Ù‡ ÛŒÚ©ØªØ§ÛŒ ØªÙˆÚ©Ù†</td>
                    </tr>
                </tbody>
            </table>

            <h3>ğŸ” Access Token vs Refresh Token</h3>

            <div class="grid-2">
                <div class="card">
                    <h4>ğŸ« Access Token</h4>
                    <ul>
                        <li>Ø¹Ù…Ø± Ú©ÙˆØªØ§Ù‡ (5-30 Ø¯Ù‚ÛŒÙ‚Ù‡)</li>
                        <li>Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ù…Ù†Ø§Ø¨Ø¹</li>
                        <li>Ø§Ø±Ø³Ø§Ù„ Ø¯Ø± Ù‡Ø± Ø¯Ø±Ø®ÙˆØ§Ø³Øª</li>
                        <li>Ø¯Ø± ØµÙˆØ±Øª Ø³Ø±Ù‚ØªØŒ Ø¢Ø³ÛŒØ¨ Ù…Ø­Ø¯ÙˆØ¯</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>ğŸ”„ Refresh Token</h4>
                    <ul>
                        <li>Ø¹Ù…Ø± Ø·ÙˆÙ„Ø§Ù†ÛŒ (Ø±ÙˆØ²Ù‡Ø§/Ù‡ÙØªÙ‡â€ŒÙ‡Ø§)</li>
                        <li>Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Access Token Ø¬Ø¯ÛŒØ¯</li>
                        <li>Ø°Ø®ÛŒØ±Ù‡ Ø§Ù…Ù†â€ŒØªØ± (HttpOnly Cookie)</li>
                        <li>Ù‚Ø§Ø¨Ù„ Ø§Ø¨Ø·Ø§Ù„ (Blacklist)</li>
                    </ul>
                </div>
            </div>

            <div class="warning-box">
                <h4>âš ï¸ Ù†Ú©ØªÙ‡ Ø§Ù…Ù†ÛŒØªÛŒ</h4>
                <p>
                    <strong>Payload Ø±Ù…Ø²Ú¯Ø°Ø§Ø±ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª!</strong> ÙÙ‚Ø· Base64 encode Ø´Ø¯Ù‡. 
                    Ù‡Ø±Ú¯Ø² Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø­Ø³Ø§Ø³ (Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±ØŒ Ú©Ø§Ø±Øª Ø¨Ø§Ù†Ú©ÛŒ) Ø±Ø§ Ø¯Ø± JWT Ù‚Ø±Ø§Ø± Ù†Ø¯Ù‡ÛŒØ¯.
                </p>
            </div>
        </div>

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 3: Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ -->
        <div class="slide" id="setup">
            <div class="slide-number">3</div>
            <h2>âš™ï¸ Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ</h2>

            <p>
                Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ JWT Ø¯Ø± Django Ø§Ø² Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ 
                <strong>djangorestframework-simplejwt</strong> Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ….
            </p>

            <h3>ğŸ“¦ Ù†ØµØ¨ Ù¾Ú©ÛŒØ¬â€ŒÙ‡Ø§</h3>

            <div class="terminal">
                <div class="terminal-header">
                    <div class="terminal-dot red"></div>
                    <div class="terminal-dot yellow"></div>
                    <div class="terminal-dot green"></div>
                </div>
                <div class="terminal-content">
                    <span class="prompt">$</span> <span class="command">pip install djangorestframework</span><br>
                    <span class="prompt">$</span> <span class="command">pip install djangorestframework-simplejwt</span><br>
                    <span class="prompt">$</span> <span class="command">pip install django-cors-headers</span>
                </div>
            </div>

            <h3>ğŸ“ ØªÙ†Ø¸ÛŒÙ…Ø§Øª settings.py</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># settings.py</span>

INSTALLED_APPS = [
    <span class="string">'django.contrib.admin'</span>,
    <span class="string">'django.contrib.auth'</span>,
    <span class="string">'django.contrib.contenttypes'</span>,
    <span class="string">'django.contrib.sessions'</span>,
    <span class="string">'django.contrib.messages'</span>,
    <span class="string">'django.contrib.staticfiles'</span>,
    
    <span class="comment"># Third-party apps</span>
    <span class="string">'rest_framework'</span>,
    <span class="string">'rest_framework_simplejwt'</span>,
    <span class="string">'rest_framework_simplejwt.token_blacklist'</span>,  <span class="comment"># Ø¨Ø±Ø§ÛŒ logout</span>
    <span class="string">'corsheaders'</span>,
    
    <span class="comment"># Your apps</span>
    <span class="string">'accounts'</span>,
]

MIDDLEWARE = [
    <span class="string">'corsheaders.middleware.CorsMiddleware'</span>,  <span class="comment"># Ø¨Ø§ÛŒØ¯ Ø§ÙˆÙ„ Ø¨Ø§Ø´Ø¯</span>
    <span class="string">'django.middleware.security.SecurityMiddleware'</span>,
    <span class="string">'django.contrib.sessions.middleware.SessionMiddleware'</span>,
    <span class="string">'django.middleware.common.CommonMiddleware'</span>,
    <span class="string">'django.middleware.csrf.CsrfViewMiddleware'</span>,
    <span class="string">'django.contrib.auth.middleware.AuthenticationMiddleware'</span>,
    <span class="string">'django.contrib.messages.middleware.MessageMiddleware'</span>,
    <span class="string">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span>,
]

<span class="comment"># REST Framework Settings</span>
REST_FRAMEWORK = {
    <span class="string">'DEFAULT_AUTHENTICATION_CLASSES'</span>: (
        <span class="string">'rest_framework_simplejwt.authentication.JWTAuthentication'</span>,
    ),
    <span class="string">'DEFAULT_PERMISSION_CLASSES'</span>: (
        <span class="string">'rest_framework.permissions.IsAuthenticated'</span>,
    ),
}

<span class="comment"># CORS Settings</span>
CORS_ALLOWED_ORIGINS = [
    <span class="string">"http://localhost:3000"</span>,
    <span class="string">"http://127.0.0.1:3000"</span>,
]
            </div>

            <h3>ğŸ”— ØªÙ†Ø¸ÛŒÙ… URLs</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># urls.py (Ù¾Ø±ÙˆÚ˜Ù‡ Ø§ØµÙ„ÛŒ)</span>

<span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin
<span class="keyword">from</span> django.urls <span class="keyword">import</span> path, include
<span class="keyword">from</span> rest_framework_simplejwt.views <span class="keyword">import</span> (
    TokenObtainPairView,
    TokenRefreshView,
    TokenVerifyView,
)

urlpatterns = [
    path(<span class="string">'admin/'</span>, admin.site.urls),
    
    <span class="comment"># JWT Authentication URLs</span>
    path(<span class="string">'api/token/'</span>, TokenObtainPairView.as_view(), name=<span class="string">'token_obtain_pair'</span>),
    path(<span class="string">'api/token/refresh/'</span>, TokenRefreshView.as_view(), name=<span class="string">'token_refresh'</span>),
    path(<span class="string">'api/token/verify/'</span>, TokenVerifyView.as_view(), name=<span class="string">'token_verify'</span>),
    
    <span class="comment"># Your app URLs</span>
    path(<span class="string">'api/'</span>, include(<span class="string">'accounts.urls'</span>)),
]
            </div>

            <h3>ğŸ“¡ Endpoints Ù¾ÛŒØ´â€ŒÙØ±Ø¶</h3>

            <div class="api-endpoint">
                <span class="api-method post">POST</span>
                <span class="api-url">/api/token/</span>
                <span style="color: #888; margin-right: auto;">Ø¯Ø±ÛŒØ§ÙØª Access Ùˆ Refresh Token</span>
            </div>

            <div class="api-endpoint">
                <span class="api-method post">POST</span>
                <span class="api-url">/api/token/refresh/</span>
                <span style="color: #888; margin-right: auto;">Ø¯Ø±ÛŒØ§ÙØª Access Token Ø¬Ø¯ÛŒØ¯</span>
            </div>

            <div class="api-endpoint">
                <span class="api-method post">POST</span>
                <span class="api-url">/api/token/verify/</span>
                <span style="color: #888; margin-right: auto;">Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø¹ØªØ¨Ø§Ø± ØªÙˆÚ©Ù†</span>
            </div>

            <h3>ğŸ§ª ØªØ³Øª Ø¨Ø§ cURL</h3>

            <div class="terminal">
                <div class="terminal-header">
                    <div class="terminal-dot red"></div>
                    <div class="terminal-dot yellow"></div>
                    <div class="terminal-dot green"></div>
                </div>
                <div class="terminal-content">
                    <span class="comment"># Ø¯Ø±ÛŒØ§ÙØª ØªÙˆÚ©Ù†</span><br>
                    <span class="prompt">$</span> <span class="command">curl -X POST http://localhost:8000/api/token/ \</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="command">-H "Content-Type: application/json" \</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="command">-d '{"username": "admin", "password": "password123"}'</span><br><br>
                    
                    <span class="comment"># Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ØªÙˆÚ©Ù†</span><br>
                    <span class="prompt">$</span> <span class="command">curl http://localhost:8000/api/protected/ \</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="command">-H "Authorization: Bearer eyJhbGciOiJIUzI1NiIs..."</span>
                </div>
            </div>
        </div>

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 4: Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ -->
        <div class="slide" id="config">
            <div class="slide-number">4</div>
            <h2>ğŸ”§ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ú©Ø§Ù…Ù„ Simple JWT</h2>

            <p>
                ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú©Ø§Ù…Ù„ <code class="code-inline">SIMPLE_JWT</code> Ø¯Ø± ÙØ§ÛŒÙ„ settings.py:
            </p>

            <div class="code-block" data-lang="Python">
<span class="comment"># settings.py</span>

<span class="keyword">from</span> datetime <span class="keyword">import</span> timedelta

SIMPLE_JWT = {
    <span class="comment"># Ù…Ø¯Øª Ø²Ù…Ø§Ù† Ø§Ø¹ØªØ¨Ø§Ø± ØªÙˆÚ©Ù†â€ŒÙ‡Ø§</span>
    <span class="string">'ACCESS_TOKEN_LIFETIME'</span>: timedelta(minutes=<span class="number">15</span>),
    <span class="string">'REFRESH_TOKEN_LIFETIME'</span>: timedelta(days=<span class="number">7</span>),
    <span class="string">'SLIDING_TOKEN_LIFETIME'</span>: timedelta(minutes=<span class="number">5</span>),
    <span class="string">'SLIDING_TOKEN_REFRESH_LIFETIME'</span>: timedelta(days=<span class="number">1</span>),
    
    <span class="comment"># ØªÙ†Ø¸ÛŒÙ…Ø§Øª Refresh Token</span>
    <span class="string">'ROTATE_REFRESH_TOKENS'</span>: <span class="keyword">True</span>,   <span class="comment"># ØªÙˆÚ©Ù† Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ Ù‡Ø± refresh</span>
    <span class="string">'BLACKLIST_AFTER_ROTATION'</span>: <span class="keyword">True</span>, <span class="comment"># ØªÙˆÚ©Ù† Ù‚Ø¨Ù„ÛŒ Ø±Ø§ Ø¨Ø§Ø·Ù„ Ú©Ù†</span>
    <span class="string">'UPDATE_LAST_LOGIN'</span>: <span class="keyword">True</span>,        <span class="comment"># Ø¢Ù¾Ø¯ÛŒØª last_login</span>
    
    <span class="comment"># Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… Ùˆ Ú©Ù„ÛŒØ¯</span>
    <span class="string">'ALGORITHM'</span>: <span class="string">'HS256'</span>,
    <span class="string">'SIGNING_KEY'</span>: SECRET_KEY,  <span class="comment"># ÛŒØ§ ÛŒÚ© Ú©Ù„ÛŒØ¯ Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡</span>
    <span class="string">'VERIFYING_KEY'</span>: <span class="keyword">None</span>,      <span class="comment"># Ø¨Ø±Ø§ÛŒ RS256</span>
    
    <span class="comment"># ØªÙ†Ø¸ÛŒÙ…Ø§Øª Header</span>
    <span class="string">'AUTH_HEADER_TYPES'</span>: (<span class="string">'Bearer'</span>,),
    <span class="string">'AUTH_HEADER_NAME'</span>: <span class="string">'HTTP_AUTHORIZATION'</span>,
    
    <span class="comment"># ÙÛŒÙ„Ø¯ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ú©Ø§Ø±Ø¨Ø±</span>
    <span class="string">'USER_ID_FIELD'</span>: <span class="string">'id'</span>,
    <span class="string">'USER_ID_CLAIM'</span>: <span class="string">'user_id'</span>,
    
    <span class="comment"># ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ</span>
    <span class="string">'USER_AUTHENTICATION_RULE'</span>: <span class="string">'rest_framework_simplejwt.authentication.default_user_authentication_rule'</span>,
    
    <span class="comment"># Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ</span>
    <span class="string">'AUTH_TOKEN_CLASSES'</span>: (<span class="string">'rest_framework_simplejwt.tokens.AccessToken'</span>,),
    <span class="string">'TOKEN_TYPE_CLAIM'</span>: <span class="string">'token_type'</span>,
    <span class="string">'TOKEN_USER_CLASS'</span>: <span class="string">'rest_framework_simplejwt.models.TokenUser'</span>,
    
    <span class="comment"># JTI (JWT ID)</span>
    <span class="string">'JTI_CLAIM'</span>: <span class="string">'jti'</span>,
    
    <span class="comment"># Serializer Ù‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ</span>
    <span class="string">'TOKEN_OBTAIN_SERIALIZER'</span>: <span class="string">'rest_framework_simplejwt.serializers.TokenObtainPairSerializer'</span>,
    <span class="string">'TOKEN_REFRESH_SERIALIZER'</span>: <span class="string">'rest_framework_simplejwt.serializers.TokenRefreshSerializer'</span>,
    <span class="string">'TOKEN_VERIFY_SERIALIZER'</span>: <span class="string">'rest_framework_simplejwt.serializers.TokenVerifySerializer'</span>,
    <span class="string">'TOKEN_BLACKLIST_SERIALIZER'</span>: <span class="string">'rest_framework_simplejwt.serializers.TokenBlacklistSerializer'</span>,
}
            </div>

            <h3>ğŸ“Š ØªÙˆØ¶ÛŒØ­ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ù‡Ù…</h3>

            <table>
                <thead>
                    <tr>
                        <th>ØªÙ†Ø¸ÛŒÙ…</th>
                        <th>ØªÙˆØ¶ÛŒØ­</th>
                        <th>Ù…Ù‚Ø¯Ø§Ø± Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code class="code-inline">ACCESS_TOKEN_LIFETIME</code></td>
                        <td>Ø¹Ù…Ø± Access Token</td>
                        <td>5-30 Ø¯Ù‚ÛŒÙ‚Ù‡</td>
                    </tr>
                    <tr>
                        <td><code class="code-inline">REFRESH_TOKEN_LIFETIME</code></td>
                        <td>Ø¹Ù…Ø± Refresh Token</td>
                        <td>1-14 Ø±ÙˆØ²</td>
                    </tr>
                    <tr>
                        <td><code class="code-inline">ROTATE_REFRESH_TOKENS</code></td>
                        <td>ØªÙˆÚ©Ù† Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ Ù‡Ø± refresh</td>
                        <td>True (Ø§Ù…Ù†ÛŒØª Ø¨Ø§Ù„Ø§ØªØ±)</td>
                    </tr>
                    <tr>
                        <td><code class="code-inline">BLACKLIST_AFTER_ROTATION</code></td>
                        <td>Ø¨Ø§Ø·Ù„ Ú©Ø±Ø¯Ù† ØªÙˆÚ©Ù† Ù‚Ø¨Ù„ÛŒ</td>
                        <td>True</td>
                    </tr>
                    <tr>
                        <td><code class="code-inline">UPDATE_LAST_LOGIN</code></td>
                        <td>Ø¢Ù¾Ø¯ÛŒØª Ø²Ù…Ø§Ù† Ø¢Ø®Ø±ÛŒÙ† ÙˆØ±ÙˆØ¯</td>
                        <td>True</td>
                    </tr>
                </tbody>
            </table>

            <h3>ğŸ”„ Migrate Ø¨Ø±Ø§ÛŒ Blacklist</h3>

            <div class="terminal">
                <div class="terminal-header">
                    <div class="terminal-dot red"></div>
                    <div class="terminal-dot yellow"></div>
                    <div class="terminal-dot green"></div>
                </div>
                <div class="terminal-content">
                    <span class="prompt">$</span> <span class="command">python manage.py migrate</span>
                </div>
            </div>

            <div class="tip-box">
                <h4>ğŸ’¡ Ù†Ú©ØªÙ‡</h4>
                <p>
                    Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² BlacklistØŒ Ø¨Ø§ÛŒØ¯ 
                    <code class="code-inline">'rest_framework_simplejwt.token_blacklist'</code> 
                    Ø±Ø§ Ø¨Ù‡ INSTALLED_APPS Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù‡ Ùˆ migrate Ú©Ù†ÛŒØ¯.
                </p>
            </div>
        </div>

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 5: Views Ùˆ Serializers -->
        <div class="slide" id="views">
            <div class="slide-number">5</div>
            <h2>ğŸ¯ Views Ùˆ Serializers</h2>

            <h3>ğŸ“ Serializers Ø³ÙØ§Ø±Ø´ÛŒ</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/serializers.py</span>

<span class="keyword">from</span> rest_framework <span class="keyword">import</span> serializers
<span class="keyword">from</span> rest_framework_simplejwt.serializers <span class="keyword">import</span> TokenObtainPairSerializer
<span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> User
<span class="keyword">from</span> django.contrib.auth.password_validation <span class="keyword">import</span> validate_password


<span class="keyword">class</span> <span class="class">CustomTokenObtainPairSerializer</span>(TokenObtainPairSerializer):
    <span class="string">"""Ø³ÙØ§Ø±Ø´ÛŒâ€ŒØ³Ø§Ø²ÛŒ ØªÙˆÚ©Ù† Ø¨Ø§ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø¶Ø§ÙÛŒ"""</span>
    
    <span class="decorator">@classmethod</span>
    <span class="keyword">def</span> <span class="function">get_token</span>(cls, user):
        token = <span class="keyword">super</span>().get_token(user)
        
        <span class="comment"># Ø§ÙØ²ÙˆØ¯Ù† claims Ø³ÙØ§Ø±Ø´ÛŒ</span>
        token[<span class="string">'username'</span>] = user.username
        token[<span class="string">'email'</span>] = user.email
        token[<span class="string">'is_staff'</span>] = user.is_staff
        token[<span class="string">'full_name'</span>] = user.get_full_name()
        
        <span class="keyword">return</span> token
    
    <span class="keyword">def</span> <span class="function">validate</span>(self, attrs):
        data = <span class="keyword">super</span>().validate(attrs)
        
        <span class="comment"># Ø§ÙØ²ÙˆØ¯Ù† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡ response</span>
        data[<span class="string">'user'</span>] = {
            <span class="string">'id'</span>: self.user.id,
            <span class="string">'username'</span>: self.user.username,
            <span class="string">'email'</span>: self.user.email,
            <span class="string">'is_staff'</span>: self.user.is_staff,
        }
        
        <span class="keyword">return</span> data


<span class="keyword">class</span> <span class="class">RegisterSerializer</span>(serializers.ModelSerializer):
    <span class="string">"""Serializer Ø¨Ø±Ø§ÛŒ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±"""</span>
    
    password = serializers.CharField(
        write_only=<span class="keyword">True</span>,
        required=<span class="keyword">True</span>,
        validators=[validate_password]
    )
    password2 = serializers.CharField(write_only=<span class="keyword">True</span>, required=<span class="keyword">True</span>)
    
    <span class="keyword">class</span> <span class="class">Meta</span>:
        model = User
        fields = (<span class="string">'username'</span>, <span class="string">'email'</span>, <span class="string">'password'</span>, <span class="string">'password2'</span>, 
                  <span class="string">'first_name'</span>, <span class="string">'last_name'</span>)
    
    <span class="keyword">def</span> <span class="function">validate</span>(self, attrs):
        <span class="keyword">if</span> attrs[<span class="string">'password'</span>] != attrs[<span class="string">'password2'</span>]:
            <span class="keyword">raise</span> serializers.ValidationError({
                <span class="string">'password'</span>: <span class="string">'Ø±Ù…Ø²Ù‡Ø§ÛŒ Ø¹Ø¨ÙˆØ± Ù…Ø·Ø§Ø¨Ù‚Øª Ù†Ø¯Ø§Ø±Ù†Ø¯.'</span>
            })
        <span class="keyword">return</span> attrs
    
    <span class="keyword">def</span> <span class="function">create</span>(self, validated_data):
        user = User.objects.create(
            username=validated_data[<span class="string">'username'</span>],
            email=validated_data[<span class="string">'email'</span>],
            first_name=validated_data.get(<span class="string">'first_name'</span>, <span class="string">''</span>),
            last_name=validated_data.get(<span class="string">'last_name'</span>, <span class="string">''</span>)
        )
        user.set_password(validated_data[<span class="string">'password'</span>])
        user.save()
        <span class="keyword">return</span> user


<span class="keyword">class</span> <span class="class">UserSerializer</span>(serializers.ModelSerializer):
    <span class="string">"""Serializer Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±"""</span>
    
    <span class="keyword">class</span> <span class="class">Meta</span>:
        model = User
        fields = (<span class="string">'id'</span>, <span class="string">'username'</span>, <span class="string">'email'</span>, <span class="string">'first_name'</span>, 
                  <span class="string">'last_name'</span>, <span class="string">'date_joined'</span>)
        read_only_fields = (<span class="string">'id'</span>, <span class="string">'date_joined'</span>)


<span class="keyword">class</span> <span class="class">ChangePasswordSerializer</span>(serializers.Serializer):
    <span class="string">"""Serializer Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±"""</span>
    
    old_password = serializers.CharField(required=<span class="keyword">True</span>)
    new_password = serializers.CharField(required=<span class="keyword">True</span>, validators=[validate_password])
    new_password2 = serializers.CharField(required=<span class="keyword">True</span>)
    
    <span class="keyword">def</span> <span class="function">validate</span>(self, attrs):
        <span class="keyword">if</span> attrs[<span class="string">'new_password'</span>] != attrs[<span class="string">'new_password2'</span>]:
            <span class="keyword">raise</span> serializers.ValidationError({
                <span class="string">'new_password'</span>: <span class="string">'Ø±Ù…Ø²Ù‡Ø§ÛŒ Ø¹Ø¨ÙˆØ± Ø¬Ø¯ÛŒØ¯ Ù…Ø·Ø§Ø¨Ù‚Øª Ù†Ø¯Ø§Ø±Ù†Ø¯.'</span>
            })
        <span class="keyword">return</span> attrs
            </div>

            <h3>ğŸ® Views</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/views.py</span>

<span class="keyword">from</span> rest_framework <span class="keyword">import</span> generics, status, permissions
<span class="keyword">from</span> rest_framework.response <span class="keyword">import</span> Response
<span class="keyword">from</span> rest_framework.views <span class="keyword">import</span> APIView
<span class="keyword">from</span> rest_framework_simplejwt.views <span class="keyword">import</span> TokenObtainPairView
<span class="keyword">from</span> rest_framework_simplejwt.tokens <span class="keyword">import</span> RefreshToken
<span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> User

<span class="keyword">from</span> .serializers <span class="keyword">import</span> (
    CustomTokenObtainPairSerializer,
    RegisterSerializer,
    UserSerializer,
    ChangePasswordSerializer
)


<span class="keyword">class</span> <span class="class">CustomTokenObtainPairView</span>(TokenObtainPairView):
    <span class="string">"""View Ø³ÙØ§Ø±Ø´ÛŒ Ø¨Ø±Ø§ÛŒ Ù„Ø§Ú¯ÛŒÙ†"""</span>
    serializer_class = CustomTokenObtainPairSerializer


<span class="keyword">class</span> <span class="class">RegisterView</span>(generics.CreateAPIView):
    <span class="string">"""View Ø¨Ø±Ø§ÛŒ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯"""</span>
    
    queryset = User.objects.all()
    permission_classes = (permissions.AllowAny,)
    serializer_class = RegisterSerializer
    
    <span class="keyword">def</span> <span class="function">create</span>(self, request, *args, **kwargs):
        serializer = self.get_serializer(data=request.data)
        serializer.is_valid(raise_exception=<span class="keyword">True</span>)
        user = serializer.save()
        
        <span class="comment"># ØªÙˆÙ„ÛŒØ¯ ØªÙˆÚ©Ù† Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯</span>
        refresh = RefreshToken.for_user(user)
        
        <span class="keyword">return</span> Response({
            <span class="string">'user'</span>: UserSerializer(user).data,
            <span class="string">'refresh'</span>: str(refresh),
            <span class="string">'access'</span>: str(refresh.access_token),
            <span class="string">'message'</span>: <span class="string">'Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯.'</span>
        }, status=status.HTTP_201_CREATED)


<span class="keyword">class</span> <span class="class">LogoutView</span>(APIView):
    <span class="string">"""View Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ (Blacklist Ú©Ø±Ø¯Ù† ØªÙˆÚ©Ù†)"""</span>
    
    permission_classes = (permissions.IsAuthenticated,)
    
    <span class="keyword">def</span> <span class="function">post</span>(self, request):
        <span class="keyword">try</span>:
            refresh_token = request.data[<span class="string">'refresh'</span>]
            token = RefreshToken(refresh_token)
            token.blacklist()
            
            <span class="keyword">return</span> Response({
                <span class="string">'message'</span>: <span class="string">'Ø®Ø±ÙˆØ¬ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯.'</span>
            }, status=status.HTTP_200_OK)
        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
            <span class="keyword">return</span> Response({
                <span class="string">'error'</span>: str(e)
            }, status=status.HTTP_400_BAD_REQUEST)


<span class="keyword">class</span> <span class="class">ProfileView</span>(generics.RetrieveUpdateAPIView):
    <span class="string">"""View Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ùˆ ÙˆÛŒØ±Ø§ÛŒØ´ Ù¾Ø±ÙˆÙØ§ÛŒÙ„"""</span>
    
    serializer_class = UserSerializer
    permission_classes = (permissions.IsAuthenticated,)
    
    <span class="keyword">def</span> <span class="function">get_object</span>(self):
        <span class="keyword">return</span> self.request.user


<span class="keyword">class</span> <span class="class">ChangePasswordView</span>(generics.UpdateAPIView):
    <span class="string">"""View Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±"""</span>
    
    serializer_class = ChangePasswordSerializer
    permission_classes = (permissions.IsAuthenticated,)
    
    <span class="keyword">def</span> <span class="function">get_object</span>(self):
        <span class="keyword">return</span> self.request.user
    
    <span class="keyword">def</span> <span class="function">update</span>(self, request, *args, **kwargs):
        user = self.get_object()
        serializer = self.get_serializer(data=request.data)
        serializer.is_valid(raise_exception=<span class="keyword">True</span>)
        
        <span class="comment"># Ø¨Ø±Ø±Ø³ÛŒ Ø±Ù…Ø² ÙØ¹Ù„ÛŒ</span>
        <span class="keyword">if</span> <span class="keyword">not</span> user.check_password(serializer.data.get(<span class="string">'old_password'</span>)):
            <span class="keyword">return</span> Response({
                <span class="string">'old_password'</span>: <span class="string">'Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± ÙØ¹Ù„ÛŒ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª.'</span>
            }, status=status.HTTP_400_BAD_REQUEST)
        
        <span class="comment"># ØªÙ†Ø¸ÛŒÙ… Ø±Ù…Ø² Ø¬Ø¯ÛŒØ¯</span>
        user.set_password(serializer.data.get(<span class="string">'new_password'</span>))
        user.save()
        
        <span class="keyword">return</span> Response({
            <span class="string">'message'</span>: <span class="string">'Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªØºÛŒÛŒØ± Ú©Ø±Ø¯.'</span>
        }, status=status.HTTP_200_OK)


<span class="keyword">class</span> <span class="class">LogoutAllView</span>(APIView):
    <span class="string">"""Ø®Ø±ÙˆØ¬ Ø§Ø² Ù‡Ù…Ù‡ Ø¯Ø³ØªÚ¯Ø§Ù‡â€ŒÙ‡Ø§ (Ø¨Ø§Ø·Ù„ Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ ØªÙˆÚ©Ù†â€ŒÙ‡Ø§)"""</span>
    
    permission_classes = (permissions.IsAuthenticated,)
    
    <span class="keyword">def</span> <span class="function">post</span>(self, request):
        <span class="keyword">from</span> rest_framework_simplejwt.token_blacklist.models <span class="keyword">import</span> OutstandingToken, BlacklistedToken
        
        tokens = OutstandingToken.objects.filter(user_id=request.user.id)
        <span class="keyword">for</span> token <span class="keyword">in</span> tokens:
            <span class="keyword">try</span>:
                BlacklistedToken.objects.get_or_create(token=token)
            <span class="keyword">except</span>:
                <span class="keyword">pass</span>
        
        <span class="keyword">return</span> Response({
            <span class="string">'message'</span>: <span class="string">'Ø§Ø² Ù‡Ù…Ù‡ Ø¯Ø³ØªÚ¯Ø§Ù‡â€ŒÙ‡Ø§ Ø®Ø§Ø±Ø¬ Ø´Ø¯ÛŒØ¯.'</span>
        }, status=status.HTTP_200_OK)
            </div>

            <h3>ğŸ”— URLs</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/urls.py</span>

<span class="keyword">from</span> django.urls <span class="keyword">import</span> path
<span class="keyword">from</span> rest_framework_simplejwt.views <span class="keyword">import</span> TokenRefreshView, TokenVerifyView

<span class="keyword">from</span> .views <span class="keyword">import</span> (
    CustomTokenObtainPairView,
    RegisterView,
    LogoutView,
    LogoutAllView,
    ProfileView,
    ChangePasswordView,
)

urlpatterns = [
    <span class="comment"># Authentication</span>
    path(<span class="string">'auth/login/'</span>, CustomTokenObtainPairView.as_view(), name=<span class="string">'login'</span>),
    path(<span class="string">'auth/register/'</span>, RegisterView.as_view(), name=<span class="string">'register'</span>),
    path(<span class="string">'auth/logout/'</span>, LogoutView.as_view(), name=<span class="string">'logout'</span>),
    path(<span class="string">'auth/logout-all/'</span>, LogoutAllView.as_view(), name=<span class="string">'logout_all'</span>),
    
    <span class="comment"># Token management</span>
    path(<span class="string">'auth/token/refresh/'</span>, TokenRefreshView.as_view(), name=<span class="string">'token_refresh'</span>),
    path(<span class="string">'auth/token/verify/'</span>, TokenVerifyView.as_view(), name=<span class="string">'token_verify'</span>),
    
    <span class="comment"># User</span>
    path(<span class="string">'user/profile/'</span>, ProfileView.as_view(), name=<span class="string">'profile'</span>),
    path(<span class="string">'user/change-password/'</span>, ChangePasswordView.as_view(), name=<span class="string">'change_password'</span>),
]
            </div>

            <h3>ğŸ“¡ Ø®Ù„Ø§ØµÙ‡ Endpoints</h3>

            <div class="api-endpoint">
                <span class="api-method post">POST</span>
                <span class="api-url">/api/auth/register/</span>
                <span style="color: #888; margin-right: auto;">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</span>
            </div>

            <div class="api-endpoint">
                <span class="api-method post">POST</span>
                <span class="api-url">/api/auth/login/</span>
                <span style="color: #888; margin-right: auto;">ÙˆØ±ÙˆØ¯</span>
            </div>

            <div class="api-endpoint">
                <span class="api-method post">POST</span>
                <span class="api-url">/api/auth/logout/</span>
                <span style="color: #888; margin-right: auto;">Ø®Ø±ÙˆØ¬</span>
            </div>

            <div class="api-endpoint">
                <span class="api-method post">POST</span>
                <span class="api-url">/api/auth/token/refresh/</span>
                <span style="color: #888; margin-right: auto;">ØªÙ…Ø¯ÛŒØ¯ ØªÙˆÚ©Ù†</span>
            </div>

            <div class="api-endpoint">
                <span class="api-method get">GET</span>
                <span class="api-url">/api/user/profile/</span>
                <span style="color: #888; margin-right: auto;">Ù¾Ø±ÙˆÙØ§ÛŒÙ„</span>
            </div>

            <div class="api-endpoint">
                <span class="api-method put">PUT</span>
                <span class="api-url">/api/user/change-password/</span>
                <span style="color: #888; margin-right: auto;">ØªØºÛŒÛŒØ± Ø±Ù…Ø²</span>
            </div>
        </div>

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 6: Ø³ÙØ§Ø±Ø´ÛŒâ€ŒØ³Ø§Ø²ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ -->
        <div class="slide" id="custom">
            <div class="slide-number">6</div>
            <h2>âš¡ Ø³ÙØ§Ø±Ø´ÛŒâ€ŒØ³Ø§Ø²ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</h2>

            <h3>ğŸ‘¤ Custom User Model</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/models.py</span>

<span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> AbstractUser
<span class="keyword">from</span> django.db <span class="keyword">import</span> models


<span class="keyword">class</span> <span class="class">CustomUser</span>(AbstractUser):
    <span class="string">"""Ù…Ø¯Ù„ Ú©Ø§Ø±Ø¨Ø± Ø³ÙØ§Ø±Ø´ÛŒ"""</span>
    
    email = models.EmailField(unique=<span class="keyword">True</span>)
    phone = models.CharField(max_length=<span class="number">15</span>, blank=<span class="keyword">True</span>, null=<span class="keyword">True</span>)
    avatar = models.ImageField(upload_to=<span class="string">'avatars/'</span>, blank=<span class="keyword">True</span>, null=<span class="keyword">True</span>)
    bio = models.TextField(blank=<span class="keyword">True</span>)
    date_of_birth = models.DateField(blank=<span class="keyword">True</span>, null=<span class="keyword">True</span>)
    
    <span class="comment"># ØªÙ†Ø¸ÛŒÙ…Ø§Øª JWT</span>
    jwt_secret = models.CharField(max_length=<span class="number">255</span>, blank=<span class="keyword">True</span>)  <span class="comment"># Ø¨Ø±Ø§ÛŒ invalidate Ú©Ø±Ø¯Ù† ØªÙˆÚ©Ù†â€ŒÙ‡Ø§</span>
    
    USERNAME_FIELD = <span class="string">'email'</span>  <span class="comment"># Ù„Ø§Ú¯ÛŒÙ† Ø¨Ø§ Ø§ÛŒÙ…ÛŒÙ„</span>
    REQUIRED_FIELDS = [<span class="string">'username'</span>]
    
    <span class="keyword">class</span> <span class="class">Meta</span>:
        verbose_name = <span class="string">'Ú©Ø§Ø±Ø¨Ø±'</span>
        verbose_name_plural = <span class="string">'Ú©Ø§Ø±Ø¨Ø±Ø§Ù†'</span>
    
    <span class="keyword">def</span> <span class="function">__str__</span>(self):
        <span class="keyword">return</span> self.email
            </div>

            <div class="code-block" data-lang="Python">
<span class="comment"># settings.py</span>

AUTH_USER_MODEL = <span class="string">'accounts.CustomUser'</span>
            </div>

            <h3>ğŸ« Custom Token Claims</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/serializers.py</span>

<span class="keyword">from</span> rest_framework_simplejwt.serializers <span class="keyword">import</span> TokenObtainPairSerializer


<span class="keyword">class</span> <span class="class">CustomTokenObtainPairSerializer</span>(TokenObtainPairSerializer):
    <span class="string">"""Ø§ÙØ²ÙˆØ¯Ù† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³ÙØ§Ø±Ø´ÛŒ Ø¨Ù‡ ØªÙˆÚ©Ù†"""</span>
    
    <span class="decorator">@classmethod</span>
    <span class="keyword">def</span> <span class="function">get_token</span>(cls, user):
        token = <span class="keyword">super</span>().get_token(user)
        
        <span class="comment"># Claims Ø³ÙØ§Ø±Ø´ÛŒ</span>
        token[<span class="string">'username'</span>] = user.username
        token[<span class="string">'email'</span>] = user.email
        token[<span class="string">'is_staff'</span>] = user.is_staff
        token[<span class="string">'is_superuser'</span>] = user.is_superuser
        
        <span class="comment"># Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§ Ùˆ Ù…Ø¬ÙˆØ²Ù‡Ø§</span>
        token[<span class="string">'groups'</span>] = list(user.groups.values_list(<span class="string">'name'</span>, flat=<span class="keyword">True</span>))
        token[<span class="string">'permissions'</span>] = list(user.get_all_permissions())
        
        <span class="comment"># Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ø±ÙˆÙØ§ÛŒÙ„</span>
        <span class="keyword">if</span> <span class="keyword">hasattr</span>(user, <span class="string">'phone'</span>):
            token[<span class="string">'phone'</span>] = user.phone
        
        <span class="keyword">return</span> token
            </div>

            <h3>ğŸ” Custom Authentication Backend</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/backends.py</span>

<span class="keyword">from</span> django.contrib.auth.backends <span class="keyword">import</span> ModelBackend
<span class="keyword">from</span> django.contrib.auth <span class="keyword">import</span> get_user_model
<span class="keyword">from</span> django.db.models <span class="keyword">import</span> Q

User = get_user_model()


<span class="keyword">class</span> <span class="class">EmailOrUsernameBackend</span>(ModelBackend):
    <span class="string">"""Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø¨Ø§ Ø§ÛŒÙ…ÛŒÙ„ ÛŒØ§ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ"""</span>
    
    <span class="keyword">def</span> <span class="function">authenticate</span>(self, request, username=<span class="keyword">None</span>, password=<span class="keyword">None</span>, **kwargs):
        <span class="keyword">try</span>:
            <span class="comment"># Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø§ Ø§ÛŒÙ…ÛŒÙ„ ÛŒØ§ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ</span>
            user = User.objects.get(
                Q(username__iexact=username) | Q(email__iexact=username)
            )
        <span class="keyword">except</span> User.DoesNotExist:
            <span class="keyword">return</span> <span class="keyword">None</span>
        <span class="keyword">except</span> User.MultipleObjectsReturned:
            user = User.objects.filter(email__iexact=username).first()
        
        <span class="keyword">if</span> user <span class="keyword">and</span> user.check_password(password) <span class="keyword">and</span> self.user_can_authenticate(user):
            <span class="keyword">return</span> user
        
        <span class="keyword">return</span> <span class="keyword">None</span>
            </div>

            <div class="code-block" data-lang="Python">
<span class="comment"># settings.py</span>

AUTHENTICATION_BACKENDS = [
    <span class="string">'accounts.backends.EmailOrUsernameBackend'</span>,
    <span class="string">'django.contrib.auth.backends.ModelBackend'</span>,
]
            </div>

            <h3>ğŸ›¡ï¸ Custom Permission</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/permissions.py</span>

<span class="keyword">from</span> rest_framework <span class="keyword">import</span> permissions


<span class="keyword">class</span> <span class="class">IsOwnerOrReadOnly</span>(permissions.BasePermission):
    <span class="string">"""ÙÙ‚Ø· Ù…Ø§Ù„Ú© Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ ÙˆÛŒØ±Ø§ÛŒØ´ Ú©Ù†Ø¯"""</span>
    
    <span class="keyword">def</span> <span class="function">has_object_permission</span>(self, request, view, obj):
        <span class="comment"># Ø®ÙˆØ§Ù†Ø¯Ù† Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡</span>
        <span class="keyword">if</span> request.method <span class="keyword">in</span> permissions.SAFE_METHODS:
            <span class="keyword">return</span> <span class="keyword">True</span>
        
        <span class="comment"># Ù†ÙˆØ´ØªÙ† ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ù…Ø§Ù„Ú©</span>
        <span class="keyword">return</span> obj.user == request.user


<span class="keyword">class</span> <span class="class">IsAdminOrReadOnly</span>(permissions.BasePermission):
    <span class="string">"""ÙÙ‚Ø· Ø§Ø¯Ù…ÛŒÙ† Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ ÙˆÛŒØ±Ø§ÛŒØ´ Ú©Ù†Ø¯"""</span>
    
    <span class="keyword">def</span> <span class="function">has_permission</span>(self, request, view):
        <span class="keyword">if</span> request.method <span class="keyword">in</span> permissions.SAFE_METHODS:
            <span class="keyword">return</span> <span class="keyword">True</span>
        <span class="keyword">return</span> request.user <span class="keyword">and</span> request.user.is_staff


<span class="keyword">class</span> <span class="class">HasGroupPermission</span>(permissions.BasePermission):
    <span class="string">"""Ø¨Ø±Ø±Ø³ÛŒ Ø¹Ø¶ÙˆÛŒØª Ø¯Ø± Ú¯Ø±ÙˆÙ‡"""</span>
    
    <span class="keyword">def</span> <span class="function">has_permission</span>(self, request, view):
        required_groups = <span class="keyword">getattr</span>(view, <span class="string">'required_groups'</span>, [])
        
        <span class="keyword">if</span> <span class="keyword">not</span> required_groups:
            <span class="keyword">return</span> <span class="keyword">True</span>
        
        user_groups = request.user.groups.values_list(<span class="string">'name'</span>, flat=<span class="keyword">True</span>)
        <span class="keyword">return</span> <span class="keyword">any</span>(group <span class="keyword">in</span> user_groups <span class="keyword">for</span> group <span class="keyword">in</span> required_groups)
            </div>

            <h3>â° Custom Token Lifetime per User</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/tokens.py</span>

<span class="keyword">from</span> rest_framework_simplejwt.tokens <span class="keyword">import</span> RefreshToken
<span class="keyword">from</span> datetime <span class="keyword">import</span> timedelta


<span class="keyword">class</span> <span class="class">CustomRefreshToken</span>(RefreshToken):
    <span class="string">"""ØªÙˆÚ©Ù† Ø¨Ø§ Ø¹Ù…Ø± Ù…ØªÙØ§ÙˆØª Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ù…Ø®ØªÙ„Ù"""</span>
    
    <span class="decorator">@classmethod</span>
    <span class="keyword">def</span> <span class="function">for_user</span>(cls, user):
        token = <span class="keyword">super</span>().for_user(user)
        
        <span class="comment"># Ø¹Ù…Ø± Ø¨ÛŒØ´ØªØ± Ø¨Ø±Ø§ÛŒ Ø§Ø¯Ù…ÛŒÙ†â€ŒÙ‡Ø§</span>
        <span class="keyword">if</span> user.is_staff:
            token.set_exp(lifetime=timedelta(days=<span class="number">30</span>))
        <span class="keyword">else</span>:
            token.set_exp(lifetime=timedelta(days=<span class="number">7</span>))
        
        <span class="keyword">return</span> token


<span class="comment"># Ø§Ø³ØªÙØ§Ø¯Ù‡</span>
<span class="keyword">from</span> .tokens <span class="keyword">import</span> CustomRefreshToken

refresh = CustomRefreshToken.for_user(user)
access = refresh.access_token
            </div>

            <div class="tip-box">
                <h4>ğŸ’¡ Ù†Ú©ØªÙ‡</h4>
                <p>
                    Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ØªÙˆÚ©Ù† Ø³ÙØ§Ø±Ø´ÛŒØŒ Ø¨Ø§ÛŒØ¯ Ø¯Ø± ØªÙ†Ø¸ÛŒÙ…Ø§Øª 
                    <code class="code-inline">AUTH_TOKEN_CLASSES</code> Ø±Ø§ ØªØºÛŒÛŒØ± Ø¯Ù‡ÛŒØ¯.
                </p>
            </div>
        </div>

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 7: Frontend Integration -->
        <div class="slide" id="frontend">
            <div class="slide-number">7</div>
            <h2>ğŸŒ ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Frontend</h2>

            <h3>âš›ï¸ React Ø¨Ø§ Axios</h3>

            <div class="code-block" data-lang="JavaScript">
<span class="comment">// api/axios.js</span>

<span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;

<span class="keyword">const</span> API_URL = <span class="string">'http://localhost:8000/api'</span>;

<span class="comment">// Ø§ÛŒØ¬Ø§Ø¯ instance</span>
<span class="keyword">const</span> api = axios.create({
    baseURL: API_URL,
    headers: {
        <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span>,
    },
});

<span class="comment">// Interceptor Ø¨Ø±Ø§ÛŒ Ø§ÙØ²ÙˆØ¯Ù† ØªÙˆÚ©Ù† Ø¨Ù‡ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§</span>
api.interceptors.request.use(
    (config) => {
        <span class="keyword">const</span> token = localStorage.getItem(<span class="string">'access_token'</span>);
        <span class="keyword">if</span> (token) {
            config.headers.Authorization = <span class="string">`Bearer <span class="keyword">${</span>token<span class="keyword">}</span>`</span>;
        }
        <span class="keyword">return</span> config;
    },
    (error) => Promise.reject(error)
);

<span class="comment">// Interceptor Ø¨Ø±Ø§ÛŒ refresh Ø®ÙˆØ¯Ú©Ø§Ø± ØªÙˆÚ©Ù†</span>
api.interceptors.response.use(
    (response) => response,
    <span class="keyword">async</span> (error) => {
        <span class="keyword">const</span> originalRequest = error.config;
        
        <span class="comment">// Ø§Ú¯Ø± 401 Ùˆ Ù‡Ù†ÙˆØ² retry Ù†Ø´Ø¯Ù‡</span>
        <span class="keyword">if</span> (error.response?.status === <span class="number">401</span> && !originalRequest._retry) {
            originalRequest._retry = <span class="keyword">true</span>;
            
            <span class="keyword">try</span> {
                <span class="keyword">const</span> refreshToken = localStorage.getItem(<span class="string">'refresh_token'</span>);
                <span class="keyword">const</span> response = <span class="keyword">await</span> axios.post(<span class="string">`<span class="keyword">${</span>API_URL<span class="keyword">}</span>/auth/token/refresh/`</span>, {
                    refresh: refreshToken,
                });
                
                <span class="keyword">const</span> { access } = response.data;
                localStorage.setItem(<span class="string">'access_token'</span>, access);
                
                <span class="comment">// ØªÚ©Ø±Ø§Ø± Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø§ØµÙ„ÛŒ Ø¨Ø§ ØªÙˆÚ©Ù† Ø¬Ø¯ÛŒØ¯</span>
                originalRequest.headers.Authorization = <span class="string">`Bearer <span class="keyword">${</span>access<span class="keyword">}</span>`</span>;
                <span class="keyword">return</span> api(originalRequest);
                
            } <span class="keyword">catch</span> (refreshError) {
                <span class="comment">// Refresh token Ù‡Ù… Ù…Ù†Ù‚Ø¶ÛŒ Ø´Ø¯Ù‡ - logout</span>
                localStorage.removeItem(<span class="string">'access_token'</span>);
                localStorage.removeItem(<span class="string">'refresh_token'</span>);
                window.location.href = <span class="string">'/login'</span>;
            }
        }
        
        <span class="keyword">return</span> Promise.reject(error);
    }
);

<span class="keyword">export default</span> api;
            </div>

            <h3>ğŸ”‘ Auth Service</h3>

            <div class="code-block" data-lang="JavaScript">
<span class="comment">// services/authService.js</span>

<span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">'../api/axios'</span>;

<span class="keyword">class</span> <span class="class">AuthService</span> {
    <span class="comment">// ÙˆØ±ÙˆØ¯</span>
    <span class="keyword">async</span> <span class="function">login</span>(username, password) {
        <span class="keyword">const</span> response = <span class="keyword">await</span> api.post(<span class="string">'/auth/login/'</span>, {
            username,
            password,
        });
        
        <span class="keyword">if</span> (response.data.access) {
            localStorage.setItem(<span class="string">'access_token'</span>, response.data.access);
            localStorage.setItem(<span class="string">'refresh_token'</span>, response.data.refresh);
            localStorage.setItem(<span class="string">'user'</span>, JSON.stringify(response.data.user));
        }
        
        <span class="keyword">return</span> response.data;
    }
    
    <span class="comment">// Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</span>
    <span class="keyword">async</span> <span class="function">register</span>(userData) {
        <span class="keyword">const</span> response = <span class="keyword">await</span> api.post(<span class="string">'/auth/register/'</span>, userData);
        
        <span class="keyword">if</span> (response.data.access) {
            localStorage.setItem(<span class="string">'access_token'</span>, response.data.access);
            localStorage.setItem(<span class="string">'refresh_token'</span>, response.data.refresh);
            localStorage.setItem(<span class="string">'user'</span>, JSON.stringify(response.data.user));
        }
        
        <span class="keyword">return</span> response.data;
    }
    
    <span class="comment">// Ø®Ø±ÙˆØ¬</span>
    <span class="keyword">async</span> <span class="function">logout</span>() {
        <span class="keyword">try</span> {
            <span class="keyword">const</span> refreshToken = localStorage.getItem(<span class="string">'refresh_token'</span>);
            <span class="keyword">await</span> api.post(<span class="string">'/auth/logout/'</span>, { refresh: refreshToken });
        } <span class="keyword">catch</span> (error) {
            console.error(<span class="string">'Logout error:'</span>, error);
        } <span class="keyword">finally</span> {
            localStorage.removeItem(<span class="string">'access_token'</span>);
            localStorage.removeItem(<span class="string">'refresh_token'</span>);
            localStorage.removeItem(<span class="string">'user'</span>);
        }
    }
    
    <span class="comment">// Ø¯Ø±ÛŒØ§ÙØª Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ù„ÛŒ</span>
    <span class="function">getCurrentUser</span>() {
        <span class="keyword">const</span> user = localStorage.getItem(<span class="string">'user'</span>);
        <span class="keyword">return</span> user ? JSON.parse(user) : <span class="keyword">null</span>;
    }
    
    <span class="comment">// Ø¨Ø±Ø±Ø³ÛŒ Ù„Ø§Ú¯ÛŒÙ† Ø¨ÙˆØ¯Ù†</span>
    <span class="function">isAuthenticated</span>() {
        <span class="keyword">return</span> !!localStorage.getItem(<span class="string">'access_token'</span>);
    }
    
    <span class="comment">// Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø±ÙˆÙØ§ÛŒÙ„</span>
    <span class="keyword">async</span> <span class="function">getProfile</span>() {
        <span class="keyword">const</span> response = <span class="keyword">await</span> api.get(<span class="string">'/user/profile/'</span>);
        <span class="keyword">return</span> response.data;
    }
    
    <span class="comment">// ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</span>
    <span class="keyword">async</span> <span class="function">changePassword</span>(oldPassword, newPassword, newPassword2) {
        <span class="keyword">const</span> response = <span class="keyword">await</span> api.put(<span class="string">'/user/change-password/'</span>, {
            old_password: oldPassword,
            new_password: newPassword,
            new_password2: newPassword2,
        });
        <span class="keyword">return</span> response.data;
    }
}

<span class="keyword">export default new</span> <span class="class">AuthService</span>();
            </div>

            <h3>ğŸ”’ Protected Route (React)</h3>

            <div class="code-block" data-lang="JavaScript">
<span class="comment">// components/ProtectedRoute.jsx</span>

<span class="keyword">import</span> { Navigate, useLocation } <span class="keyword">from</span> <span class="string">'react-router-dom'</span>;
<span class="keyword">import</span> authService <span class="keyword">from</span> <span class="string">'../services/authService'</span>;

<span class="keyword">const</span> <span class="function">ProtectedRoute</span> = ({ children }) => {
    <span class="keyword">const</span> location = useLocation();
    
    <span class="keyword">if</span> (!authService.isAuthenticated()) {
        <span class="comment">// Ø°Ø®ÛŒØ±Ù‡ Ù…Ø³ÛŒØ± ÙØ¹Ù„ÛŒ Ø¨Ø±Ø§ÛŒ redirect Ø¨Ø¹Ø¯ Ø§Ø² Ù„Ø§Ú¯ÛŒÙ†</span>
        <span class="keyword">return</span> &lt;Navigate to=<span class="string">"/login"</span> state={{ from: location }} replace /&gt;;
    }
    
    <span class="keyword">return</span> children;
};

<span class="keyword">export default</span> ProtectedRoute;


<span class="comment">// App.jsx - Ø§Ø³ØªÙØ§Ø¯Ù‡</span>
<span class="keyword">import</span> { BrowserRouter, Routes, Route } <span class="keyword">from</span> <span class="string">'react-router-dom'</span>;
<span class="keyword">import</span> ProtectedRoute <span class="keyword">from</span> <span class="string">'./components/ProtectedRoute'</span>;

<span class="keyword">function</span> <span class="function">App</span>() {
    <span class="keyword">return</span> (
        &lt;BrowserRouter&gt;
            &lt;Routes&gt;
                &lt;Route path=<span class="string">"/login"</span> element={&lt;LoginPage /&gt;} /&gt;
                &lt;Route path=<span class="string">"/register"</span> element={&lt;RegisterPage /&gt;} /&gt;
                
                &lt;Route path=<span class="string">"/dashboard"</span> element={
                    &lt;ProtectedRoute&gt;
                        &lt;DashboardPage /&gt;
                    &lt;/ProtectedRoute&gt;
                } /&gt;
                
                &lt;Route path=<span class="string">"/profile"</span> element={
                    &lt;ProtectedRoute&gt;
                        &lt;ProfilePage /&gt;
                    &lt;/ProtectedRoute&gt;
                } /&gt;
            &lt;/Routes&gt;
        &lt;/BrowserRouter&gt;
    );
}
            </div>

            <h3>ğŸª Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± HttpOnly Cookie (Ø§Ù…Ù†â€ŒØªØ±)</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># Django - views.py</span>

<span class="keyword">from</span> rest_framework.response <span class="keyword">import</span> Response
<span class="keyword">from</span> rest_framework_simplejwt.views <span class="keyword">import</span> TokenObtainPairView


<span class="keyword">class</span> <span class="class">CookieTokenObtainPairView</span>(TokenObtainPairView):
    <span class="string">"""Ø°Ø®ÛŒØ±Ù‡ ØªÙˆÚ©Ù† Ø¯Ø± HttpOnly Cookie"""</span>
    
    <span class="keyword">def</span> <span class="function">post</span>(self, request, *args, **kwargs):
        response = <span class="keyword">super</span>().post(request, *args, **kwargs)
        
        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:
            access_token = response.data.get(<span class="string">'access'</span>)
            refresh_token = response.data.get(<span class="string">'refresh'</span>)
            
            <span class="comment"># ØªÙ†Ø¸ÛŒÙ… Cookie Ø¨Ø±Ø§ÛŒ Refresh Token</span>
            response.set_cookie(
                key=<span class="string">'refresh_token'</span>,
                value=refresh_token,
                httponly=<span class="keyword">True</span>,
                secure=<span class="keyword">True</span>,  <span class="comment"># ÙÙ‚Ø· HTTPS</span>
                samesite=<span class="string">'Lax'</span>,
                max_age=<span class="number">7</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span>,  <span class="comment"># 7 Ø±ÙˆØ²</span>
            )
            
            <span class="comment"># Ø­Ø°Ù refresh Ø§Ø² body (ÙÙ‚Ø· access Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†)</span>
            <span class="keyword">del</span> response.data[<span class="string">'refresh'</span>]
        
        <span class="keyword">return</span> response
            </div>

            <div class="warning-box">
                <h4>âš ï¸ Ø§Ù…Ù†ÛŒØª Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ ØªÙˆÚ©Ù†</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Ø±ÙˆØ´</th>
                            <th>XSS</th>
                            <th>CSRF</th>
                            <th>ØªÙˆØµÛŒÙ‡</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>localStorage</td>
                            <td>âŒ Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±</td>
                            <td>âœ… Ø§Ù…Ù†</td>
                            <td>ÙÙ‚Ø· Access Token</td>
                        </tr>
                        <tr>
                            <td>HttpOnly Cookie</td>
                            <td>âœ… Ø§Ù…Ù†</td>
                            <td>âŒ Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±</td>
                            <td>Refresh Token + CSRF Token</td>
                        </tr>
                        <tr>
                            <td>Memory (State)</td>
                            <td>âœ… Ø§Ù…Ù†</td>
                            <td>âœ… Ø§Ù…Ù†</td>
                            <td>Access Token (Ø§Ø² Ø¨ÛŒÙ† Ù…ÛŒâ€ŒØ±ÙˆØ¯ Ø¨Ø§ refresh)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 8: Ø§Ù…Ù†ÛŒØª -->
        <div class="slide" id="security">
            <div class="slide-number">8</div>
            <h2>ğŸ›¡ï¸ Ø§Ù…Ù†ÛŒØª JWT</h2>

            <h3>âš ï¸ Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø±Ø§ÛŒØ¬</h3>

            <div class="grid-2">
                <div class="card">
                    <div class="icon">ğŸ”“</div>
                    <h4>Token Theft</h4>
                    <p>Ø³Ø±Ù‚Øª ØªÙˆÚ©Ù† Ø§Ø² Ø·Ø±ÛŒÙ‚ XSS ÛŒØ§ Ø´Ø¨Ú©Ù‡</p>
                    <ul>
                        <li>Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² HTTPS</li>
                        <li>HttpOnly Cookie</li>
                        <li>Ø¹Ù…Ø± Ú©ÙˆØªØ§Ù‡ Access Token</li>
                    </ul>
                </div>
                <div class="card">
                    <div class="icon">ğŸ”„</div>
                    <h4>Token Replay</h4>
                    <p>Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…Ø¬Ø¯Ø¯ Ø§Ø² ØªÙˆÚ©Ù† Ø³Ø±Ù‚Øªâ€ŒØ´Ø¯Ù‡</p>
                    <ul>
                        <li>Rotate Refresh Tokens</li>
                        <li>Blacklist</li>
                        <li>IP/Device binding</li>
                    </ul>
                </div>
                <div class="card">
                    <div class="icon">ğŸ’‰</div>
                    <h4>Algorithm Confusion</h4>
                    <p>ØªØºÛŒÛŒØ± Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… Ø¨Ù‡ none</p>
                    <ul>
                        <li>Whitelist Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ…â€ŒÙ‡Ø§</li>
                        <li>Ø¨Ø±Ø±Ø³ÛŒ alg Ø¯Ø± header</li>
                    </ul>
                </div>
                <div class="card">
                    <div class="icon">ğŸ”‘</div>
                    <h4>Weak Secret Key</h4>
                    <p>Ú©Ù„ÛŒØ¯ Ø¶Ø¹ÛŒÙ Ù‚Ø§Ø¨Ù„ Ø­Ø¯Ø³</p>
                    <ul>
                        <li>Ú©Ù„ÛŒØ¯ ØªØµØ§Ø¯ÙÛŒ Ø·ÙˆÙ„Ø§Ù†ÛŒ</li>
                        <li>Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² RS256</li>
                    </ul>
                </div>
            </div>

            <h3>ğŸ” ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ù…Ù†ÛŒØªÛŒ Django</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># settings.py - Production Security Settings</span>

<span class="comment"># Ú©Ù„ÛŒØ¯ Ø§Ù…Ù† Ùˆ Ø·ÙˆÙ„Ø§Ù†ÛŒ</span>
SECRET_KEY = os.environ.get(<span class="string">'DJANGO_SECRET_KEY'</span>)

<span class="comment"># JWT Secret Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡</span>
JWT_SECRET_KEY = os.environ.get(<span class="string">'JWT_SECRET_KEY'</span>)

SIMPLE_JWT = {
    <span class="string">'SIGNING_KEY'</span>: JWT_SECRET_KEY,
    <span class="string">'ALGORITHM'</span>: <span class="string">'HS256'</span>,
    
    <span class="comment"># Ø¹Ù…Ø± Ú©ÙˆØªØ§Ù‡</span>
    <span class="string">'ACCESS_TOKEN_LIFETIME'</span>: timedelta(minutes=<span class="number">5</span>),
    <span class="string">'REFRESH_TOKEN_LIFETIME'</span>: timedelta(days=<span class="number">1</span>),
    
    <span class="comment"># Rotate Ùˆ Blacklist</span>
    <span class="string">'ROTATE_REFRESH_TOKENS'</span>: <span class="keyword">True</span>,
    <span class="string">'BLACKLIST_AFTER_ROTATION'</span>: <span class="keyword">True</span>,
}

<span class="comment"># HTTPS Only</span>
SECURE_SSL_REDIRECT = <span class="keyword">True</span>
SESSION_COOKIE_SECURE = <span class="keyword">True</span>
CSRF_COOKIE_SECURE = <span class="keyword">True</span>

<span class="comment"># Security Headers</span>
SECURE_BROWSER_XSS_FILTER = <span class="keyword">True</span>
SECURE_CONTENT_TYPE_NOSNIFF = <span class="keyword">True</span>
X_FRAME_OPTIONS = <span class="string">'DENY'</span>
SECURE_HSTS_SECONDS = <span class="number">31536000</span>  <span class="comment"># 1 Ø³Ø§Ù„</span>
SECURE_HSTS_INCLUDE_SUBDOMAINS = <span class="keyword">True</span>

<span class="comment"># CORS Ù…Ø­Ø¯ÙˆØ¯</span>
CORS_ALLOWED_ORIGINS = [
    <span class="string">"https://yourdomain.com"</span>,
]
CORS_ALLOW_CREDENTIALS = <span class="keyword">True</span>
            </div>

            <h3>ğŸ” Rate Limiting</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># settings.py</span>

REST_FRAMEWORK = {
    <span class="string">'DEFAULT_THROTTLE_CLASSES'</span>: [
        <span class="string">'rest_framework.throttling.AnonRateThrottle'</span>,
        <span class="string">'rest_framework.throttling.UserRateThrottle'</span>,
    ],
    <span class="string">'DEFAULT_THROTTLE_RATES'</span>: {
        <span class="string">'anon'</span>: <span class="string">'100/hour'</span>,
        <span class="string">'user'</span>: <span class="string">'1000/hour'</span>,
        <span class="string">'login'</span>: <span class="string">'5/minute'</span>,  <span class="comment"># Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù„Ø§Ú¯ÛŒÙ†</span>
    }
}
            </div>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/throttles.py</span>

<span class="keyword">from</span> rest_framework.throttling <span class="keyword">import</span> AnonRateThrottle


<span class="keyword">class</span> <span class="class">LoginRateThrottle</span>(AnonRateThrottle):
    <span class="string">"""Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù†Ø±Ø® Ø¨Ø±Ø§ÛŒ Ù„Ø§Ú¯ÛŒÙ†"""</span>
    scope = <span class="string">'login'</span>


<span class="comment"># views.py</span>
<span class="keyword">class</span> <span class="class">CustomTokenObtainPairView</span>(TokenObtainPairView):
    throttle_classes = [LoginRateThrottle]
    serializer_class = CustomTokenObtainPairSerializer
            </div>

            <h3>ğŸ“ Audit Logging</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/signals.py</span>

<span class="keyword">from</span> django.contrib.auth.signals <span class="keyword">import</span> user_logged_in, user_logged_out, user_login_failed
<span class="keyword">from</span> django.dispatch <span class="keyword">import</span> receiver
<span class="keyword">import</span> logging

logger = logging.getLogger(<span class="string">'auth'</span>)


<span class="decorator">@receiver</span>(user_logged_in)
<span class="keyword">def</span> <span class="function">log_user_login</span>(sender, request, user, **kwargs):
    ip = get_client_ip(request)
    logger.info(f<span class="string">'User {user.username} logged in from {ip}'</span>)


<span class="decorator">@receiver</span>(user_login_failed)
<span class="keyword">def</span> <span class="function">log_user_login_failed</span>(sender, credentials, request, **kwargs):
    ip = get_client_ip(request)
    username = credentials.get(<span class="string">'username'</span>, <span class="string">'unknown'</span>)
    logger.warning(f<span class="string">'Failed login attempt for {username} from {ip}'</span>)


<span class="keyword">def</span> <span class="function">get_client_ip</span>(request):
    x_forwarded_for = request.META.get(<span class="string">'HTTP_X_FORWARDED_FOR'</span>)
    <span class="keyword">if</span> x_forwarded_for:
        ip = x_forwarded_for.split(<span class="string">','</span>)[<span class="number">0</span>]
    <span class="keyword">else</span>:
        ip = request.META.get(<span class="string">'REMOTE_ADDR'</span>)
    <span class="keyword">return</span> ip
            </div>

            <h3>ğŸ” Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² RS256 (Ú©Ù„ÛŒØ¯ Ù†Ø§Ù…ØªÙ‚Ø§Ø±Ù†)</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># settings.py - RS256 Configuration</span>

<span class="comment"># ØªÙˆÙ„ÛŒØ¯ Ú©Ù„ÛŒØ¯:</span>
<span class="comment"># openssl genrsa -out private.pem 2048</span>
<span class="comment"># openssl rsa -in private.pem -pubout -out public.pem</span>

<span class="keyword">import</span> os

PRIVATE_KEY_PATH = os.path.join(BASE_DIR, <span class="string">'keys'</span>, <span class="string">'private.pem'</span>)
PUBLIC_KEY_PATH = os.path.join(BASE_DIR, <span class="string">'keys'</span>, <span class="string">'public.pem'</span>)

<span class="keyword">with</span> <span class="builtin">open</span>(PRIVATE_KEY_PATH, <span class="string">'r'</span>) <span class="keyword">as</span> f:
    PRIVATE_KEY = f.read()

<span class="keyword">with</span> <span class="builtin">open</span>(PUBLIC_KEY_PATH, <span class="string">'r'</span>) <span class="keyword">as</span> f:
    PUBLIC_KEY = f.read()

SIMPLE_JWT = {
    <span class="string">'ALGORITHM'</span>: <span class="string">'RS256'</span>,
    <span class="string">'SIGNING_KEY'</span>: PRIVATE_KEY,
    <span class="string">'VERIFYING_KEY'</span>: PUBLIC_KEY,
    <span class="comment"># ...</span>
}
            </div>

            <div class="tip-box">
                <h4>ğŸ’¡ Ù…Ø²ÛŒØª RS256</h4>
                <p>
                    Ø¨Ø§ RS256ØŒ Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ ÙÙ‚Ø· Ø¨Ø§ Ú©Ù„ÛŒØ¯ Ø¹Ù…ÙˆÙ…ÛŒ ØªÙˆÚ©Ù† Ø±Ø§ verify Ú©Ù†Ù†Ø¯ 
                    Ø¨Ø¯ÙˆÙ† Ù†ÛŒØ§Ø² Ø¨Ù‡ Ú©Ù„ÛŒØ¯ Ø®ØµÙˆØµÛŒ. Ø§ÛŒØ¯Ù‡â€ŒØ¢Ù„ Ø¨Ø±Ø§ÛŒ <strong>Microservices</strong>.
                </p>
            </div>
        </div>

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 9: Ø¨Ù‡ØªØ±ÛŒÙ† Ø±ÙˆØ´â€ŒÙ‡Ø§ -->
        <div class="slide" id="best-practices">
            <div class="slide-number">9</div>
            <h2>âœ… Ø¨Ù‡ØªØ±ÛŒÙ† Ø±ÙˆØ´â€ŒÙ‡Ø§</h2>

            <h3>ğŸ“‹ Ú†Ú©â€ŒÙ„ÛŒØ³Øª Ø§Ù…Ù†ÛŒØªÛŒ</h3>

            <div class="grid-2">
                <div class="card">
                    <h4>ğŸ” ØªÙˆÚ©Ù†</h4>
                    <ul>
                        <li>âœ… Ø¹Ù…Ø± Ú©ÙˆØªØ§Ù‡ Access Token (5-15 Ø¯Ù‚ÛŒÙ‚Ù‡)</li>
                        <li>âœ… Rotate Refresh Tokens</li>
                        <li>âœ… Blacklist ØªÙˆÚ©Ù†â€ŒÙ‡Ø§ÛŒ Ù…Ù†Ù‚Ø¶ÛŒ</li>
                        <li>âœ… Ú©Ù„ÛŒØ¯ Ø§Ù…Ø¶Ø§ÛŒ Ù‚ÙˆÛŒ Ùˆ ØªØµØ§Ø¯ÙÛŒ</li>
                        <li>âœ… Ø¨Ø±Ø±Ø³ÛŒ claims Ø¶Ø±ÙˆØ±ÛŒ</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>ğŸŒ Ø§Ù†ØªÙ‚Ø§Ù„</h4>
                    <ul>
                        <li>âœ… Ù‡Ù…ÛŒØ´Ù‡ HTTPS</li>
                        <li>âœ… HttpOnly Cookie Ø¨Ø±Ø§ÛŒ Refresh</li>
                        <li>âœ… CORS Ù…Ø­Ø¯ÙˆØ¯</li>
                        <li>âœ… Security Headers</li>
                        <li>âœ… Rate Limiting</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ</h4>
                    <ul>
                        <li>âœ… Access Ø¯Ø± Memory/localStorage</li>
                        <li>âœ… Refresh Ø¯Ø± HttpOnly Cookie</li>
                        <li>âœ… Ù‡Ø±Ú¯Ø² Ø¯Ø± URL Ù‚Ø±Ø§Ø± Ù†Ø¯Ù‡ÛŒØ¯</li>
                        <li>âœ… Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø¯Ø± logout</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>ğŸ“Š Ù…Ø§Ù†ÛŒØªÙˆØ±ÛŒÙ†Ú¯</h4>
                    <ul>
                        <li>âœ… Ù„Ø§Ú¯ ØªÙ„Ø§Ø´â€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù…ÙˆÙÙ‚</li>
                        <li>âœ… Alert Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„ÛŒØª Ù…Ø´Ú©ÙˆÚ©</li>
                        <li>âœ… Ù…Ø§Ù†ÛŒØªÙˆØ± ØªÙˆÚ©Ù†â€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„</li>
                        <li>âœ… Audit trail</li>
                    </ul>
                </div>
            </div>

            <h3>ğŸ—ï¸ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ</h3>

            <div class="flow-diagram">
                <div class="flow-step">
                    ğŸ“± Client<br>
                    <small>React/Vue/Mobile</small>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    ğŸ”’ API Gateway<br>
                    <small>Rate Limit, CORS</small>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    ğŸ” Auth Service<br>
                    <small>JWT Issue/Verify</small>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    ğŸ“Š API Services<br>
                    <small>Protected Resources</small>
                </div>
            </div>

            <h3>ğŸ“ Ù†Ù…ÙˆÙ†Ù‡ Ú©Ø§Ù…Ù„ Ù¾Ø±ÙˆÚ˜Ù‡</h3>

            <div class="code-block" data-lang="Text">
<span class="comment"># Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø±ÙˆÚ˜Ù‡</span>

myproject/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ settings/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â”œâ”€â”€ development.py
â”‚   â”‚   â””â”€â”€ production.py
â”‚   â”œâ”€â”€ urls.py
â”‚   â””â”€â”€ wsgi.py
â”œâ”€â”€ accounts/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ models.py
â”‚   â”œâ”€â”€ serializers.py
â”‚   â”œâ”€â”€ views.py
â”‚   â”œâ”€â”€ urls.py
â”‚   â”œâ”€â”€ backends.py
â”‚   â”œâ”€â”€ permissions.py
â”‚   â”œâ”€â”€ throttles.py
â”‚   â”œâ”€â”€ signals.py
â”‚   â””â”€â”€ tests/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ test_auth.py
â”‚       â””â”€â”€ test_views.py
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ views.py
â”‚   â””â”€â”€ urls.py
â”œâ”€â”€ keys/
â”‚   â”œâ”€â”€ private.pem
â”‚   â””â”€â”€ public.pem
â”œâ”€â”€ requirements/
â”‚   â”œâ”€â”€ base.txt
â”‚   â”œâ”€â”€ development.txt
â”‚   â””â”€â”€ production.txt
â”œâ”€â”€ manage.py
â””â”€â”€ docker-compose.yml
            </div>

            <h3>ğŸ§ª ØªØ³Øªâ€ŒÙ‡Ø§</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/tests/test_auth.py</span>

<span class="keyword">from</span> django.test <span class="keyword">import</span> TestCase
<span class="keyword">from</span> django.contrib.auth <span class="keyword">import</span> get_user_model
<span class="keyword">from</span> rest_framework.test <span class="keyword">import</span> APIClient
<span class="keyword">from</span> rest_framework <span class="keyword">import</span> status

User = get_user_model()


<span class="keyword">class</span> <span class="class">JWTAuthenticationTest</span>(TestCase):
    <span class="string">"""ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª JWT"""</span>
    
    <span class="keyword">def</span> <span class="function">setUp</span>(self):
        self.client = APIClient()
        self.user = User.objects.create_user(
            username=<span class="string">'testuser'</span>,
            email=<span class="string">'test@example.com'</span>,
            password=<span class="string">'testpass123'</span>
        )
    
    <span class="keyword">def</span> <span class="function">test_login_success</span>(self):
        <span class="string">"""ØªØ³Øª Ù„Ø§Ú¯ÛŒÙ† Ù…ÙˆÙÙ‚"""</span>
        response = self.client.post(<span class="string">'/api/auth/login/'</span>, {
            <span class="string">'username'</span>: <span class="string">'testuser'</span>,
            <span class="string">'password'</span>: <span class="string">'testpass123'</span>
        })
        
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        self.assertIn(<span class="string">'access'</span>, response.data)
        self.assertIn(<span class="string">'refresh'</span>, response.data)
    
    <span class="keyword">def</span> <span class="function">test_login_wrong_password</span>(self):
        <span class="string">"""ØªØ³Øª Ù„Ø§Ú¯ÛŒÙ† Ø¨Ø§ Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡"""</span>
        response = self.client.post(<span class="string">'/api/auth/login/'</span>, {
            <span class="string">'username'</span>: <span class="string">'testuser'</span>,
            <span class="string">'password'</span>: <span class="string">'wrongpass'</span>
        })
        
        self.assertEqual(response.status_code, status.HTTP_401_UNAUTHORIZED)
    
    <span class="keyword">def</span> <span class="function">test_protected_endpoint_without_token</span>(self):
        <span class="string">"""ØªØ³Øª Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ endpoint Ù…Ø­Ø§ÙØ¸Øªâ€ŒØ´Ø¯Ù‡ Ø¨Ø¯ÙˆÙ† ØªÙˆÚ©Ù†"""</span>
        response = self.client.get(<span class="string">'/api/user/profile/'</span>)
        
        self.assertEqual(response.status_code, status.HTTP_401_UNAUTHORIZED)
    
    <span class="keyword">def</span> <span class="function">test_protected_endpoint_with_token</span>(self):
        <span class="string">"""ØªØ³Øª Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ endpoint Ù…Ø­Ø§ÙØ¸Øªâ€ŒØ´Ø¯Ù‡ Ø¨Ø§ ØªÙˆÚ©Ù†"""</span>
        <span class="comment"># Ø¯Ø±ÛŒØ§ÙØª ØªÙˆÚ©Ù†</span>
        login_response = self.client.post(<span class="string">'/api/auth/login/'</span>, {
            <span class="string">'username'</span>: <span class="string">'testuser'</span>,
            <span class="string">'password'</span>: <span class="string">'testpass123'</span>
        })
        token = login_response.data[<span class="string">'access'</span>]
        
        <span class="comment"># Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ø§ ØªÙˆÚ©Ù†</span>
        self.client.credentials(HTTP_AUTHORIZATION=f<span class="string">'Bearer {token}'</span>)
        response = self.client.get(<span class="string">'/api/user/profile/'</span>)
        
        self.assertEqual(response.status_code, status.HTTP_200_OK)
    
    <span class="keyword">def</span> <span class="function">test_token_refresh</span>(self):
        <span class="string">"""ØªØ³Øª refresh ØªÙˆÚ©Ù†"""</span>
        <span class="comment"># Ø¯Ø±ÛŒØ§ÙØª ØªÙˆÚ©Ù†</span>
        login_response = self.client.post(<span class="string">'/api/auth/login/'</span>, {
            <span class="string">'username'</span>: <span class="string">'testuser'</span>,
            <span class="string">'password'</span>: <span class="string">'testpass123'</span>
        })
        refresh_token = login_response.data[<span class="string">'refresh'</span>]
        
        <span class="comment"># Refresh</span>
        response = self.client.post(<span class="string">'/api/auth/token/refresh/'</span>, {
            <span class="string">'refresh'</span>: refresh_token
        })
        
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        self.assertIn(<span class="string">'access'</span>, response.data)
    
    <span class="keyword">def</span> <span class="function">test_logout</span>(self):
        <span class="string">"""ØªØ³Øª Ø®Ø±ÙˆØ¬ Ùˆ blacklist"""</span>
        <span class="comment"># Ù„Ø§Ú¯ÛŒÙ†</span>
        login_response = self.client.post(<span class="string">'/api/auth/login/'</span>, {
            <span class="string">'username'</span>: <span class="string">'testuser'</span>,
            <span class="string">'password'</span>: <span class="string">'testpass123'</span>
        })
        access_token = login_response.data[<span class="string">'access'</span>]
        refresh_token = login_response.data[<span class="string">'refresh'</span>]
        
        <span class="comment"># Logout</span>
        self.client.credentials(HTTP_AUTHORIZATION=f<span class="string">'Bearer {access_token}'</span>)
        logout_response = self.client.post(<span class="string">'/api/auth/logout/'</span>, {
            <span class="string">'refresh'</span>: refresh_token
        })
        
        self.assertEqual(logout_response.status_code, status.HTTP_200_OK)
        
        <span class="comment"># ØªÙ„Ø§Ø´ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² refresh token Ø¨Ø§Ø·Ù„â€ŒØ´Ø¯Ù‡</span>
        refresh_response = self.client.post(<span class="string">'/api/auth/token/refresh/'</span>, {
            <span class="string">'refresh'</span>: refresh_token
        })
        
        self.assertEqual(refresh_response.status_code, status.HTTP_401_UNAUTHORIZED)
            </div>

            <h3>ğŸ“š Ù…Ù†Ø§Ø¨Ø¹ Ø¨ÛŒØ´ØªØ±</h3>

            <div class="grid-2">
                <div class="card">
                    <div class="icon">ğŸ“–</div>
                    <h4>Ù…Ø³ØªÙ†Ø¯Ø§Øª</h4>
                    <ul>
                        <li><a href="https://jwt.io" target="_blank">jwt.io - JWT Debugger</a></li>
                        <li><a href="https://django-rest-framework-simplejwt.readthedocs.io" target="_blank">Simple JWT Docs</a></li>
                        <li><a href="https://www.django-rest-framework.org" target="_blank">DRF Documentation</a></li>
                    </ul>
                </div>
                <div class="card">
                    <div class="icon">ğŸ”’</div>
                    <h4>Ø§Ù…Ù†ÛŒØª</h4>
                    <ul>
                        <li><a href="https://owasp.org/www-project-web-security-testing-guide/" target="_blank">OWASP Testing Guide</a></li>
                        <li><a href="https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_for_Java_Cheat_Sheet.html" target="_blank">JWT Security Cheat Sheet</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 10: Ø®Ù„Ø§ØµÙ‡ -->
        <div class="slide">
            <div class="slide-number">10</div>
            <h2>ğŸ“‹ Ø®Ù„Ø§ØµÙ‡</h2>

            <div class="info-box">
                <h4>ğŸ¯ Ù†Ú©Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ</h4>
                <ul>
                    <li><strong>JWT</strong> ÛŒÚ© Ø±ÙˆØ´ stateless Ø¨Ø±Ø§ÛŒ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø§Ø³Øª</li>
                    <li>Ø§Ø² <strong>Access Token</strong> Ú©ÙˆØªØ§Ù‡â€ŒØ¹Ù…Ø± Ùˆ <strong>Refresh Token</strong> Ø·ÙˆÙ„Ø§Ù†ÛŒâ€ŒØ¹Ù…Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                    <li><strong>Simple JWT</strong> Ø¨Ù‡ØªØ±ÛŒÙ† Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ø¨Ø±Ø§ÛŒ Django Ø§Ø³Øª</li>
                    <li>Ù‡Ù…ÛŒØ´Ù‡ Ø§Ø² <strong>HTTPS</strong> Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                    <li><strong>Blacklist</strong> Ø±Ø§ Ø¨Ø±Ø§ÛŒ logout ÙØ¹Ø§Ù„ Ú©Ù†ÛŒØ¯</li>
                    <li>ØªÙˆÚ©Ù†â€ŒÙ‡Ø§ Ø±Ø§ <strong>Rotate</strong> Ú©Ù†ÛŒØ¯</li>
                </ul>
            </div>

            <h3>ğŸš€ Ù…Ø±Ø§Ø­Ù„ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ</h3>

            <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-content">
                    <h4>Ù†ØµØ¨ Ù¾Ú©ÛŒØ¬â€ŒÙ‡Ø§</h4>
                    <p><code class="code-inline">pip install djangorestframework-simplejwt</code></p>
                </div>
            </div>

            <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-content">
                    <h4>ØªÙ†Ø¸ÛŒÙ…Ø§Øª settings.py</h4>
                    <p>Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ INSTALLED_APPS Ùˆ REST_FRAMEWORK</p>
                </div>
            </div>

            <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-content">
                    ```html
>]
            token = RefreshToken(refresh_token)
            token.blacklist()
            
            <span class="keyword">return</span> Response({
                <span class="string">'message'</span>: <span class="string">'Ø®Ø±ÙˆØ¬ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯.'</span>
            }, status=status.HTTP_205_RESET_CONTENT)
        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
            <span class="keyword">return</span> Response({
                <span class="string">'error'</span>: str(e)
            }, status=status.HTTP_400_BAD_REQUEST)


<span class="keyword">class</span> <span class="class">UserProfileView</span>(generics.RetrieveUpdateAPIView):
    <span class="string">"""View Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ùˆ ÙˆÛŒØ±Ø§ÛŒØ´ Ù¾Ø±ÙˆÙØ§ÛŒÙ„"""</span>
    
    serializer_class = UserSerializer
    permission_classes = (permissions.IsAuthenticated,)
    
    <span class="keyword">def</span> <span class="function">get_object</span>(self):
        <span class="keyword">return</span> self.request.user


<span class="keyword">class</span> <span class="class">ChangePasswordView</span>(generics.UpdateAPIView):
    <span class="string">"""View Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±"""</span>
    
    serializer_class = ChangePasswordSerializer
    permission_classes = (permissions.IsAuthenticated,)
    
    <span class="keyword">def</span> <span class="function">get_object</span>(self):
        <span class="keyword">return</span> self.request.user
    
    <span class="keyword">def</span> <span class="function">update</span>(self, request, *args, **kwargs):
        user = self.get_object()
        serializer = self.get_serializer(data=request.data)
        serializer.is_valid(raise_exception=<span class="keyword">True</span>)
        
        <span class="comment"># Ø¨Ø±Ø±Ø³ÛŒ Ø±Ù…Ø² Ù‚Ø¯ÛŒÙ…ÛŒ</span>
        <span class="keyword">if</span> <span class="keyword">not</span> user.check_password(serializer.data.get(<span class="string">'old_password'</span>)):
            <span class="keyword">return</span> Response({
                <span class="string">'old_password'</span>: <span class="string">'Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± ÙØ¹Ù„ÛŒ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª.'</span>
            }, status=status.HTTP_400_BAD_REQUEST)
        
        <span class="comment"># ØªÙ†Ø¸ÛŒÙ… Ø±Ù…Ø² Ø¬Ø¯ÛŒØ¯</span>
        user.set_password(serializer.data.get(<span class="string">'new_password'</span>))
        user.save()
        
        <span class="keyword">return</span> Response({
            <span class="string">'message'</span>: <span class="string">'Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªØºÛŒÛŒØ± Ú©Ø±Ø¯.'</span>
        }, status=status.HTTP_200_OK)


<span class="keyword">class</span> <span class="class">LogoutAllView</span>(APIView):
    <span class="string">"""Ø®Ø±ÙˆØ¬ Ø§Ø² Ù‡Ù…Ù‡ Ø¯Ø³ØªÚ¯Ø§Ù‡â€ŒÙ‡Ø§"""</span>
    
    permission_classes = (permissions.IsAuthenticated,)
    
    <span class="keyword">def</span> <span class="function">post</span>(self, request):
        <span class="keyword">from</span> rest_framework_simplejwt.token_blacklist.models <span class="keyword">import</span> OutstandingToken, BlacklistedToken
        
        tokens = OutstandingToken.objects.filter(user_id=request.user.id)
        <span class="keyword">for</span> token <span class="keyword">in</span> tokens:
            t, _ = BlacklistedToken.objects.get_or_create(token=token)
        
        <span class="keyword">return</span> Response({
            <span class="string">'message'</span>: <span class="string">'Ø§Ø² Ù‡Ù…Ù‡ Ø¯Ø³ØªÚ¯Ø§Ù‡â€ŒÙ‡Ø§ Ø®Ø§Ø±Ø¬ Ø´Ø¯ÛŒØ¯.'</span>
        }, status=status.HTTP_205_RESET_CONTENT)
            </div>

            <h3>ğŸ”— URLs</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/urls.py</span>

<span class="keyword">from</span> django.urls <span class="keyword">import</span> path
<span class="keyword">from</span> rest_framework_simplejwt.views <span class="keyword">import</span> TokenRefreshView, TokenVerifyView
<span class="keyword">from</span> .views <span class="keyword">import</span> (
    CustomTokenObtainPairView,
    RegisterView,
    LogoutView,
    LogoutAllView,
    UserProfileView,
    ChangePasswordView,
)

urlpatterns = [
    <span class="comment"># Authentication</span>
    path(<span class="string">'auth/login/'</span>, CustomTokenObtainPairView.as_view(), name=<span class="string">'login'</span>),
    path(<span class="string">'auth/refresh/'</span>, TokenRefreshView.as_view(), name=<span class="string">'token_refresh'</span>),
    path(<span class="string">'auth/verify/'</span>, TokenVerifyView.as_view(), name=<span class="string">'token_verify'</span>),
    path(<span class="string">'auth/register/'</span>, RegisterView.as_view(), name=<span class="string">'register'</span>),
    path(<span class="string">'auth/logout/'</span>, LogoutView.as_view(), name=<span class="string">'logout'</span>),
    path(<span class="string">'auth/logout-all/'</span>, LogoutAllView.as_view(), name=<span class="string">'logout_all'</span>),
    
    <span class="comment"># User</span>
    path(<span class="string">'user/profile/'</span>, UserProfileView.as_view(), name=<span class="string">'profile'</span>),
    path(<span class="string">'user/change-password/'</span>, ChangePasswordView.as_view(), name=<span class="string">'change_password'</span>),
]
            </div>

            <h3>ğŸ“¡ Ø®Ù„Ø§ØµÙ‡ Endpoints</h3>

            <div class="api-endpoint">
                <span class="api-method post">POST</span>
                <span class="api-url">/api/auth/register/</span>
                <span style="color: #888; margin-right: auto;">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯</span>
            </div>

            <div class="api-endpoint">
                <span class="api-method post">POST</span>
                <span class="api-url">/api/auth/login/</span>
                <span style="color: #888; margin-right: auto;">ÙˆØ±ÙˆØ¯ Ùˆ Ø¯Ø±ÛŒØ§ÙØª ØªÙˆÚ©Ù†</span>
            </div>

            <div class="api-endpoint">
                <span class="api-method post">POST</span>
                <span class="api-url">/api/auth/refresh/</span>
                <span style="color: #888; margin-right: auto;">ØªÙ…Ø¯ÛŒØ¯ ØªÙˆÚ©Ù†</span>
            </div>

            <div class="api-endpoint">
                <span class="api-method post">POST</span>
                <span class="api-url">/api/auth/logout/</span>
                <span style="color: #888; margin-right: auto;">Ø®Ø±ÙˆØ¬</span>
            </div>

            <div class="api-endpoint">
                <span class="api-method get">GET</span>
                <span class="api-url">/api/user/profile/</span>
                <span style="color: #888; margin-right: auto;">Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø±ÙˆÙØ§ÛŒÙ„</span>
            </div>

            <div class="api-endpoint">
                <span class="api-method put">PUT</span>
                <span class="api-url">/api/user/change-password/</span>
                <span style="color: #888; margin-right: auto;">ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</span>
            </div>
        </div>

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 6: Ø³ÙØ§Ø±Ø´ÛŒâ€ŒØ³Ø§Ø²ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ -->
        <div class="slide" id="custom">
            <div class="slide-number">6</div>
            <h2>âš¡ Ø³ÙØ§Ø±Ø´ÛŒâ€ŒØ³Ø§Ø²ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</h2>

            <h3>ğŸ‘¤ Ù…Ø¯Ù„ Ú©Ø§Ø±Ø¨Ø± Ø³ÙØ§Ø±Ø´ÛŒ</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/models.py</span>

<span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> AbstractUser
<span class="keyword">from</span> django.db <span class="keyword">import</span> models


<span class="keyword">class</span> <span class="class">CustomUser</span>(AbstractUser):
    <span class="string">"""Ù…Ø¯Ù„ Ú©Ø§Ø±Ø¨Ø± Ø³ÙØ§Ø±Ø´ÛŒ"""</span>
    
    email = models.EmailField(unique=<span class="keyword">True</span>)
    phone = models.CharField(max_length=<span class="number">15</span>, blank=<span class="keyword">True</span>, null=<span class="keyword">True</span>)
    avatar = models.ImageField(upload_to=<span class="string">'avatars/'</span>, blank=<span class="keyword">True</span>, null=<span class="keyword">True</span>)
    bio = models.TextField(blank=<span class="keyword">True</span>)
    is_verified = models.BooleanField(default=<span class="keyword">False</span>)
    
    <span class="comment"># Ù„Ø§Ú¯ÛŒÙ† Ø¨Ø§ Ø§ÛŒÙ…ÛŒÙ„</span>
    USERNAME_FIELD = <span class="string">'email'</span>
    REQUIRED_FIELDS = [<span class="string">'username'</span>]
    
    <span class="keyword">class</span> <span class="class">Meta</span>:
        verbose_name = <span class="string">'Ú©Ø§Ø±Ø¨Ø±'</span>
        verbose_name_plural = <span class="string">'Ú©Ø§Ø±Ø¨Ø±Ø§Ù†'</span>
    
    <span class="keyword">def</span> <span class="function">__str__</span>(self):
        <span class="keyword">return</span> self.email
            </div>

            <div class="code-block" data-lang="Python">
<span class="comment"># settings.py</span>

AUTH_USER_MODEL = <span class="string">'accounts.CustomUser'</span>
            </div>

            <h3>ğŸ« ØªÙˆÚ©Ù† Ø³ÙØ§Ø±Ø´ÛŒ Ø¨Ø§ Claims Ø§Ø¶Ø§ÙÛŒ</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/tokens.py</span>

<span class="keyword">from</span> rest_framework_simplejwt.tokens <span class="keyword">import</span> RefreshToken


<span class="keyword">class</span> <span class="class">CustomRefreshToken</span>(RefreshToken):
    <span class="string">"""ØªÙˆÚ©Ù† Ø³ÙØ§Ø±Ø´ÛŒ Ø¨Ø§ claims Ø§Ø¶Ø§ÙÛŒ"""</span>
    
    <span class="decorator">@classmethod</span>
    <span class="keyword">def</span> <span class="function">for_user</span>(cls, user):
        token = <span class="keyword">super</span>().for_user(user)
        
        <span class="comment"># Ø§ÙØ²ÙˆØ¯Ù† claims Ø³ÙØ§Ø±Ø´ÛŒ</span>
        token[<span class="string">'username'</span>] = user.username
        token[<span class="string">'email'</span>] = user.email
        token[<span class="string">'is_staff'</span>] = user.is_staff
        token[<span class="string">'is_verified'</span>] = getattr(user, <span class="string">'is_verified'</span>, <span class="keyword">False</span>)
        
        <span class="comment"># Ø§ÙØ²ÙˆØ¯Ù† permissions</span>
        token[<span class="string">'permissions'</span>] = list(user.get_all_permissions())
        
        <span class="comment"># Ø§ÙØ²ÙˆØ¯Ù† groups</span>
        token[<span class="string">'groups'</span>] = list(user.groups.values_list(<span class="string">'name'</span>, flat=<span class="keyword">True</span>))
        
        <span class="keyword">return</span> token


<span class="keyword">def</span> <span class="function">get_tokens_for_user</span>(user):
    <span class="string">"""ØªÙˆÙ„ÛŒØ¯ ØªÙˆÚ©Ù†â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±"""</span>
    refresh = CustomRefreshToken.for_user(user)
    
    <span class="keyword">return</span> {
        <span class="string">'refresh'</span>: str(refresh),
        <span class="string">'access'</span>: str(refresh.access_token),
    }
            </div>

            <h3>ğŸ”’ Permission Ù‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/permissions.py</span>

<span class="keyword">from</span> rest_framework <span class="keyword">import</span> permissions


<span class="keyword">class</span> <span class="class">IsVerifiedUser</span>(permissions.BasePermission):
    <span class="string">"""ÙÙ‚Ø· Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù‡"""</span>
    
    message = <span class="string">'Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø´Ù…Ø§ ØªØ£ÛŒÛŒØ¯ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.'</span>
    
    <span class="keyword">def</span> <span class="function">has_permission</span>(self, request, view):
        <span class="keyword">return</span> (
            request.user <span class="keyword">and</span>
            request.user.is_authenticated <span class="keyword">and</span>
            getattr(request.user, <span class="string">'is_verified'</span>, <span class="keyword">False</span>)
        )


<span class="keyword">class</span> <span class="class">IsOwnerOrReadOnly</span>(permissions.BasePermission):
    <span class="string">"""Ù…Ø§Ù„Ú© Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ ÙˆÛŒØ±Ø§ÛŒØ´ Ú©Ù†Ø¯ØŒ Ø¨Ù‚ÛŒÙ‡ ÙÙ‚Ø· Ø®ÙˆØ§Ù†Ø¯Ù†"""</span>
    
    <span class="keyword">def</span> <span class="function">has_object_permission</span>(self, request, view, obj):
        <span class="keyword">if</span> request.method <span class="keyword">in</span> permissions.SAFE_METHODS:
            <span class="keyword">return</span> <span class="keyword">True</span>
        <span class="keyword">return</span> obj.user == request.user


<span class="keyword">class</span> <span class="class">HasGroupPermission</span>(permissions.BasePermission):
    <span class="string">"""Ø¨Ø±Ø±Ø³ÛŒ Ø¹Ø¶ÙˆÛŒØª Ø¯Ø± Ú¯Ø±ÙˆÙ‡ Ø®Ø§Øµ"""</span>
    
    <span class="keyword">def</span> <span class="function">has_permission</span>(self, request, view):
        required_groups = getattr(view, <span class="string">'required_groups'</span>, [])
        
        <span class="keyword">if</span> <span class="keyword">not</span> required_groups:
            <span class="keyword">return</span> <span class="keyword">True</span>
        
        user_groups = request.user.groups.values_list(<span class="string">'name'</span>, flat=<span class="keyword">True</span>)
        <span class="keyword">return</span> <span class="keyword">any</span>(group <span class="keyword">in</span> user_groups <span class="keyword">for</span> group <span class="keyword">in</span> required_groups)
            </div>

            <h3>ğŸ¨ Middleware Ø³ÙØ§Ø±Ø´ÛŒ</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/middleware.py</span>

<span class="keyword">from</span> django.utils <span class="keyword">import</span> timezone
<span class="keyword">from</span> rest_framework_simplejwt.authentication <span class="keyword">import</span> JWTAuthentication


<span class="keyword">class</span> <span class="class">UpdateLastActivityMiddleware</span>:
    <span class="string">"""Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ø®Ø±ÛŒÙ† ÙØ¹Ø§Ù„ÛŒØª Ú©Ø§Ø±Ø¨Ø±"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(self, get_response):
        self.get_response = get_response
    
    <span class="keyword">def</span> <span class="function">__call__</span>(self, request):
        response = self.get_response(request)
        
        <span class="keyword">if</span> request.user.is_authenticated:
            <span class="comment"># Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ last_activity (Ø§Ú¯Ø± ÙÛŒÙ„Ø¯ Ø¯Ø§Ø±ÛŒØ¯)</span>
            <span class="keyword">try</span>:
                request.user.last_activity = timezone.now()
                request.user.save(update_fields=[<span class="string">'last_activity'</span>])
            <span class="keyword">except</span>:
                <span class="keyword">pass</span>
        
        <span class="keyword">return</span> response


<span class="keyword">class</span> <span class="class">JWTAuthenticationMiddleware</span>:
    <span class="string">"""ØªÙ†Ø¸ÛŒÙ… user Ø§Ø² JWT Ø¯Ø± request"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(self, get_response):
        self.get_response = get_response
        self.jwt_auth = JWTAuthentication()
    
    <span class="keyword">def</span> <span class="function">__call__</span>(self, request):
        <span class="keyword">try</span>:
            auth_result = self.jwt_auth.authenticate(request)
            <span class="keyword">if</span> auth_result:
                request.user, request.auth = auth_result
        <span class="keyword">except</span>:
            <span class="keyword">pass</span>
        
        <span class="keyword">return</span> self.get_response(request)
            </div>

            <h3>ğŸ“§ Ø§Ø±Ø³Ø§Ù„ Ø§ÛŒÙ…ÛŒÙ„ ØªØ£ÛŒÛŒØ¯</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/utils.py</span>

<span class="keyword">from</span> django.core.mail <span class="keyword">import</span> send_mail
<span class="keyword">from</span> django.template.loader <span class="keyword">import</span> render_to_string
<span class="keyword">from</span> django.utils.http <span class="keyword">import</span> urlsafe_base64_encode
<span class="keyword">from</span> django.utils.encoding <span class="keyword">import</span> force_bytes
<span class="keyword">from</span> django.contrib.auth.tokens <span class="keyword">import</span> default_token_generator
<span class="keyword">from</span> django.conf <span class="keyword">import</span> settings


<span class="keyword">def</span> <span class="function">send_verification_email</span>(user, request):
    <span class="string">"""Ø§Ø±Ø³Ø§Ù„ Ø§ÛŒÙ…ÛŒÙ„ ØªØ£ÛŒÛŒØ¯ Ø­Ø³Ø§Ø¨"""</span>
    
    token = default_token_generator.make_token(user)
    uid = urlsafe_base64_encode(force_bytes(user.pk))
    
    verification_url = f<span class="string">"{settings.FRONTEND_URL}/verify-email/{uid}/{token}/"</span>
    
    subject = <span class="string">'ØªØ£ÛŒÛŒØ¯ Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ'</span>
    message = render_to_string(<span class="string">'emails/verify_email.html'</span>, {
        <span class="string">'user'</span>: user,
        <span class="string">'verification_url'</span>: verification_url,
    })
    
    send_mail(
        subject,
        message,
        settings.DEFAULT_FROM_EMAIL,
        [user.email],
        html_message=message,
        fail_silently=<span class="keyword">False</span>,
    )


<span class="keyword">def</span> <span class="function">send_password_reset_email</span>(user):
    <span class="string">"""Ø§Ø±Ø³Ø§Ù„ Ø§ÛŒÙ…ÛŒÙ„ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±"""</span>
    
    token = default_token_generator.make_token(user)
    uid = urlsafe_base64_encode(force_bytes(user.pk))
    
    reset_url = f<span class="string">"{settings.FRONTEND_URL}/reset-password/{uid}/{token}/"</span>
    
    subject = <span class="string">'Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±'</span>
    message = render_to_string(<span class="string">'emails/reset_password.html'</span>, {
        <span class="string">'user'</span>: user,
        <span class="string">'reset_url'</span>: reset_url,
    })
    
    send_mail(
        subject,
        message,
        settings.DEFAULT_FROM_EMAIL,
        [user.email],
        html_message=message,
        fail_silently=<span class="keyword">False</span>,
    )
            </div>
        </div>

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 7: Frontend Integration -->
        <div class="slide" id="frontend">
            <div class="slide-number">7</div>
            <h2>ğŸŒ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Frontend</h2>

            <h3>âš›ï¸ React Ø¨Ø§ Axios</h3>

            <div class="code-block" data-lang="JavaScript">
<span class="comment">// services/api.js</span>

<span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;

<span class="keyword">const</span> API_URL = <span class="string">'http://localhost:8000/api'</span>;

<span class="comment">// Ø§ÛŒØ¬Ø§Ø¯ instance Ø§Ø² axios</span>
<span class="keyword">const</span> api = axios.create({
    baseURL: API_URL,
    headers: {
        <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span>,
    },
});

<span class="comment">// Interceptor Ø¨Ø±Ø§ÛŒ Ø§ÙØ²ÙˆØ¯Ù† ØªÙˆÚ©Ù† Ø¨Ù‡ Ù‡Ù…Ù‡ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§</span>
api.interceptors.request.use(
    (config) => {
        <span class="keyword">const</span> token = localStorage.getItem(<span class="string">'access_token'</span>);
        <span class="keyword">if</span> (token) {
            config.headers.Authorization = <span class="string">`Bearer <span class="keyword">${</span>token<span class="keyword">}</span>`</span>;
        }
        <span class="keyword">return</span> config;
    },
    (error) => {
        <span class="keyword">return</span> Promise.reject(error);
    }
);

<span class="comment">// Interceptor Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§ÛŒ 401 Ùˆ refresh token</span>
api.interceptors.response.use(
    (response) => response,
    <span class="keyword">async</span> (error) => {
        <span class="keyword">const</span> originalRequest = error.config;
        
        <span class="keyword">if</span> (error.response?.status === <span class="number">401</span> && !originalRequest._retry) {
            originalRequest._retry = <span class="keyword">true</span>;
            
            <span class="keyword">try</span> {
                <span class="keyword">const</span> refreshToken = localStorage.getItem(<span class="string">'refresh_token'</span>);
                <span class="keyword">const</span> response = <span class="keyword">await</span> axios.post(<span class="string">`<span class="keyword">${</span>API_URL<span class="keyword">}</span>/auth/refresh/`</span>, {
                    refresh: refreshToken
                });
                
                <span class="keyword">const</span> { access } = response.data;
                localStorage.setItem(<span class="string">'access_token'</span>, access);
                
                originalRequest.headers.Authorization = <span class="string">`Bearer <span class="keyword">${</span>access<span class="keyword">}</span>`</span>;
                <span class="keyword">return</span> api(originalRequest);
            } <span class="keyword">catch</span> (refreshError) {
                <span class="comment">// Refresh token Ù‡Ù… Ù…Ù†Ù‚Ø¶ÛŒ Ø´Ø¯Ù‡ - logout</span>
                localStorage.removeItem(<span class="string">'access_token'</span>);
                localStorage.removeItem(<span class="string">'refresh_token'</span>);
                window.location.href = <span class="string">'/login'</span>;
                <span class="keyword">return</span> Promise.reject(refreshError);
            }
        }
        
        <span class="keyword">return</span> Promise.reject(error);
    }
);

<span class="keyword">export default</span> api;
            </div>

            <h3>ğŸ” Auth Service</h3>

            <div class="code-block" data-lang="JavaScript">
<span class="comment">// services/authService.js</span>

<span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">'./api'</span>;

<span class="keyword">const</span> authService = {
    <span class="comment">// ÙˆØ±ÙˆØ¯</span>
    <span class="keyword">async</span> <span class="function">login</span>(email, password) {
        <span class="keyword">const</span> response = <span class="keyword">await</span> api.post(<span class="string">'/auth/login/'</span>, { email, password });
        
        <span class="keyword">if</span> (response.data.access) {
            localStorage.setItem(<span class="string">'access_token'</span>, response.data.access);
            localStorage.setItem(<span class="string">'refresh_token'</span>, response.data.refresh);
            localStorage.setItem(<span class="string">'user'</span>, JSON.stringify(response.data.user));
        }
        
        <span class="keyword">return</span> response.data;
    },
    
    <span class="comment">// Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</span>
    <span class="keyword">async</span> <span class="function">register</span>(userData) {
        <span class="keyword">const</span> response = <span class="keyword">await</span> api.post(<span class="string">'/auth/register/'</span>, userData);
        
        <span class="keyword">if</span> (response.data.access) {
            localStorage.setItem(<span class="string">'access_token'</span>, response.data.access);
            localStorage.setItem(<span class="string">'refresh_token'</span>, response.data.refresh);
            localStorage.setItem(<span class="string">'user'</span>, JSON.stringify(response.data.user));
        }
        
        <span class="keyword">return</span> response.data;
    },
    
    <span class="comment">// Ø®Ø±ÙˆØ¬</span>
    <span class="keyword">async</span> <span class="function">logout</span>() {
        <span class="keyword">try</span> {
            <span class="keyword">const</span> refreshToken = localStorage.getItem(<span class="string">'refresh_token'</span>);
            <span class="keyword">await</span> api.post(<span class="string">'/auth/logout/'</span>, { refresh: refreshToken });
        } <span class="keyword">catch</span> (error) {
            console.error(<span class="string">'Logout error:'</span>, error);
        } <span class="keyword">finally</span> {
            localStorage.removeItem(<span class="string">'access_token'</span>);
            localStorage.removeItem(<span class="string">'refresh_token'</span>);
            localStorage.removeItem(<span class="string">'user'</span>);
        }
    },
    
    <span class="comment">// Ø¯Ø±ÛŒØ§ÙØª Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ù„ÛŒ</span>
    <span class="function">getCurrentUser</span>() {
        <span class="keyword">const</span> user = localStorage.getItem(<span class="string">'user'</span>);
        <span class="keyword">return</span> user ? JSON.parse(user) : <span class="keyword">null</span>;
    },
    
    <span class="comment">// Ø¨Ø±Ø±Ø³ÛŒ Ù„Ø§Ú¯ÛŒÙ† Ø¨ÙˆØ¯Ù†</span>
    <span class="function">isAuthenticated</span>() {
        <span class="keyword">return</span> !!localStorage.getItem(<span class="string">'access_token'</span>);
    },
    
    <span class="comment">// Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø±ÙˆÙØ§ÛŒÙ„</span>
    <span class="keyword">async</span> <span class="function">getProfile</span>() {
        <span class="keyword">const</span> response = <span class="keyword">await</span> api.get(<span class="string">'/user/profile/'</span>);
        <span class="keyword">return</span> response.data;
    },
    
    <span class="comment">// Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù¾Ø±ÙˆÙØ§ÛŒÙ„</span>
    <span class="keyword">async</span> <span class="function">updateProfile</span>(data) {
        <span class="keyword">const</span> response = <span class="keyword">await</span> api.patch(<span class="string">'/user/profile/'</span>, data);
        localStorage.setItem(<span class="string">'user'</span>, JSON.stringify(response.data));
        <span class="keyword">return</span> response.data;
    },
    
    <span class="comment">// ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</span>
    <span class="keyword">async</span> <span class="function">changePassword</span>(oldPassword, newPassword, newPassword2) {
        <span class="keyword">const</span> response = <span class="keyword">await</span> api.put(<span class="string">'/user/change-password/'</span>, {
            old_password: oldPassword,
            new_password: newPassword,
            new_password2: newPassword2
        });
        <span class="keyword">return</span> response.data;
    }
};

<span class="keyword">export default</span> authService;
            </div>

            <h3>ğŸ£ React Hook</h3>

            <div class="code-block" data-lang="JavaScript">
<span class="comment">// hooks/useAuth.js</span>

<span class="keyword">import</span> { useState, useEffect, createContext, useContext } <span class="keyword">from</span> <span class="string">'react'</span>;
<span class="keyword">import</span> authService <span class="keyword">from</span> <span class="string">'../services/authService'</span>;

<span class="keyword">const</span> AuthContext = createContext(<span class="keyword">null</span>);

<span class="keyword">export const</span> <span class="function">AuthProvider</span> = ({ children }) => {
    <span class="keyword">const</span> [user, setUser] = useState(<span class="keyword">null</span>);
    <span class="keyword">const</span> [loading, setLoading] = useState(<span class="keyword">true</span>);
    
    useEffect(() => {
        <span class="keyword">const</span> currentUser = authService.getCurrentUser();
        <span class="keyword">if</span> (currentUser) {
            setUser(currentUser);
        }
        setLoading(<span class="keyword">false</span>);
    }, []);
    
    <span class="keyword">const</span> <span class="function">login</span> = <span class="keyword">async</span> (email, password) => {
        <span class="keyword">const</span> data = <span class="keyword">await</span> authService.login(email, password);
        setUser(data.user);
        <span class="keyword">return</span> data;
    };
    
    <span class="keyword">const</span> <span class="function">register</span> = <span class="keyword">async</span> (userData) => {
        <span class="keyword">const</span> data = <span class="keyword">await</span> authService.register(userData);
        setUser(data.user);
        <span class="keyword">return</span> data;
    };
    
    <span class="keyword">const</span> <span class="function">logout</span> = <span class="keyword">async</span> () => {
        <span class="keyword">await</span> authService.logout();
        setUser(<span class="keyword">null</span>);
    };
    
    <span class="keyword">const</span> value = {
        user,
        loading,
        login,
        register,
        logout,
        isAuthenticated: !!user
    };
    
    <span class="keyword">return</span> (
        &lt;AuthContext.Provider value={value}&gt;
            {!loading && children}
        &lt;/AuthContext.Provider&gt;
    );
};

<span class="keyword">export const</span> <span class="function">useAuth</span> = () => {
    <span class="keyword">const</span> context = useContext(AuthContext);
    <span class="keyword">if</span> (!context) {
        <span class="keyword">throw new</span> Error(<span class="string">'useAuth must be used within AuthProvider'</span>);
    }
    <span class="keyword">return</span> context;
};
            </div>

            <h3>ğŸ›¡ï¸ Protected Route</h3>

            <div class="code-block" data-lang="JavaScript">
<span class="comment">// components/ProtectedRoute.js</span>

<span class="keyword">import</span> { Navigate, useLocation } <span class="keyword">from</span> <span class="string">'react-router-dom'</span>;
<span class="keyword">import</span> { useAuth } <span class="keyword">from</span> <span class="string">'../hooks/useAuth'</span>;

<span class="keyword">const</span> <span class="function">ProtectedRoute</span> = ({ children }) => {
    <span class="keyword">const</span> { isAuthenticated } = useAuth();
    <span class="keyword">const</span> location = useLocation();
    
    <span class="keyword">if</span> (!isAuthenticated) {
        <span class="keyword">return</span> &lt;Navigate to=<span class="string">"/login"</span> state={{ from: location }} replace /&gt;;
    }
    
    <span class="keyword">return</span> children;
};

<span class="keyword">export default</span> ProtectedRoute;
            </div>

            <div class="tip-box">
                <h4>ğŸ’¡ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø§Ù…Ù† ØªÙˆÚ©Ù†</h4>
                <ul>
                    <li><strong>localStorage:</strong> Ø³Ø§Ø¯Ù‡ Ø§Ù…Ø§ Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ± Ø¨Ù‡ XSS</li>
                    <li><strong>HttpOnly Cookie:</strong> Ø§Ù…Ù†â€ŒØªØ±ØŒ Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªÙ†Ø¸ÛŒÙ… Ø³Ø±ÙˆØ±</li>
                    <li><strong>Memory:</strong> Ø§Ù…Ù†â€ŒØªØ±ÛŒÙ†ØŒ Ø§Ù…Ø§ Ø¨Ø§ refresh Ø§Ø² Ø¯Ø³Øª Ù…ÛŒâ€ŒØ±ÙˆØ¯</li>
                </ul>
            </div>
        </div>

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 8: Ø§Ù…Ù†ÛŒØª -->
        <div class="slide" id="security">
            <div class="slide-number">8</div>
            <h2>ğŸ›¡ï¸ Ø§Ù…Ù†ÛŒØª JWT</h2>

            <h3>âš ï¸ Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø±Ø§ÛŒØ¬</h3>

            <div class="grid-2">
                <div class="card">
                    <div class="icon">ğŸ”“</div>
                    <h4>XSS (Cross-Site Scripting)</h4>
                    <p>Ø§Ú¯Ø± ØªÙˆÚ©Ù† Ø¯Ø± localStorage Ø¨Ø§Ø´Ø¯ØŒ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù…Ø®Ø±Ø¨ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¢Ù† Ø±Ø§ Ø¨Ø®ÙˆØ§Ù†Ø¯.</p>
                </div>
                <div class="card">
                    <div class="icon">ğŸ­</div>
                    <h4>CSRF (Cross-Site Request Forgery)</h4>
                    <p>Ø§Ú¯Ø± ØªÙˆÚ©Ù† Ø¯Ø± Cookie Ø¨Ø§Ø´Ø¯ØŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¬Ø¹Ù„ÛŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø§Ø±Ø³Ø§Ù„ Ø´ÙˆØ¯.</p>
                </div>
                <div class="card">
                    <div class="icon">ğŸ•</div>
                    <h4>Token Theft</h4>
                    <p>Ø³Ø±Ù‚Øª ØªÙˆÚ©Ù† Ø§Ø² Ø´Ø¨Ú©Ù‡ ÛŒØ§ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ú©Ø§Ø±Ø¨Ø±.</p>
                </div>
                <div class="card">
                    <div class="icon">ğŸ”„</div>
                    <h4>Token Replay</h4>
                    <p>Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…Ø¬Ø¯Ø¯ Ø§Ø² ØªÙˆÚ©Ù† Ø³Ø±Ù‚Øª Ø´Ø¯Ù‡.</p>
                </div>
            </div>

            <h3>ğŸ” Ø±Ø§Ù‡â€ŒØ­Ù„â€ŒÙ‡Ø§ÛŒ Ø§Ù…Ù†ÛŒØªÛŒ</h3>

            <h4>1ï¸âƒ£ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² HttpOnly Cookie</h4>

            <div class="code-block" data-lang="Python">
<span class="comment"># settings.py</span>

<span class="comment"># ØªÙ†Ø¸ÛŒÙ…Ø§Øª Cookie</span>
SIMPLE_JWT = {
    <span class="comment"># ... Ø³Ø§ÛŒØ± ØªÙ†Ø¸ÛŒÙ…Ø§Øª</span>
    <span class="string">'AUTH_COOKIE'</span>: <span class="string">'access_token'</span>,
    <span class="string">'AUTH_COOKIE_SECURE'</span>: <span class="keyword">True</span>,      <span class="comment"># ÙÙ‚Ø· HTTPS</span>
    <span class="string">'AUTH_COOKIE_HTTP_ONLY'</span>: <span class="keyword">True</span>,  <span class="comment"># ØºÛŒØ±Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªØ±Ø³ Ø¨Ø§ JS</span>
    <span class="string">'AUTH_COOKIE_SAMESITE'</span>: <span class="string">'Lax'</span>,  <span class="comment"># Ù…Ø­Ø§ÙØ¸Øª CSRF</span>
}

<span class="comment"># ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ù…Ù†ÛŒØªÛŒ</span>
SECURE_SSL_REDIRECT = <span class="keyword">True</span>
SESSION_COOKIE_SECURE = <span class="keyword">True</span>
CSRF_COOKIE_SECURE = <span class="keyword">True</span>
            </div>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/views.py - Ù„Ø§Ú¯ÛŒÙ† Ø¨Ø§ Cookie</span>

<span class="keyword">from</span> rest_framework_simplejwt.views <span class="keyword">import</span> TokenObtainPairView
<span class="keyword">from</span> django.conf <span class="keyword">import</span> settings


<span class="keyword">class</span> <span class="class">CookieTokenObtainPairView</span>(TokenObtainPairView):
    <span class="string">"""Ù„Ø§Ú¯ÛŒÙ† Ø¨Ø§ Ø°Ø®ÛŒØ±Ù‡ ØªÙˆÚ©Ù† Ø¯Ø± Cookie"""</span>
    
    <span class="keyword">def</span> <span class="function">finalize_response</span>(self, request, response, *args, **kwargs):
        <span class="keyword">if</span> response.data.get(<span class="string">'access'</span>):
            <span class="comment"># Ø°Ø®ÛŒØ±Ù‡ Access Token Ø¯Ø± Cookie</span>
            response.set_cookie(
                key=<span class="string">'access_token'</span>,
                value=response.data[<span class="string">'access'</span>],
                max_age=<span class="number">60</span> * <span class="number">15</span>,  <span class="comment"># 15 Ø¯Ù‚ÛŒÙ‚Ù‡</span>
                httponly=<span class="keyword">True</span>,
                secure=<span class="keyword">True</span>,  <span class="comment"># ÙÙ‚Ø· HTTPS</span>
                samesite=<span class="string">'Lax'</span>
            )
            
            <span class="comment"># Ø°Ø®ÛŒØ±Ù‡ Refresh Token Ø¯Ø± Cookie</span>
            response.set_cookie(
                key=<span class="string">'refresh_token'</span>,
                value=response.data[<span class="string">'refresh'</span>],
                max_age=<span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">7</span>,  <span class="comment"># 7 Ø±ÙˆØ²</span>
                httponly=<span class="keyword">True</span>,
                secure=<span class="keyword">True</span>,
                samesite=<span class="string">'Lax'</span>
            )
            
            <span class="comment"># Ø­Ø°Ù ØªÙˆÚ©Ù† Ø§Ø² body (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)</span>
            <span class="comment"># del response.data['access']</span>
            <span class="comment"># del response.data['refresh']</span>
        
        <span class="keyword">return</span> <span class="keyword">super</span>().finalize_response(request, response, *args, **kwargs)
            </div>

            <h4>2ï¸âƒ£ Authentication Ø§Ø² Cookie</h4>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/authentication.py</span>

<span class="keyword">from</span> rest_framework_simplejwt.authentication <span class="keyword">import</span> JWTAuthentication
<span class="keyword">from</span> rest_framework <span class="keyword">import</span> exceptions


<span class="keyword">class</span> <span class="class">CookieJWTAuthentication</span>(JWTAuthentication):
    <span class="string">"""Ø®ÙˆØ§Ù†Ø¯Ù† ØªÙˆÚ©Ù† Ø§Ø² Cookie"""</span>
    
    <span class="keyword">def</span> <span class="function">authenticate</span>(self, request):
        <span class="comment"># Ø§Ø¨ØªØ¯Ø§ Ø§Ø² Header</span>
        header = self.get_header(request)
        <span class="keyword">if</span> header <span class="keyword">is not</span> <span class="keyword">None</span>:
            <span class="keyword">return</span> <span class="keyword">super</span>().authenticate(request)
        
        <span class="comment"># Ø³Ù¾Ø³ Ø§Ø² Cookie</span>
        raw_token = request.COOKIES.get(<span class="string">'access_token'</span>)
        <span class="keyword">if</span> raw_token <span class="keyword">is</span> <span class="keyword">None</span>:
            <span class="keyword">return</span> <span class="keyword">None</span>
        
        validated_token = self.get_validated_token(raw_token)
        <span class="keyword">return</span> self.get_user(validated_token), validated_token
            </div>

            <h4>3ï¸âƒ£ Rate Limiting</h4>

            <div class="code-block" data-lang="Python">
<span class="comment"># settings.py</span>

REST_FRAMEWORK = {
    <span class="comment"># ... Ø³Ø§ÛŒØ± ØªÙ†Ø¸ÛŒÙ…Ø§Øª</span>
    <span class="string">'DEFAULT_THROTTLE_CLASSES'</span>: [
        <span class="string">'rest_framework.throttling.AnonRateThrottle'</span>,
        <span class="string">'rest_framework.throttling.UserRateThrottle'</span>
    ],
    <span class="string">'DEFAULT_THROTTLE_RATES'</span>: {
        <span class="string">'anon'</span>: <span class="string">'100/hour'</span>,
        <span class="string">'user'</span>: <span class="string">'1000/hour'</span>,
        <span class="string">'login'</span>: <span class="string">'5/minute'</span>,  <span class="comment"># Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù„Ø§Ú¯ÛŒÙ†</span>
    }
}
            </div>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/throttling.py</span>

<span class="keyword">from</span> rest_framework.throttling <span class="keyword">import</span> AnonRateThrottle


<span class="keyword">class</span> <span class="class">LoginRateThrottle</span>(AnonRateThrottle):
    <span class="string">"""Ù…Ø­Ø¯ÙˆØ¯ÛŒØª ØªÙ„Ø§Ø´ Ø¨Ø±Ø§ÛŒ Ù„Ø§Ú¯ÛŒÙ†"""</span>
    scope = <span class="string">'login'</span>


<span class="comment"># Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± view</span>
<span class="keyword">class</span> <span class="class">LoginView</span>(TokenObtainPairView):
    throttle_classes = [LoginRateThrottle]
            </div>

            <h4>4ï¸âƒ£ IP Ùˆ Device Tracking</h4>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/models.py</span>

<span class="keyword">from</span> django.db <span class="keyword">import</span> models
<span class="keyword">from</span> django.conf <span class="keyword">import</span> settings


<span class="keyword">class</span> <span class="class">UserSession</span>(models.Model):
    <span class="string">"""Ø±Ø¯ÛŒØ§Ø¨ÛŒ Ù†Ø´Ø³Øªâ€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±"""</span>
    
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE)
    token_jti = models.CharField(max_length=<span class="number">255</span>, unique=<span class="keyword">True</span>)
    ip_address = models.GenericIPAddressField()
    user_agent = models.TextField()
    device_type = models.CharField(max_length=<span class="number">50</span>)
    created_at = models.DateTimeField(auto_now_add=<span class="keyword">True</span>)
    last_activity = models.DateTimeField(auto_now=<span class="keyword">True</span>)
    is_active = models.BooleanField(default=<span class="keyword">True</span>)
    
    <span class="keyword">class</span> <span class="class">Meta</span>:
        ordering = [<span class="string">'-last_activity'</span>]
            </div>

            <h3>ğŸ“‹ Ú†Ú©â€ŒÙ„ÛŒØ³Øª Ø§Ù…Ù†ÛŒØªÛŒ</h3>

            <div class="warning-box">
                <h4>âœ… Ú†Ú©â€ŒÙ„ÛŒØ³Øª Ø§Ù…Ù†ÛŒØª JWT</h4>
                <ul>
                    <li>â˜ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² HTTPS Ø¯Ø± Production</li>
                    <li>â˜ Ø¹Ù…Ø± Ú©ÙˆØªØ§Ù‡ Ø¨Ø±Ø§ÛŒ Access Token (5-15 Ø¯Ù‚ÛŒÙ‚Ù‡)</li>
                    <li>â˜ Rotate Ú©Ø±Ø¯Ù† Refresh Token</li>
                    <li>â˜ Blacklist Ø¨Ø±Ø§ÛŒ Logout</li>
                    <li>â˜ Rate Limiting Ø¨Ø±Ø§ÛŒ Ù„Ø§Ú¯ÛŒÙ†</li>
                    <li>â˜ HttpOnly Cookie Ø¨Ø±Ø§ÛŒ ØªÙˆÚ©Ù†â€ŒÙ‡Ø§</li>
                    <li>â˜ SECRET_KEY Ù‚ÙˆÛŒ Ùˆ Ù…Ø­Ø±Ù…Ø§Ù†Ù‡</li>
                    <li>â˜ Ø¹Ø¯Ù… Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø­Ø³Ø§Ø³ Ø¯Ø± Payload</li>
                    <li>â˜ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ aud Ùˆ iss claims</li>
                    <li>â˜ Ù…Ø§Ù†ÛŒØªÙˆØ±ÛŒÙ†Ú¯ ÙØ¹Ø§Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…Ø´Ú©ÙˆÚ©</li>
                </ul>
            </div>
        </div>

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 9: Ø¨Ù‡ØªØ±ÛŒÙ† Ø±ÙˆØ´â€ŒÙ‡Ø§ -->
        <div class="slide" id="best-practices">
            <div class="slide-number">9</div>
            <h2>âœ¨ Ø¨Ù‡ØªØ±ÛŒÙ† Ø±ÙˆØ´â€ŒÙ‡Ø§</h2>

            <h3>ğŸ¯ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ</h3>

            <div class="grid-2">
                <div class="card">
                    <div class="icon">â±ï¸</div>
                    <h4>Ø¹Ù…Ø± ØªÙˆÚ©Ù† Ù…Ù†Ø§Ø³Ø¨</h4>
                    <ul>
                        <li>Access: 5-15 Ø¯Ù‚ÛŒÙ‚Ù‡</li>
                        <li>Refresh: 1-7 Ø±ÙˆØ²</li>
                        <li>Ø¨Ø³ØªÙ‡ Ø¨Ù‡ Ø­Ø³Ø§Ø³ÛŒØª Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù†</li>
                    </ul>
                </div>
                <div class="card">
                    <div class="icon">ğŸ”„</div>
                    <h4>Refresh Token Rotation</h4>
                    <ul>
                        <li>ØªÙˆÚ©Ù† Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ Ù‡Ø± refresh</li>
                        <li>Blacklist ØªÙˆÚ©Ù† Ù‚Ø¨Ù„ÛŒ</li>
                        <li>ØªØ´Ø®ÛŒØµ Ø³Ø±Ù‚Øª ØªÙˆÚ©Ù†</li>
                    </ul>
                </div>
                <div class="card">
                    <div class="icon">ğŸ“¦</div>
                    <h4>Payload Ø³Ø¨Ú©</h4>
                    <ul>
                        <li>ÙÙ‚Ø· Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¶Ø±ÙˆØ±ÛŒ</li>
                        <li>Ø¨Ø¯ÙˆÙ† Ø¯Ø§Ø¯Ù‡ Ø­Ø³Ø§Ø³</li>
                        <li>Ø§Ù†Ø¯Ø§Ø²Ù‡ ØªÙˆÚ©Ù† Ú©ÙˆÚ†Ú©</li>
                    </ul>
                </div>
                <div class="card">
                    <div class="icon">ğŸ”’</div>
                    <h4>Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø§Ù…Ù†</h4>
                    <ul>
                        <li>HttpOnly Cookie ØªØ±Ø¬ÛŒØ­Ø§Ù‹</li>
                        <li>ÛŒØ§ Memory + Refresh</li>
                        <li>Ù†Ù‡ localStorage Ø¨Ø±Ø§ÛŒ production</li>
                    </ul>
                </div>
            </div>

            <h3>ğŸ“ Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø±ÙˆÚ˜Ù‡ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ</h3>

            <div class="code-block" data-lang="Text">
myproject/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ settings/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â”œâ”€â”€ development.py
â”‚   â”‚   â””â”€â”€ production.py
â”‚   â”œâ”€â”€ urls.py
â”‚   â””â”€â”€ wsgi.py
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ accounts/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ admin.py
â”‚   â”‚   â”œâ”€â”€ apps.py
â”‚   â”‚   â”œâ”€â”€ models.py
â”‚   â”‚   â”œâ”€â”€ serializers.py
â”‚   â”‚   â”œâ”€â”€ views.py
â”‚   â”‚   â”œâ”€â”€ urls.py
â”‚   â”‚   â”œâ”€â”€ permissions.py
â”‚   â”‚   â”œâ”€â”€ authentication.py
â”‚   â”‚   â”œâ”€â”€ tokens.py
â”‚   â”‚   â”œâ”€â”€ throttling.py
â”‚   â”‚   â””â”€â”€ tests/
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ test_auth.py
â”‚   â”‚       â””â”€â”€ test_views.py
â”‚   â””â”€â”€ core/
â”‚       â””â”€â”€ ...
â”œâ”€â”€ requirements/
â”‚   â”œâ”€â”€ base.txt
â”‚   â”œâ”€â”€ development.txt
â”‚   â””â”€â”€ production.txt
â””â”€â”€ manage.py
            </div>

            <h3>ğŸ§ª ØªØ³Øªâ€ŒÙ†ÙˆÛŒØ³ÛŒ</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># accounts/tests/test_auth.py</span>

<span class="keyword">from</span> django.test <span class="keyword">import</span> TestCase
<span class="keyword">from</span> django.contrib.auth <span class="keyword">import</span> get_user_model
<span class="keyword">from</span> rest_framework.test <span class="keyword">import</span> APIClient
<span class="keyword">from</span> rest_framework <span class="keyword">import</span> status

User = get_user_model()


<span class="keyword">class</span> <span class="class">AuthenticationTests</span>(TestCase):
    <span class="string">"""ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª"""</span>
    
    <span class="keyword">def</span> <span class="function">setUp</span>(self):
        self.client = APIClient()
        self.user = User.objects.create_user(
            username=<span class="string">'testuser'</span>,
            email=<span class="string">'test@example.com'</span>,
            password=<span class="string">'testpass123'</span>
        )
    
    <span class="keyword">def</span> <span class="function">test_login_success</span>(self):
        <span class="string">"""ØªØ³Øª Ù„Ø§Ú¯ÛŒÙ† Ù…ÙˆÙÙ‚"""</span>
        response = self.client.post(<span class="string">'/api/auth/login/'</span>, {
            <span class="string">'username'</span>: <span class="string">'testuser'</span>,
            <span class="string">'password'</span>: <span class="string">'testpass123'</span>
        })
        
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        self.assertIn(<span class="string">'access'</span>, response.data)
        self.assertIn(<span class="string">'refresh'</span>, response.data)
    
    <span class="keyword">def</span> <span class="function">test_login_invalid_credentials</span>(self):
        <span class="string">"""ØªØ³Øª Ù„Ø§Ú¯ÛŒÙ† Ø¨Ø§ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù†Ø§Ø¯Ø±Ø³Øª"""</span>
        response = self.client.post(<span class="string">'/api/auth/login/'</span>, {
            <span class="string">'username'</span>: <span class="string">'testuser'</span>,
            <span class="string">'password'</span>: <span class="string">'wrongpass'</span>
        })
        
        self.assertEqual(response.status_code, status.HTTP_401_UNAUTHORIZED)
    
    <span class="keyword">def</span> <span class="function">test_protected_endpoint_without_token</span>(self):
        <span class="string">"""ØªØ³Øª Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ø¯ÙˆÙ† ØªÙˆÚ©Ù†"""</span>
        response = self.client.get(<span class="string">'/api/user/profile/'</span>)
        
        self.assertEqual(response.status_code, status.HTTP_401_UNAUTHORIZED)
    
    <span class="keyword">def</span> <span class="function">test_protected_endpoint_with_token</span>(self):
        <span class="string">"""ØªØ³Øª Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ø§ ØªÙˆÚ©Ù†"""</span>
        <span class="comment"># Ø¯Ø±ÛŒØ§ÙØª ØªÙˆÚ©Ù†</span>
        login_response = self.client.post(<span class="string">'/api/auth/login/'</span>, {
            <span class="string">'username'</span>: <span class="string">'testuser'</span>,
            <span class="string">'password'</span>: <span class="string">'testpass123'</span>
        })
        token = login_response.data[<span class="string">'access'</span>]
        
        <span class="comment"># Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ø§ ØªÙˆÚ©Ù†</span>
        self.client.credentials(HTTP_AUTHORIZATION=f<span class="string">'Bearer {token}'</span>)
        response = self.client.get(<span class="string">'/api/user/profile/'</span>)
        
        self.assertEqual(response.status_code, status.HTTP_200_OK)
    
    <span class="keyword">def</span> <span class="function">test_token_refresh</span>(self):
        <span class="string">"""ØªØ³Øª ØªÙ…Ø¯ÛŒØ¯ ØªÙˆÚ©Ù†"""</span>
        <span class="comment"># Ø¯Ø±ÛŒØ§ÙØª ØªÙˆÚ©Ù†</span>
        login_response = self.client.post(<span class="string">'/api/auth/login/'</span>, {
            <span class="string">'username'</span>: <span class="string">'testuser'</span>,
            <span class="string">'password'</span>: <span class="string">'testpass123'</span>
        })
        refresh_token = login_response.data[<span class="string">'refresh'</span>]
        
        <span class="comment"># ØªÙ…Ø¯ÛŒØ¯ ØªÙˆÚ©Ù†</span>
        response = self.client.post(<span class="string">'/api/auth/refresh/'</span>, {
            <span class="string">'refresh'</span>: refresh_token
        })
        
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        self.assertIn(<span class="string">'access'</span>, response.data)
    
    <span class="keyword">def</span> <span class="function">test_logout</span>(self):
        <span class="string">"""ØªØ³Øª Ø®Ø±ÙˆØ¬"""</span>
        <span class="comment"># Ø¯Ø±ÛŒØ§ÙØª ØªÙˆÚ©Ù†</span>
        login_response = self.client.post(<span class="string">'/api/auth/login/'</span>, {
            <span class="string">'username'</span>: <span class="string">'testuser'</span>,
            <span class="string">'password'</span>: <span class="string">'testpass123'</span>
        })
        access_token = login_response.data[<span class="string">'access'</span>]
        refresh_token = login_response.data[<span class="string">'refresh'</span>]
        
        <span class="comment"># Ø®Ø±ÙˆØ¬</span>
        self.client.credentials(HTTP_AUTHORIZATION=f<span class="string">'Bearer {access_token}'</span>)
        response = self.client.post(<span class="string">'/api/auth/logout/'</span>, {
            <span class="string">'refresh'</span>: refresh_token
        })
        
        self.assertEqual(response.status_code, status.HTTP_205_RESET_CONTENT)
        
        <span class="comment"># ØªÙ„Ø§Ø´ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² refresh token Ø¨Ø§Ø·Ù„ Ø´Ø¯Ù‡</span>
        response = self.client.post(<span class="string">'/api/auth/refresh/'</span>, {
            <span class="string">'refresh'</span>: refresh_token
        })
        
        self.assertEqual(response.status_code, status.HTTP_401_UNAUTHORIZED)
            </div>

            <h3>ğŸ“Š Ø®Ù„Ø§ØµÙ‡</h3>

            <div class="info-box">
                <h4>ğŸ¯ Ù†Ú©Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ JWT Ø¨Ø§ Django</h4>
                <ol>
                    <li><strong>Ù†ØµØ¨:</strong> <code class="code-inline">djangorestframework-simplejwt</code></li>
                    <li><strong>Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ:</strong> ØªÙ†Ø¸ÛŒÙ… Ø¹Ù…Ø± ØªÙˆÚ©Ù†ØŒ rotationØŒ blacklist</li>
                    <li><strong>Endpoints:</strong> login, refresh, verify, logout</li>
                    <li><strong>Ø³ÙØ§Ø±Ø´ÛŒâ€ŒØ³Ø§Ø²ÛŒ:</strong> Claims Ø§Ø¶Ø§ÙÛŒØŒ Serializer Ù‡Ø§</li>
                    <li><strong>Frontend:</strong> Axios interceptorsØŒ refresh Ø®ÙˆØ¯Ú©Ø§Ø±</li>
                    <li><strong>Ø§Ù…Ù†ÛŒØª:</strong> HttpOnly CookieØŒ Rate LimitingØŒ HTTPS</li>
                </ol>
            </div>

            <div class="tip-box">
                <h4>ğŸ“š Ù…Ù†Ø§Ø¨Ø¹ Ø¨ÛŒØ´ØªØ±</h4>
                <ul>
                    <li><a href="https://django-rest-framework-simplejwt.readthedocs.io/" target="_blank">Ù…Ø³ØªÙ†Ø¯Ø§Øª Simple JWT</a></li>
                    <li><a href="https://jwt.io/" target="_blank">JWT.io - Debugger Ùˆ Ù…Ø³ØªÙ†Ø¯Ø§Øª</a></li>
                    <li><a href="https://www.django-rest-framework.org/" target="_blank">Django REST Framework</a></li>
                    <li><a href="https://owasp.org/www-project-web-security-testing-guide/" target="_blank">OWASP Security Guide</a></li>
                </ul>
            </div>
        </div>

        <!-- Ø§Ø³Ù„Ø§ÛŒØ¯ 10: Ù…Ø«Ø§Ù„ Ú©Ø§Ù…Ù„ -->
        <div class="slide">
            <div class="slide-number">10</div>
            <h2>ğŸš€ Ù¾Ø±ÙˆÚ˜Ù‡ Ú©Ø§Ù…Ù„</h2>

            <h3>ğŸ“‹ ÙØ§ÛŒÙ„ requirements.txt</h3>

            <div class="code-block" data-lang="Text">
Django>=4.2,<5.0
djangorestframework>=3.14.0
djangorestframework-simplejwt>=5.3.0
django-cors-headers>=4.3.0
python-dotenv>=1.0.0
            </div>

            <h3>âš™ï¸ ÙØ§ÛŒÙ„ settings.py Ú©Ø§Ù…Ù„</h3>

            <div class="code-block" data-lang="Python">
<span class="comment"># config/settings.py</span>

<span class="keyword">import</span> os
<span class="keyword">from</span> pathlib <span class="keyword">import</span> Path
<span class="keyword">from</span> datetime <span class="keyword">import</span> timedelta
<span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv

load_dotenv()

BASE_DIR = Path(__file__).resolve().parent.parent
SECRET_KEY = os.getenv(<span class="string">'SECRET_KEY'</span>, <span class="string">'your-secret-key-here'</span>)
DEBUG = os.getenv(<span class="string">'DEBUG'</span>, <span class="string">'False'</span>) == <span class="string">'True'</span>

ALLOWED_HOSTS = os.getenv(<span class="string">'ALLOWED_HOSTS'</span>, <span class="string">'localhost,127.0.0.1'</span>).split(<span class="string">','</span>)

INSTALLED_APPS = [
    <span class="string">'django.contrib.admin'</span>,
    <span class="string">'django.contrib.auth'</span>,
    <span class="string">'django.contrib.