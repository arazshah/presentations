<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>جلسه هشتم: کتابخانه Pandas - دوره علم داده با پایتون</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Tahoma', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .slide {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: none;
            position: relative;
            min-height: 80vh;
        }

        .slide.active {
            display: block;
        }

        .slide.expanded {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1000;
            margin: 0;
            border-radius: 0;
            overflow-y: auto;
            padding: 60px 40px 40px 40px;
        }

        .slide-number {
            position: absolute;
            top: 15px;
            left: 20px;
            background: #4CAF50;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }

        .expand-btn {
            position: absolute;
            top: 15px;
            right: 80px;
            background: #2196F3;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: #f44336;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            display: none;
        }

        .slide.expanded .close-btn {
            display: block;
        }

        .icon {
            font-size: 4em;
            text-align: center;
            margin-bottom: 20px;
        }

        .slide-title {
            font-size: 2.5em;
            text-align: center;
            margin-bottom: 30px;
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 15px;
        }

        .slide-content h3 {
            color: #2980b9;
            font-size: 1.4em;
            margin: 25px 0 15px 0;
            border-right: 4px solid #3498db;
            padding-right: 15px;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            position: relative;
            border: 2px solid #4a5568;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: #4CAF50;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }

        .copy-btn:hover {
            background: #45a049;
        }

        .keyword { color: #ff7979; font-weight: bold; }
        .string { color: #00b894; }
        .comment { color: #74b9ff; font-style: italic; }
        .number { color: #fdcb6e; }
        .function { color: #a29bfe; }

        .method-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .method-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #e9ecef;
            text-align: center;
        }

        .method-name {
            font-weight: bold;
            color: #495057;
            font-size: 1.1em;
        }

        .method-desc {
            color: #6c757d;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .tip-box, .warning-box, .info-box {
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .tip-box {
            background: #d4edda;
            border: 2px solid #c3e6cb;
        }

        .warning-box {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
        }

        .info-box {
            background: #cce5ff;
            border: 2px solid #99d6ff;
        }

        .tip-title, .warning-title, .info-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .navigation {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.9);
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .nav-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .nav-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .slide-counter {
            font-weight: bold;
            color: #2c3e50;
        }

        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(255,255,255,0.3);
            z-index: 1000;
        }

        .progress-bar {
            height: 100%;
            background: #4CAF50;
            width: 0%;
            transition: width 0.3s ease;
        }

        .table-demo {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            overflow-x: auto;
        }

        .table-demo table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
        }

        .table-demo th, .table-demo td {
            border: 1px solid #dee2e6;
            padding: 8px;
            text-align: center;
        }

        .table-demo th {
            background: #e9ecef;
            font-weight: bold;
        }

        .dataframe-example {
            background: #f1f3f4;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: monospace;
            border: 2px solid #dadce0;
        }

        ul, ol {
            margin-right: 20px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            .slide {
                padding: 20px;
                margin: 10px 0;
            }
            
            .slide-title {
                font-size: 1.8em;
            }
            
            .method-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="slides">
            <!-- اسلاید 1: معرفی -->
            <div class="slide active" id="slide1">
                <div class="slide-number">1/15</div>
                <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                <button class="close-btn" onclick="closeSlide(this)">×</button>
                <div class="icon">🐼</div>
                <div class="slide-title">جلسه هشتم: کتابخانه Pandas</div>
                <div class="slide-content">
                    <h3>🎯 اهداف این جلسه:</h3>
                    <ul>
                        <li>آشنایی با کتابخانه Pandas و کاربردهای آن</li>
                        <li>درک مفاهیم Series و DataFrame</li>
                        <li>یادگیری روش‌های خواندن و نوشتن داده‌ها</li>
                        <li>تسلط بر Indexing و Slicing در Pandas</li>
                        <li>آشنایی با عملیات تحلیل و تمیز کردن داده‌ها</li>
                        <li>یادگیری GroupBy و عملیات تجمیعی</li>
                        <li>کار عملی با داده‌های واقعی</li>
                    </ul>

                    <h3>📚 Pandas چیست؟</h3>
                    <p><strong>Pandas</strong> (Python Data Analysis Library) یکی از مهم‌ترین و پرکاربردترین کتابخانه‌های پایتون برای تحلیل داده است که توسط Wes McKinney در سال 2008 ایجاد شد.</p>

                    <div class="info-box">
                        <div class="info-title">🔑 ویژگی‌های کلیدی Pandas:</div>
                        <ul>
                            <li><strong>DataFrame و Series:</strong> ساختارهای داده قدرتمند</li>
                            <li><strong>I/O Tools:</strong> خواندن/نوشتن انواع فایل‌ها</li>
                            <li><strong>Data Cleaning:</strong> تمیز کردن و آماده‌سازی داده‌ها</li>
                            <li><strong>Data Manipulation:</strong> دستکاری و تبدیل داده‌ها</li>
                            <li><strong>Grouping:</strong> گروه‌بندی و تحلیل تجمیعی</li>
                            <li><strong>Time Series:</strong> تحلیل سری‌های زمانی</li>
                        </ul>
                    </div>

                    <h3>🚀 نصب و وارد کردن Pandas:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># نصب Pandas</span>
<span class="comment"># pip install pandas</span>

<span class="comment"># وارد کردن کتابخانه‌ها</span>
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># بررسی نسخه</span>
<span class="function">print</span>(<span class="string">f"نسخه Pandas: {pd.__version__}"</span>)
<span class="function">print</span>(<span class="string">f"نسخه NumPy: {np.__version__}"</span>)

<span class="comment"># تنظیمات نمایش</span>
pd.set_option(<span class="string">'display.max_columns'</span>, <span class="number">10</span>)
pd.set_option(<span class="string">'display.max_rows'</span>, <span class="number">20</span>)
pd.set_option(<span class="string">'display.width'</span>, <span class="number">1000</span>)
<span class="function">print</span>(<span class="string">"✅ Pandas آماده استفاده است!"</span>)
                    </div>

                    <h3>🏗️ معماری Pandas:</h3>
                    <div class="table-demo">
                        <table>
                            <tr>
                                <th>ساختار داده</th>
                                <th>ابعاد</th>
                                <th>توضیح</th>
                                <th>معادل NumPy</th>
                            </tr>
                            <tr>
                                <td>Series</td>
                                <td>1D</td>
                                <td>آرایه یک‌بعدی با ایندکس</td>
                                <td>1D Array</td>
                            </tr>
                            <tr>
                                <td>DataFrame</td>
                                <td>2D</td>
                                <td>جدول با سطرها و ستون‌ها</td>
                                <td>2D Array</td>
                            </tr>
                        </table>
                    </div>

                    <h3>💡 چرا Pandas؟</h3>
                    <div class="tip-box">
                        <div class="tip-title">مزایای Pandas نسبت به NumPy:</div>
                        <ul>
                            <li><strong>ایندکس‌گذاری انعطاف‌پذیر:</strong> استفاده از برچسب‌ها به جای اعداد</li>
                            <li><strong>مدیریت داده‌های ناقص:</strong> کار آسان با NaN</li>
                            <li><strong>انواع داده مختلط:</strong> ترکیب عدد، متن، تاریخ در یک جدول</li>
                            <li><strong>عملیات پیشرفته:</strong> GroupBy، Merge، Pivot</li>
                            <li><strong>I/O غنی:</strong> خواندن/نوشتن CSV، Excel، SQL، JSON</li>
                        </ul>
                    </div>

                    <h3>🎓 پیش‌نیازها:</h3>
                    <ul>
                        <li>آشنایی با پایتون پایه</li>
                        <li>تسلط بر NumPy (جلسه قبل)</li>
                        <li>درک مفاهیم آماری پایه</li>
                        <li>آشنایی با ساختارهای داده</li>
                    </ul>

                    <div class="warning-box">
                        <div class="warning-title">⚠️ نکته مهم:</div>
                        Pandas بر پایه NumPy ساخته شده است، بنابراین درک خوب NumPy برای یادگیری مؤثر Pandas ضروری است.
                    </div>
                </div>
            </div>

            <!-- اسلاید 2: Series -->
            <div class="slide" id="slide2">
                <div class="slide-number">2/15</div>
                <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                <button class="close-btn" onclick="closeSlide(this)">×</button>
                <div class="icon">📊</div>
                <div class="slide-title">Series: ساختار داده یک‌بعدی</div>
                <div class="slide-content">
                    <h3>🔍 Series چیست؟</h3>
                    <p>Series یک ساختار داده یک‌بعدی در Pandas است که شامل یک آرایه از داده‌ها به همراه یک آرایه از برچسب‌ها (ایندکس) می‌باشد.</p>

                    <h3>🏗️ ایجاد Series:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># روش 1: از لیست</span>
data = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>]
series1 = pd.Series(data)
<span class="function">print</span>(<span class="string">"Series از لیست:"</span>)
<span class="function">print</span>(series1)
<span class="function">print</span>(<span class="string">f"نوع: {type(series1)}"</span>)

<span class="comment"># روش 2: با ایندکس سفارشی</span>
cities = [<span class="string">'تهران'</span>, <span class="string">'اصفهان'</span>, <span class="string">'شیراز'</span>, <span class="string">'مشهد'</span>, <span class="string">'تبریز'</span>]
populations = [<span class="number">9000000</span>, <span class="number">2000000</span>, <span class="number">1800000</span>, <span class="number">3200000</span>, <span class="number">1700000</span>]
population_series = pd.Series(populations, index=cities)
<span class="function">print</span>(<span class="string">f"\nجمعیت شهرها:"</span>)
<span class="function">print</span>(population_series)

<span class="comment"># روش 3: از دیکشنری</span>
scores = {<span class="string">'ریاضی'</span>: <span class="number">18</span>, <span class="string">'فیزیک'</span>: <span class="number">16</span>, <span class="string">'شیمی'</span>: <span class="number">19</span>, <span class="string">'زیست'</span>: <span class="number">17</span>}
scores_series = pd.Series(scores)
<span class="function">print</span>(<span class="string">f"\nنمرات درس‌ها:"</span>)
<span class="function">print</span>(scores_series)

<span class="comment"># روش 4: از آرایه NumPy</span>
np_array = np.random.randint(<span class="number">1</span>, <span class="number">100</span>, <span class="number">5</span>)
series_from_numpy = pd.Series(np_array, index=[<span class="string">f'item_{i}'</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>)])
<span class="function">print</span>(<span class="string">f"\nاز NumPy:"</span>)
<span class="function">print</span>(series_from_numpy)

<span class="comment"># روش 5: با مقدار ثابت</span>
constant_series = pd.Series(<span class="number">100</span>, index=[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>])
<span class="function">print</span>(<span class="string">f"\nسری با مقدار ثابت:"</span>)
<span class="function">print</span>(constant_series)
                    </div>

                    <h3>🔧 ویژگی‌های Series:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># استفاده از population_series از بالا</span>
<span class="function">print</span>(<span class="string">"📊 ویژگی‌های Series:"</span>)
<span class="function">print</span>(<span class="string">f"شکل (Shape): {population_series.shape}"</span>)
<span class="function">print</span>(<span class="string">f"اندازه (Size): {population_series.size}"</span>)
<span class="function">print</span>(<span class="string">f"نوع داده (Dtype): {population_series.dtype}"</span>)
<span class="function">print</span>(<span class="string">f"نام: {population_series.name}"</span>)

<span class="comment"># تنظیم نام</span>
population_series.name = <span class="string">'جمعیت شهرها'</span>
population_series.index.name = <span class="string">'شهر'</span>
<span class="function">print</span>(<span class="string">f"\nبا نام:"</span>)
<span class="function">print</span>(population_series)

<span class="comment"># دسترسی به مقادیر و ایندکس</span>
<span class="function">print</span>(<span class="string">f"\nمقادیر (Values): {population_series.values}"</span>)
<span class="function">print</span>(<span class="string">f"ایندکس (Index): {population_series.index}"</span>)
<span class="function">print</span>(<span class="string">f"لیست ایندکس: {population_series.index.tolist()}"</span>)

<span class="comment"># بررسی خالی بودن</span>
<span class="function">print</span>(<span class="string">f"خالی است؟ {population_series.empty}"</span>)
<span class="function">print</span>(<span class="string">f"تعداد عناصر غیر null: {population_series.count()}"</span>)
                    </div>

                    <h3>🎯 Indexing و Slicing در Series:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># دسترسی با ایندکس عددی</span>
<span class="function">print</span>(<span class="string">"🔍 دسترسی به عناصر:"</span>)
<span class="function">print</span>(<span class="string">f"اولین عنصر: {population_series[0]}"</span>)
<span class="function">print</span>(<span class="string">f"آخرین عنصر: {population_series[-1]}"</span>)

<span class="comment"># دسترسی با برچسب</span>
<span class="function">print</span>(<span class="string">f"جمعیت تهران: {population_series['تهران']}"</span>)
<span class="function">print</span>(<span class="string">f"جمعیت اصفهان: {population_series['اصفهان']}"</span>)

<span class="comment"># دسترسی به چندین عنصر</span>
selected_cities = population_series[[<span class="string">'تهران'</span>, <span class="string">'مشهد'</span>]]
<span class="function">print</span>(<span class="string">f"\nشهرهای انتخابی:\n{selected_cities}"</span>)

<span class="comment"># Slicing با ایندکس عددی</span>
first_three = population_series[<span class="number">0</span>:<span class="number">3</span>]
<span class="function">print</span>(<span class="string">f"\nسه شهر اول:\n{first_three}"</span>)

<span class="comment"># Slicing با برچسب</span>
tehran_to_shiraz = population_series[<span class="string">'تهران'</span>:<span class="string">'شیراز'</span>]
<span class="function">print</span>(<span class="string">f"\nاز تهران تا شیراز:\n{tehran_to_shiraz}"</span>)

<span class="comment"># دسترسی شرطی</span>
big_cities = population_series[population_series > <span class="number">2000000</span>]
<span class="function">print</span>(<span class="string">f"\nشهرهای بزرگ (>2M):\n{big_cities}"</span>)

<span class="comment"># استفاده از loc و iloc</span>
<span class="function">print</span>(<span class="string">f"\nبا loc: {population_series.loc['تهران']}"</span>)
<span class="function">print</span>(<span class="string">f"با iloc: {population_series.iloc[0]}"</span>)
                    </div>

                    <h3>🧮 عملیات ریاضی بر Series:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># عملیات اسکالر</span>
<span class="function">print</span>(<span class="string">"🧮 عملیات ریاضی:"</span>)
population_in_millions = population_series / <span class="number">1000000</span>
<span class="function">print</span>(<span class="string">f"جمعیت بر حسب میلیون:\n{population_in_millions}"</span>)

<span class="comment"># عملیات بین دو Series</span>
area = pd.Series([<span class="number">730</span>, <span class="number">551</span>, <span class="number">240</span>, <span class="number">351</span>, <span class="number">237</span>], index=cities)
density = population_series / area
density.name = <span class="string">'تراکم جمعیت'</span>
<span class="function">print</span>(<span class="string">f"\nتراکم جمعیت (نفر در کیلومتر مربع):\n{density}"</span>)

<span class="comment"># آمار توصیفی</span>
<span class="function">print</span>(<span class="string">f"\n📊 آمار توصیفی جمعیت:"</span>)
<span class="function">print</span>(<span class="string">f"مجموع: {population_series.sum():,}"</span>)
<span class="function">print</span>(<span class="string">f"میانگین: {population_series.mean():,.0f}"</span>)
<span class="function">print</span>(<span class="string">f"میانه: {population_series.median():,.0f}"</span>)
<span class="function">print</span>(<span class="string">f"انحراف معیار: {population_series.std():,.0f}"</span>)
<span class="function">print</span>(<span class="string">f"حداقل: {population_series.min():,}"</span>)
<span class="function">print</span>(<span class="string">f"حداکثر: {population_series.max():,}"</span>)

<span class="comment"># پیدا کردن شهر با بیشترین و کمترین جمعیت</span>
<span class="function">print</span>(<span class="string">f"پرجمعیت‌ترین: {population_series.idxmax()}"</span>)
<span class="function">print</span>(<span class="string">f"کم‌جمعیت‌ترین: {population_series.idxmin()}"</span>)

<span class="comment"># خلاصه آماری کامل</span>
<span class="function">print</span>(<span class="string">f"\n📈 خلاصه آماری:\n{population_series.describe()}"</span>)
                    </div>

                    <h3>🔄 عملیات رشته‌ای در Series:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ایجاد Series از رشته‌ها</span>
names = pd.Series([<span class="string">'علی احمدی'</span>, <span class="string">'فاطمه رضایی'</span>, <span class="string">'محمد کریمی'</span>, <span class="string">'زهرا محمدی'</span>])
<span class="function">print</span>(<span class="string">"👥 نام‌ها:"</span>)
<span class="function">print</span>(names)

<span class="comment"># عملیات رشته‌ای با .str</span>
<span class="function">print</span>(<span class="string">f"\nبه حروف بزرگ:\n{names.str.upper()}"</span>)
<span class="function">print</span>(<span class="string">f"\nطول نام‌ها:\n{names.str.len()}"</span>)

<span class="comment"># تقسیم نام و نام خانوادگی</span>
split_names = names.str.split(<span class="string">' '</span>, expand=<span class="keyword">True</span>)
<span class="function">print</span>(<span class="string">f"\nتقسیم شده:\n{split_names}"</span>)

<span class="comment"># استخراج نام</span>
first_names = names.str.split(<span class="string">' '</span>).str[<span class="number">0</span>]
<span class="function">print</span>(<span class="string">f"\nنام‌ها:\n{first_names}"</span>)

<span class="comment"># جستجو در رشته‌ها</span>
contains_ali = names.str.contains(<span class="string">'علی'</span>)
<span class="function">print</span>(<span class="string">f"\nشامل 'علی':\n{contains_ali}"</span>)

<span class="comment"># جایگزینی</span>
replaced_names = names.str.replace(<span class="string">'احمدی'</span>, <span class="string">'احمدزاده'</span>)
<span class="function">print</span>(<span class="string">f"\nبعد از جایگزینی:\n{replaced_names}"</span>)
                    </div>

                    <div class="method-grid">
                        <div class="method-card">
                            <div class="method-name">pd.Series()</div>
                            <div class="method-desc">ایجاد Series</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.loc[]</div>
                            <div class="method-desc">دسترسی با برچسب</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.iloc[]</div>
                            <div class="method-desc">دسترسی با موقعیت</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.describe()</div>
                            <div class="method-desc">آمار توصیفی</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.str</div>
                            <div class="method-desc">عملیات رشته‌ای</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.value_counts()</div>
                            <div class="method-desc">شمارش مقادیر</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">💡 نکات مهم Series:</div>
                        <ul>
                            <li>Series مانند دیکشنری عمل می‌کند اما با قابلیت‌های بیشتر</li>
                            <li>ایندکس‌ها منحصربه‌فرد نیستند (می‌توان تکرار داشت)</li>
                            <li>عملیات ریاضی element-wise انجام می‌شوند</li>
                            <li>از .str برای عملیات رشته‌ای استفاده کنید</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- اسلاید 3: DataFrame -->
            <div class="slide" id="slide3">
                <div class="slide-number">3/15</div>
                <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                <button class="close-btn" onclick="closeSlide(this)">×</button>
                <div class="icon">📋</div>
                <div class="slide-title">DataFrame: ساختار داده دوبعدی</div>
                <div class="slide-content">
                    <h3>🔍 DataFrame چیست؟</h3>
                    <p>DataFrame یک ساختار داده دوبعدی در Pandas است که شامل سطرها و ستون‌هایی با برچسب می‌باشد. می‌توان آن را به عنوان جدولی از Series‌ها در نظر گرفت.</p>

                    <h3>🏗️ ایجاد DataFrame:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># روش 1: از دیکشنری</span>
data = {
    <span class="string">'نام'</span>: [<span class="string">'علی'</span>, <span class="string">'فاطمه'</span>, <span class="string">'محمد'</span>, <span class="string">'زهرا'</span>, <span class="string">'حسن'</span>],
    <span class="string">'سن'</span>: [<span class="number">25</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">28</span>, <span class="number">32</span>],
    <span class="string">'شهر'</span>: [<span class="string">'تهران'</span>, <span class="string">'اصفهان'</span>, <span class="string">'شیراز'</span>, <span class="string">'مشهد'</span>, <span class="string">'تبریز'</span>],
    <span class="string">'حقوق'</span>: [<span class="number">5000000</span>, <span class="number">4500000</span>, <span class="number">6000000</span>, <span class="number">5500000</span>, <span class="number">4800000</span>]
}

df = pd.DataFrame(data)
<span class="function">print</span>(<span class="string">"📋 DataFrame از دیکشنری:"</span>)
<span class="function">print</span>(df)
<span class="function">print</span>(<span class="string">f"نوع: {type(df)}"</span>)

<span class="comment"># روش 2: از لیست دیکشنری‌ها</span>
employees = [
    {<span class="string">'نام'</span>: <span class="string">'رضا'</span>, <span class="string">'سن'</span>: <span class="number">29</span>, <span class="string">'بخش'</span>: <span class="string">'IT'</span>},
    {<span class="string">'نام'</span>: <span class="string">'مریم'</span>, <span class="string">'سن'</span>: <span class="number">31</span>, <span class="string">'بخش'</span>: <span class="string">'HR'</span>},
    {<span class="string">'نام'</span>: <span class="string">'امیر'</span>, <span class="string">'سن'</span>: <span class="number">27</span>, <span class="string">'بخش'</span>: <span class="string">'Finance'</span>}
]
df_employees = pd.DataFrame(employees)
<span class="function">print</span>(<span class="string">f"\nاز لیست دیکشنری:\n{df_employees}"</span>)

<span class="comment"># روش 3: از آرایه NumPy</span>
np_data = np.random.randint(<span class="number">1</span>, <span class="number">100</span>, (<span class="number">4</span>, <span class="number">3</span>))
df_numpy = pd.DataFrame(np_data, 
                       columns=[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>],
                       index=[<span class="string">'سطر1'</span>, <span class="string">'سطر2'</span>, <span class="string">'سطر3'</span>, <span class="string">'سطر4'</span>])
<span class="function">print</span>(<span class="string">f"\nاز NumPy:\n{df_numpy}"</span>)

<span class="comment"># روش 4: از Series‌ها</span>
names = pd.Series([<span class="string">'احمد'</span>, <span class="string">'سارا'</span>, <span class="string">'کیوان'</span>])
ages = pd.Series([<span class="number">24</span>, <span class="number">26</span>, <span class="number">30</span>])
df_from_series = pd.DataFrame({<span class="string">'نام'</span>: names, <span class="string">'سن'</span>: ages})
<span class="function">print</span>(<span class="string">f"\nاز Series:\n{df_from_series}"</span>)

<span class="comment"># روش 5: DataFrame خالی</span>
empty_df = pd.DataFrame()
<span class="function">print</span>(<span class="string">f"\nDataFrame خالی:\n{empty_df}"</span>)
<span class="function">print</span>(<span class="string">f"خالی است؟ {empty_df.empty}"</span>)
                    </div>

                    <h3>🔧 ویژگی‌های DataFrame:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># استفاده از df ایجاد شده در بالا</span>
<span class="function">print</span>(<span class="string">"📊 ویژگی‌های DataFrame:"</span>)
<span class="function">print</span>(<span class="string">f"شکل (Shape): {df.shape}"</span>)
<span class="function">print</span>(<span class="string">f"اندازه (Size): {df.size}"</span>)
<span class="function">print</span>(<span class="string">f"تعداد ابعاد: {df.ndim}"</span>)
<span class="function">print</span>(<span class="string">f"نام ستون‌ها: {df.columns.tolist()}"</span>)
<span class="function">print</span>(<span class="string">f"نام ایندکس‌ها: {df.index.tolist()}"</span>)

<span class="comment"># انواع داده</span>
<span class="function">print</span>(<span class="string">f"\nانواع داده:\n{df.dtypes}"</span>)

<span class="comment"># اطلاعات کلی</span>
<span class="function">print</span>(<span class="string">f"\nاطلاعات کلی:"</span>)
df.info()

<span class="comment"># حافظه مصرفی</span>
memory_usage = df.memory_usage(deep=<span class="keyword">True</span>)
<span class="function">print</span>(<span class="string">f"\nحافظه مصرفی:\n{memory_usage}"</span>)
<span class="function">print</span>(<span class="string">f"کل حافظه: {memory_usage.sum()} بایت"</span>)

<span class="comment"># نمایش چند سطر اول و آخر</span>
<span class="function">print</span>(<span class="string">f"\n5 سطر اول:\n{df.head()}"</span>)
<span class="function">print</span>(<span class="string">f"\n3 سطر اول:\n{df.head(3)}"</span>)
<span class="function">print</span>(<span class="string">f"\n2 سطر آخر:\n{df.tail(2)}"</span>)
                    </div>

                    <h3>🎯 دسترسی به داده‌ها در DataFrame:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># دسترسی به ستون</span>
<span class="function">print</span>(<span class="string">"🎯 دسترسی به ستون‌ها:"</span>)
names_column = df[<span class="string">'نام'</span>]
<span class="function">print</span>(<span class="string">f"ستون نام:\n{names_column}"</span>)
<span class="function">print</span>(<span class="string">f"نوع ستون: {type(names_column)}"</span>)

<span class="comment"># دسترسی به چندین ستون</span>
selected_columns = df[[<span class="string">'نام'</span>, <span class="string">'سن'</span>]]
<span class="function">print</span>(<span class="string">f"\nستون‌های انتخابی:\n{selected_columns}"</span>)

<span class="comment"># دسترسی با نقطه (فقط برای نام‌های بدون فاصله)</span>
<span class="comment"># df.نام  # این کار نمی‌کند چون نام فارسی است</span>

<span class="comment"># دسترسی به سطر با iloc</span>
<span class="function">print</span>(<span class="string">f"\nسطر اول:\n{df.iloc[0]}"</span>)
<span class="function">print</span>(<span class="string">f"سطر آخر:\n{df.iloc[-1]}"</span>)

<span class="comment"># دسترسی به سطر با loc</span>
<span class="function">print</span>(<span class="string">f"\nسطر با ایندکس 2:\n{df.loc[2]}"</span>)

<span class="comment"># دسترسی به چندین سطر</span>
first_three_rows = df.iloc[<span class="number">0</span>:<span class="number">3</span>]
<span class="function">print</span>(<span class="string">f"\nسه سطر اول:\n{first_three_rows}"</span>)

<span class="comment"># دسترسی به سلول خاص</span>
<span class="function">print</span>(<span class="string">f"\nسن علی: {df.loc[0, 'سن']}"</span>)
<span class="function">print</span>(<span class="string">f"شهر فاطمه: {df.iloc[1, 2]}"</span>)

<span class="comment"># دسترسی شرطی</span>
high_salary = df[df[<span class="string">'حقوق'</span>] > <span class="number">5000000</span>]
<span class="function">print</span>(<span class="string">f"\nحقوق بالا:\n{high_salary}"</span>)

<span class="comment"># شرط چندگانه</span>
young_tehrani = df[(df[<span class="string">'سن'</span>] < <span class="number">30</span>) & (df[<span class="string">'شهر'</span>] == <span class="string">'تهران'</span>)]
<span class="function">print</span>(<span class="string">f"\nجوان و تهرانی:\n{young_tehrani}"</span>)
                    </div>

                    <h3>➕ اضافه و حذف ستون‌ها:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># کپی DataFrame برای تغییرات</span>
df_copy = df.copy()

<span class="comment"># اضافه کردن ستون جدید</span>
df_copy[<span class="string">'تجربه'</span>] = [<span class="number">3</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">7</span>]
<span class="function">print</span>(<span class="string">"➕ بعد از اضافه کردن ستون تجربه:"</span>)
<span class="function">print</span>(df_copy)

<span class="comment"># محاسبه ستون جدید بر اساس ستون‌های موجود</span>
df_copy[<span class="string">'حقوق_سالانه'</span>] = df_copy[<span class="string">'حقوق'</span>] * <span class="number">12</span>
df_copy[<span class="string">'نسبت_حقوق_به_سن'</span>] = df_copy[<span class="string">'حقوق'</span>] / df_copy[<span class="string">'سن'</span>]
<span class="function">print</span>(<span class="string">f"\nبا ستون‌های محاسبه شده:\n{df_copy}"</span>)

<span class="comment"># اضافه کردن ستون با assign</span>
df_assigned = df_copy.assign(
    رده_سنی=pd.cut(df_copy[<span class="string">'سن'</span>], bins=[<span class="number">0</span>, <span class="number">30</span>, <span class="number">40</span>], labels=[<span class="string">'جوان'</span>, <span class="string">'میانسال'</span>])
)
<span class="function">print</span>(<span class="string">f"\nبا رده سنی:\n{df_assigned[[<span class="string">'نام'</span>, <span class="string">'سن'</span>, <span class="string">'رده_سنی'</span>]]}"</span>)

<span class="comment"># حذف ستون</span>
df_dropped = df_copy.drop([<span class="string">'نسبت_حقوق_به_سن'</span>], axis=<span class="number">1</span>)
<span class="function">print</span>(<span class="string">f"\nبعد از حذف ستون:\n{df_dropped.columns.tolist()}"</span>)

<span class="comment"># حذف ستون درجا</span>
df_copy.drop(<span class="string">'حقوق_سالانه'</span>, axis=<span class="number">1</span>, inplace=<span class="keyword">True</span>)
<span class="function">print</span>(<span class="string">f"ستون‌های باقی‌مانده: {df_copy.columns.tolist()}"</span>)

<span class="comment"># حذف با del</span>
<span class="keyword">del</span> df_copy[<span class="string">'تجربه'</span>]
<span class="function">print</span>(<span class="string">f"بعد از حذف با del: {df_copy.columns.tolist()}"</span>)
                    </div>

                    <h3>📊 آمار توصیفی DataFrame:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># آمار توصیفی کلی</span>
<span class="function">print</span>(<span class="string">"📊 آمار توصیفی:"</span>)
<span class="function">print</span>(df.describe())

<span class="comment"># آمار برای ستون‌های غیرعددی</span>
<span class="function">print</span>(<span class="string">f"\nآمار ستون‌های متنی:\n{df.describe(include='object')}"</span>)

<span class="comment"># آمار کامل (همه انواع داده)</span>
<span class="function">print</span>(<span class="string">f"\nآمار کامل:\n{df.describe(include='all')}"</span>)

<span class="comment"># آمار برای ستون خاص</span>
<span class="function">print</span>(<span class="string">f"\nآمار سن:\n{df['سن'].describe()}"</span>)

<span class="comment"># شمارش مقادیر منحصربه‌فرد</span>
<span class="function">print</span>(<span class="string">f"\nتعداد شهرهای مختلف: {df['شهر'].nunique()}"</span>)
<span class="function">print</span>(<span class="string">f"شهرهای منحصربه‌فرد: {df['شهر'].unique()}"</span>)

<span class="comment"># شمارش تکرار مقادیر</span>
<span class="function">print</span>(<span class="string">f"\nتوزیع شهرها:\n{df['شهر'].value_counts()}"</span>)

<span class="comment"># بررسی مقادیر null</span>
<span class="function">print</span>(<span class="string">f"\nمقادیر null:\n{df.isnull().sum()}"</span>)
<span class="function">print</span>(<span class="string">f"آیا مقدار null دارد؟ {df.isnull().any().any()}"</span>)

<span class="comment"># همبستگی بین ستون‌های عددی</span>
numeric_df = df.select_dtypes(include=[np.number])
<span class="function">print</span>(<span class="string">f"\nماتریس همبستگی:\n{numeric_df.corr()}"</span>)
                    </div>

                    <div class="dataframe-example">
                        <strong>نمونه خروجی DataFrame:</strong><br>
                        <pre>
   نام  سن     شهر     حقوق
0   علی  25    تهران  5000000
1  فاطمه  30   اصفهان  4500000
2  محمد  35    شیراز  6000000
3   زهرا  28     مشهد  5500000
4   حسن  32    تبریز  4800000
                        </pre>
                    </div>

                    <div class="method-grid">
                        <div class="method-card">
                            <div class="method-name">pd.DataFrame()</div>
                            <div class="method-desc">ایجاد DataFrame</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.head() / .tail()</div>
                            <div class="method-desc">نمایش سطرها</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.loc[] / .iloc[]</div>
                            <div class="method-desc">دسترسی به داده</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.describe()</div>
                            <div class="method-desc">آمار توصیفی</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.info()</div>
                            <div class="method-desc">اطلاعات کلی</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.drop()</div>
                            <div class="method-desc">حذف سطر/ستون</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">💡 نکات مهم DataFrame:</div>
                        <ul>
                            <li>هر ستون یک Series است</li>
                            <li>از .loc برای برچسب و .iloc برای موقعیت استفاده کنید</li>
                            <li>عملیات شرطی با & و | انجام دهید نه and و or</li>
                            <li>برای تغییرات دائمی از inplace=True استفاده کنید</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- اسلاید 4: خواندن و نوشتن داده‌ها -->
            <div class="slide" id="slide4">
                <div class="slide-number">4/15</div>
                <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                <button class="close-btn" onclick="closeSlide(this)">×</button>
                <div class="icon">📁</div>
                <div class="slide-title">خواندن و نوشتن داده‌ها</div>
                <div class="slide-content">
                    <h3>📄 خواندن فایل‌های CSV:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ایجاد یک فایل CSV نمونه</span>
sample_data = {
    <span class="string">'id'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],
    <span class="string">'name'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, <span class="string">'زهرا'</span>, <span class="string">'محمد'</span>],
    <span class="string">'age'</span>: [<span class="number">25</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">28</span>, <span class="number">32</span>],
    <span class="string">'salary'</span>: [<span class="number">50000</span>, <span class="number">60000</span>, <span class="number">55000</span>, <span class="number">58000</span>, <span class="number">62000</span>],
    <span class="string">'department'</span>: [<span class="string">'IT'</span>, <span class="string">'HR'</span>, <span class="string">'Finance'</span>, <span class="string">'IT'</span>, <span class="string">'Marketing'</span>]
}

df_sample = pd.DataFrame(sample_data)

<span class="comment"># ذخیره در فایل CSV</span>
df_sample.to_csv(<span class="string">'employees.csv'</span>, index=<span class="keyword">False</span>)
<span class="function">print</span>(<span class="string">"✅ فایل employees.csv ایجاد شد"</span>)

<span class="comment"># خواندن فایل CSV ساده</span>
df_read = pd.read_csv(<span class="string">'employees.csv'</span>)
<span class="function">print</span>(<span class="string">"📄 خواندن CSV ساده:"</span>)
<span class="function">print</span>(df_read)
<span class="function">print</span>(<span class="string">f"شکل: {df_read.shape}"</span>)

<span class="comment"># خواندن با پارامترهای مختلف</span>
df_custom = pd.read_csv(<span class="string">'employees.csv'</span>,
                       sep=<span class="string">','</span>,           <span class="comment"># جداکننده</span>
                       header=<span class="number">0</span>,          <span class="comment"># سطر header</span>
                       index_col=<span class="string">'id'</span>,    <span class="comment"># ستون ایندکس</span>
                       dtype={<span class="string">'age'</span>: <span class="string">'int32'</span>, <span class="string">'salary'</span>: <span class="string">'float64'</span>})  <span class="comment"># نوع داده</span>
<span class="function">print</span>(<span class="string">f"\nبا تنظیمات سفارشی:\n{df_custom}"</span>)
<span class="function">print</span>(<span class="string">f"انواع داده:\n{df_custom.dtypes}"</span>)

<span class="comment"># خواندن بخشی از فایل</span>
df_partial = pd.read_csv(<span class="string">'employees.csv'</span>, nrows=<span class="number">3</span>)  <span class="comment"># فقط 3 سطر اول</span>
<span class="function">print</span>(<span class="string">f"\n3 سطر اول:\n{df_partial}"</span>)

<span class="comment"># خواندن ستون‌های خاص</span>
df_columns = pd.read_csv(<span class="string">'employees.csv'</span>, usecols=[<span class="string">'name'</span>, <span class="string">'salary'</span>])
<span class="function">print</span>(<span class="string">f"\nفقط نام و حقوق:\n{df_columns}"</span>)
                    </div>

                    <h3>📊 خواندن فایل‌های Excel:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ذخیره در Excel</span>
df_sample.to_excel(<span class="string">'employees.xlsx'</span>, index=<span class="keyword">False</span>, sheet_name=<span class="string">'کارمندان'</span>)
<span class="function">print</span>(<span class="string">"✅ فایل Excel ایجاد شد"</span>)

<span class="comment"># خواندن از Excel</span>
df_excel = pd.read_excel(<span class="string">'employees.xlsx'</span>, sheet_name=<span class="string">'کارمندان'</span>)
<span class="function">print</span>(<span class="string">f"📊 از Excel:\n{df_excel}"</span>)

<span class="comment"># ایجاد فایل Excel با چندین sheet</span>
<span class="keyword">with</span> pd.ExcelWriter(<span class="string">'multiple_sheets.xlsx'</span>) <span class="keyword">as</span> writer:
    df_sample.to_excel(writer, sheet_name=<span class="string">'کارمندان'</span>, index=<span class="keyword">False</span>)
    df_sample[df_sample[<span class="string">'department'</span>] == <span class="string">'IT'</span>].to_excel(writer, sheet_name=<span class="string">'IT'</span>, index=<span class="keyword">False</span>)
    df_sample.groupby(<span class="string">'department'</span>)[<span class="string">'salary'</span>].mean().to_excel(writer, sheet_name=<span class="string">'میانگین_حقوق'</span>)

<span class="function">print</span>(<span class="string">"✅ فایل Excel چند صفحه‌ای ایجاد شد"</span>)

<span class="comment"># خواندن همه sheet‌ها</span>
all_sheets = pd.read_excel(<span class="string">'multiple_sheets.xlsx'</span>, sheet_name=<span class="keyword">None</span>)
<span class="function">print</span>(<span class="string">f"نام sheet‌ها: {list(all_sheets.keys())}"</span>)
                    </div>

                    <h3>🌐 خواندن فایل‌های JSON:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ذخیره در JSON</span>
df_sample.to_json(<span class="string">'employees.json'</span>, orient=<span class="string">'records'</span>, force_ascii=<span class="keyword">False</span>)
<span class="function">print</span>(<span class="string">"✅ فایل JSON ایجاد شد"</span>)

<span class="comment"># خواندن از JSON</span>
df_json = pd.read_json(<span class="string">'employees.json'</span>)
<span class="function">print</span>(<span class="string">f"🌐 از JSON:\n{df_json}"</span>)

<span class="comment"># انواع مختلف orient در JSON</span>
orientations = [<span class="string">'records'</span>, <span class="string">'index'</span>, <span class="string">'values'</span>, <span class="string">'split'</span>]
<span class="keyword">for</span> orient <span class="keyword">in</span> orientations:
    filename = <span class="string">f'employees_{orient}.json'</span>
    df_sample.to_json(filename, orient=orient, force_ascii=<span class="keyword">False</span>)
    <span class="function">print</span>(<span class="string">f"ایجاد شد: {filename}"</span>)

<span class="comment"># نمایش محتوای JSON با orient مختلف</span>
<span class="keyword">import</span> json
<span class="keyword">with</span> <span class="function">open</span>(<span class="string">'employees_records.json'</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:
    json_content = json.load(f)
    <span class="function">print</span>(<span class="string">f"\nJSON records format:\n{json_content[:2]}"</span>)  <span class="comment"># نمایش 2 رکورد اول</span>
                    </div>

                    <h3>🗃️ کار با پایگاه داده:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># کار با SQLite (نیاز به sqlite3 که built-in پایتون است)</span>
<span class="keyword">import</span> sqlite3

<span class="comment"># ایجاد اتصال به پایگاه داده</span>
conn = sqlite3.connect(<span class="string">'company.db'</span>)

<span class="comment"># ذخیره DataFrame در پایگاه داده</span>
df_sample.to_sql(<span class="string">'employees'</span>, conn, if_exists=<span class="string">'replace'</span>, index=<span class="keyword">False</span>)
<span class="function">print</span>(<span class="string">"✅ داده‌ها در پایگاه داده ذخیره شد"</span>)

<span class="comment"># خواندن از پایگاه داده</span>
df_sql = pd.read_sql_query(<span class="string">"SELECT * FROM employees"</span>, conn)
<span class="function">print</span>(<span class="string">f"🗃️ از پایگاه داده:\n{df_sql}"</span>)

<span class="comment"># کوئری پیچیده‌تر</span>
high_salary_query = <span class="string">"""
    SELECT name, salary, department 
    FROM employees 
    WHERE salary > 55000 
    ORDER BY salary DESC
"""</span>
df_high_salary = pd.read_sql_query(high_salary_query, conn)
<span class="function">print</span>(<span class="string">f"\nحقوق بالا:\n{df_high_salary}"</span>)

<span class="comment"># بستن اتصال</span>
conn.close()
<span class="function">print</span>(<span class="string">"🔒 اتصال پایگاه داده بسته شد"</span>)
                    </div>

                    <h3>🌍 خواندن از وب:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># خواندن جدول HTML (نیاز به lxml یا html5lib)</span>
<span class="keyword">try</span>:
    <span class="comment"># مثال: خواندن جدول از Wikipedia</span>
    url = <span class="string">'https://en.wikipedia.org/wiki/List_of_countries_by_population'</span>
    tables = pd.read_html(url)
    <span class="function">print</span>(<span class="string">f"تعداد جداول پیدا شده: {len(tables)}"</span>)
    
    <span class="comment"># نمایش اولین جدول</span>
    <span class="keyword">if</span> tables:
        <span class="function">print</span>(<span class="string">f"شکل اولین جدول: {tables[0].shape}"</span>)
        <span class="function">print</span>(<span class="string">f"ستون‌های اولین جدول: {tables[0].columns.tolist()}"</span>)
<span class="keyword">except</span> Exception <span class="keyword">as</span> e:
    <span class="function">print</span>(<span class="string">f"خطا در خواندن از وب: {e}"</span>)

<span class="comment"># خواندن CSV از URL</span>
<span class="keyword">try</span>:
    <span class="comment"># مثال فرضی - در عمل URL معتبر استفاده کنید</span>
    <span class="comment"># df_web = pd.read_csv('https://example.com/data.csv')</span>
    <span class="function">print</span>(<span class="string">"برای خواندن از وب، URL معتبر لازم است"</span>)
<span class="keyword">except</span>:
    <span class="keyword">pass</span>

<span class="comment"># خواندن از clipboard</span>
<span class="function">print</span>(<span class="string">"\n📋 برای خواندن از clipboard:"</span>)
<span class="function">print</span>(<span class="string">"df = pd.read_clipboard()"</span>)
<span class="function">print</span>(<span class="string">"داده‌ای را کپی کنید و سپس این دستور را اجرا کنید"</span>)
                    </div>

                    <h3>💾 تنظیمات پیشرفته ذخیره‌سازی:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ذخیره CSV با تنظیمات پیشرفته</span>
df_sample.to_csv(<span class="string">'employees_advanced.csv'</span>,
                index=<span class="keyword">False</span>,                    <span class="comment"># بدون ایندکس</span>
                sep=<span class="string">';'</span>,                       <span class="comment"># جداکننده سمی‌کالن</span>
                encoding=<span class="string">'utf-8-sig'</span>,          <span class="comment"># انکودینگ برای فارسی</span>
                float_format=<span class="string">'%.2f'</span>,           <span class="comment"># فرمت اعشار</span>
                date_format=<span class="string">'%Y-%m-%d'</span>)         <span class="comment"># فرمت تاریخ</span>
<span class="function">print</span>(<span class="string">"✅ CSV پیشرفته ذخیره شد"</span>)

<span class="comment"># ذخیره فقط ستون‌های خاص</span>
df_sample[[<span class="string">'name'</span>, <span class="string">'salary'</span>]].to_csv(<span class="string">'salary_report.csv'</span>, index=<span class="keyword">False</span>)

<span class="comment"># ذخیره با فیلتر</span>
df_sample[df_sample[<span class="string">'salary'</span>] > <span class="number">55000</span>].to_csv(<span class="string">'high_earners.csv'</span>, index=<span class="keyword">False</span>)

<span class="comment"># ذخیره در فرمت Parquet (بهینه برای داده‌های بزرگ)</span>
<span class="keyword">try</span>:
    df_sample.to_parquet(<span class="string">'employees.parquet'</span>)
    df_parquet = pd.read_parquet(<span class="string">'employees.parquet'</span>)
    <span class="function">print</span>(<span class="string">f"✅ Parquet: {df_parquet.shape}"</span>)
<span class="keyword">except</span>:
    <span class="function">print</span>(<span class="string">"⚠️ برای Parquet نیاز به نصب pyarrow یا fastparquet"</span>)

<span class="comment"># ذخیره فشرده</span>
df_sample.to_csv(<span class="string">'employees_compressed.csv.gz'</span>, 
                compression=<span class="string">'gzip'</span>, index=<span class="keyword">False</span>)
<span class="function">print</span>(<span class="string">"✅ فایل فشرده ایجاد شد"</span>)

<span class="comment"># خواندن فایل فشرده</span>
df_compressed = pd.read_csv(<span class="string">'employees_compressed.csv.gz'</span>)
<span class="function">print</span>(<span class="string">f"فایل فشرده خوانده شد: {df_compressed.shape}"</span>)

<span class="comment"># پاک کردن فایل‌های ایجاد شده</span
    <span class="keyword">import</span> os
    files_to_remove = [
        <span class="string">'employees.csv'</span>, <span class="string">'employees.xlsx'</span>, <span class="string">'employees.json'</span>,
        <span class="string">'multiple_sheets.xlsx'</span>, <span class="string">'company.db'</span>, <span class="string">'employees_advanced.csv'</span>,
        <span class="string">'salary_report.csv'</span>, <span class="string">'high_earners.csv'</span>, <span class="string">'employees_compressed.csv.gz'</span>
    ]
    
    <span class="keyword">for</span> file <span class="keyword">in</span> files_to_remove:
        <span class="keyword">try</span>:
            os.remove(file)
        <span class="keyword">except</span>:
            <span class="keyword">pass</span>
    
    <span class="function">print</span>(<span class="string">"🧹 فایل‌های نمونه پاک شدند"</span>)
                        </div>
    
                        <div class="method-grid">
                            <div class="method-card">
                                <div class="method-name">pd.read_csv()</div>
                                <div class="method-desc">خواندن CSV</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">pd.read_excel()</div>
                                <div class="method-desc">خواندن Excel</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">pd.read_json()</div>
                                <div class="method-desc">خواندن JSON</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">pd.read_sql()</div>
                                <div class="method-desc">خواندن SQL</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.to_csv()</div>
                                <div class="method-desc">ذخیره CSV</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.to_excel()</div>
                                <div class="method-desc">ذخیره Excel</div>
                            </div>
                        </div>
    
                        <div class="tip-box">
                            <div class="tip-title">💡 نکات I/O:</div>
                            <ul>
                                <li>همیشه encoding مناسب برای متن فارسی تنظیم کنید</li>
                                <li>برای داده‌های بزرگ از Parquet استفاده کنید</li>
                                <li>از compression برای صرفه‌جویی فضا استفاده کنید</li>
                                <li>dtype را مشخص کنید تا حافظه بهینه شود</li>
                            </ul>
                        </div>
                    </div>
                </div>
    
                <!-- اسلاید 5: Indexing و Slicing پیشرفته -->
                <div class="slide" id="slide5">
                    <div class="slide-number">5/15</div>
                    <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                    <button class="close-btn" onclick="closeSlide(this)">×</button>
                    <div class="icon">🎯</div>
                    <div class="slide-title">Indexing و Slicing پیشرفته</div>
                    <div class="slide-content">
                        <h3>🔍 loc و iloc به تفصیل:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد DataFrame نمونه برای تمرین</span>
    data = {
        <span class="string">'نام'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, <span class="string">'زهرا'</span>, <span class="string">'محمد'</span>, <span class="string">'مریم'</span>],
        <span class="string">'سن'</span>: [<span class="number">25</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">28</span>, <span class="number">32</span>, <span class="number">27</span>],
        <span class="string">'شهر'</span>: [<span class="string">'تهران'</span>, <span class="string">'اصفهان'</span>, <span class="string">'شیراز'</span>, <span class="string">'مشهد'</span>, <span class="string">'تبریز'</span>, <span class="string">'کرج'</span>],
        <span class="string">'حقوق'</span>: [<span class="number">5000000</span>, <span class="number">4500000</span>, <span class="number">6000000</span>, <span class="number">5500000</span>, <span class="number">4800000</span>, <span class="number">5200000</span>],
        <span class="string">'بخش'</span>: [<span class="string">'IT'</span>, <span class="string">'HR'</span>, <span class="string">'Finance'</span>, <span class="string">'IT'</span>, <span class="string">'Marketing'</span>, <span class="string">'HR'</span>]
    }
    
    df = pd.DataFrame(data)
    <span class="function">print</span>(<span class="string">"📊 DataFrame اصلی:"</span>)
    <span class="function">print</span>(df)
    
    <span class="comment"># loc: دسترسی با برچسب</span>
    <span class="function">print</span>(<span class="string">f"\n🎯 استفاده از loc:"</span>)
    
    <span class="comment"># دسترسی به سطر خاص</span>
    <span class="function">print</span>(<span class="string">f"سطر 2:\n{df.loc[2]}"</span>)
    
    <span class="comment"># دسترسی به چندین سطر</span>
    <span class="function">print</span>(<span class="string">f"\nسطرهای 1 تا 3:\n{df.loc[1:3]}"</span>)
    
    <span class="comment"># دسترسی به سطر و ستون خاص</span>
    <span class="function">print</span>(<span class="string">f"\nنام سطر 2: {df.loc[2, 'نام']}"</span>)
    
    <span class="comment"># دسترسی به چندین سطر و ستون</span>
    <span class="function">print</span>(<span class="string">f"\nنام و سن سطرهای 0-2:\n{df.loc[0:2, ['نام', 'سن']]}"</span>)
    
    <span class="comment"># استفاده از شرط با loc</span>
    high_salary = df.loc[df[<span class="string">'حقوق'</span>] > <span class="number">5000000</span>, [<span class="string">'نام'</span>, <span class="string">'حقوق'</span>]]
    <span class="function">print</span>(<span class="string">f"\nحقوق بالا:\n{high_salary}"</span>)
                        </div>
    
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># iloc: دسترسی با موقعیت عددی</span>
    <span class="function">print</span>(<span class="string">f"\n🔢 استفاده از iloc:"</span>)
    
    <span class="comment"># دسترسی به سطر خاص</span>
    <span class="function">print</span>(<span class="string">f"سطر اول:\n{df.iloc[0]}"</span>)
    
    <span class="comment"># دسترسی به چندین سطر</span>
    <span class="function">print</span>(<span class="string">f"\n3 سطر اول:\n{df.iloc[:3]}"</span>)
    
    <span class="comment"># دسترسی به سطر و ستون با موقعیت</span>
    <span class="function">print</span>(<span class="string">f"\nسلول [1,2]: {df.iloc[1, 2]}"</span>)
    
    <span class="comment"># دسترسی به بخشی از DataFrame</span>
    <span class="function">print</span>(<span class="string">f"\n2 سطر و 3 ستون اول:\n{df.iloc[:2, :3]}"</span>)
    
    <span class="comment"># دسترسی با فاصله</span>
    <span class="function">print</span>(<span class="string">f"\nهر دو سطر یکبار:\n{df.iloc[::2]}"</span>)
    
    <span class="comment"># دسترسی به سطر آخر</span>
    <span class="function">print</span>(<span class="string">f"\nسطر آخر:\n{df.iloc[-1]}"</span>)
    
    <span class="comment"># دسترسی به ستون‌های خاص با موقعیت</span>
    <span class="function">print</span>(<span class="string">f"\nستون‌های 1 و 3:\n{df.iloc[:, [1, 3]]}"</span>)
                        </div>
    
                        <h3>🏷️ کار با Index سفارشی:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># تنظیم ایندکس سفارشی</span>
    df_indexed = df.set_index(<span class="string">'نام'</span>)
    <span class="function">print</span>(<span class="string">"🏷️ با ایندکس سفارشی:"</span>)
    <span class="function">print</span>(df_indexed)
    
    <span class="comment"># دسترسی با نام ایندکس</span>
    <span class="function">print</span>(<span class="string">f"\nاطلاعات احمد:\n{df_indexed.loc['احمد']}"</span>)
    
    <span class="comment"># دسترسی به چندین نفر</span>
    selected_people = df_indexed.loc[[<span class="string">'احمد'</span>, <span class="string">'زهرا'</span>]]
    <span class="function">print</span>(<span class="string">f"\nاحمد و زهرا:\n{selected_people}"</span>)
    
    <span class="comment"># بازگشت ایندکس به ستون</span>
    df_reset = df_indexed.reset_index()
    <span class="function">print</span>(<span class="string">f"\nبعد از reset_index:\n{df_reset}"</span>)
    
    <span class="comment"># ایندکس چندسطحی</span>
    df_multi = df.set_index([<span class="string">'بخش'</span>, <span class="string">'نام'</span>])
    <span class="function">print</span>(<span class="string">f"\nایندکس چندسطحی:\n{df_multi}"</span>)
    
    <span class="comment"># دسترسی در ایندکس چندسطحی</span>
    <span class="function">print</span>(<span class="string">f"\nبخش IT:\n{df_multi.loc['IT']}"</span>)
    <span class="function">print</span>(<span class="string">f"\nاحمد در IT: {df_multi.loc[('IT', 'احمد'), 'سن']}"</span>)
                        </div>
    
                        <h3>🔍 انتخاب شرطی پیشرفته:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># شرط ساده</span>
    young_people = df[df[<span class="string">'سن'</span>] < <span class="number">30</span>]
    <span class="function">print</span>(<span class="string">"👶 افراد جوان:"</span>)
    <span class="function">print</span>(young_people[[<span class="string">'نام'</span>, <span class="string">'سن'</span>]])
    
    <span class="comment"># شرط چندگانه با &</span>
    young_high_earners = df[(df[<span class="string">'سن'</span>] < <span class="number">30</span>) & (df[<span class="string">'حقوق'</span>] > <span class="number">5000000</span>)]
    <span class="function">print</span>(<span class="string">f"\nجوان و پردرآمد:\n{young_high_earners[[<span class="string">'نام'</span>, <span class="string">'سن'</span>, <span class="string">'حقوق'</span>]]}"</span>)
    
    <span class="comment"># شرط چندگانه با |</span>
    it_or_hr = df[(df[<span class="string">'بخش'</span>] == <span class="string">'IT'</span>) | (df[<span class="string">'بخش'</span>] == <span class="string">'HR'</span>)]
    <span class="function">print</span>(<span class="string">f"\nIT یا HR:\n{it_or_hr[[<span class="string">'نام'</span>, <span class="string">'بخش'</span>]]}"</span>)
    
    <span class="comment"># استفاده از isin</span>
    selected_cities = df[df[<span class="string">'شهر'</span>].isin([<span class="string">'تهران'</span>, <span class="string">'اصفهان'</span>])]
    <span class="function">print</span>(<span class="string">f"\nتهران یا اصفهان:\n{selected_cities[[<span class="string">'نام'</span>, <span class="string">'شهر'</span>]]}"</span>)
    
    <span class="comment"># استفاده از between</span>
    middle_aged = df[df[<span class="string">'سن'</span>].between(<span class="number">28</span>, <span class="number">32</span>)]
    <span class="function">print</span>(<span class="string">f"\nمیانسال (28-32):\n{middle_aged[[<span class="string">'نام'</span>, <span class="string">'سن'</span>]]}"</span>)
    
    <span class="comment"># جستجو در رشته‌ها</span>
    names_with_a = df[df[<span class="string">'نام'</span>].str.contains(<span class="string">'ا'</span>)]
    <span class="function">print</span>(<span class="string">f"\nنام‌های دارای 'ا':\n{names_with_a[<span class="string">'نام'</span>]}"</span>)
    
    <span class="comment"># نفی کردن شرط</span>
    not_tehran = df[~(df[<span class="string">'شهر'</span>] == <span class="string">'تهران'</span>)]
    <span class="function">print</span>(<span class="string">f"\nغیر تهرانی‌ها:\n{not_tehran[[<span class="string">'نام'</span>, <span class="string">'شهر'</span>]]}"</span>)
                        </div>
    
                        <h3>🎭 استفاده از query:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># استفاده از query برای شرط‌های پیچیده</span>
    <span class="function">print</span>(<span class="string">"🎭 استفاده از query:"</span>)
    
    <span class="comment"># شرط ساده</span>
    result1 = df.query(<span class="string">'سن > 30'</span>)
    <span class="function">print</span>(<span class="string">f"سن > 30:\n{result1[[<span class="string">'نام'</span>, <span class="string">'سن'</span>]]}"</span>)
    
    <span class="comment"># شرط چندگانه</span>
    result2 = df.query(<span class="string">'سن > 25 and حقوق > 5000000'</span>)
    <span class="function">print</span>(<span class="string">f"\nسن > 25 و حقوق > 5M:\n{result2[[<span class="string">'نام'</span>, <span class="string">'سن'</span>, <span class="string">'حقوق'</span>]]}"</span>)
    
    <span class="comment"># استفاده از متغیر خارجی</span>
    min_salary = <span class="number">5000000</span>
    result3 = df.query(<span class="string">'حقوق > @min_salary'</span>)
    <span class="function">print</span>(<span class="string">f"\nحقوق > {min_salary}:\n{result3[[<span class="string">'نام'</span>, <span class="string">'حقوق'</span>]]}"</span>)
    
    <span class="comment"># شرط رشته‌ای</span>
    result4 = df.query(<span class="string">"بخش == 'IT'"</span>)
    <span class="function">print</span>(<span class="string">f"\nبخش IT:\n{result4[[<span class="string">'نام'</span>, <span class="string">'بخش'</span>]]}"</span>)
    
    <span class="comment"># شرط پیچیده</span>
    result5 = df.query(<span class="string">'(سن < 30 and بخش == "IT") or حقوق > 5500000'</span>)
    <span class="function">print</span>(<span class="string">f"\nشرط پیچیده:\n{result5[[<span class="string">'نام'</span>, <span class="string">'سن'</span>, <span class="string">'بخش'</span>, <span class="string">'حقوق'</span>]]}"</span>)
                        </div>
    
                        <h3>🔄 تغییر و به‌روزرسانی داده‌ها:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># کپی DataFrame برای تغییرات</span>
    df_copy = df.copy()
    
    <span class="comment"># تغییر مقدار خاص</span>
    df_copy.loc[<span class="number">0</span>, <span class="string">'حقوق'</span>] = <span class="number">5500000</span>
    <span class="function">print</span>(<span class="string">"🔄 بعد از تغییر حقوق احمد:"</span>)
    <span class="function">print</span>(df_copy.loc[<span class="number">0</span>])
    
    <span class="comment"># تغییر چندین مقدار</span>
    df_copy.loc[df_copy[<span class="string">'بخش'</span>] == <span class="string">'IT'</span>, <span class="string">'حقوق'</span>] *= <span class="number">1.1</span>  <span class="comment"># 10% افزایش</span>
    <span class="function">print</span>(<span class="string">f"\nبعد از افزایش حقوق IT:\n{df_copy[df_copy['بخش'] == 'IT'][[<span class="string">'نام'</span>, <span class="string">'حقوق'</span>]]}"</span>)
    
    <span class="comment"># اضافه کردن ستون محاسبه شده</span>
    df_copy[<span class="string">'حقوق_سالانه'</span>] = df_copy[<span class="string">'حقوق'</span>] * <span class="number">12</span>
    <span class="function">print</span>(<span class="string">f"\nبا حقوق سالانه:\n{df_copy[[<span class="string">'نام'</span>, <span class="string">'حقوق'</span>, <span class="string">'حقوق_سالانه'</span>]].head(3)}"</span>)
    
    <span class="comment"># استفاده از where برای تغییر شرطی</span>
    df_copy[<span class="string">'رده_سنی'</span>] = df_copy[<span class="string">'سن'</span>].where(df_copy[<span class="string">'سن'</span>] >= <span class="number">30</span>, <span class="string">'جوان'</span>)
    df_copy[<span class="string">'رده_سنی'</span>] = df_copy[<span class="string">'رده_سنی'</span>].where(df_copy[<span class="string">'رده_سنی'</span>] == <span class="string">'جوان'</span>, <span class="string">'بزرگسال'</span>)
    <span class="function">print</span>(<span class="string">f"\nبا رده سنی:\n{df_copy[[<span class="string">'نام'</span>, <span class="string">'سن'</span>, <span class="string">'رده_سنی'</span>]]}"</span>)
    
    <span class="comment"># استفاده از mask</span>
    df_copy[<span class="string">'حقوق_مخفی'</span>] = df_copy[<span class="string">'حقوق'</span>].mask(df_copy[<span class="string">'حقوق'</span>] > <span class="number">5500000</span>, <span class="string">'محرمانه'</span>)
    <span class="function">print</span>(<span class="string">f"\nبا حقوق مخفی:\n{df_copy[[<span class="string">'نام'</span>, <span class="string">'حقوق'</span>, <span class="string">'حقوق_مخفی'</span>]]}"</span>)
                        </div>
    
                        <div class="method-grid">
                            <div class="method-card">
                                <div class="method-name">.loc[]</div>
                                <div class="method-desc">دسترسی با برچسب</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.iloc[]</div>
                                <div class="method-desc">دسترسی با موقعیت</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.query()</div>
                                <div class="method-desc">کوئری SQL-مانند</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.set_index()</div>
                                <div class="method-desc">تنظیم ایندکس</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.where()</div>
                                <div class="method-desc">تغییر شرطی</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.mask()</div>
                                <div class="method-desc">پنهان کردن شرطی</div>
                            </div>
                        </div>
    
                        <div class="warning-box">
                            <div class="warning-title">⚠️ نکات مهم:</div>
                            <ul>
                                <li>از & و | استفاده کنید نه and و or</li>
                                <li>شرط‌های چندگانه را در پرانتز قرار دهید</li>
                                <li>loc شامل انتهای بازه است، iloc شامل نیست</li>
                                <li>برای تغییرات دائمی از inplace=True استفاده کنید</li>
                            </ul>
                        </div>
                    </div>
                </div>
    
                <!-- اسلاید 6: تمیز کردن و آماده‌سازی داده‌ها -->
                <div class="slide" id="slide6">
                    <div class="slide-number">6/15</div>
                    <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                    <button class="close-btn" onclick="closeSlide(this)">×</button>
                    <div class="icon">🧹</div>
                    <div class="slide-title">تمیز کردن و آماده‌سازی داده‌ها</div>
                    <div class="slide-content">
                        <h3>🕳️ مدیریت مقادیر ناقص (Missing Values):</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد DataFrame با مقادیر ناقص</span>
    <span class="keyword">import</span> numpy <span class="keyword">as</span> np
    
    data_with_missing = {
        <span class="string">'نام'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, <span class="string">'زهرا'</span>, <span class="string">'محمد'</span>],
        <span class="string">'سن'</span>: [<span class="number">25</span>, np.nan, <span class="number">35</span>, <span class="number">28</span>, <span class="number">32</span>],
        <span class="string">'حقوق'</span>: [<span class="number">5000000</span>, <span class="number">4500000</span>, np.nan, <span class="number">5500000</span>, <span class="number">4800000</span>],
        <span class="string">'بخش'</span>: [<span class="string">'IT'</span>, <span class="keyword">None</span>, <span class="string">'Finance'</span>, <span class="string">'IT'</span>, <span class="string">'Marketing'</span>],
        <span class="string">'تلفن'</span>: [<span class="string">'09123456789'</span>, <span class="string">''</span>, <span class="string">'09187654321'</span>, np.nan, <span class="string">'09351234567'</span>]
    }
    
    df_missing = pd.DataFrame(data_with_missing)
    <span class="function">print</span>(<span class="string">"🕳️ DataFrame با مقادیر ناقص:"</span>)
    <span class="function">print</span>(df_missing)
    
    <span class="comment"># شناسایی مقادیر ناقص</span>
    <span class="function">print</span>(<span class="string">f"\n🔍 بررسی مقادیر ناقص:"</span>)
    <span class="function">print</span>(<span class="string">f"تعداد NaN در هر ستون:\n{df_missing.isnull().sum()}"</span>)
    <span class="function">print</span>(<span class="string">f"درصد مقادیر ناقص:\n{(df_missing.isnull().sum() / len(df_missing) * 100).round(2)}"</span>)
    
    <span class="comment"># نمایش سطرهایی که مقدار ناقص دارند</span>
    rows_with_missing = df_missing[df_missing.isnull().any(axis=<span class="number">1</span>)]
    <span class="function">print</span>(<span class="string">f"\nسطرهای دارای مقدار ناقص:\n{rows_with_missing}"</span>)
    
    <span class="comment"># نمایش ستون‌هایی که مقدار ناقص دارند</span>
    cols_with_missing = df_missing.columns[df_missing.isnull().any()].tolist()
    <span class="function">print</span>(<span class="string">f"ستون‌های دارای مقدار ناقص: {cols_with_missing}"</span>)
                        </div>
    
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># روش‌های مختلف حذف مقادیر ناقص</span>
    <span class="function">print</span>(<span class="string">"🗑️ حذف مقادیر ناقص:"</span>)
    
    <span class="comment"># حذف سطرهای دارای هر نوع NaN</span>
    df_drop_any = df_missing.dropna()
    <span class="function">print</span>(<span class="string">f"بعد از حذف سطرهای دارای NaN: {df_drop_any.shape}"</span>)
    <span class="function">print</span>(df_drop_any)
    
    <span class="comment"># حذف سطرهایی که همه مقادیر آن‌ها NaN است</span>
    df_drop_all = df_missing.dropna(how=<span class="string">'all'</span>)
    <span class="function">print</span>(<span class="string">f"\nبعد از حذف سطرهای کاملاً خالی: {df_drop_all.shape}"</span>)
    
    <span class="comment"># حذف بر اساس ستون خاص</span>
    df_drop_subset = df_missing.dropna(subset=[<span class="string">'سن'</span>, <span class="string">'حقوق'</span>])
    <span class="function">print</span>(<span class="string">f"\nبعد از حذف بر اساس سن و حقوق: {df_drop_subset.shape}"</span>)
    
    <span class="comment"># حذف ستون‌های دارای مقادیر ناقص</span>
    df_drop_cols = df_missing.dropna(axis=<span class="number">1</span>)
    <span class="function">print</span>(<span class="string">f"\nبعد از حذف ستون‌های دارای NaN: {df_drop_cols.shape}"</span>)
    <span class="function">print</span>(<span class="string">f"ستون‌های باقی‌مانده: {df_drop_cols.columns.tolist()}"</span>)
    
    <span class="comment"># تنظیم threshold برای حذف</span>
    df_thresh = df_missing.dropna(thresh=<span class="number">4</span>)  <span class="comment"># حداقل 4 مقدار غیر null</span>
    <span class="function">print</span>(<span class="string">f"\nبا threshold=4: {df_thresh.shape}"</span>)
                        </div>
    
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># پر کردن مقادیر ناقص</span>
    <span class="function">print</span>(<span class="string">"🔧 پر کردن مقادیر ناقص:"</span>)
    
    <span class="comment"># پر کردن با مقدار ثابت</span>
    df_filled_constant = df_missing.fillna(<span class="string">'نامشخص'</span>)
    <span class="function">print</span>(<span class="string">f"پر کردن با 'نامشخص':\n{df_filled_constant}"</span>)
    
    <span class="comment"># پر کردن هر ستون با مقدار متفاوت</span>
    fill_values = {
        <span class="string">'سن'</span>: df_missing[<span class="string">'سن'</span>].mean(),
        <span class="string">'حقوق'</span>: df_missing[<span class="string">'حقوق'</span>].median(),
        <span class="string">'بخش'</span>: <span class="string">'عمومی'</span>,
        <span class="string">'تلفن'</span>: <span class="string">'ندارد'</span>
    }
    
    df_filled_dict = df_missing.fillna(fill_values)
    <span class="function">print</span>(<span class="string">f"\nپر کردن با مقادیر مختلف:\n{df_filled_dict}"</span>)
    
    <span class="comment"># پر کردن با روش forward fill</span>
    df_ffill = df_missing.fillna(method=<span class="string">'ffill'</span>)
    <span class="function">print</span>(<span class="string">f"\nForward fill:\n{df_ffill}"</span>)
    
    <span class="comment"># پر کردن با روش backward fill</span>
    df_bfill = df_missing.fillna(method=<span class="string">'bfill'</span>)
    <span class="function">print</span>(<span class="string">f"\nBackward fill:\n{df_bfill}"</span>)
    
    <span class="comment"># پر کردن با interpolation</span>
    df_interpolated = df_missing.copy()
    df_interpolated[<span class="string">'سن'</span>] = df_interpolated[<span class="string">'سن'</span>].interpolate()
    df_interpolated[<span class="string">'حقوق'</span>] = df_interpolated[<span class="string">'حقوق'</span>].interpolate()
    <span class="function">print</span>(<span class="string">f"\nبا interpolation:\n{df_interpolated[[<span class="string">'نام'</span>, <span class="string">'سن'</span>, <span class="string">'حقوق'</span>]]}"</span>)
                        </div>
    
                        <h3>🔄 تبدیل نوع داده‌ها:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد DataFrame با انواع داده مختلط</span>
    mixed_data = {
        <span class="string">'id'</span>: [<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>],  <span class="comment"># رشته اما باید عدد باشد</span>
        <span class="string">'score'</span>: [<span class="string">'85.5'</span>, <span class="string">'92.0'</span>, <span class="string">'78.5'</span>, <span class="string">'88.0'</span>],  <span class="comment"># رشته اما باید float باشد</span>
        <span class="string">'is_active'</span>: [<span class="string">'True'</span>, <span class="string">'False'</span>, <span class="string">'True'</span>, <span class="string">'False'</span>],  <span class="comment"># رشته اما باید boolean باشد</span>
        <span class="string">'date_str'</span>: [<span class="string">'2023-01-15'</span>, <span class="string">'2023-02-20'</span>, <span class="string">'2023-03-10'</span>, <span class="string">'2023-04-05'</span>]  <span class="comment"># رشته اما باید datetime باشد</span>
    }
    
    df_mixed = pd.DataFrame(mixed_data)
    <span class="function">print</span>(<span class="string">"🔄 DataFrame با انواع داده مختلط:"</span>)
    <span class="function">print</span>(df_mixed)
    <span class="function">print</span>(<span class="string">f"\nانواع داده فعلی:\n{df_mixed.dtypes}"</span>)
    
    <span class="comment"># تبدیل نوع داده‌ها</span>
    df_converted = df_mixed.copy()
    
    <span class="comment"># تبدیل به عدد صحیح</span>
    df_converted[<span class="string">'id'</span>] = pd.to_numeric(df_converted[<span class="string">'id'</span>])
    
    <span class="comment"># تبدیل به عدد اعشاری</span>
    df_converted[<span class="string">'score'</span>] = pd.to_numeric(df_converted[<span class="string">'score'</span>])
    
    <span class="comment"># تبدیل به boolean</span>
    df_converted[<span class="string">'is_active'</span>] = df_converted[<span class="string">'is_active'</span>].map({<span class="string">'True'</span>: <span class="keyword">True</span>, <span class="string">'False'</span>: <span class="keyword">False</span>})
    
    <span class="comment"># تبدیل به datetime</span>
    df_converted[<span class="string">'date_str'</span>] = pd.to_datetime(df_converted[<span class="string">'date_str'</span>])
    
    <span class="function">print</span>(<span class="string">f"\nبعد از تبدیل:\n{df_converted.dtypes}"</span>)
    <span class="function">print</span>(<span class="string">f"\nDataFrame تبدیل شده:\n{df_converted}"</span>)
    
    <span class="comment"># تبدیل با خطا handling</span>
    problematic_data = pd.Series([<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'abc'</span>, <span class="string">'4'</span>])
    <span class="function">print</span>(<span class="string">f"\nداده مشکل‌دار: {problematic_data.tolist()}"</span>)
    
    <span class="comment"># تبدیل با errors='coerce' (تبدیل خطاها به NaN)</span>
    converted_safe = pd.to_numeric(problematic_data, errors=<span class="string">'coerce'</span>)
    <span class="function">print</span>(<span class="string">f"تبدیل ایمن: {converted_safe.tolist()}"</span>)
                        </div>
    
                        <h3>🧹 تمیز کردن رشته‌ها:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد DataFrame با رشته‌های کثیف</span>
    dirty_strings = {
        <span class="string">'نام'</span>: [<span class="string">'  احمد  '</span>, <span class="string">'فاطمه'</span>, <span class="string">'  علی محمدی  '</span>, <span class="string">'زهرا'</span>],
        <span class="string">'ایمیل'</span>: [<span class="string">'AHMAD@GMAIL.COM'</span>, <span class="string">'fateme@Yahoo.com'</span>, <span class="string">'ali.m@COMPANY.IR'</span>, <span class="string">'zahra@test.COM'</span>],
        <span class="string">'تلفن'</span>: [<span class="string">'091-234-5678'</span>, <span class="string">'09187654321'</span>, <span class="string">'(0919) 123-4567'</span>, <span class="string">'+98 935 123 4567'</span>]
    }
    
    df_dirty = pd.DataFrame(dirty_strings)
    <span class="function">print</span>(<span class="string">"🧹 رشته‌های کثیف:"</span>)
    <span class="function">print</span>(df_dirty)
    
    <span class="comment"># تمیز کردن نام‌ها</span>
    df_clean = df_dirty.copy()
    df_clean[<span class="string">'نام'</span>] = df_clean[<span class="string">'نام'</span>].str.strip()  <span class="comment"># حذف فاصله‌های اضافی</span>
    <span class="function">print</span>(<span class="string">f"\nبعد از strip:\n{df_clean['نام'].tolist()}"</span>)
    
    <span class="comment"># یکسان‌سازی ایمیل‌ها</span>
    df_clean[<span class="string">'ایمیل'</span>] = df_clean[<span class="string">'ایمیل'</span>].str.lower()  <span class="comment"># تبدیل به حروف کوچک</span>
    <span class="function">print</span>(<span class="string">f"ایمیل‌های یکسان: {df_clean['ایمیل'].tolist()}"</span>)
    
    <span class="comment"># تمیز کردن شماره تلفن</span>
    df_clean[<span class="string">'تلفن_تمیز'</span>] = (df_clean[<span class="string">'تلفن'</span>]
                                  .str.replace(<span class="string">'[^0-9]'</span>, <span class="string">''</span>, regex=<span class="keyword">True</span>)  <span class="comment"># حذف غیر عددی‌ها</span>
                                  .str.replace(<span class="string">'^98'</span>, <span class="string">'0'</span>, regex=<span class="keyword">True</span>))  <span class="comment"># تبدیل کد کشور</span>
    <span class="function">print</span>(<span class="string">f"تلفن‌های تمیز: {df_clean['تلفن_تمیز'].tolist()}"</span>)
    
    <span class="comment"># حذف کاراکترهای خاص</span>
    df_clean[<span class="string">'نام_انگلیسی'</span>] = df_clean[<span class="string">'نام'</span>].str.replace(<span class="string">'[^a-zA-Z\s]'</span>, <span class="string">''</span>, regex=<span class="keyword">True</span>)
    
    <span class="comment"># تبدیل به title case</span>
    df_clean[<span class="string">'نام_فرمت'</span>] = df_clean[<span class="string">'نام'</span>].str.title()
    
    <span class="function">print</span>(<span class="string">f"\nDataFrame تمیز شده:\n{df_clean}"</span>)
                        </div>
    
                        <h3>🔍 شناسایی و حذف تکراری‌ها:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد DataFrame با تکراری‌ها</span>
    duplicate_data = {
        <span class="string">'نام'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'احمد'</span>, <span class="string">'علی'</span>, <span class="string">'فاطمه'</span>],
        <span class="string">'سن'</span>: [<span class="number">25</span>, <span class="number">30</span>, <span class="number">25</span>, <span class="number">35</span>, <span class="number">30</span>],
        <span class="string">'شهر'</span>: [<span class="string">'تهران'</span>, <span class="string">'اصفهان'</span>, <span class="string">'تهران'</span>, <span class="string">'شیراز'</span>, <span class="string">'اصفهان'</span>]
    }
    
    df_dup = pd.DataFrame(duplicate_data)
    <span class="function">print</span>(<span class="string">"🔍 DataFrame با تکراری‌ها:"</span>)
    <span class="function">print</span>(df_dup)
    
    <span class="comment"># شناسایی تکراری‌ها</span>
    <span class="function">print</span>(<span class="string">f"\nآیا تکراری است؟\n{df_dup.duplicated()}"</span>)
    <span class="function">print</span>(<span class="string">f"تعداد تکراری‌ها: {df_dup.duplicated().sum()}"</span>)
    
    <span class="comment"># نمایش سطرهای تکراری</span>
    duplicate_rows = df_dup[df_dup.duplicated()]
    <span class="function">print</span>(<span class="string">f"\nسطرهای تکراری:\n{duplicate_rows}"</span>)
    
    <span class="comment"># حذف تکراری‌ها</span>
    df_no_dup = df_dup.drop_duplicates()
    <span class="function">print</span>(<span class="string">f"\nبعد از حذف تکراری‌ها:\n{df_no_dup}"</span>)
    
    <span class="comment"># حذف تکراری بر اساس ستون خاص</span>
    df_no_dup_name = df_dup.drop_duplicates(subset=[<span class="string">'نام'</span>])
    <span class="function">print</span>(<span class="string">f"\nحذف تکراری بر اساس نام:\n{df_no_dup_name}"</span>)
    
    <span class="comment"># نگه داشتن آخرین تکراری</span>
    df_keep_last = df_dup.drop_duplicates(keep=<span class="string">'last'</span>)
    <span class="function">print</span>(<span class="string">f"\nنگه داشتن آخرین:\n{df_keep_last}"</span>)
    
    <span class="comment"># شمارش تکرار هر مقدار</span>
    value_counts = df_dup.value_counts()
    <span class="function">print</span>(<span class="string">f"\nشمارش تکرارها:\n{value_counts}"</span>)
                        </div>
    
                        <div class="method-grid">
                            <div class="method-card">
                                <div class="method-name">.isnull()</div>
                                <div class="method-desc">شناسایی NaN</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.dropna()</div>
                                <div class="method-desc">حذف NaN</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.fillna()</div>
                                <div class="method-desc">پر کردن NaN</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">pd.to_numeric()</div>
                                <div class="method-desc">تبدیل به عدد</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.duplicated()</div>
                                <div class="method-desc">شناسایی تکراری</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.drop_duplicates()</div>
                                <div class="method-desc">حذف تکراری</div>
                            </div>
                        </div>
    
                        <div class="tip-box">
                            <div class="tip-title">🧹 بهترین روش‌های تمیزسازی:</div>
                            <ul>
                                <li><strong>مقادیر ناقص:</strong> ابتدا علت را بررسی کنید</li>
                                <li><strong>تبدیل نوع:</strong> از errors='coerce' برای امنیت استفاده کنید</li>
                                <li><strong>رشته‌ها:</strong> همیشه strip() و lower() اعمال کنید</li>
                                <li><strong>تکراری‌ها:</strong> قبل از حذف، علت تکرار را بررسی کنید</li>
                            </ul>
                        </div>
                    </div>
                </div>
    
                <!-- اسلاید 7: GroupBy و تجمیع داده‌ها -->
                <div class="slide" id="slide7">
                    <div class="slide-number">7/15</div>
                    <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                    <button class="close-btn" onclick="closeSlide(this)">×</button>
                    <div class="icon">📊</div>
                    <div class="slide-title">GroupBy و تجمیع داده‌ها</div>
                    <div class="slide-content">
                        <h3>🎯 مفهوم GroupBy:</h3>
                        <p>GroupBy یکی از قدرتمندترین ابزارهای Pandas برای تحلیل داده‌ها است که بر اساس مفهوم "Split-Apply-Combine" عمل می‌کند:</p>
                        <ul>
                            <li><strong>Split:</strong> تقسیم داده‌ها بر اساس معیار مشخص</li>
                            <li><strong>Apply:</strong> اعمال تابع بر روی هر گروه</li>
                            <li><strong>Combine:</strong> ترکیب نتایج</li>
                        </ul>
    
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد DataFrame نمونه برای GroupBy</span>
    sales_data = {
        <span class="string">'فروشنده'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, <span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, <span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>],
        <span class="string">'منطقه'</span>: [<span class="string">'شمال'</span>, <span class="string">'جنوب'</span>, <span class="string">'شرق'</span>, <span class="string">'شمال'</span>, <span class="string">'جنوب'</span>, <span class="string">'شرق'</span>, <span class="string">'غرب'</span>, <span class="string">'غرب'</span>],
        <span class="string">'محصول'</span>: [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'A'</span>, <span class="string">'B'</span>],
        <span class="string">'فروش'</span>: [<span class="number">100</span>, <span class="number">150</span>, <span class="number">200</span>, <span class="number">120</span>, <span class="number">180</span>, <span class="number">160</span>, <span class="number">90</span>, <span class="number">140</span>],
        <span class="string">'تعداد'</span>: [<span class="number">10</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">16</span>, <span class="number">9</span>, <span class="number">14</span>],
        <span class="string">'ماه'</span>: [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>]
    }
    
    df_sales = pd.DataFrame(sales_data)
    <span class="function">print</span>(<span class="string">"📊 داده‌های فروش:"</span>)
    <span class="function">print</span>(df_sales)
    
    <span class="comment"># GroupBy ساده</span>
    grouped_by_seller = df_sales.groupby(<span class="string">'فروشنده'</span>)
    <span class="function">print</span>(<span class="string">f"\nنوع GroupBy object: {type(grouped_by_seller)}"</span>)
    <span class="function">print</span>(<span class="string">f"تعداد گروه‌ها: {grouped_by_seller.ngroups}"</span>)
    <span class="function">print</span>(<span class="string">f"کلیدهای گروه‌ها: {list(grouped_by_seller.groups.keys())}"</span>)
                        </div>
    
                        <h3>📈 توابع تجمیعی پایه:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># توابع تجمیعی مختلف</span>
    <span class="function">print</span>(<span class="string">"📈 توابع تجمیعی:"</span>)
    
    <span class="comment"># مجموع فروش هر فروشنده</span>
    total_sales = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].sum()
    <span class="function">print</span>(<span class="string">f"مجموع فروش:\n{total_sales}"</span>)
    
    <span class="comment"># میانگین فروش هر فروشنده</span>
    avg_sales = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].mean()
    <span class="function">print</span>(<span class="string">f"\nمیانگین فروش:\n{avg_sales}"</span>)
    
    <span class="comment"># تعداد تراکنش‌های هر فروشنده</span>
    count_transactions = df_sales.groupby(<span class="string">'فروشنده'</span>).size()
    <span class="function">print</span>(<span class="string">f"\nتعداد تراکنش‌ها:\n{count_transactions}"</span>)
    
    <span class="comment"># حداکثر و حداقل فروش</span>
    max_sales = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].max()
    min_sales = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].min()
    <span class="function">print</span>(<span class="string">f"\nحداکثر فروش:\n{max_sales}"</span>)
    <span class="function">print</span>(<span class="string">f"حداقل فروش:\n{min_sales}"</span>)
    
    <span class="comment"># چندین تابع تجمیعی همزمان</span>
    multi_agg = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].agg([<span class="string">'sum'</span>, <span class="string">'mean'</span>, <span class="string">'count'</span>, <span class="string">'std'</span>])
    <span class="function">print</span>(<span class="string">f"\nچندین تابع تجمیعی:\n{multi_agg}"</span>)
    
    <span class="comment"># آمار کامل</span>
    describe_by_seller = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].describe()
    <span class="function">print</span>(<span class="string">f"\nآمار کامل:\n{describe_by_seller}"</span>)
                        </div>
    
                        <h3>🎯 GroupBy چندگانه:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># گروه‌بندی بر اساس چندین ستون</span>
    <span class="function">print</span>(<span class="string">"🎯 GroupBy چندگانه:"</span>)
    
    <span class="comment"># گروه‌بندی بر اساس فروشنده و منطقه</span>
    multi_group = df_sales.groupby([<span class="string">'فروشنده'</span>, <span class="string">'منطقه'</span>])[<span class="string">'فروش'</span>].sum()
    <span class="function">print</span>(<span class="string">f"فروش بر اساس فروشنده و منطقه:\n{multi_group}"</span>)
    
    <span class="comment"># تبدیل به DataFrame</span>
    multi_group_df = multi_group.reset_index()
    <span class="function">print</span>(<span class="string">f"\nبه صورت DataFrame:\n{multi_group_df}"</span>)
    
    <span class="comment"># گروه‌بندی سه‌گانه</span>
    triple_group = df_sales.groupby([<span class="string">'فروشنده'</span>, <span class="string">'منطقه'</span>, <span class="string">'محصول'</span>])[<span class="string">'فروش'</span>].sum()
    <span class="function">print</span>(<span class="string">f"\nگروه‌بندی سه‌گانه:\n{triple_group}"</span>)
    
    <span class="comment"># استفاده از unstack برای تبدیل به جدول</span>
    pivot_table = df_sales.groupby([<span class="string">'فروشنده'</span>, <span class="string">'منطقه'</span>])[<span class="string">'فروش'</span>].sum().unstack()
    <span class="function">print</span>(<span class="string">f"\nجدول محوری:\n{pivot_table}"</span>)
    
    <span class="comment"># پر کردن مقادیر NaN</span>
    pivot_filled = pivot_table.fillna(<span class="number">0</span>)
    <span class="function">print</span>(<span class="string">f"\nبا پر کردن NaN:\n{pivot_filled}"</span>)
                        </div>
    
                        <h3>🔧 توابع تجمیعی سفارشی:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># تعریف توابع سفارشی</span>
    <span class="keyword">def</span> <span class="function">range_func</span>(series):
        <span class="string">"""محاسبه دامنه (حداکثر - حداقل)"""</span>
        <span class="keyword">return</span> series.max() - series.min()
    
    <span class="keyword">def</span> <span class="function">coefficient_of_variation</span>(series):
        <span class="string">"""محاسبه ضریب تغییرات"""</span>
        <span class="keyword">return</span> series.std() / series.mean() <span class="keyword">if</span> series.mean() != <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>
    
    <span class="function">print</span>(<span class="string">"🔧 توابع سفارشی:"</span>)
    
    <span class="comment"># اعمال تابع سفارشی</span>
    sales_range = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].agg(range_func)
    <span class="function">print</span>(<span class="string">f"دامنه فروش:\n{sales_range}"</span>)
    
    <span class="comment"># اعمال چندین تابع سفارشی</span>
    custom_agg = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].agg([
        (<span class="string">'مجموع'</span>, <span class="string">'sum'</span>),
        (<span class="string">'میانگین'</span>, <span class="string">'mean'</span>),
        (<span class="string">'دامنه'</span>, range_func),
        (<span class="string">'ضریب_تغییرات'</span>, coefficient_of_variation)
    ])
    <span class="function">print</span>(<span class="string">f"\nتوابع سفارشی:\n{custom_agg}"</span>)
    
    <span class="comment"># اعمال توابع مختلف به ستون‌های مختلف</span>
    different_aggs = df_sales.groupby(<span class="string">'فروشنده'</span>).agg({
        <span class="string">'فروش'</span>: [<span class="string">'sum'</span>, <span class="string">'mean'</span>],
        <span class="string">'تعداد'</span>: [<span class="string">'sum'</span>, <span class="string">'max'</span>]
    })
    <span class="function">print</span>(<span class="string">f"\nتوابع مختلف برای ستون‌های مختلف:\n{different_aggs}"</span>)
    
    <span class="comment"># تابع lambda</span>
    lambda_agg = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].agg(<span class="keyword">lambda</span> x: x.max() - x.min())
    <span class="function">print</span>(<span class="string">f"\nبا lambda:\n{lambda_agg}"</span>)
                        </div>
    
                        <h3>🔍 بررسی گروه‌ها:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># بررسی جزئیات گروه‌ها</span>
    <span class="function">print</span>(<span class="string">"🔍 بررسی گروه‌ها:"</span>)
    
    grouped = df_sales.groupby(<span class="string">'فروشنده'</span>)
    
    <span class="comment"># نمایش هر گروه</span>
    <span class="keyword">for</span> name, group <span class="keyword">in</span> grouped:
        <span class="function">print</span>(<span class="string">f"\nگروه {name}:"</span>)
        <span class="function">print</span>(group)
    
    <span class="comment"># دسترسی به گروه خاص</span>
    ahmad_group = grouped.get_group(<span class="string">'احمد'</span>)
    <span class="function">print</span>(<span class="string">f"\nفروش‌های احمد:\n{ahmad_group}"</span>)
    
    <span class="comment"># اندازه هر گروه</span>
    group_sizes = grouped.size()
    <span class="function">print</span>(<span class="string">f"\nاندازه گروه‌ها:\n{group_sizes}"</span>)
    
    <span class="comment"># اولین و آخرین رکورد هر گروه</span>
    first_records = grouped.first()
    last_records = grouped.last()
    <span class="function">print</span>(<span class="string">f"\nاولین رکورد هر گروه:\n{first_records}"</span>)
    <span class="function">print</span>(<span class="string">f"\nآخرین رکورد هر گروه:\n{last_records}"</span>)
    
    <span class="comment"># n رکورد اول/آخر هر گروه</span>
    top_2 = grouped.head(<span class="number">2</span>)
    <span class="function">print</span>(<span class="string">f"\n2 رکورد اول هر گروه:\n{top_2}"</span>)
                        </div>
    
                        <h3>🎲 فیلتر کردن گروه‌ها:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># فیلتر کردن گروه‌ها بر اساس شرط</span>
    <span class="function">print</span>(<span class="string">"🎲 فیلتر گروه‌ها:"</span>)
    
    <span class="comment"># نگه داشتن گروه‌هایی که مجموع فروش بیش از 300 دارند</span>
    high_sales_groups = df_sales.groupby(<span class="string">'فروشنده'</span>).filter(<span class="keyword">lambda</span> x: x[<span class="string">'فروش'</span>].sum() > <span class="number">300</span>)
    <span class="function">print</span>(<span class="string">f"گروه‌های پرفروش:\n{high_sales_groups}"</span>)
    
    <span class="comment"># فیلتر بر اساس تعداد رکوردها</span>
    active_sellers = df_sales.groupby(<span class="string">'فروشنده'</span>).filter(<span class="keyword">lambda</span> x: len(x) >= <span class="number">3</span>)
    <span class="function">print</span>(<span class="string">f"\nفروشندگان فعال (حداقل 3 فروش):\n{active_sellers}"</span>)
    
    <span class="comment"># فیلتر پیچیده</span>
    consistent_sellers = df_sales.groupby(<span class="string">'فروشنده'</span>).filter(
        <span class="keyword">lambda</span> x: x[<span class="string">'فروش'</span>].std() < <span class="number">50</span>  <span class="comment"># انحراف معیار کم</span>
    )
    <span class="function">print</span>(<span class="string">f"\nفروشندگان با عملکرد ثابت:\n{consistent_sellers}"</span>)
    
    <span class="comment"># ترکیب فیلتر و تجمیع</span>
    filtered_agg = (df_sales.groupby(<span class="string">'فروشنده'</span>)
                    .filter(<span class="keyword">lambda</span> x: x[<span class="string">'فروش'</span>].sum() > <span class="number">250</span>)
                    .groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>]
                    .mean())
    <span class="function">print</span>(<span class="string">f"\nمیانگین فروش گروه‌های فیلتر شده:\n{filtered_agg}"</span>)
                        </div>
    
                        <h3>📊 Transform و Apply:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># استفاده از transform</span>
    <span class="function">print</span>(<span class="string">"📊 Transform و Apply:"</span>)
    
    <span class="comment"># اضافه کردن میانگین گروه به هر رکورد</span>
    df_sales[<span class="string">'میانگین_فروشنده'</span>] = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].transform(<span class="string">'mean'</span>)
    <span class="function">print</span>(<span class="string">f"با میانگین فروشنده:\n{df_sales[[<span class="string">'فروشنده'</span>, <span class="string">'فروش'</span>, <span class="string">'میانگین_فروشنده'</span>]]}"</span>)
    
    <span class="comment"># محاسبه انحراف از میانگین</span>
    df_sales[<span class="string">'انحراف_از_میانگین'</span>] = df_sales[<span class="string">'فروش'</span>] - df_sales[<span class="string">'میانگین_فروشنده'</span>]
    <span class="function">print</span>(<span class="string">f"\nبا انحراف از میانگین:\n{df_sales[[<span class="string">'فروشنده'</span>, <span class="string">'فروش'</span>, <span class="string">'انحراف_از_میانگین'</span>]]}"</span>)
    
    <span class="comment"># نرمال‌سازی در هر گروه</span>
    df_sales[<span class="string">'فروش_نرمال'</span>] = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].transform(
        <span class="keyword">lambda</span> x: (x - x.mean()) / x.std()
    )
    <span class="function">print</span>(<span class="string">f"\nفروش نرمال شده:\n{df_sales[[<span class="string">'فروشنده'</span>, <span class="string">'فروش'</span>, <span class="string">'فروش_نرمال'</span>]]}"</span>)
    
    <span class="comment"># رتبه‌بندی در هر گروه</span>
    df_sales[<span class="string">'رتبه_در_گروه'</span>] = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].rank(ascending=<span class="keyword">False</span>)
    <span class="function">print</span>(<span class="string">f"\nرتبه در گروه:\n{df_sales[[<span class="string">'فروشنده'</span>, <span class="string">'فروش'</span>, <span class="string">'رتبه_در_گروه```html
    <span class="keyword">import</span> os
    files_to_remove = [
        <span class="string">'employees.csv'</span>, <span class="string">'employees.xlsx'</span>, <span class="string">'employees.json'</span>,
        <span class="string">'multiple_sheets.xlsx'</span>, <span class="string">'company.db'</span>, <span class="string">'employees_advanced.csv'</span>,
        <span class="string">'salary_report.csv'</span>, <span class="string">'high_earners.csv'</span>, <span class="string">'employees_compressed.csv.gz'</span>
    ]
    
    <span class="keyword">for</span> file <span class="keyword">in</span> files_to_remove:
        <span class="keyword">try</span>:
            <span class="keyword">if</span> os.path.exists(file):
                os.remove(file)
        <span class="keyword">except</span>:
            <span class="keyword">pass</span>
    
    <span class="function">print</span>(<span class="string">"🧹 فایل‌های نمونه پاک شدند"</span>)
                        </div>
    
                        <div class="method-grid">
                            <div class="method-card">
                                <div class="method-name">pd.read_csv()</div>
                                <div class="method-desc">خواندن CSV</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">pd.read_excel()</div>
                                <div class="method-desc">خواندن Excel</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">pd.read_json()</div>
                                <div class="method-desc">خواندن JSON</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">pd.read_sql()</div>
                                <div class="method-desc">خواندن از پایگاه داده</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.to_csv()</div>
                                <div class="method-desc">ذخیره CSV</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.to_excel()</div>
                                <div class="method-desc">ذخیره Excel</div>
                            </div>
                        </div>
    
                        <div class="info-box">
                            <div class="info-title">📁 فرمت‌های پشتیبانی شده:</div>
                            <ul>
                                <li><strong>CSV:</strong> متداول‌ترین فرمت تبادل داده</li>
                                <li><strong>Excel:</strong> فایل‌های .xlsx و .xls</li>
                                <li><strong>JSON:</strong> فرمت وب و API</li>
                                <li><strong>SQL:</strong> پایگاه‌های داده مختلف</li>
                                <li><strong>Parquet:</strong> بهینه برای داده‌های بزرگ</li>
                                <li><strong>HDF5:</strong> فرمت علمی پرسرعت</li>
                            </ul>
                        </div>
    
                        <div class="tip-box">
                            <div class="tip-title">💡 نکات I/O:</div>
                            <ul>
                                <li>همیشه encoding مناسب برای متن فارسی تنظیم کنید</li>
                                <li>برای داده‌های بزرگ از چانک‌ها استفاده کنید</li>
                                <li>نوع داده‌ها را در هنگام خواندن مشخص کنید</li>
                                <li>از فشرده‌سازی برای صرفه‌جویی فضا استفاده کنید</li>
                            </ul>
                        </div>
                    </div>
                </div>
    
                <!-- اسلاید 5: Indexing و Slicing پیشرفته -->
                <div class="slide" id="slide5">
                    <div class="slide-number">5/15</div>
                    <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                    <button class="close-btn" onclick="closeSlide(this)">×</button>
                    <div class="icon">🎯</div>
                    <div class="slide-title">Indexing و Slicing پیشرفته</div>
                    <div class="slide-content">
                        <h3>🔍 تفاوت loc و iloc:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد DataFrame نمونه</span>
    data = {
        <span class="string">'نام'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, <span class="string">'زهرا'</span>, <span class="string">'محمد'</span>],
        <span class="string">'ریاضی'</span>: [<span class="number">18</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">17</span>, <span class="number">15</span>],
        <span class="string">'فیزیک'</span>: [<span class="number">17</span>, <span class="number">18</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">14</span>],
        <span class="string">'شیمی'</span>: [<span class="number">16</span>, <span class="number">19</span>, <span class="number">18</span>, <span class="number">17</span>, <span class="number">16</span>],
        <span class="string">'زیست'</span>: [<span class="number">19</span>, <span class="number">17</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">17</span>]
    }
    
    df = pd.DataFrame(data)
    df.index = [<span class="string">'std_001'</span>, <span class="string">'std_002'</span>, <span class="string">'std_003'</span>, <span class="string">'std_004'</span>, <span class="string">'std_005'</span>]
    <span class="function">print</span>(<span class="string">"📊 DataFrame دانش‌آموزان:"</span>)
    <span class="function">print</span>(df)
    
    <span class="comment"># loc: دسترسی با برچسب</span>
    <span class="function">print</span>(<span class="string">f"\n🎯 با loc (برچسب):"</span>)
    <span class="function">print</span>(<span class="string">f"دانش‌آموز std_002:\n{df.loc['std_002']}"</span>)
    <span class="function">print</span>(<span class="string">f"نمره ریاضی احمد: {df.loc['std_001', 'ریاضی']}"</span>)
    
    <span class="comment"># iloc: دسترسی با موقعیت</span>
    <span class="function">print</span>(<span class="string">f"\n🎯 با iloc (موقعیت):"</span>)
    <span class="function">print</span>(<span class="string">f"دانش‌آموز ایندکس 1:\n{df.iloc[1]}"</span>)
    <span class="function">print</span>(<span class="string">f"سلول [0,1]: {df.iloc[0, 1]}"</span>)
    
    <span class="comment"># دسترسی به محدوده</span>
    <span class="function">print</span>(<span class="string">f"\nمحدوده با loc:\n{df.loc['std_001':'std_003', 'ریاضی':'شیمی']}"</span>)
    <span class="function">print</span>(<span class="string">f"\nمحدوده با iloc:\n{df.iloc[0:3, 1:4]}"</span>)
    
    <span class="comment"># انتخاب سطرها و ستون‌های غیرمتوالی</span>
    selected_students = [<span class="string">'std_001'</span>, <span class="string">'std_003'</span>, <span class="string">'std_005'</span>]
    selected_subjects = [<span class="string">'نام'</span>, <span class="string">'ریاضی'</span>, <span class="string">'فیزیک'</span>]
    <span class="function">print</span>(<span class="string">f"\nانتخاب غیرمتوالی:\n{df.loc[selected_students, selected_subjects]}"</span>)
                        </div>
    
                        <h3>🔎 فیلترینگ و انتخاب شرطی:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># شرط ساده</span>
    high_math = df[df[<span class="string">'ریاضی'</span>] >= <span class="number">17</span>]
    <span class="function">print</span>(<span class="string">"🔎 دانش‌آموزان با نمره ریاضی بالا:"</span>)
    <span class="function">print</span>(high_math)
    
    <span class="comment"># شرط چندگانه با AND</span>
    good_students = df[(df[<span class="string">'ریاضی'</span>] >= <span class="number">17</span>) & (df[<span class="string">'فیزیک'</span>] >= <span class="number">17</span>)]
    <span class="function">print</span>(<span class="string">f"\nدانش‌آموزان خوب در ریاضی و فیزیک:\n{good_students}"</span>)
    
    <span class="comment"># شرط چندگانه با OR</span>
    math_or_physics = df[(df[<span class="string">'ریاضی'</span>] >= <span class="number">19</span>) | (df[<span class="string">'فیزیک'</span>] >= <span class="number">19</span>)]
    <span class="function">print</span>(<span class="string">f"\nعالی در ریاضی یا فیزیک:\n{math_or_physics}"</span>)
    
    <span class="comment"># شرط با in</span>
    selected_names = [<span class="string">'احمد'</span>, <span class="string">'زهرا'</span>]
    selected_students = df[df[<span class="string">'نام'</span>].isin(selected_names)]
    <span class="function">print</span>(<span class="string">f"\nدانش‌آموزان انتخابی:\n{selected_students}"</span>)
    
    <span class="comment"># شرط با between</span>
    medium_scores = df[df[<span class="string">'ریاضی'</span>].between(<span class="number">16</span>, <span class="number">18</span>)]
    <span class="function">print</span>(<span class="string">f"\nنمرات متوسط ریاضی:\n{medium_scores}"</span>)
    
    <span class="comment"># شرط با رشته</span>
    names_with_a = df[df[<span class="string">'نام'</span>].str.contains(<span class="string">'ا'</span>)]
    <span class="function">print</span>(<span class="string">f"\nنام‌های شامل 'ا':\n{names_with_a}"</span>)
    
    <span class="comment"># شرط معکوس</span>
    not_high_math = df[~(df[<span class="string">'ریاضی'</span>] >= <span class="number">18</span>)]
    <span class="function">print</span>(<span class="string">f"\nغیر از نمرات بالای ریاضی:\n{not_high_math}"</span>)
    
    <span class="comment"># استفاده از query (روش جایگزین)</span>
    query_result = df.query(<span class="string">'ریاضی >= 17 and فیزیک >= 16'</span>)
    <span class="function">print</span>(<span class="string">f"\nبا query:\n{query_result}"</span>)
                        </div>
    
                        <h3>🎲 نمونه‌گیری و مرتب‌سازی:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># نمونه‌گیری تصادفی</span>
    random_sample = df.sample(n=<span class="number">3</span>, random_state=<span class="number">42</span>)
    <span class="function">print</span>(<span class="string">"🎲 نمونه تصادفی (3 دانش‌آموز):"</span>)
    <span class="function">print</span>(random_sample)
    
    <span class="comment"># نمونه‌گیری با درصد</span>
    percent_sample = df.sample(frac=<span class="number">0.6</span>, random_state=<span class="number">42</span>)  <span class="comment"># 60% از داده‌ها</span>
    <span class="function">print</span>(<span class="string">f"\nنمونه 60 درصدی:\n{percent_sample}"</span>)
    
    <span class="comment"># مرتب‌سازی بر اساس یک ستون</span>
    sorted_by_math = df.sort_values(<span class="string">'ریاضی'</span>, ascending=<span class="keyword">False</span>)
    <span class="function">print</span>(<span class="string">f"\nمرتب شده بر اساس ریاضی (نزولی):\n{sorted_by_math}"</span>)
    
    <span class="comment"># مرتب‌سازی بر اساس چندین ستون</span>
    sorted_multi = df.sort_values([<span class="string">'ریاضی'</span>, <span class="string">'فیزیک'</span>], ascending=[<span class="keyword">False</span>, <span class="keyword">True</span>])
    <span class="function">print</span>(<span class="string">f"\nمرتب چندگانه:\n{sorted_multi}"</span>)
    
    <span class="comment"># مرتب‌سازی بر اساس ایندکس</span>
    sorted_by_index = df.sort_index(ascending=<span class="keyword">True</span>)
    <span class="function">print</span>(<span class="string">f"\nمرتب بر اساس ایندکس:\n{sorted_by_index}"</span>)
    
    <span class="comment"># رتبه‌بندی</span>
    df[<span class="string">'رتبه_ریاضی'</span>] = df[<span class="string">'ریاضی'</span>].rank(ascending=<span class="keyword">False</span>, method=<span class="string">'min'</span>)
    <span class="function">print</span>(<span class="string">f"\nبا رتبه‌بندی:\n{df[[<span class="string">'نام'</span>, <span class="string">'ریاضی'</span>, <span class="string">'رتبه_ریاضی'</span>]]}"</span>)
    
    <span class="comment"># پیدا کردن n مقدار بالا/پایین</span>
    top_3_math = df.nlargest(<span class="number">3</span>, <span class="string">'ریاضی'</span>)
    bottom_2_physics = df.nsmallest(<span class="number">2</span>, <span class="string">'فیزیک'</span>)
    <span class="function">print</span>(<span class="string">f"\n3 نمره برتر ریاضی:\n{top_3_math[[<span class="string">'نام'</span>, <span class="string">'ریاضی'</span>]]}"</span>)
    <span class="function">print</span>(<span class="string">f"\n2 نمره پایین فیزیک:\n{bottom_2_physics[[<span class="string">'نام'</span>, <span class="string">'فیزیک'</span>]]}"</span>)
                        </div>
    
                        <h3>🔄 تغییر شکل داده‌ها:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># تنظیم مجدد ایندکس</span>
    df_reset = df.reset_index()
    <span class="function">print</span>(<span class="string">"🔄 بعد از reset_index:"</span>)
    <span class="function">print</span>(df_reset.head())
    
    <span class="comment"># تنظیم ستون به عنوان ایندکس</span>
    df_name_index = df.set_index(<span class="string">'نام'</span>)
    <span class="function">print</span>(<span class="string">f"\nبا نام به عنوان ایندکس:\n{df_name_index.head()}"</span>)
    
    <span class="comment"># ایندکس چندسطحی</span>
    df_multi = df.copy()
    df_multi[<span class="string">'کلاس'</span>] = [<span class="string">'10A'</span>, <span class="string">'10A'</span>, <span class="string">'10B'</span>, <span class="string">'10B'</span>, <span class="string">'10A'</span>]
    df_multi_index = df_multi.set_index([<span class="string">'کلاس'</span>, <span class="string">'نام'</span>])
    <span class="function">print</span>(<span class="string">f"\nایندکس چندسطحی:\n{df_multi_index}"</span>)
    
    <span class="comment"># دسترسی در ایندکس چندسطحی</span>
    <span class="function">print</span>(<span class="string">f"\nدانش‌آموزان کلاس 10A:\n{df_multi_index.loc['10A']}"</span>)
    <span class="function">print</span>(<span class="string">f"\nاحمد از کلاس 10A:\n{df_multi_index.loc[('10A', 'احمد')]}"</span>)
    
    <span class="comment"># تبدیل ایندکس چندسطحی به ستون</span>
    df_unstacked = df_multi_index.unstack(level=<span class="number">0</span>)
    <span class="function">print</span>(<span class="string">f"\nبعد از unstack:\n{df_unstacked}"</span>)
    
    <span class="comment"># جابجایی سطرها و ستون‌ها</span>
    df_transposed = df[[<span class="string">'ریاضی'</span>, <span class="string">'فیزیک'</span>, <span class="string">'شیمی'</span>]].T
    <span class="function">print</span>(<span class="string">f"\nجابجا شده:\n{df_transposed}"</span>)
    
    <span class="comment"># تغییر نام ستون‌ها و ایندکس</span>
    df_renamed = df.rename(columns={<span class="string">'ریاضی'</span>: <span class="string">'Math'</span>, <span class="string">'فیزیک'</span>: <span class="string">'Physics'</span>})
    df_renamed = df_renamed.rename(index={<span class="string">'std_001'</span>: <span class="string">'student_001'</span>})
    <span class="function">print</span>(<span class="string">f"\nبعد از تغییر نام:\n{df_renamed.head()}"</span>)
                        </div>
    
                        <h3>🎨 ایندکس‌گذاری پیشرفته:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد ایندکس تاریخی</span>
    dates = pd.date_range(<span class="string">'2024-01-01'</span>, periods=<span class="number">5</span>, freq=<span class="string">'D'</span>)
    df_time = pd.DataFrame({
        <span class="string">'فروش'</span>: [<span class="number">100</span>, <span class="number">120</span>, <span class="number">90</span>, <span class="number">150</span>, <span class="number">110</span>],
        <span class="string">'بازدید'</span>: [<span class="number">500</span>, <span class="number">600</span>, <span class="number">450</span>, <span class="number">750</span>, <span class="number">550</span>]
    }, index=dates)
    <span class="function">print</span>(<span class="string">"🎨 DataFrame با ایندکس تاریخی:"</span>)
    <span class="function">print</span>(df_time)
    
    <span class="comment"># دسترسی با تاریخ</span>
    <span class="function">print</span>(<span class="string">f"\nداده‌های 2024-01-03:\n{df_time.loc['2024-01-03']}"</span>)
    <span class="function">print</span>(<span class="string">f"\nداده‌های بازه:\n{df_time.loc['2024-01-02':'2024-01-04']}"</span>)
    
    <span class="comment"># ایندکس عددی غیرمتوالی</span>
    irregular_index = [<span class="number">10</span>, <span class="number">25</span>, <span class="number">30</span>, <span class="number">45</span>, <span class="number">60</span>]
    df_irregular = pd.DataFrame({
        <span class="string">'مقدار'</span>: [<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>]
    }, index=irregular_index)
    <span class="function">print</span>(<span class="string">f"\nایندکس غیرمتوالی:\n{df_irregular}"</span>)
    
    <span class="comment"># reindex: تغییر ترتیب یا اضافه کردن ایندکس</span>
    new_index = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>]
    df_reindexed = df_irregular.reindex(new_index, fill_value=<span class="number">0</span>)
    <span class="function">print</span>(<span class="string">f"\nبعد از reindex:\n{df_reindexed}"</span>)
    
    <span class="comment"># ایندکس‌گذاری بولین پیشرفته</span>
    mask = (df[<span class="string">'ریاضی'</span>] > df[<span class="string">'ریاضی'</span>].mean()) & (df[<span class="string">'فیزیک'</span>] > df[<span class="string">'فیزیک'</span>].mean())
    above_average = df[mask]
    <span class="function">print</span>(<span class="string">f"\nبالاتر از میانگین در هر دو درس:\n{above_average}"</span>)
    
    <span class="comment"># where: جایگزینی شرطی</span>
    df_conditional = df.where(df > <span class="number">16</span>, <span class="string">'پایین'</span>)
    <span class="function">print</span>(<span class="string">f"\nجایگزینی شرطی:\n{df_conditional}"</span>)
                        </div>
    
                        <div class="method-grid">
                            <div class="method-card">
                                <div class="method-name">.loc[]</div>
                                <div class="method-desc">دسترسی با برچسب</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.iloc[]</div>
                                <div class="method-desc">دسترسی با موقعیت</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.query()</div>
                                <div class="method-desc">فیلتر با رشته</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.sample()</div>
                                <div class="method-desc">نمونه‌گیری</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.sort_values()</div>
                                <div class="method-desc">مرتب‌سازی</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.set_index()</div>
                                <div class="method-desc">تنظیم ایندکس</div>
                            </div>
                        </div>
    
                        <div class="warning-box">
                            <div class="warning-title">⚠️ نکات مهم:</div>
                            <ul>
                                <li>از & و | برای شرایط چندگانه استفاده کنید، نه and و or</li>
                                <li>شرایط را در پرانتز قرار دهید</li>
                                <li>loc شامل انتها است، iloc شامل انتها نیست</li>
                                <li>برای کپی از .copy() استفاده کنید تا از SettingWithCopyWarning جلوگیری کنید</li>
                            </ul>
                        </div>
                    </div>
                </div>
    
                <!-- اسلاید 6: تمیز کردن و آماده‌سازی داده‌ها -->
                <div class="slide" id="slide6">
                    <div class="slide-number">6/15</div>
                    <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                    <button class="close-btn" onclick="closeSlide(this)">×</button>
                    <div class="icon">🧹</div>
                    <div class="slide-title">تمیز کردن و آماده‌سازی داده‌ها</div>
                    <div class="slide-content">
                        <h3>🔍 شناسایی مشکلات داده:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد داده‌های کثیف برای تمرین</span>
    dirty_data = {
        <span class="string">'نام'</span>: [<span class="string">'احمد'</span>, <span class="string">'  فاطمه  '</span>, <span class="string">'علی'</span>, <span class="keyword">None</span>, <span class="string">'زهرا'</span>, <span class="string">'محمد'</span>],
        <span class="string">'سن'</span>: [<span class="number">25</span>, <span class="string">'30'</span>, <span class="number">35</span>, <span class="number">28</span>, np.nan, <span class="string">'نامعلوم'</span>],
        <span class="string">'حقوق'</span>: [<span class="number">5000000</span>, <span class="number">4500000</span>, <span class="keyword">None</span>, <span class="number">5500000</span>, <span class="number">4800000</span>, <span class="string">'6,000,000'</span>],
        <span class="string">'شهر'</span>: [<span class="string">'تهران'</span>, <span class="string">'اصفهان'</span>, <span class="string">'SHIRAZ'</span>, <span class="string">'مشهد'</span>, <span class="string">'تبریز'</span>, <span class="string">'تهران'</span>],
        <span class="string">'تاریخ_استخدام'</span>: [<span class="string">'2020-01-15'</span>, <span class="string">'2019/03/20'</span>, <span class="string">'2021-12-01'</span>, <span class="string">'نامعلوم'</span>, <span class="string">'2020-06-10'</span>, <span class="string">'2018-09-25'</span>]
    }
    
    df_dirty = pd.DataFrame(dirty_data)
    <span class="function">print</span>(<span class="string">"🧹 داده‌های کثیف:"</span>)
    <span class="function">print</span>(df_dirty)
    <span class="function">print</span>(<span class="string">f"\nانواع داده:\n{df_dirty.dtypes}"</span>)
    
    <span class="comment"># بررسی مقادیر null</span>
    <span class="function">print</span>(<span class="string">f"\nمقادیر null:\n{df_dirty.isnull().sum()}"</span>)
    <span class="function">print</span>(<span class="string">f"\nدرصد مقادیر null:\n{(df_dirty.isnull().sum() / len(df_dirty) * 100).round(2)}"</span>)
    
    <span class="comment"># بررسی مقادیر تکراری</span>
    <span class="function">print</span>(<span class="string">f"\nتعداد سطرهای تکراری: {df_dirty.duplicated().sum()}"</span>)
    
    <span class="comment"># نمایش اطلاعات کلی</span>
    <span class="function">print</span>(<span class="string">f"\nاطلاعات کلی:"</span>)
    df_dirty.info()
                        </div>
    
                        <h3>🔧 تمیز کردن مقادیر null:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># کپی برای تمیز کردن</span>
    df_clean = df_dirty.copy()
    
    <span class="comment"># روش 1: حذف سطرهای دارای null</span>
    df_dropped_rows = df_clean.dropna()
    <span class="function">print</span>(<span class="string">f"🔧 بعد از حذف سطرهای null: {df_dropped_rows.shape}"</span>)
    
    <span class="comment"># روش 2: حذف ستون‌های دارای null زیاد</span>
    df_dropped_cols = df_clean.dropna(axis=<span class="number">1</span>, thresh=<span class="number">4</span>)  <span class="comment"># حداقل 4 مقدار غیر null</span>
    <span class="function">print</span>(<span class="string">f"بعد از حذف ستون‌های null: {df_dropped_cols.shape}"</span>)
    
    <span class="comment"># روش 3: پر کردن با مقدار ثابت</span>
    df_filled = df_clean.fillna(<span class="string">'نامشخص'</span>)
    <span class="function">print</span>(<span class="string">f"\nپر شده با 'نامشخص':\n{df_filled}"</span>)
    
    <span class="comment"># روش 4: پر کردن با میانگین/مد</span>
    df_smart_fill = df_clean.copy()
    
    <span class="comment"># تبدیل سن به عددی (با خطاها)</span>
    df_smart_fill[<span class="string">'سن'</span>] = pd.to_numeric(df_smart_fill[<span class="string">'سن'</span>], errors=<span class="string">'coerce'</span>)
    <span class="comment"># پر کردن سن با میانگین</span>
    mean_age = df_smart_fill[<span class="string">'سن'</span>].mean()
    df_smart_fill[<span class="string">'سن'</span>].fillna(mean_age, inplace=<span class="keyword">True</span>)
    
    <span class="comment"># پر کردن نام با مد (پرتکرارترین)</span>
    mode_name = df_smart_fill[<span class="string">'نام'</span>].mode()[<span class="number">0</span>] <span class="keyword">if</span> not df_smart_fill[<span class="string">'نام'</span>].mode().empty <span class="keyword">else</span> <span class="string">'نامشخص'</span>
    df_smart_fill[<span class="string">'نام'</span>].fillna(mode_name, inplace=<span class="keyword">True</span>)
    
    <span class="function">print</span>(<span class="string">f"\nپر شده هوشمند:\n{df_smart_fill}"</span>)
    
    <span class="comment"># روش 5: forward fill و backward fill</span>
    df_ffill = df_clean.fillna(method=<span class="string">'ffill'</span>)  <span class="comment"># پر کردن با مقدار قبلی</span>
    df_bfill = df_clean.fillna(method=<span class="string">'bfill'</span>)  <span class="comment"># پر کردن با مقدار بعدی</span>
    <span class="function">print</span>(<span class="string">f"\nForward fill:\n{df_ffill}"</span>)
    
    <span class="comment"># روش 6: interpolation</span>
    numeric_series = pd.Series([<span class="number">1</span>, <span class="number">2</span>, np.nan, <span class="number">4</span>, <span class="number">5</span>, np.nan, <span class="number">7</span>])
    interpolated = numeric_series.interpolate()
    <span class="function">print</span>(<span class="string">f"\nقبل از interpolation: {numeric_series.tolist()}"</span>)
    <span class="function">print</span>(<span class="string">f"بعد از interpolation: {interpolated.tolist()}"</span>)
                        </div>
    
                        <h3>🔤 تمیز کردن داده‌های متنی:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># تمیز کردن فضاهای اضافی</span>
    df_text_clean = df_dirty.copy()
    df_text_clean[<span class="string">'نام'</span>] = df_text_clean[<span class="string">'نام'</span>].str.strip()
    <span class="function">print</span>(<span class="string">"🔤 بعد از حذف فضاهای اضافی:"</span>)
    <span class="function">print</span>(df_text_clean[<span class="string">'نام'</span>])
    
    <span class="comment"># یکسان‌سازی حروف</span>
    df_text_clean[<span class="string">'شهر'</span>] = df_text_clean[<span class="string">'شهر'</span>].str.lower()
    <span class="function">print</span>(<span class="string">f"\nبعد از تبدیل به حروف کوچک:\n{df_text_clean['شهر']}"</span>)
    
    <span class="comment"># جایگزینی مقادیر</span>
    df_text_clean[<span class="string">'شهر'</span>] = df_text_clean[<span class="string">'شهر'</span>].str.replace(<span class="string">'shiraz'</span>, <span class="string">'شیراز'</span>)
    <span class="function">print</span>(<span class="string">f"\nبعد از جایگزینی:\n{df_text_clean['شهر']}"</span>)
    
    <span class="comment"># حذف کاراکترهای خاص از حقوق</span>
    df_text_clean[<span class="string">'حقوق_تمیز'</span>] = df_text_clean[<span class="string">'حقوق'</span>].astype(str).str.replace(<span class="string">','</span>, <span class="string">''</span>)
    df_text_clean[<span class="string">'حقوق_تمیز'</span>] = pd.to_numeric(df_text_clean[<span class="string">'حقوق_تمیز'</span>], errors=<span class="string">'coerce'</span>)
    <span class="function">print</span>(<span class="string">f"\nحقوق تمیز:\n{df_text_clean[['حقوق', 'حقوق_تمیز']]}"</span>)
    
    <span class="comment"># استاندارد کردن نام‌ها</span>
    df_text_clean[<span class="string">'نام_استاندارد'</span>] = (df_text_clean[<span class="string">'نام'</span>]
                                        .str.strip()
                                        .str.title()  <span class="comment"># حرف اول بزرگ</span>
                                        .str.replace(<span class="string">r'\s+'</span>, <span class="string">' '</span>, regex=<span class="keyword">True</span>))  <span class="comment"># فضاهای چندگانه</span>
    <span class="function">print</span>(<span class="string">f"\nنام‌های استاندارد:\n{df_text_clean[['نام', 'نام_استاندارد']]}"</span>)
    
    <span class="comment"># شناسایی و تصحیح املا (ساده)</span>
    city_corrections = {
        <span class="string">'tehran'</span>: <span class="string">'تهران'</span>,
        <span class="string">'isfahan'</span>: <span class="string">'اصفهان'</span>,
        <span class="string">'shiraz'</span>: <span class="string">'شیراز'</span>
    }
    df_text_clean[<span class="string">'شهر'</span>] = df_text_clean[<span class="string">'شهر'</span>].replace(city_corrections)
    <span class="function">print</span>(<span class="string">f"\nشهرهای تصحیح شده:\n{df_text_clean['شهر']}"</span>)
                        </div>
    
                        <h3>📅 تمیز کردن داده‌های تاریخ:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># تبدیل تاریخ‌ها</span>
    df_date_clean = df_dirty.copy()
    
    <span class="comment"># جایگزینی مقادیر نامعلوم</span>
    df_date_clean[<span class="string">'تاریخ_استخدام'</span>] = df_date_clean[<span class="string">'تاریخ_استخدام'</span>].replace(<span class="string">'نامعلوم'</span>, np.nan)
    
    <span class="comment"># تبدیل به datetime</span>
    df_date_clean[<span class="string">'تاریخ_استخدام'</span>] = pd.to_datetime(
        df_date_clean[<span class="string">'تاریخ_استخدام'</span>], 
        errors=<span class="string">'coerce'</span>,
        infer_datetime_format=<span class="keyword">True</span>
    )
    <span class="function">print</span>(<span class="string">"📅 تاریخ‌های تبدیل شده:"</span>)
    <span class="function">print</span>(df_date_clean[<span class="string">'تاریخ_استخدام'</span>])
    <span class="function">print</span>(<span class="string">f"نوع داده: {df_date_clean['تاریخ_استخدام'].dtype}"</span>)
    
    <span class="comment"># استخراج اجزای تاریخ</span>
    df_date_clean[<span class="string">'سال_استخدام'</span>] = df_date_clean[<span class="string">'تاریخ_استخدام'</span>].dt.year
    df_date_clean[<span class="string">'ماه_استخدام'</span>] = df_date_clean[<span class="string">'تاریخ_استخدام'</span>].dt.month
    df_date_clean[<span class="string">'روز_هفته'</span>] = df_date_clean[<span class="string">'تاریخ_استخدام'</span>].dt.day_name()
    
    <span class="function">print</span>(<span class="string">f"\nاجزای تاریخ:\n{df_date_clean[['تاریخ_استخدام', 'سال_استخدام', 'ماه_استخدام', 'روز_هفته']]}"</span>)
    
    <span class="comment"># محاسبه سابقه کار</span>
    today = pd.Timestamp.now()
    df_date_clean[<span class="string">'سابقه_کار'</span>] = (today - df_date_clean[<span class="string">'تاریخ_استخدام'</span>]).dt.days / <span class="number">365.25</span>
    <span class="function">print</span>(<span class="string">f"\nسابقه کار (سال):\n{df_date_clean[['نام', 'سابقه_کار']].round(1)}"</span>)
                        </div>
    
                        <h3>🔍 شناسایی و حذف نقاط پرت:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد داده با نقاط پرت</span>
    outlier_data = {
        <span class="string">'نام'</span>: [<span class="string">f'شخص_{i}'</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">21</span>)],
        <span class="string">'حقوق'</span>: [<span class="number">5000000</span>, <span class="number">5200000</span>, <span class="number">4800000</span>, <span class="number">5100000</span>, <span class="number">4900000</span>,
                  <span class="number">5300000</span>, <span class="number">25000000</span>, <span class="number">5000000</span>, <span class="number">4700000</span>, <span class="number">5400000</span>,  <span class="comment"># 25M نقطه پرت</span>
                  <span class="number">5100000</span>, <span class="number">4950000</span>, <span class="number">5250000</span>, <span class="number">4850000</span>, <span class="number">5150000</span>,
                  <span class="number">5050000</span>, <span class="number">500000</span>, <span class="number">5200000</span>, <span class="number">4900000</span>, <span class="number">5300000</span>]   <span class="comment"># 500K نقطه پرت</span>
    }
    
    df_outliers = pd.DataFrame(outlier_data)
    <span class="function">print</span>(<span class="string">"🔍 داده‌ها با نقاط پرت:"</span>)
    <span class="function">print</span>(df_outliers.describe())
    
    <span class="comment"># روش 1: Z-Score</span>
    <span class="keyword">from</span> scipy <span class="keyword">import</span> stats
    z_scores = np.abs(stats.zscore(df_outliers[<span class="string">'حقوق'</span>]))
    threshold_z = <span class="number">2</span>  <span class="comment"># آستانه</span>
    outliers_z = df_outliers[z_scores > threshold_z]
    <span class="function">print</span>(<span class="string">f"\nنقاط پرت با Z-Score:\n{outliers_z}"</span>)
    
    <span class="comment"># روش 2: IQR (Interquartile Range)</span>
    Q1 = df_outliers[<span class="string">'حقوق'</span>].quantile(<span class="number">0.25</span>)
    Q3 = df_outliers[<span class="string">'حقوق'</span>].quantile(<span class="number">0.75</span>)
    IQR = Q3 - Q1
    lower_bound = Q1 - <span class="number">1.5</span> * IQR
    upper_bound = Q3 + <span class="number">1.5</span> * IQR
    
    outliers_iqr = df_outliers[(df_outliers[<span class="string">'حقوق'</span>] < lower_bound) | 
                              (df_outliers[<span class="string">'حقوق'</span>] > upper_bound)]
    <span class="function">print</span>(<span class="string">f"\nنقاط پرت با IQR:\n{outliers_iqr}"</span>)
    <span class="function">print</span>(<span class="string">f"محدوده طبیعی: {lower_bound:,.0f} - {upper_bound:,.0f}"</span>)
    
    <span class="comment"># حذف نقاط پرت</span>
    df_no_outliers = df_outliers[(df_outliers[<span class="string">'حقوق'</span>] >= lower_bound) & 
                                (df_outliers[<span class="string">'حقوق'</span>] <= upper_bound)]
    <span class="function">print</span>(<span class="string">f"\nبعد از حذف نقاط پرت: {df_no_outliers.shape[0]} سطر"</span>)
    <span class="function">print</span>(df_no_outliers[<span class="string">'حقوق'</span>].describe())
    
    <span class="comment"># جایگزینی نقاط پرت با میانه</span>
    df_capped = df_outliers.copy()
    median_salary = df_capped[<span class="string">'حقوق'</span>].median()
    df_capped.loc[df_capped[<span class="string">'حقوق'</span>] > upper_bound, <span class="string">'حقوق'</span>] = median_salary
    df_capped.loc[df_capped[<span class="string">'حقوق'</span>] < lower_bound, <span class="string">'حقوق'</span>] = median_salary
    <span class="function">print</span>(<span class="string">f"\nبعد از جایگزینی با میانه:\n{df_capped['حقوق'].describe()}"</span>)
                        </div>
    
                        <h3>🔄 حذف تکرارها:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد داده با تکرار</span>
    duplicate_data = {
        <span class="string">'نام'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'احمد'</span>, <span class="string">'علی'</span>, <span class="string">'فاطمه'</span>],
        <span class="string">'سن'</span>: [<span class="number">25</span>, <span class="number">30</span>, <span class="number">25</span>, <span class="number">35</span>, <span class="number">30</span>],
        <span class="string">'شهر'</span>: [<span class="string">'تهران'</span>, <span class="string">'اصفهان'</span>, <span class="string">'تهران'</span>, <span class="string">'شیراز'</span>, <span class="string">'اصفهان'</span>]
    }
    
    df_dup = pd.DataFrame(duplicate_data)
    <span class="function">print</span>(<span class="string">"🔄 داده‌های تکراری:"</span>)
    <span class="function">print</span>(df_dup)
    
    <span class="comment"># شناسایی تکرارها</span>
    <span class="function">print</span>(<span class="string">f"\nسطرهای تکراری:\n{df_dup[df_dup.duplicated()]}"</span>)
    <span class="function">print</span>(<span class="string">f"تعداد تکرارها: {df_dup.duplicated().sum()}"</span>)
    
    <span class="comment"># حذف تکرارها</span>
    df_unique = df_dup.drop_duplicates()
    <span class="function">print</span>(<span class="string">f"\nبعد از حذف تکرارها:\n{df_unique}"</span>)
    
    <span class="comment"># حذف تکرار بر اساس ستون خاص</span>
    df_unique_name = df_dup.drop_duplicates(subset=[<span class="string">'نام'</span>], keep=<span class="string">'first'</span>)
    <span class="function">print</span>(<span class="string">f"\nحذف تکرار بر اساس نام:\n{df_unique_name}"</span>)
    
    <span class="comment"># نگه داشتن آخرین تکرار</span>
    df_unique_last = df_dup.drop_duplicates(keep=<span class="string">'last'</span>)
    <span class="function">print</span>(<span class="string">f"\nنگه داشتن آخرین:\n{df_unique_last}"</span>)
    
    <span class="comment"># شمارش تکرارها</span>
    value_counts = df_dup.value_counts()
    <span class="function">print</span>(<span class="string">f"\nشمارش تکرارها:\n{value_counts}"</span>)
                        </div>
    
                        <div class="method-grid">
                            <div class="method-card">
                                <div class="method-name">.isnull()</div>
                                <div class="method-desc">شناسایی null</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.fillna()</div>
                                <div class="method-desc">پر کردن null</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.dropna()</div>
                                <div class="method-desc">حذف null</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.str.strip()</div>
                                <div class="method-desc">تمیز کردن متن</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.drop_duplicates()</div>
                                <div class="method-desc">حذف تکرار</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">pd.to_datetime()</div>
                                <div class="method-desc">تبدیل تاریخ</div>
                            </div>
                        </div>
    
                        <div class="tip-box">
                            <div class="tip-title">🧹 بهترین روش‌های تمیز کردن:</div>
                            <ul>
                                <li><strong>همیشه کپی بگیرید:</strong> از داده اصلی محافظت کنید</li>
                                <li><strong>مرحله به مرحله:</strong> هر تغییر را جداگانه بررسی کنید</li>
                                <li><strong>مستند کنید:</strong> فرآیند تمیز کردن را یادداشت کنید</li>
                                <li><strong>اعتبارسنجی:</strong> نتایج را با داده اصلی مقایسه کنید</li>
                            </ul>
                        </div>
                    </div>
                </div>
    
                <!-- اسلاید 7: عملیات تجمیعی و GroupBy -->
                <div class="slide" id="slide7">
                    <div class="slide-number">7/15</div>
                    <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                    <button class="close-btn" onclick="closeSlide(this)">×</button>
                    <div class="icon">📊</div>
                    <div class="slide-title">عملیات تجمیعی و GroupBy</div>
                    <div class="slide-content">
                        <h3>🎯 مفهوم GroupBy:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد داده‌های فروش</span>
    sales_data = {
        <span class="string">'فروشنده'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'احمد'</span>, <span class="string">'علی'</span>, <span class="string">'فاطمه'</span>, <span class="string">'احمد'</span>, <span class="string">'علی'</span>, <span class="string">'فاطمه'</span>],
        <span class="string">'منطقه'</span>: [<span class="string">'شمال'</span>, <span class="string">'جنوب'</span>, <span class="string">'شمال'</span>, <span class="string">'شرق'</span>, <span class="string">'جنوب'</span>, <span class="string">'غرب'</span>, <span class="string">'شرق'</span>, <span class="string">'شمال'</span>],
        <span class="string">'محصول'</span>: [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'A'</span>, <span class="string">'C'</span>, <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'A'</span>],
        <span class="string">'مقدار'</span>: [<span class="number">100</span>, <span class="number">150</span>, <span class="number">120</span>, <span class="number">200</span>, <span class="number">80</span>, <span class="number">110</span>, <span class="number">180</span>, <span class="number">90</span>],
        <span class="string">'درآمد'</span>: [<span class="number">1000000</span>, <span class="number">2250000</span>, <span class="number">1200000</span>, <span class="number">4000000</span>, <span class="number">1200000</span>, <span class="number">1650000</span>, <span class="number">3600000</span>, <span class="number">1350000</span>]
    }
    
    df_sales = pd.DataFrame(sales_data)
    <span class="function">print</span>(<span class="string">"📊 داده‌های فروش:"</span>)
    <span class="function">print</span>(df_sales)
    
    <span class="comment"># GroupBy ساده - گروه‌بندی بر اساس فروشنده</span>
    grouped_seller = df_sales.groupby(<span class="string">'فروشنده'</span>)
    <span class="function">print</span>(<span class="string">f"\n🎯 نوع GroupBy object: {type(grouped_seller)}"</span>)
    <span class="function">print</span>(<span class="string">f"تعداد گروه‌ها: {grouped_seller.ngroups}"</span>)
    <span class="function">print</span>(<span class="string">f"کلیدهای گروه‌ها: {list(grouped_seller.groups.keys())}"</span>)
    
    <span class="comment"># نمایش گروه‌ها</span>
    <span class="function">print</span>(<span class="string">f"\nگروه احمد:\n{grouped_seller.get_group('احمد')}"</span>)
                        </div>
    
                        <h3>🧮 عملیات تجمیعی پایه:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># عملیات تجمیعی ساده</span>
    <span class="function">print</span>(<span class="string">"🧮 عملیات تجمیعی:"</span>)
    
    <span class="comment"># مجموع فروش هر فروشنده</span>
    total_by_seller = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'درآمد'</span>].sum()
    <span class="function">print</span>(<span class="string">f"\nکل درآمد هر فروشنده:\n{total_by_seller}"</span>)
    
    <span class="comment"># میانگین فروش هر فروشنده</span>
    avg_by_seller = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'درآمد'</span>].mean()
    <span class="function">print</span>(<span class="string">f"\nمیانگین درآمد:\n{avg_by_seller}"</span>)
    
    <span class="comment"># تعداد فروش هر فروشنده</span>
    count_by_seller = df_sales.groupby(<span class="string">'فروشنده'</span>).size()
    <span class="function">print</span>(<span class="string">f"\nتعداد فروش:\n{count_by_seller}"</span>)
    
    <span class="comment"># چندین عملیات همزمان</span>
    stats_by_seller = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'درآمد'</span>].agg([<span class="string">'sum'</span>, <span class="string">'mean'</span>, <span class="string">'count'</span>, <span class="string">'std'</span>])
    <span class="function">print</span>(<span class="string">f"\nآمار کامل:\n{stats_by_seller}"</span>)
    
    <span class="comment"># عملیات بر چندین ستون</span>
    multi_stats = df_sales.groupby(<span class="string">'فروشنده'</span>).agg({
        <span class="string">'مقدار'</span>: [<span class="string">'sum'</span>, <span class="string">'mean'</span>],
        <span class="string">'درآمد'</span>: [<span class="string">'sum'</span>, <span class="string">'max'</span>, <span class="string">'min'</span>]
    })
    <span class="function">print</span>(<span class="string">f"\nآمار چندستونه:\n{multi_stats}"</span>)
    
    <span class="comment"># تابع سفارشی</span>
    <span class="keyword">def</span> <span class="function">range_func</span>(x):
        <span class="keyword">return</span> x.max() - x.min()
    
    custom_agg = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'درآمد'</span>].agg([<span class="string">'mean'</span>, range_func])
    <span class="function">print</span>(<span class="string">f"\nبا تابع سفارشی:\n{custom_agg}"</span>)
                        </div>
    
                        <h3>🎭 GroupBy چندسطحی:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># گروه‌بندی بر اساس چندین ستون</span>
    multi_group = df_sales.groupby([<span class="string">'فروشنده'</span>, <span class="string">'منطقه'</span>])
    <span class="function">print</span>(<span class="string">"🎭 گروه‌بندی چندسطحی:"</span>)
    <span class="function">print</span>(<span class="string">f"تعداد گروه‌ها: {multi_group.ngroups}"</span>)
    
    <span class="comment"># آمار بر اساس فروشنده و منطقه</span>
    multi_stats = multi_group[<span class="string">'درآمد'</span>].sum()
    <span class="function">print</span>(<span class="string">f"\nدرآمد بر اساس فروشنده و منطقه:\n{multi_stats}"</span>)
    
    <span class="comment"># تبدیل به جدول</span>
    pivot_table = multi_stats.unstack(fill_value=<span class="number">0</span>)
    <span class="function">print</span>(<span class="string">f"\nجدول محوری:\n{pivot_table}"</span>)
    
    <span class="comment"># گروه‌بندی بر اساس شرط</span>
    <span class="comment"># ایجاد دسته‌بندی درآمد</span>
    df_sales[<span class="string">'دسته_درآمد'</span>] = pd.cut(df_sales[<span class="string">'درآمد'</span>], 
                                    bins=[<span class="number">0</span>, <span class="number">2000000</span>, <span class="number">4000000</span>, <span class="number">10000000</span>],
                                    labels=[<span class="string">'کم'</span>, <span class="string">'متوسط'</span>, <span class="string">'زیاد'</span>])
    
    income_group = df_sales.groupby(<span class="string">'دسته_درآمد'</span>).size()
    <span class="function">print</span>(<span class="string">f"\nتوزیع دسته درآمد:\n{income_group}"</span>)
    
    <span class="comment"># گروه‌بندی با تابع</span>
    <span class="keyword">def</span> <span class="function">categorize_amount</span>(x):
        <span class="keyword">if</span> x < <span class="number">100</span>:
            <span class="keyword">return</span> <span class="string">'کم'</span>
        <span class="keyword">elif</span> x < <span class="number">150</span>:
            <span class="keyword">return</span> <span class="string">'متوسط'</span>
        <span class="keyword">else</span>:
            <span class="keyword">return</span> <span class="string">'زیاد'</span>
    
    df_sales[<span class="string">'دسته_مقدار'</span>] = df_sales[<span class="string">'مقدار'</span>].apply(categorize_amount)
    amount_group = df_sales.groupby(<span class="string">'دسته_مقدار'</span>)[<span class="string">'درآمد'</span>].mean()
    <span class="function">print</span>(<span class="string">f"\nمیانگین درآمد بر اساس دسته مقدار:\n{amount_group}"</span>)
                        </div>
    
                        <h3>🔄 Transform و Apply:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># Transform: حفظ شکل اصلی داده</span>
    <span class="function">print</span>(<span class="string">"🔄 Transform operations:"</span>)
    
    <span class="comment"># اضافه کردن میانگین گروه به هر سطر</span>
    df_sales[<span class="string">'میانگین_گروه'</span>] = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'درآمد'</span>].transform(<span class="string">'mean'</span>)
    <span class="function">print</span>(<span class="string">f"\nبا میانگین گروه:\n{df_sales[[<span class="string">'فروشنده'</span>, <span class="string">'درآمد'</span>, <span class="string">'میانگین_گروه'</span>]]}"</span>)
    
    <span class="comment"># انحراف از میانگین گروه</span>
    df_sales[<span class="string">'انحراف_از_میانگین'</span>] = df_sales[<span class="string">'درآمد'</span>] - df_sales[<span class="string">'میانگین_گروه'</span>]
    <span class="function">print</span>(<span class="string">f"\nانحراف از میانگین:\n{df_sales[[<span class="string">'فروشنده'</span>, <span class="string">'درآمد'</span>, <span class="string">'انحراف_از_میانگین'</span>]]}"</span>)
    
    <span class="comment"># رتبه‌بندی درون گروه</span>
    df_sales[<span class="string">'رتبه_در_گروه'</span>] = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'درآمد'</span>].rank(ascending=<span class="keyword">False</span>)
    <span class="function">print</span>(<span class="string">f"\nرتبه در گروه:\n{df_sales[[<span class="string">'فروشنده'</span>, <span class="string">'درآمد'</span>, <span class="string">'رتبه_در_گروه'</span>]]}"</span>)
    
    <span class="comment"># درصد از کل گروه</span>
    df_sales[<span class="string">'درصد_از_گروه'</span>] = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'درآمد'</span>].transform(
        <span class="keyword">lambda</span> x: x / x.sum() * <span class="number">100</span>
    )
    <span class="function">print</span>(<span class="string">f"\nدرصد از کل گروه:\n{df_sales[[<span class="string">'فروشنده'</span>, <span class="string">'درآمد'</span>, <span class="string">'درصد_از_گروه'</span>]].round(1)}"</span>)
    
    <span class="comment"># Apply: اعمال تابع پیچیده</span>
    <span class="keyword">def</span> <span class="function">group_analysis</span>(group):
        <span class="keyword">return</span> pd.Series({
            <span class="string">'تعداد'</span>: len(group),
            <span class="string">'کل_درآمد'</span>: group[<span class="string">'درآمد'</span>].sum(),
            <span class="string">'بهترین_فروش'</span>: group[<span class="string">'درآمد'</span>].max(),
            <span class="string">'محصول_پرفروش'</span>: group.loc[group[<span class="string">'درآمد'</span>].idxmax(), <span class="string">'محصول'</span>]
        })
    
    detailed_analysis = df_sales.groupby(<span class="string">'فروشنده'</span>).apply(group_analysis)
    <span class="function">print</span>(<span class="string">f"\nتحلیل تفصیلی:\n{detailed_analysis}"</span>)
                        </div>
    
                        <h3>📊 Pivot Table و Cross Tabulation:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># Pivot Table</span>
    <span class="function">print</span>(<span class="string">"📊 Pivot Tables:"</span>)
    
    <span class="comment"># جدول محوری ساده</span>
    pivot_simple = df_sales.pivot_table(
        values=<span class="string">'درآمد'</span>,
        index=<span class="string">'فروشنده'</span>,
        columns=<span class="string">'منطقه'</span>,
        aggfunc=<span class="string">'sum'</span>,
        fill_value=<span class="number">0</span>
    )
    <span class="function">print</span>(<span class="string">f"\nجدول محوری ساده:\n{pivot_simple}"</span>)
    
    <span class="comment"># جدول محوری پیچیده</span>
    pivot_complex = df_sales.pivot_table(
        values=[<span class="string">'درآمد'</span>, <span class="string">'مقدار'</span>],
        index=<span class="string">'فروشنده'</span>,
        columns=<span class="string">'محصول'</span>,
        aggfunc={<span class="string">'درآمد'</span>: <span class="string">'sum'</span>, <span class="string">'مقدار'</span>: <span class="string">'mean'</span>},
        fill_value=<span class="number">0</span>
    )
    <span class="function">print</span>(<span class="string">f"\nجدول محوری پیچیده:\n{pivot_complex}"</span>)
    
    <span class="comment"># اضافه کردن مجموع</span>
    pivot_with_totals = df_sales.pivot_table(
        values=<span class="string">'درآمد'</span>,
        index=<span class="string">'فروشنده'</span>,
        columns=<span class="string">'منطقه'</span>,
        aggfunc=<span class```html
    <span class="keyword">import</span> os
    files_to_remove = [
        <span class="string">'employees.csv'</span>, <span class="string">'employees.xlsx'</span>, <span class="string">'employees.json'</span>,
        <span class="string">'multiple_sheets.xlsx'</span>, <span class="string">'company.db'</span>, <span class="string">'employees_advanced.csv'</span>,
        <span class="string">'salary_report.csv'</span>, <span class="string">'high_earners.csv'</span>, <span class="string">'employees_compressed.csv.gz'</span>
    ]
    
    <span class="keyword">for</span> filename <span class="keyword">in</span> files_to_remove:
        <span class="keyword">try</span>:
            <span class="keyword">if</span> os.path.exists(filename):
                os.remove(filename)
        <span class="keyword">except</span>:
            <span class="keyword">pass</span>
    
    <span class="function">print</span>(<span class="string">"🧹 فایل‌های تمرینی پاک شدند"</span>)
                        </div>
    
                        <div class="method-grid">
                            <div class="method-card">
                                <div class="method-name">pd.read_csv()</div>
                                <div class="method-desc">خواندن CSV</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">pd.read_excel()</div>
                                <div class="method-desc">خواندن Excel</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">pd.read_json()</div>
                                <div class="method-desc">خواندن JSON</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">pd.read_sql()</div>
                                <div class="method-desc">خواندن از DB</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.to_csv()</div>
                                <div class="method-desc">ذخیره CSV</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.to_excel()</div>
                                <div class="method-desc">ذخیره Excel</div>
                            </div>
                        </div>
    
                        <div class="tip-box">
                            <div class="tip-title">💡 نکات I/O در Pandas:</div>
                            <ul>
                                <li><strong>انکودینگ:</strong> برای متن‌های فارسی از utf-8-sig استفاده کنید</li>
                                <li><strong>نوع داده:</strong> dtype را مشخص کنید تا حافظه بهینه شود</li>
                                <li><strong>فایل‌های بزرگ:</strong> از chunksize برای خواندن تدریجی استفاده کنید</li>
                                <li><strong>فشرده‌سازی:</strong> برای ذخیره‌سازی بهتر از compression استفاده کنید</li>
                            </ul>
                        </div>
    
                        <div class="warning-box">
                            <div class="warning-title">⚠️ نکات مهم:</div>
                            <ul>
                                <li>همیشه مسیر فایل‌ها را بررسی کنید</li>
                                <li>برای فایل‌های بزرگ از nrows برای تست استفاده کنید</li>
                                <li>انواع داده را صحیح تعریف کنید</li>
                                <li>از try-except برای مدیریت خطا استفاده کنید</li>
                            </ul>
                        </div>
                    </div>
                </div>
    
                <!-- اسلاید 5: Indexing و Slicing پیشرفته -->
                <div class="slide" id="slide5">
                    <div class="slide-number">5/15</div>
                    <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                    <button class="close-btn" onclick="closeSlide(this)">×</button>
                    <div class="icon">🎯</div>
                    <div class="slide-title">Indexing و Slicing پیشرفته</div>
                    <div class="slide-content">
                        <h3>🔍 انواع Indexing در Pandas:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد DataFrame نمونه</span>
    data = {
        <span class="string">'نام'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, <span class="string">'زهرا'</span>, <span class="string">'محمد'</span>, <span class="string">'مریم'</span>],
        <span class="string">'سن'</span>: [<span class="number">25</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">28</span>, <span class="number">32</span>, <span class="number">27</span>],
        <span class="string">'شهر'</span>: [<span class="string">'تهران'</span>, <span class="string">'اصفهان'</span>, <span class="string">'شیراز'</span>, <span class="string">'مشهد'</span>, <span class="string">'تبریز'</span>, <span class="string">'کرج'</span>],
        <span class="string">'حقوق'</span>: [<span class="number">5000000</span>, <span class="number">4500000</span>, <span class="number">6000000</span>, <span class="number">5500000</span>, <span class="number">4800000</span>, <span class="number">5200000</span>],
        <span class="string">'بخش'</span>: [<span class="string">'IT'</span>, <span class="string">'HR'</span>, <span class="string">'Finance'</span>, <span class="string">'IT'</span>, <span class="string">'Marketing'</span>, <span class="string">'HR'</span>]
    }
    
    df = pd.DataFrame(data)
    <span class="function">print</span>(<span class="string">"📋 DataFrame اصلی:"</span>)
    <span class="function">print</span>(df)
    
    <span class="comment"># تنظیم ایندکس سفارشی</span>
    df_indexed = df.set_index(<span class="string">'نام'</span>)
    <span class="function">print</span>(<span class="string">f"\nبا ایندکس نام:\n{df_indexed}"</span>)
    
    <span class="comment"># MultiIndex</span>
    df_multi = df.set_index([<span class="string">'شهر'</span>, <span class="string">'بخش'</span>])
    <span class="function">print</span>(<span class="string">f"\nMultiIndex:\n{df_multi}"</span>)
                        </div>
    
                        <h3>🎯 loc - Label-based Indexing:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># دسترسی با loc</span>
    <span class="function">print</span>(<span class="string">"🎯 استفاده از .loc:"</span>)
    
    <span class="comment"># دسترسی به سطر با نام</span>
    ahmad_info = df_indexed.loc[<span class="string">'احمد'</span>]
    <span class="function">print</span>(<span class="string">f"اطلاعات احمد:\n{ahmad_info}"</span>)
    
    <span class="comment"># دسترسی به چندین سطر</span>
    selected_people = df_indexed.loc[[<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>]]
    <span class="function">print</span>(<span class="string">f"\nافراد انتخابی:\n{selected_people}"</span>)
    
    <span class="comment"># دسترسی به سطر و ستون خاص</span>
    ahmad_salary = df_indexed.loc[<span class="string">'احمد'</span>, <span class="string">'حقوق'</span>]
    <span class="function">print</span>(<span class="string">f"حقوق احمد: {ahmad_salary:,}"</span>)
    
    <span class="comment"># دسترسی به محدوده سطرها و ستون‌ها</span>
    subset = df_indexed.loc[<span class="string">'احمد'</span>:<span class="string">'علی'</span>, <span class="string">'سن'</span>:<span class="string">'حقوق'</span>]
    <span class="function">print</span>(<span class="string">f"\nزیرمجموعه:\n{subset}"</span>)
    
    <span class="comment"># دسترسی شرطی با loc</span>
    high_salary = df_indexed.loc[df_indexed[<span class="string">'حقوق'</span>] > <span class="number">5000000</span>]
    <span class="function">print</span>(<span class="string">f"\nحقوق بالا:\n{high_salary}"</span>)
    
    <span class="comment"># تغییر مقادیر با loc</span>
    df_copy = df_indexed.copy()
    df_copy.loc[<span class="string">'احمد'</span>, <span class="string">'حقوق'</span>] = <span class="number">5500000</span>
    <span class="function">print</span>(<span class="string">f"بعد از تغییر حقوق احمد: {df_copy.loc['احمد', 'حقوق']:,}"</span>)
    
    <span class="comment"># تغییر چندین مقدار</span>
    df_copy.loc[df_copy[<span class="string">'بخش'</span>] == <span class="string">'IT'</span>, <span class="string">'حقوق'</span>] *= <span class="number">1.1</span>  <span class="comment"># 10% افزایش</span>
    <span class="function">print</span>(<span class="string">f"\nبعد از افزایش حقوق IT:\n{df_copy[df_copy['بخش'] == 'IT']}"</span>)
                        </div>
    
                        <h3>📊 iloc - Position-based Indexing:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># استفاده از iloc</span>
    <span class="function">print</span>(<span class="string">"📊 استفاده از .iloc:"</span>)
    
    <span class="comment"># دسترسی به سطر با موقعیت</span>
    first_row = df.iloc[<span class="number">0</span>]
    <span class="function">print</span>(<span class="string">f"اولین سطر:\n{first_row}"</span>)
    
    <span class="comment"># دسترسی به چندین سطر</span>
    first_three = df.iloc[<span class="number">0</span>:<span class="number">3</span>]
    <span class="function">print</span>(<span class="string">f"\nسه سطر اول:\n{first_three}"</span>)
    
    <span class="comment"># دسترسی به سطر و ستون خاص</span>
    cell_value = df.iloc[<span class="number">0</span>, <span class="number">3</span>]  <span class="comment"># سطر اول، ستون چهارم</span>
    <span class="function">print</span>(<span class="string">f"مقدار سلول [0,3]: {cell_value:,}"</span>)
    
    <span class="comment"># دسترسی به محدوده</span>
    subset_iloc = df.iloc[<span class="number">1</span>:<span class="number">4</span>, <span class="number">1</span>:<span class="number">4</span>]  <span class="comment"># سطرهای 1-3، ستون‌های 1-3</span>
    <span class="function">print</span>(<span class="string">f"\nزیرمجموعه با iloc:\n{subset_iloc}"</span>)
    
    <span class="comment"># دسترسی به سطرهای خاص</span>
    specific_rows = df.iloc[[<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>]]  <span class="comment"># سطرهای 0، 2، 4</span>
    <span class="function">print</span>(<span class="string">f"\nسطرهای خاص:\n{specific_rows}"</span>)
    
    <span class="comment"># دسترسی به ستون‌های خاص</span>
    specific_columns = df.iloc[:, [<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>]]  <span class="comment"># همه سطرها، ستون‌های 0، 2، 3</span>
    <span class="function">print</span>(<span class="string">f"\nستون‌های خاص:\n{specific_columns}"</span>)
    
    <span class="comment"># آخرین سطر و ستون</span>
    last_cell = df.iloc[-<span class="number">1</span>, -<span class="number">1</span>]
    <span class="function">print</span>(<span class="string">f"آخرین سلول: {last_cell}"</span>)
    
    <span class="comment"># هر دو سطر یکی</span>
    every_second = df.iloc[::<span class="number">2</span>]  <span class="comment"># سطرهای 0، 2، 4</span>
    <span class="function">print</span>(<span class="string">f"\nهر دو سطر یکی:\n{every_second}"</span>)
                        </div>
    
                        <h3>🔧 at و iat - دسترسی سریع:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># at برای دسترسی سریع با برچسب</span>
    <span class="function">print</span>(<span class="string">"🔧 دسترسی سریع:"</span>)
    
    ahmad_age_at = df_indexed.at[<span class="string">'احمد'</span>, <span class="string">'سن'</span>]
    <span class="function">print</span>(<span class="string">f"سن احمد با .at: {ahmad_age_at}"</span>)
    
    <span class="comment"># iat برای دسترسی سریع با موقعیت</span>
    first_salary_iat = df.iat[<span class="number">0</span>, <span class="number">3</span>]
    <span class="function">print</span>(<span class="string">f"اولین حقوق با .iat: {first_salary_iat:,}"</span>)
    
    <span class="comment"># مقایسه سرعت (در داده‌های بزرگ تفاوت محسوس است)</span>
    <span class="keyword">import</span> time
    
    <span class="comment"># تست سرعت loc vs at</span>
    start_time = time.time()
    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">1000</span>):
        value = df_indexed.loc[<span class="string">'احمد'</span>, <span class="string">'سن'</span>]
    loc_time = time.time() - start_time
    
    start_time = time.time()
    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">1000</span>):
        value = df_indexed.at[<span class="string">'احمد'</span>, <span class="string">'سن'</span>]
    at_time = time.time() - start_time
    
    <span class="function">print</span>(<span class="string">f"\nسرعت .loc: {loc_time:.4f}s"</span>)
    <span class="function">print</span>(<span class="string">f"سرعت .at: {at_time:.4f}s"</span>)
    <span class="function">print</span>(<span class="string">f"at سریعتر است: {loc_time/at_time:.1f}x"</span>)
                        </div>
    
                        <h3>🔍 Boolean Indexing پیشرفته:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># Boolean indexing ساده</span>
    <span class="function">print</span>(<span class="string">"🔍 Boolean Indexing:"</span>)
    
    <span class="comment"># شرط ساده</span>
    young_people = df[df[<span class="string">'سن'</span>] < <span class="number">30</span>]
    <span class="function">print</span>(<span class="string">f"افراد جوان:\n{young_people}"</span>)
    
    <span class="comment"># شرط چندگانه با &</span>
    young_tehrani = df[(df[<span class="string">'سن'</span>] < <span class="number">30</span>) & (df[<span class="string">'شهر'</span>] == <span class="string">'تهران'</span>)]
    <span class="function">print</span>(<span class="string">f"\nجوان و تهرانی:\n{young_tehrani}"</span>)
    
    <span class="comment"># شرط چندگانه با |</span>
    it_or_hr = df[(df[<span class="string">'بخش'</span>] == <span class="string">'IT'</span>) | (df[<span class="string">'بخش'</span>] == <span class="string">'HR'</span>)]
    <span class="function">print</span>(<span class="string">f"\nIT یا HR:\n{it_or_hr}"</span>)
    
    <span class="comment"># استفاده از isin</span>
    selected_cities = df[df[<span class="string">'شهر'</span>].isin([<span class="string">'تهران'</span>, <span class="string">'اصفهان'</span>, <span class="string">'شیراز'</span>])]
    <span class="function">print</span>(<span class="string">f"\nشهرهای انتخابی:\n{selected_cities}"</span>)
    
    <span class="comment"># نقیض شرط با ~</span>
    not_tehran = df[~(df[<span class="string">'شهر'</span>] == <span class="string">'تهران'</span>)]
    <span class="function">print</span>(<span class="string">f"\nغیر تهرانی:\n{not_tehran}"</span>)
    
    <span class="comment"># شرط با رشته</span>
    names_with_m = df[df[<span class="string">'نام'</span>].str.contains(<span class="string">'م'</span>)]
    <span class="function">print</span>(<span class="string">f"\nنام‌های حاوی 'م':\n{names_with_m}"</span>)
    
    <span class="comment"># شرط با null</span>
    df_with_null = df.copy()
    df_with_null.loc[<span class="number">0</span>, <span class="string">'حقوق'</span>] = np.nan
    non_null_salary = df_with_null[df_with_null[<span class="string">'حقوق'</span>].notna()]
    <span class="function">print</span>(<span class="string">f"\nبدون حقوق null:\n{non_null_salary}"</span>)
                        </div>
    
                        <h3>🎭 Query Method:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># استفاده از query برای فیلتر کردن</span>
    <span class="function">print</span>(<span class="string">"🎭 استفاده از .query():"</span>)
    
    <span class="comment"># کوئری ساده</span>
    young_query = df.query(<span class="string">'سن < 30'</span>)
    <span class="function">print</span>(<span class="string">f"افراد جوان (query):\n{young_query}"</span>)
    
    <span class="comment"># کوئری چندگانه</span>
    complex_query = df.query(<span class="string">'سن > 25 and حقوق > 5000000'</span>)
    <span class="function">print</span>(<span class="string">f"\nکوئری پیچیده:\n{complex_query}"</span>)
    
    <span class="comment"># استفاده از متغیر در query</span>
    min_age = <span class="number">28</span>
    age_query = df.query(<span class="string">'سن >= @min_age'</span>)
    <span class="function">print</span>(<span class="string">f"\nسن >= {min_age}:\n{age_query}"</span>)
    
    <span class="comment"># کوئری با رشته</span>
    city_query = df.query(<span class="string">"شهر == 'تهران'"</span>)
    <span class="function">print</span>(<span class="string">f"\nتهرانی‌ها:\n{city_query}"</span>)
    
    <span class="comment"># کوئری با in</span>
    dept_query = df.query(<span class="string">"بخش in ['IT', 'HR']"</span>)
    <span class="function">print</span>(<span class="string">f"\nIT یا HR (query):\n{dept_query}"</span>)
                        </div>
    
                        <h3>🔄 MultiIndex Operations:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># کار با MultiIndex</span>
    <span class="function">print</span>(<span class="string">"🔄 عملیات MultiIndex:"</span>)
    
    <span class="comment"># دسترسی به سطح اول MultiIndex</span>
    tehran_data = df_multi.loc[<span class="string">'تهران'</span>]
    <span class="function">print</span>(<span class="string">f"داده‌های تهران:\n{tehran_data}"</span>)
    
    <span class="comment"># دسترسی به سطح دوم</span>
    <span class="keyword">try</span>:
        it_tehran = df_multi.loc[(<span class="string">'تهران'</span>, <span class="string">'IT'</span>)]
        <span class="function">print</span>(<span class="string">f"IT تهران:\n{it_tehran}"</span>)
    <span class="keyword">except</span> KeyError:
        <span class="function">print</span>(<span class="string">"IT در تهران وجود ندارد"</span>)
    
    <span class="comment"># استفاده از slice در MultiIndex</span>
    multi_slice = df_multi.loc[(<span class="string">'اصفهان'</span>, slice(<span class="keyword">None</span>)), :]
    <span class="function">print</span>(<span class="string">f"\nهمه بخش‌های اصفهان:\n{multi_slice}"</span>)
    
    <span class="comment"># reset_index برای برگرداندن به ایندکس عادی</span>
    df_reset = df_multi.reset_index()
    <span class="function">print</span>(<span class="string">f"\nبعد از reset_index:\n{df_reset}"</span>)
    
    <span class="comment"># swaplevel برای تعویض سطوح</span>
    df_swapped = df_multi.swaplevel()
    <span class="function">print</span>(<span class="string">f"\nبعد از swaplevel:\n{df_swapped.head()}"</span>)
    
    <span class="comment"># sort_index برای مرتب‌سازی</span>
    df_sorted = df_multi.sort_index()
    <span class="function">print</span>(<span class="string">f"\nمرتب شده:\n{df_sorted}"</span>)
                        </div>
    
                        <div class="method-grid">
                            <div class="method-card">
                                <div class="method-name">.loc[]</div>
                                <div class="method-desc">دسترسی با برچسب</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.iloc[]</div>
                                <div class="method-desc">دسترسی با موقعیت</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.at[] / .iat[]</div>
                                <div class="method-desc">دسترسی سریع</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.query()</div>
                                <div class="method-desc">فیلتر با عبارت</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.isin()</div>
                                <div class="method-desc">عضویت در لیست</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.set_index()</div>
                                <div class="method-desc">تنظیم ایندکس</div>
                            </div>
                        </div>
    
                        <div class="tip-box">
                            <div class="tip-title">💡 نکات Indexing:</div>
                            <ul>
                                <li><strong>.loc:</strong> برای برچسب‌ها، <strong>.iloc:</strong> برای موقعیت‌ها</li>
                                <li><strong>.at/.iat:</strong> برای دسترسی سریع به سلول واحد</li>
                                <li><strong>Boolean indexing:</strong> از پرانتز برای شرایط چندگانه استفاده کنید</li>
                                <li><strong>.query():</strong> برای کوئری‌های پیچیده خواناتر است</li>
                            </ul>
                        </div>
                    </div>
                </div>
    
                <!-- اسلاید 6: تمیز کردن و آماده‌سازی داده‌ها -->
                <div class="slide" id="slide6">
                    <div class="slide-number">6/15</div>
                    <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                    <button class="close-btn" onclick="closeSlide(this)">×</button>
                    <div class="icon">🧹</div>
                    <div class="slide-title">تمیز کردن و آماده‌سازی داده‌ها</div>
                    <div class="slide-content">
                        <h3>🔍 شناسایی مشکلات داده:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد DataFrame با مشکلات مختلف</span>
    messy_data = {
        <span class="string">'نام'</span>: [<span class="string">'احمد  '</span>, <span class="string">' فاطمه'</span>, <span class="string">'علی'</span>, <span class="keyword">None</span>, <span class="string">'زهرا'</span>, <span class="string">'محمد'</span>],
        <span class="string">'سن'</span>: [<span class="number">25</span>, <span class="string">'سی'</span>, <span class="number">35</span>, <span class="number">28</span>, np.nan, <span class="number">150</span>],  <span class="comment"># مشکل: متن، NaN، مقدار غیرمنطقی</span>
        <span class="string">'ایمیل'</span>: [<span class="string">'ahmad@gmail.com'</span>, <span class="string">'fateme'</span>, <span class="string">'ali@yahoo.com'</span>, <span class="string">'zahra@gmail.com'</span>, <span class="string">'invalid-email'</span>, <span class="string">''</span>],
        <span class="string">'حقوق'</span>: [<span class="number">5000000</span>, <span class="number">4500000</span>, <span class="string">'نامشخص'</span>, <span class="number">5500000</span>, <span class="number">-1000000</span>, <span class="number">4800000</span>],  <span class="comment"># مشکل: متن، منفی</span>
        <span class="string">'تاریخ_استخدام'</span>: [<span class="string">'2020-01-15'</span>, <span class="string">'1399/10/25'</span>, <span class="string">'2021-05-10'</span>, <span class="string">'نامعلوم'</span>, <span class="string">'2022-13-40'</span>, <span class="string">'2023-03-20'</span>]  <span class="comment"># مشکل: فرمت‌های مختلف</span>
    }
    
    df_messy = pd.DataFrame(messy_data)
    <span class="function">print</span>(<span class="string">"🔍 داده‌های آلوده:"</span>)
    <span class="function">print</span>(df_messy)
    <span class="function">print</span>(<span class="string">f"\nانواع داده:\n{df_messy.dtypes}"</span>)
    
    <span class="comment"># بررسی کلی مشکلات</span>
    <span class="function">print</span>(<span class="string">f"\n📊 تحلیل مشکلات:"</span>)
    <span class="function">print</span>(<span class="string">f"شکل داده: {df_messy.shape}"</span>)
    <span class="function">print</span>(<span class="string">f"مقادیر null:\n{df_messy.isnull().sum()}"</span>)
    <span class="function">print</span>(<span class="string">f"مقادیر تکراری: {df_messy.duplicated().sum()}"</span>)
    
    <span class="comment"># نمایش اطلاعات تفصیلی</span>
    <span class="function">print</span>(<span class="string">f"\nاطلاعات کلی:"</span>)
    df_messy.info()
                        </div>
    
                        <h3>🧹 تمیز کردن داده‌های متنی:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># کپی برای تمیز کردن</span>
    df_clean = df_messy.copy()
    
    <span class="comment"># تمیز کردن فاصله‌های اضافی در نام‌ها</span>
    df_clean[<span class="string">'نام'</span>] = df_clean[<span class="string">'نام'</span>].str.strip()  <span class="comment"># حذف فاصله ابتدا و انتها</span>
    <span class="function">print</span>(<span class="string">"🧹 بعد از حذف فاصله‌های اضافی:"</span>)
    <span class="function">print</span>(df_clean[<span class="string">'نام'</span>])
    
    <span class="comment"># تبدیل به حروف کوچک برای یکسان‌سازی</span>
    df_clean[<span class="string">'ایمیل'</span>] = df_clean[<span class="string">'ایمیل'</span>].str.lower().str.strip()
    
    <span class="comment"># جایگزینی رشته‌های خالی با NaN</span>
    df_clean[<span class="string">'ایمیل'</span>] = df_clean[<span class="string">'ایمیل'</span>].replace(<span class="string">''</span>, np.nan)
    
    <span class="comment"># تشخیص ایمیل‌های نامعتبر</span>
    <span class="keyword">import</span> re
    email_pattern = <span class="string">r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'</span>
    valid_emails = df_clean[<span class="string">'ایمیل'</span>].str.match(email_pattern, na=<span class="keyword">False</span>)
    <span class="function">print</span>(<span class="string">f"\nایمیل‌های معتبر:\n{df_clean.loc[valid_emails, 'ایمیل']}"</span>)
    
    <span class="comment"># نشان‌گذاری ایمیل‌های نامعتبر</span>
    df_clean.loc[~valid_emails & df_clean[<span class="string">'ایمیل'</span>].notna(), <span class="string">'ایمیل'</span>] = np.nan
    <span class="function">print</span>(<span class="string">f"بعد از پاک‌سازی ایمیل‌ها:\n{df_clean['ایمیل']}"</span>)
    
    <span class="comment"># تمیز کردن داده‌های عددی</span>
    <span class="function">print</span>(<span class="string">f"\nستون سن قبل از تمیز‌کاری:\n{df_clean['سن']}"</span>)
    
    <span class="comment"># تبدیل مقادیر غیرعددی به NaN</span>
    df_clean[<span class="string">'سن'</span>] = pd.to_numeric(df_clean[<span class="string">'سن'</span>], errors=<span class="string">'coerce'</span>)
    <span class="function">print</span>(<span class="string">f"بعد از تبدیل عددی:\n{df_clean['سن']}"</span>)
    
    <span class="comment"># بررسی محدوده منطقی سن</span>
    invalid_age = (df_clean[<span class="string">'سن'</span>] < <span class="number">18</span>) | (df_clean[<span class="string">'سن'</span>] > <span class="number">100</span>)
    df_clean.loc[invalid_age, <span class="string">'سن'</span>] = np.nan
    <span class="function">print</span>(<span class="string">f"بعد از حذف سن‌های غیرمنطقی:\n{df_clean['سن']}"</span>)
                        </div>
    
                        <h3>💰 تمیز کردن داده‌های مالی:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># تمیز کردن ستون حقوق</span>
    <span class="function">print</span>(<span class="string">"💰 تمیز کردن حقوق:"</span>)
    <span class="function">print</span>(<span class="string">f"حقوق قبل از تمیز‌کاری:\n{df_clean['حقوق']}"</span>)
    
    <span class="comment"># تبدیل به عددی</span>
    df_clean[<span class="string">'حقوق'</span>] = pd.to_numeric(df_clean[<span class="string">'حقوق'</span>], errors=<span class="string">'coerce'</span>)
    
    <span class="comment"># حذف مقادیر منفی یا غیرمنطقی</span>
    df_clean.loc[df_clean[<span class="string">'حقوق'</span>] <= <span class="number">0</span>, <span class="string">'حقوق'</span>] = np.nan
    
    <span class="comment"># تشخیص outlier با استفاده از IQR</span>
    Q1 = df_clean[<span class="string">'حقوق'</span>].quantile(<span class="number">0.25</span>)
    Q3 = df_clean[<span class="string">'حقوق'</span>].quantile(<span class="number">0.75</span>)
    IQR = Q3 - Q1
    lower_bound = Q1 - <span class="number">1.5</span> * IQR
    upper_bound = Q3 + <span class="number">1.5</span> * IQR
    
    <span class="function">print</span>(<span class="string">f"محدوده طبیعی حقوق: [{lower_bound:,.0f}, {upper_bound:,.0f}]"</span>)
    
    outliers = (df_clean[<span class="string">'حقوق'</span>] < lower_bound) | (df_clean[<span class="string">'حقوق'</span>] > upper_bound)
    <span class="function">print</span>(<span class="string">f"تعداد outlier: {outliers.sum()}"</span>)
    
    <span class="comment"># نمایش حقوق‌های تمیز شده</span>
    <span class="function">print</span>(<span class="string">f"حقوق بعد از تمیز‌کاری:\n{df_clean['حقوق']}"</span>)
                        </div>
    
                        <h3>📅 تمیز کردن تاریخ‌ها:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># تمیز کردن تاریخ‌ها</span>
    <span class="function">print</span>(<span class="string">"📅 تمیز کردن تاریخ‌ها:"</span>)
    <span class="function">print</span>(<span class="string">f"تاریخ‌های اصلی:\n{df_clean['تاریخ_استخدام']}"</span>)
    
    <span class="comment"># تابع برای تمیز کردن تاریخ</span>
    <span class="keyword">def</span> <span class="function">clean_date</span>(date_str):
        <span class="keyword">if</span> pd.isna(date_str) <span class="keyword">or</span> date_str == <span class="string">'نامعلوم'</span>:
            <span class="keyword">return</span> np.nan
        
        <span class="comment"># تبدیل تاریخ شمسی به میلادی (ساده‌سازی شده)</span>
        <span class="keyword">if</span> <span class="string">'/'</span> <span class="keyword">in</span> str(date_str):
            <span class="keyword">return</span> np.nan  <span class="comment"># در عمل باید تبدیل دقیق انجام شود</span>
        
        <span class="keyword">try</span>:
            <span class="keyword">return</span> pd.to_datetime(date_str)
        <span class="keyword">except</span>:
            <span class="keyword">return</span> np.nan
    
    <span class="comment"># اعمال تابع تمیز‌کاری</span>
    df_clean[<span class="string">'تاریخ_استخدام_تمیز'</span>] = df_clean[<span class="string">'تاریخ_استخدام'</span>].apply(clean_date)
    <span class="function">print</span>(<span class="string">f"تاریخ‌های تمیز شده:\n{df_clean['تاریخ_استخدام_تمیز']}"</span>)
    
    <span class="comment"># محاسبه سابقه کار</span>
    current_date = pd.Timestamp.now()
    df_clean[<span class="string">'سابقه_کار_روز'</span>] = (current_date - df_clean[<span class="string">'تاریخ_استخدام_تمیز'</span>]).dt.days
    <span class="function">print</span>(<span class="string">f"سابقه کار (روز):\n{df_clean['سابقه_کار_روز']}"</span>)
    
    <span class="comment"># حذف ستون تاریخ اصلی</span>
    df_clean = df_clean.drop(<span class="string">'تاریخ_استخدام'</span>, axis=<span class="number">1</span>)
                        </div>
    
                        <h3>🔄 مدیریت مقادیر گمشده:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># بررسی مقادیر گمشده</span>
    <span class="function">print</span>(<span class="string">"🔄 مدیریت مقادیر گمشده:"</span>)
    missing_info = df_clean.isnull().sum()
    missing_percent = (missing_info / len(df_clean)) * <span class="number">100</span>
    
    missing_summary = pd.DataFrame({
        <span class="string">'تعداد_گمشده'</span>: missing_info,
        <span class="string">'درصد_گمشده'</span>: missing_percent
    })
    <span class="function">print</span>(<span class="string">f"خلاصه مقادیر گمشده:\n{missing_summary}"</span>)
    
    <span class="comment"># روش‌های مختلف پر کردن مقادیر گمشده</span>
    
    <span class="comment"># 1. پر کردن با میانگین (برای داده‌های عددی)</span>
    df_filled = df_clean.copy()
    df_filled[<span class="string">'سن'</span>].fillna(df_filled[<span class="string">'سن'</span>].mean(), inplace=<span class="keyword">True</span>)
    <span class="function">print</span>(<span class="string">f"\nسن بعد از پر کردن با میانگین:\n{df_filled['سن']}"</span>)
    
    <span class="comment"># 2. پر کردن با میانه</span>
    df_filled[<span class="string">'حقوق'</span>].fillna(df_filled[<span class="string">'حقوق'</span>].median(), inplace=<span class="keyword">True</span>)
    <span class="function">print</span>(<span class="string">f"حقوق بعد از پر کردن با میانه:\n{df_filled['حقوق']}"</span>)
    
    <span class="comment"># 3. پر کردن با مد (برای داده‌های دسته‌ای)</span>
    <span class="comment"># df_filled['ایمیل'].fillna('نامشخص', inplace=True)</span>
    
    <span class="comment"># 4. پر کردن forward fill</span>
    df_ffill = df_clean.copy()
    df_ffill = df_ffill.fillna(method=<span class="string">'ffill'</span>)  <span class="comment"># deprecated در نسخه‌های جدید</span>
    <span class="comment"># جایگزین: df_ffill = df_ffill.ffill()</span>
    
    <span class="comment"># 5. پر کردن backward fill</span>
    df_bfill = df_clean.copy()
    df_bfill = df_bfill.fillna(method=<span class="string">'bfill'</span>)  <span class="comment"># deprecated در نسخه‌های جدید</span>
    <span class="comment"># جایگزین: df_bfill = df_bfill.bfill()</span>
    
    <span class="comment"># 6. پر کردن با interpolation</span>
    df_interpolated = df_clean.copy()
    df_interpolated[<span class="string">'سن'</span>] = df_interpolated[<span class="string">'سن'</span>].interpolate()
    <span class="function">print</span>(<span class="string">f"سن بعد از interpolation:\n{df_interpolated['سن']}"</span>)
    
    <span class="comment"># 7. حذف سطرهای دارای مقادیر گمشده</span>
    df_dropped = df_clean.dropna()
    <span class="function">print</span>(<span class="string">f"تعداد سطرها بعد از حذف: {len(df_dropped)}"</span>)
    
    <span class="comment"># 8. حذف سطرهایی که بیش از حد مقدار گمشده دارند</span>
    df_thresh = df_clean.dropna(thresh=<span class="number">3</span>)  <span class="comment"># حداقل 3 مقدار غیر null</span>
    <span class="function">print</span>(<span class="string">f"تعداد سطرها با thresh=3: {len(df_thresh)}"</span>)
                        </div>
    
                        <h3>🔍 تشخیص و حذف تکراری‌ها:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># اضافه کردن سطر تکراری برای تست</span>
    df_with_duplicates = df_clean.copy()
    duplicate_row = df_with_duplicates.iloc[<span class="number">0</span>].copy()
    df_with_duplicates = pd.concat([df_with_duplicates, duplicate_row.to_frame().T], ignore_index=<span class="keyword">True</span>)
    
    <span class="function">print</span>(<span class="string">"🔍 تشخیص تکراری‌ها:"</span>)
    <span class="function">print</span>(<span class="string">f"تعداد کل سطرها: {len(df_with_duplicates)}"</span>)
    <span class="function">print</span>(<span class="string">f"تعداد سطرهای تکراری: {df_with_duplicates.duplicated().sum()}"</span>)
    
    <span class="comment"># نمایش سطرهای تکراری</span>
    duplicates = df_with_duplicates[df_with_duplicates.duplicated(keep=<span class="keyword">False</span>)]
    <span class="function">print</span>(<span class="string">f"سطرهای تکراری:\n{duplicates}"</span>)
    
    <span class="comment"># حذف تکراری‌ها</span>
    df_no_duplicates = df_with_duplicates.drop_duplicates()
    <span class="function">print</span>(<span class="string">f"بعد از حذف تکراری‌ها: {len(df_no_duplicates)} سطر"</span>)
    
    <span class="comment"># تشخیص تکراری بر اساس ستون خاص</span>
    name_duplicates = df_with_duplicates.duplicated(subset=[<span class="string">'نام'</span>])
    <span class="function">print</span>(<span class="string">f"تکراری بر اساس نام: {name_duplicates.sum()}"</span>)
    
    <span class="comment"># حذف تکراری با نگه‌داشتن اولین یا آخرین</span>
    df_keep_first = df_with_duplicates.drop_duplicates(keep=<span class="string">'first'</span>)
    df_keep_last = df_with_duplicates.drop_duplicates(keep=<span class="string">'last'</span>)
    <span class="function">print</span>(<span class="string">f"نگه‌داشتن اولین: {len(df_keep_first)}"</span>)
    <span class="function">print</span>(<span class="string">f"نگه‌داشتن آخرین: {len(df_keep_last)}"</span>)
                        </div>
    
                        <h3>📊 خلاصه تمیز‌کاری:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># مقایسه قبل و بعد از تمیز‌کاری</span>
    <span class="function">print</span>(<span class="string">"📊 خلاصه تمیز‌کاری:"</span>)
    <span class="function">print</span>(<span class="string">f"\n🔴 داده‌های اولیه:"</span>)
    <span class="function">print</span>(<span class="string">f"شکل: {df_messy.shape}"</span>)
    <span class="function">print</span>(<span class="string">f"مقادیر null: {df_messy.isnull().sum().sum()}"</span>)
    <span class="function">print</span>(<span class="string">f"انواع داده:\n{df_messy.dtypes}"</span>)
    
    <span class="function">print</span>(<span class="string">f"\n🟢 داده‌های تمیز:"</span>)
    <span class="function">print</span>(<span class="string">f"شکل: {df_filled.shape}"</span>)
    <span class="function">print</span>(<span class="string">f"مقادیر null: {df_filled.isnull().sum().sum()}"</span>)
    <span class="function">print</span>(<span class="string">f"انواع داده:\n{df_filled.dtypes}"</span>)
    
    <span class="comment"># نمایش نتیجه نهایی</span>
    <span class="function">print</span>(<span class="string">f"\n✅ DataFrame تمیز شده:"</span>)
    <span class="function">print</span>(df_filled)
    
    <span class="comment"># ذخیره داده‌های تمیز</span>
    df_filled.to_csv(<span class="string">'cleaned_data.csv'</span>, index=<span class="keyword">False</span>)
    <span class="function">print</span>(<span class="string">f"\n💾 داده‌های تمیز در 'cleaned_data.csv' ذخیره شد"</span>)
    
    <span class="comment"># پاک کردن فایل تست</span>
    <span class="keyword">import</span> os
    <span class="keyword">if</span> os.path.exists(<span class="string">'cleaned_data.csv'</span>):
        os.remove(<span class="string">'cleaned_data.csv'</span>)
                        </div>
    
                        <div class="method-grid">
                            <div class="method-card">
                                <div class="method-name">.isnull() / .notna()</div>
                                <div class="method-desc">تشخیص مقادیر گمشده</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.fillna()</div>
                                <div class="method-desc">پر کردن مقادیر گمشده</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.dropna()</div>
                                <div class="method-desc">حذف مقادیر گمشده</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.duplicated()</div>
                                <div class="method-desc">تشخیص تکراری‌ها</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">.drop_duplicates()</div>
                                <div class="method-desc">حذف تکراری‌ها</div>
                            </div>
                            <div class="method-card">
                                <div class="method-name">pd.to_numeric()</div>
                                <div class="method-desc">تبدیل به عددی</div>
                            </div>
                        </div>
    
                        <div class="tip-box">
                            <div class="tip-title">💡 نکات تمیز‌کاری داده:</div>
                            <ul>
                                <li><strong>همیشه کپی بگیرید:</strong> از داده اصلی محافظت کنید</li>
                                <li><strong>مرحله به مرحله:</strong> تغییرات را گام به گام اعمال کنید</li>
                                <li><strong>مستندسازی:</strong> تغییرات را ثبت کنید</li>
                                <li><strong>اعتبارسنجی:</strong> نتایج را بررسی کنید</li>
                            </ul>
                        </div>
                    </div>
                </div>
    
                <!-- اسلاید 7: GroupBy و تحلیل تجمیعی -->
                <div class="slide" id="slide7">
                    <div class="slide-number">7/15</div>
                    <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                    <button class="close-btn" onclick="closeSlide(this)">×</button>
                    <div class="icon">📊</div>
                    <div class="slide-title">GroupBy و تحلیل تجمیعی</div>
                    <div class="slide-content">
                        <h3>🔍 مفهوم GroupBy:</h3>
                        <p>GroupBy یکی از قدرتمندترین ابزارهای Pandas است که به شما امکان گروه‌بندی داده‌ها و انجام عملیات تجمیعی بر روی هر گروه را می‌دهد.</p>
    
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># ایجاد DataFrame نمونه برای تحلیل فروش</span>
    sales_data = {
        <span class="string">'فروشنده'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, <span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, 
                    <span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, <span class="string">'احمد'</span>],
        <span class="string">'منطقه'</span>: [<span class="string">'شمال'</span>, <span class="string">'جنوب'</span>, <span class="string">'شرق'</span>, <span class="string">'غرب'</span>, <span class="string">'شمال'</span>, <span class="string">'جنوب'</span>,
                  <span class="string">'شرق'</span>, <span class="string">'غرب'</span>, <span class="string">'شمال'</span>, <span class="string">'جنوب'</span>],
        <span class="string">'محصول'</span>: [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'A'</span>, <span class="string">'C'</span>, <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>],
        <span class="string">'فروش'</span>: [<span class="number">100</span>, <span class="number">150</span>, <span class="number">200</span>, <span class="number">120</span>, <span class="number">180</span>, <span class="number">90</span>, <span class="number">160</span>, <span class="number">140</span>, <span class="number">110</span>, <span class="number">130</span>],
        <span class="string">'سود'</span>: [<span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">25</span>, <span class="number">35</span>, <span class="number">18</span>, <span class="number">32</span>, <span class="number">28</span>, <span class="number">22</span>, <span class="number">26</span>],
        <span class="string">'تاریخ'</span>: [<span class="string">'2024-01-15'</span>, <span class="string">'2024-01-16'</span>, <span class="string">'2024-01-17'</span>, <span class="string">'2024-01-18'</span>, <span class="string">'2024-01-19'</span>,
                 <span class="string">'2024-01-20'</span>, <span class="string">'2024-01-21'</span>, <span class="string">'2024-01-22'</span>, <span class="string">'2024-01-23'</span>, <span class="string">'2024-01-24'</span>]
    }
    
    df_sales = pd.DataFrame(sales_data)
    df_sales[<span class="string">'تاریخ'</span>] = pd.to_datetime(df_sales[<span class="string">'تاریخ'</span>])
    
    <span class="function">print</span>(<span class="string">"📊 داده‌های فروش:"</span>)
    <span class="function">print</span>(df_sales)
    <span class="function">print</span>(<span class="string">f"شکل داده: {df_sales.shape}"</span>)
                        </div>
    
                        <h3>👥 GroupBy ساده:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># گروه‌بندی بر اساس فروشنده</span>
    <span class="function">print</span>(<span class="string">"👥 گروه‌بندی بر اساس فروشنده:"</span>)
    
    <span class="comment"># مجموع فروش هر فروشنده</span>
    sales_by_seller = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].sum()
    <span class="function">print</span>(<span class="string">f"مجموع فروش:\n{sales_by_seller}"</span>)
    
    <span class="comment"># میانگین فروش هر فروشنده</span>
    avg_sales_by_seller = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].mean()
    <span class="function">print</span>(<span class="string">f"\nمیانگین فروش:\n{avg_sales_by_seller}"</span>)
    
    <span class="comment"># تعداد فروش هر فروشنده</span>
    count_by_seller = df_sales.groupby(<span class="string">'فروشنده'</span>).size()
    <span class="function">print</span>(<span class="string">f"\nتعداد فروش:\n{count_by_seller}"</span>)
    
    <span class="comment"># چندین ستون با چندین تابع</span>
    multiple_agg = df_sales.groupby(<span class="string">'فروشنده'</span>)[[<span class="string">'فروش'</span>, <span class="string">'سود'</span>]].agg([<span class="string">'sum'</span>, <span class="string">'mean'</span>, <span class="string">'count'</span>])
    <span class="function">print</span>(<span class="string">f"\nتجمیع چندگانه:\n{multiple_agg}"</span>)
    
    <span class="comment"># دسترسی به گروه‌ها</span>
    grouped = df_sales.groupby(<span class="string">'فروشنده'</span>)
    <span class="function">print</span>(<span class="string">f"\nنام گروه‌ها: {list(grouped.groups.keys())}"</span>)
    
    <span class="comment"># نمایش یک گروه خاص</span>
    ahmad_sales = grouped.get_group(<span class="string">'احمد'</span>)
    <span class="function">print</span>(<span class="string">f"\nفروش‌های احمد:\n{ahmad_sales}"</span>)
                        </div>
    
                        <h3>🗺️ GroupBy چندگانه:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># گروه‌بندی بر اساس چندین ستون</span>
    <span class="function">print</span>(<span class="string">"🗺️ گروه‌بندی چندگانه:"</span>)
    
    <span class="comment"># گروه‌بندی بر اساس فروشنده و منطقه</span>
    sales_by_seller_region = df_sales.groupby([<span class="string">'فروشنده'</span>, <span class="string">'منطقه'</span>])[<span class="string">'فروش'</span>].sum()
    <span class="function">print</span>(<span class="string">f"فروش بر اساس فروشنده و منطقه:\n{sales_by_seller_region}"</span>)
    
    <span class="comment"># تبدیل به DataFrame</span>
    sales_df = sales_by_seller_region.reset_index()
    <span class="function">print</span>(<span class="string">f"\nبه صورت DataFrame:\n{sales_df}"</span>)
    
    <span class="comment"># گروه‌بندی بر اساس منطقه و محصول</span>
    product_region_analysis = df_sales.groupby([<span class="string">'منطقه'</span>, <span class="string">'محصول'</span>]).agg({
        <span class="string">'فروش'</span>: [<span class="string">'sum'</span>, <span class="string">'mean'</span>, <span class="string">'count'</span>],
        <span class="string">'سود'</span>: [<span class="string">'sum'</span>, <span class="string">'mean'</span>]
    })
    <span class="function">print</span>(<span class="string">f"\nتحلیل محصول-منطقه:\n{product_region_analysis}"</span>)
    
    <span class="comment"># صاف کردن MultiIndex columns</span>
    product_region_analysis.columns = [<span class="string">'_'</span>.join(col).strip() <span class="keyword">for</span> col <span class="keyword">in</span> product_region_analysis.columns.values]
    <span class="function">print</span>(<span class="string">f"\nبا ستون‌های ساده:\n{product_region_analysis.head()}"</span>)
                        </div>
    
                        <h3>🔧 عملیات تجمیعی پیشرفته:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># استفاده از agg با دیکشنری</span>
    <span class="function">print</span>(<span class="string">"🔧 تجمیع پیشرفته:"</span>)
    
    <span class="comment"># تعریف عملیات مختلف برای ستون‌های مختلف</span>
    advanced_agg = df_sales.groupby(<span class="string">'فروشنده'</span>).agg({
        <span class="string">'فروش'</span>: [<span class="string">'sum'</span>, <span class="string">'mean'</span>, <span class="string">'max'</span>, <span class="string">'min'</span>],
        <span class="string">'سود'</span>: [<span class="string">'sum'</span>, <span class="string">'mean'</span>],
        <span class="string">'محصول'</span>: [<span class="string">'count'</span>, <span class="string">'nunique'</span>]  <span class="comment"># تعداد و تعداد منحصربه‌فرد</span>
    })
    
    <span class="function">print</span>(<span class="string">f"تجمیع پیشرفته:\n{advanced_agg}"</span>)
    
    <span class="comment"># تابع سفارشی</span>
    <span class="keyword">def</span> <span class="function">coefficient_of_variation</span>(x):
        <span class="string">"""محاسبه ضریب تغییرات"""</span>
        <span class="keyword">return</span> x.std() / x.mean() <span class="keyword">if</span> x.mean() != <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>
    
    custom_agg = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].agg([
        <span class="string">'mean'</span>, 
        <span class="string">'std'</span>, 
        coefficient_of_variation
    ])
    <span class="function">print</span>(<span class="string">f"\nبا تابع سفارشی:\n{custom_agg}"</span>)
    
    <span class="comment"># percentile‌ها</span>
    percentiles = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].quantile([<span class="number">0.25</span>, <span class="number">0.5</span>, <span class="number">0.75</span>])
    <span class="function">print</span>(<span class="string">f"\nصدک‌ها:\n{percentiles}"</span>)
    
    <span class="comment"># describe برای هر گروه</span>
    group_describe = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].describe()
    <span class="function">print</span>(<span class="string">f"\nآمار توصیفی گروه‌ها:\n{group_describe}"</span>)
                        </div>
    
                        <h3>🔄 Transform و Apply:</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">کپی</button>
    <span class="comment"># Transform: حفظ شکل اصلی DataFrame</span>
    <span class="function">print</span>(<span class="string">"🔄 Transform و Apply:"</span>)
    
    <span class="comment"># محاسبه انحراف از میانگین گروه</span>
    df_sales[<span class="string">'انحراف_از_میانگین'</span>] = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].transform(<span class="string">'mean'</span>) - df_sales[<span class="string">'فروش'</span>]
    <span class="function">print</span>(<span class="string">f"انحراف از میانگین:\n{df_sales[['فروشنده', 'فروش', 'انحراف_از_میانگین']]}"</span>)
    
    <span class="comment"># نرمال‌سازی در هر گروه</span>
    <span class="keyword">def</span> <span class="function">normalize</span>(x):
        <span class="keyword">return</span> (x - x.min()) / (x.max() - x.min())
    
    df_sales[<span class="string">'فروش_نرمال'</span>] = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].transform(normalize)
    <span class="function">print</span>(<span class="string">f"\nفروش نرمال شده:\n{df_sales[['فروشنده', 'فروش', 'فروش_نرمال']]}"</span>)
    
    <span class="comment"># رتبه‌بندی در هر گروه</span>
    df_sales[<span class="string">'رتبه_در_گروه'</span>] = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].rank(ascending=<span class="keyword">False</span>)
    <span class="function">print</span>(<span class="string">f"\nرتبه در گروه:\n{df_sales[['فروشنده', 'فروش', 'رتبه_در_گروه']]}"</span>)
    
    <span class="comment"># Apply: برای عملیات پیچیده‌تر</span>
    <span class="keyword">def</span> <span class="function">group_analysis</span>(group):
        <span class="string">"""تحلیل هر گروه"""</span>
        result = pd.Series({
            <span class="string">'تعداد_فروش'</span>: len(group),
            <span class="string">'کل_فروش'</span>: group[<span class="string">'فروش'</span>].sum(),
            <span class="string">'بهترین_فروش'</span>: group[<span class="string">'فروش'</span>].max(),
            <span class="string">'بدترین_فروش'</span>: group[<span class="string">'فروش'</span>].min(),
            <span class="string">'محصولات_فروخته'</span>: group[<span class="string">'محصول'</span>].nunique()
        })
        <span class="keyword">return</span> result
    
    group_stats = df_sales.groupby(<span class="string">'فروشنده'</span>).apply(group_analysis)
    <span class="function">print</span>(<span class="string">f"\nتحلیل گروه‌ها:\n{group_stats}"</span>)
                        </div>
                            <h3>📅 GroupBy با تاریخ:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># گروه‌بندی بر اساس تاریخ</span>
<span class="function">print</span>(<span class="string">"📅 GroupBy با تاریخ:"</span>)

<span class="comment"># اضافه کردن ستون‌های تاریخی</span>
df_sales[<span class="string">'سال'</span>] = df_sales[<span class="string">'تاریخ'</span>].dt.year
df_sales[<span class="string">'ماه'</span>] = df_sales[<span class="string">'تاریخ'</span>].dt.month
df_sales[<span class="string">'روز_هفته'</span>] = df_sales[<span class="string">'تاریخ'</span>].dt.day_name()

<span class="comment"># فروش بر اساس روز هفته</span>
sales_by_weekday = df_sales.groupby(<span class="string">'روز_هفته'</span>)[<span class="string">'فروش'</span>].sum()
<span class="function">print</span>(<span class="string">f"فروش بر اساس روز هفته:\n{sales_by_weekday}"</span>)

<span class="comment"># استفاده از Grouper برای گروه‌بندی زمانی</span>
df_sales_indexed = df_sales.set_index(<span class="string">'تاریخ'</span>)
daily_sales = df_sales_indexed.groupby(pd.Grouper(freq=<span class="string">'D'</span>))[<span class="string">'فروش'</span>].sum()
<span class="function">print</span>(<span class="string">f"\nفروش روزانه:\n{daily_sales}"</span>)

<span class="comment"># فروش هفتگی</span>
weekly_sales = df_sales_indexed.groupby(pd.Grouper(freq=<span class="string">'W'</span>))[<span class="string">'فروش'</span>].sum()
<span class="function">print</span>(<span class="string">f"\nفروش هفتگی:\n{weekly_sales}"</span>)

<span class="comment"># تحلیل ترکیبی: فروشنده و روز هفته</span>
seller_weekday = df_sales.groupby([<span class="string">'فروشنده'</span>, <span class="string">'روز_هفته'</span>])[<span class="string">'فروش'</span>].sum().unstack(fill_value=<span class="number">0</span>)
<span class="function">print</span>(<span class="string">f"\nفروشنده × روز هفته:\n{seller_weekday}"</span>)
                    </div>

                    <h3>🎯 فیلتر کردن گروه‌ها:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># فیلتر کردن گروه‌ها بر اساس شرایط</span>
<span class="function">print</span>(<span class="string">"🎯 فیلتر گروه‌ها:"</span>)

<span class="comment"># نگه‌داشتن گروه‌هایی که مجموع فروش بیش از 300 دارند</span>
high_performers = df_sales.groupby(<span class="string">'فروشنده'</span>).filter(<span class="keyword">lambda</span> x: x[<span class="string">'فروش'</span>].sum() > <span class="number">300</span>)
<span class="function">print</span>(<span class="string">f"فروشندگان پرکار:\n{high_performers[['فروشنده', 'فروش']].groupby('فروشنده').sum()}"</span>)

<span class="comment"># فیلتر بر اساس تعداد فروش</span>
frequent_sellers = df_sales.groupby(<span class="string">'فروشنده'</span>).filter(<span class="keyword">lambda</span> x: len(x) >= <span class="number">3</span>)
<span class="function">print</span>(<span class="string">f"\nفروشندگان فعال (حداقل 3 فروش):\n{frequent_sellers['فروشنده'].value_counts()}"</span>)

<span class="comment"># فیلتر پیچیده: فروشندگان با عملکرد پایدار</span>
consistent_performers = df_sales.groupby(<span class="string">'فروشنده'</span>).filter(
    <span class="keyword">lambda</span> x: x[<span class="string">'فروش'</span>].std() < <span class="number">30</span>  <span class="comment"># انحراف معیار کم</span>
)
<span class="function">print</span>(<span class="string">f"\nفروشندگان با عملکرد پایدار:\n{consistent_performers['فروشنده'].unique()}"</span>)

<span class="comment"># ترکیب فیلتر و تجمیع</span>
top_regions = (df_sales.groupby(<span class="string">'منطقه'</span>)
               .filter(<span class="keyword">lambda</span> x: x[<span class="string">'فروش'</span>].mean() > <span class="number">130</span>)
               .groupby(<span class="string">'منطقه'</span>)[<span class="string">'فروش'</span>]
               .agg([<span class="string">'mean'</span>, <span class="string">'sum'</span>, <span class="string">'count'</span>]))
<span class="function">print</span>(<span class="string">f"\nمناطق برتر:\n{top_regions}"</span>)
                    </div>

                    <h3>📊 Pivot Tables:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ایجاد Pivot Table</span>
<span class="function">print</span>(<span class="string">"📊 Pivot Tables:"</span>)

<span class="comment"># جدول محوری ساده</span>
pivot_simple = df_sales.pivot_table(
    values=<span class="string">'فروش'</span>,
    index=<span class="string">'فروشنده'</span>,
    columns=<span class="string">'منطقه'</span>,
    aggfunc=<span class="string">'sum'</span>,
    fill_value=<span class="number">0</span>
)
<span class="function">print</span>(<span class="string">f"جدول محوری ساده:\n{pivot_simple}"</span>)

<span class="comment"># جدول محوری پیچیده</span>
pivot_complex = df_sales.pivot_table(
    values=[<span class="string">'فروش'</span>, <span class="string">'سود'</span>],
    index=<span class="string">'فروشنده'</span>,
    columns=<span class="string">'محصول'</span>,
    aggfunc={<span class="string">'فروش'</span>: <span class="string">'sum'</span>, <span class="string">'سود'</span>: <span class="string">'mean'</span>},
    fill_value=<span class="number">0</span>
)
<span class="function">print</span>(<span class="string">f"\nجدول محوری پیچیده:\n{pivot_complex}"</span>)

<span class="comment"># اضافه کردن مجموع</span>
pivot_with_totals = df_sales.pivot_table(
    values=<span class="string">'فروش'</span>,
    index=<span class="string">'فروشنده'</span>,
    columns=<span class="string">'منطقه'</span>,
    aggfunc=<span class="string">'sum'</span>,
    fill_value=<span class="number">0</span>,
    margins=<span class="keyword">True</span>,
    margins_name=<span class="string">'مجموع'</span>
)
<span class="function">print</span>(<span class="string">f"\nبا مجموع:\n{pivot_with_totals}"</span>)

<span class="comment"># Cross tabulation</span>
crosstab = pd.crosstab(
    df_sales[<span class="string">'فروشنده'</span>], 
    df_sales[<span class="string">'محصول'</span>], 
    values=df_sales[<span class="string">'فروش'</span>], 
    aggfunc=<span class="string">'sum'</span>
)
<span class="function">print</span>(<span class="string">f"\nCross tabulation:\n{crosstab}"</span>)
                    </div>

                    <h3>🔢 محاسبات پیشرفته:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># محاسبات پیشرفته با GroupBy</span>
<span class="function">print</span>(<span class="string">"🔢 محاسبات پیشرفته:"</span>)

<span class="comment"># محاسبه درصد از کل</span>
df_sales[<span class="string">'درصد_از_کل'</span>] = df_sales[<span class="string">'فروش'</span>] / df_sales[<span class="string">'فروش'</span>].sum() * <span class="number">100</span>
<span class="function">print</span>(<span class="string">f"درصد از کل فروش:\n{df_sales[['فروشنده', 'فروش', 'درصد_از_کل']]}"</span>)

<span class="comment"># محاسبه درصد در هر گروه</span>
df_sales[<span class="string">'درصد_در_گروه'</span>] = df_sales.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].transform(
    <span class="keyword">lambda</span> x: x / x.sum() * <span class="number">100</span>
)

<span class="comment"># محاسبه رشد نسبت به قبل</span>
df_sales_sorted = df_sales.sort_values([<span class="string">'فروشنده'</span>, <span class="string">'تاریخ'</span>])
df_sales_sorted[<span class="string">'رشد_فروش'</span>] = df_sales_sorted.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].pct_change() * <span class="number">100</span>

<span class="function">print</span>(<span class="string">f"\nرشد فروش:\n{df_sales_sorted[['فروشنده', 'تاریخ', 'فروش', 'رشد_فروش']].head(8)}"</span>)

<span class="comment"># میانگین متحرک</span>
df_sales_sorted[<span class="string">'میانگین_متحرک'</span>] = df_sales_sorted.groupby(<span class="string">'فروشنده'</span>)[<span class="string">'فروش'</span>].rolling(window=<span class="number">2</span>, min_periods=<span class="number">1</span>).mean().reset_index(<span class="number">0</span>, drop=<span class="keyword">True</span>)

<span class="function">print</span>(<span class="string">f"\nمیانگین متحرک:\n{df_sales_sorted[['فروشنده', 'فروش', 'میانگین_متحرک']].head(8)}"</span>)

<span class="comment"># رتبه‌بندی کلی</span>
seller_ranking = df_sales.groupby(<span class="string">'فروشنده'</span>).agg({
    <span class="string">'فروش'</span>: [<span class="string">'sum'</span>, <span class="string">'mean'</span>, <span class="string">'count'</span>],
    <span class="string">'سود'</span>: <span class="string">'sum'</span>
}).round(<span class="number">2</span>)

seller_ranking.columns = [<span class="string">'کل_فروش'</span>, <span class="string">'میانگین_فروش'</span>, <span class="string">'تعداد_فروش'</span>, <span class="string">'کل_سود'</span>]
seller_ranking[<span class="string">'رتبه_کل_فروش'</span>] = seller_ranking[<span class="string">'کل_فروش'</span>].rank(ascending=<span class="keyword">False</span>)
seller_ranking = seller_ranking.sort_values(<span class="string">'رتبه_کل_فروش'</span>)

<span class="function">print</span>(<span class="string">f"\nرتبه‌بندی فروشندگان:\n{seller_ranking}"</span>)
                    </div>

                    <h3>📈 تحلیل عملکرد:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># تحلیل جامع عملکرد</span>
<span class="function">print</span>(<span class="string">"📈 تحلیل عملکرد:"</span>)

<span class="comment"># KPI اصلی هر فروشنده</span>
performance_metrics = df_sales.groupby(<span class="string">'فروشنده'</span>).agg({
    <span class="string">'فروش'</span>: [<span class="string">'sum'</span>, <span class="string">'mean'</span>, <span class="string">'std'</span>, <span class="string">'min'</span>, <span class="string">'max'</span>],
    <span class="string">'سود'</span>: [<span class="string">'sum'</span>, <span class="string">'mean'</span>]
})

<span class="comment"># محاسبه ضریب تغییرات</span>
performance_metrics[(<span class="string">'فروش'</span>, <span class="string">'cv'</span>)] = performance_metrics[(<span class="string">'فروش'</span>, <span class="string">'std'</span>)] / performance_metrics[(<span class="string">'فروش'</span>, <span class="string">'mean'</span>)]

<span class="function">print</span>(<span class="string">f"شاخص‌های عملکرد:\n{performance_metrics.round(2)}"</span>)

<span class="comment"># تحلیل محصولات</span>
product_analysis = df_sales.groupby(<span class="string">'محصول'</span>).agg({
    <span class="string">'فروش'</span>: [<span class="string">'sum'</span>, <span class="string">'count'</span>, <span class="string">'mean'</span>],
    <span class="string">'سود'</span>: <span class="string">'sum'</span>,
    <span class="string">'فروشنده'</span>: <span class="string">'nunique'</span>  <span class="comment"># تعداد فروشندگان منحصربه‌فرد</span>
})
product_analysis.columns = [<span class="string">'کل_فروش'</span>, <span class="string">'تعداد_فروش'</span>, <span class="string">'میانگین_فروش'</span>, <span class="string">'کل_سود'</span>, <span class="string">'تعداد_فروشنده'</span>]

<span class="comment"># محاسبه نرخ سود</span>
product_analysis[<span class="string">'نرخ_سود'</span>] = (product_analysis[<span class="string">'کل_سود'</span>] / product_analysis[<span class="string">'کل_فروش'</span>] * <span class="number">100</span>).round(<span class="number">2</span>)

<span class="function">print</span>(<span class="string">f"\nتحلیل محصولات:\n{product_analysis}"</span>)

<span class="comment"># تحلیل مناطق</span>
region_performance = df_sales.groupby(<span class="string">'منطقه'</span>).agg({
    <span class="string">'فروش'</span>: [<span class="string">'sum'</span>, <span class="string">'mean'</span>, <span class="string">'count'</span>],
    <span class="string">'فروشنده'</span>: <span class="string">'nunique'</span>,
    <span class="string">'محصول'</span>: <span class="string">'nunique'</span>
})
region_performance.columns = [<span class="string">'کل_فروش'</span>, <span class="string">'میانگین_فروش'</span>, <span class="string">'تعداد_تراکنش'</span>, <span class="string">'تعداد_فروشنده'</span>, <span class="string">'تعداد_محصول'</span>]

<span class="comment"># محاسبه فروش به ازای هر فروشنده در منطقه</span>
region_performance[<span class="string">'فروش_به_ازای_فروشنده'</span>] = (region_performance[<span class="string">'کل_فروش'</span>] / region_performance[<span class="string">'تعداد_فروشنده'</span>]).round(<span class="number">2</span>)

<span class="function">print</span>(<span class="string">f"\nتحلیل مناطق:\n{region_performance}"</span>)

<span class="comment"># خلاصه نهایی</span>
<span class="function">print</span>(<span class="string">f"\n📊 خلاصه کلی:"</span>)
<span class="function">print</span>(<span class="string">f"کل فروش: {df_sales['فروش'].sum():,}"</span>)
<span class="function">print</span>(<span class="string">f"کل سود: {df_sales['سود'].sum():,}"</span>)
<span class="function">print</span>(<span class="string">f"تعداد تراکنش‌ها: {len(df_sales)}"</span>)
<span class="function">print</span>(<span class="string">f"تعداد فروشندگان: {df_sales['فروشنده'].nunique()}"</span>)
<span class="function">print</span>(<span class="string">f"تعداد مناطق: {df_sales['منطقه'].nunique()}"</span>)
<span class="function">print</span>(<span class="string">f"تعداد محصولات: {df_sales['محصول'].nunique()}"</span>)
                    </div>

                    <div class="method-grid">
                        <div class="method-card">
                            <div class="method-name">.groupby()</div>
                            <div class="method-desc">گروه‌بندی داده‌ها</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.agg()</div>
                            <div class="method-desc">تجمیع چندگانه</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.transform()</div>
                            <div class="method-desc">حفظ شکل داده</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.apply()</div>
                            <div class="method-desc">عملیات پیچیده</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.pivot_table()</div>
                            <div class="method-desc">جدول محوری</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.filter()</div>
                            <div class="method-desc">فیلتر گروه‌ها</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">💡 نکات GroupBy:</div>
                        <ul>
                            <li><strong>Transform:</strong> برای اضافه کردن آمار گروه به هر سطر</li>
                            <li><strong>Apply:</strong> برای عملیات پیچیده که DataFrame برمی‌گردانند</li>
                            <li><strong>Agg:</strong> برای چندین تابع تجمیعی همزمان</li>
                            <li><strong>Filter:</strong> برای انتخاب گروه‌های خاص</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- اسلاید 8: ادغام و ترکیب داده‌ها -->
            <div class="slide" id="slide8">
                <div class="slide-number">8/15</div>
                <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                <button class="close-btn" onclick="closeSlide(this)">×</button>
                <div class="icon">🔗</div>
                <div class="slide-title">ادغام و ترکیب داده‌ها</div>
                <div class="slide-content">
                    <h3>🔗 انواع ترکیب داده‌ها:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ایجاد DataFrame های نمونه</span>
employees = pd.DataFrame({
    <span class="string">'کد_کارمند'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],
    <span class="string">'نام'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, <span class="string">'زهرا'</span>, <span class="string">'محمد'</span>],
    <span class="string">'بخش'</span>: [<span class="string">'IT'</span>, <span class="string">'HR'</span>, <span class="string">'Finance'</span>, <span class="string">'IT'</span>, <span class="string">'Marketing'</span>],
    <span class="string">'سن'</span>: [<span class="number">28</span>, <span class="number">32</span>, <span class="number">35</span>, <span class="number">29</span>, <span class="number">31</span>]
})

salaries = pd.DataFrame({
    <span class="string">'کد_کارمند'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>],  <span class="comment"># 6 وجود ندارد در employees</span>
    <span class="string">'حقوق'</span>: [<span class="number">5000000</span>, <span class="number">4500000</span>, <span class="number">6000000</span>, <span class="number">5500000</span>, <span class="number">4800000</span>],
    <span class="string">'پاداش'</span>: [<span class="number">500000</span>, <span class="number">400000</span>, <span class="number">600000</span>, <span class="number">550000</span>, <span class="number">480000</span>]
})

departments = pd.DataFrame({
    <span class="string">'بخش'</span>: [<span class="string">'IT'</span>, <span class="string">'HR'</span>, <span class="string">'Finance'</span>, <span class="string">'Marketing'</span>, <span class="string">'Sales'</span>],
    <span class="string">'مدیر'</span>: [<span class="string">'رضا'</span>, <span class="string">'نرگس'</span>, <span class="string">'حسن'</span>, <span class="string">'مینا'</span>, <span class="string">'کریم'</span>],
    <span class="string">'بودجه'</span>: [<span class="number">50000000</span>, <span class="number">30000000</span>, <span class="number">40000000</span>, <span class="number">25000000</span>, <span class="number">35000000</span>]
})

<span class="function">print</span>(<span class="string">"🔗 DataFrame های اولیه:"</span>)
<span class="function">print</span>(<span class="string">f"کارمندان:\n{employees}\n"</span>)
<span class="function">print</span>(<span class="string">f"حقوق‌ها:\n{salaries}\n"</span>)
<span class="function">print</span>(<span class="string">f"بخش‌ها:\n{departments}"</span>)
                    </div>

                    <h3>🤝 Merge - ادغام بر اساس کلید:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># انواع مختلف merge</span>
<span class="function">print</span>(<span class="string">"🤝 انواع Merge:"</span>)

<span class="comment"># Inner join - فقط رکوردهای مشترک</span>
inner_merge = pd.merge(employees, salaries, on=<span class="string">'کد_کارمند'</span>, how=<span class="string">'inner'</span>)
<span class="function">print</span>(<span class="string">f"Inner Join:\n{inner_merge}\n"</span>)

<span class="comment"># Left join - همه رکوردهای چپ + مشترک</span>
left_merge = pd.merge(employees, salaries, on=<span class="string">'کد_کارمند'</span>, how=<span class="string">'left'</span>)
<span class="function">print</span>(<span class="string">f"Left Join:\n{left_merge}\n"</span>)

<span class="comment"># Right join - همه رکوردهای راست + مشترک</span>
right_merge = pd.merge(employees, salaries, on=<span class="string">'کد_کارمند'</span>, how=<span class="string">'right'</span>)
<span class="function">print</span>(<span class="string">f"Right Join:\n{right_merge}\n"</span>)

<span class="comment"># Outer join - همه رکوردها</span>
outer_merge = pd.merge(employees, salaries, on=<span class="string">'کد_کارمند'</span>, how=<span class="string">'outer'</span>)
<span class="function">print</span>(<span class="string">f"Outer Join:\n{outer_merge}\n"</span>)

<span class="comment"># Merge با نام ستون‌های متفاوت</span>
projects = pd.DataFrame({
    <span class="string">'emp_id'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>],
    <span class="string">'پروژه'</span>: [<span class="string">'پروژه A'</span>, <span class="string">'پروژه B'</span>, <span class="string">'پروژه C'</span>, <span class="string">'پروژه D'</span>],
    <span class="string">'وضعیت'</span>: [<span class="string">'تکمیل'</span>, <span class="string">'در حال انجام'</span>, <span class="string">'تکمیل'</span>, <span class="string">'شروع نشده'</span>]
})

project_merge = pd.merge(employees, projects, left_on=<span class="string">'کد_کارمند'</span>, right_on=<span class="string">'emp_id'</span>)
<span class="function">print</span>(<span class="string">f"Merge با نام ستون متفاوت:\n{project_merge}\n"</span>)
                    </div>

                    <h3>🔄 Join - ادغام بر اساس ایندکس:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># تنظیم ایندکس برای join</span>
<span class="function">print</span>(<span class="string">"🔄 Join operations:"</span>)

emp_indexed = employees.set_index(<span class="string">'کد_کارمند'</span>)
sal_indexed = salaries.set_index(<span class="string">'کد_کارمند'</span>)

<span class="comment"># Join بر اساس ایندکس</span>
joined_data = emp_indexed.join(sal_indexed, how=<span class="string">'inner'</span>)
<span class="function">print</span>(<span class="string">f"Inner Join با ایندکس:\n{joined_data}\n"</span>)

<span class="comment"># Left join</span>
left_joined = emp_indexed.join(sal_indexed, how=<span class="string">'left'</span>)
<span class="function">print</span>(<span class="string">f"Left Join:\n{left_joined}\n"</span>)

<span class="comment"># Join چندین DataFrame</span>
dept_indexed = departments.set_index(<span class="string">'بخش'</span>)
emp_dept_indexed = employees.set_index(<span class="string">'بخش'</span>)

multi_join = emp_dept_indexed.join(dept_indexed, how=<span class="string">'left'</span>)
<span class="function">print</span>(<span class="string">f"Join با بخش:\n{multi_join}\n"</span>)
                    </div>

                    <h3>📚 Concat - ترکیب عمودی و افقی:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ترکیب عمودی (اضافه کردن سطرها)</span>
<span class="function">print</span>(<span class="string">"📚 Concat operations:"</span>)

<span class="comment"># ایجاد DataFrame های اضافی</span>
new_employees = pd.DataFrame({
    <span class="string">'کد_کارمند'</span>: [<span class="number">6</span>, <span class="number">7</span>],
    <span class="string">'نام'</span>: [<span class="string">'سارا'</span>, <span class="string">'امیر'</span>],
    <span class="string">'بخش'</span>: [<span class="string">'Sales'</span>, <span class="string">'IT'</span>],
    <span class="string">'سن'</span>: [<span class="number">26</span>, <span class="number">30</span>]
})

<span class="comment"># ترکیب عمودی</span>
all_employees = pd.concat([employees, new_employees], ignore_index=<span class="keyword">True</span>)
<span class="function">print</span>(<span class="string">f"ترکیب عمودی:\n{all_employees}\n"</span>)

<span class="comment"># ترکیب افقی (اضافه کردن ستون‌ها)</span>
emp_sal_concat = pd.concat([employees.set_index(<span class="string">'کد_کارمند'</span>), 
                           salaries.set_index(<span class="string">'کد_کارمند'</span>)], axis=<span class="number">1</span>)
<span class="function">print</span>(<span class="string">f"ترکیب افقی:\n{emp_sal_concat}\n"</span>)

<span class="comment"># ترکیب با کلیدهای مختلف</span>
df1 = pd.DataFrame({<span class="string">'A'</span>: [<span class="number">1</span>, <span class="number">2</span>], <span class="string">'B'</span>: [<span class="number">3</span>, <span class="number">4</span>]})
df2 = pd.DataFrame({<span class="string">'C'</span>: [<span class="number">5</span>, <span class="number">6</span>], <span class="string">'D'</span>: [<span class="number">7</span>, <span class="number">8</span>]})

concat_with_keys = pd.concat([df1, df2], keys=[<span class="string">'اول'</span>, <span class="string">'دوم'</span>])
<span class="function">print</span>(<span class="string">f"ترکیب با کلید:\n{concat_with_keys}\n"</span>)

<span class="comment"># ترکیب با نام‌گذاری</span>
concat_named = pd.concat({<span class="string">'کارمندان'</span>: employees, <span class="string">'جدید'</span>: new_employees})
<span class="function">print</span>(<span class="string">f"ترکیب با نام:\n{concat_named.head()}"</span>)
                    </div>

                    <h3>🔀 Merge پیشرفته:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># Merge پیشرفته با شرایط مختلف</span>
<span class="function">print</span>(<span class="string">"🔀 Merge پیشرفته:"</span>)

<span class="comment"># Merge با چندین ستون</span>
emp_detailed = pd.DataFrame({
    <span class="string">'نام'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>],
    <span class="string">'بخش'</span>: [<span class="string">'IT'</span>, <span class="string">'HR'</span>, <span class="string">'Finance'</span>],
    <span class="string">'تجربه'</span>: [<span class="number">5</span>, <span class="number">3</span>, <span class="number">7</span>]
})

performance = pd.DataFrame({
    <span class="string">'نام'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, <span class="string">'احمد'</span>],
    <span class="string">'بخش'</span>: [<span class="string">'IT'</span>, <span class="string">'HR'</span>, <span class="string">'Finance'</span>, <span class="string">'Marketing'</span>],  <span class="comment"># احمد در بخش دیگر</span>
    <span class="string">'امتیاز'</span>: [<span class="number">85</span>, <span class="number">92</span>, <span class="number">78</span>, <span class="number">88</span>]
})

multi_key_merge = pd.merge(emp_detailed, performance, on=[<span class="string">'نام'</span>, <span class="string">'بخش'</span>])
<span class="function">print</span>(<span class="string">f"Merge با چند کلید:\n{multi_key_merge}\n"</span>)

<span class="comment"># Merge با suffixes</span>
emp_current = pd.DataFrame({
    <span class="string">'کد'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],
    <span class="string">'حقوق'</span>: [<span class="number">5000000</span>, <span class="number">4500000</span>, <span class="number">6000000</span>]
})

emp_previous = pd.DataFrame({
    <span class="string">'کد'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],
    <span class="string">'حقوق'</span>: [<span class="number">4500000</span>, <span class="number">4200000</span>, <span class="number">5500000</span>]
})

salary_comparison = pd.merge(emp_current, emp_previous, on=<span class="string">'کد'</span>, suffixes=(<span class="string">'_فعلی'</span>, <span class="string">'_قبلی'</span>))
salary_comparison[<span class="string">'افزایش'</span>] = salary_comparison[<span class="string">'حقوق_فعلی'</span>] - salary_comparison[<span class="string">'حقوق_قبلی'</span>]
<span class="function">print</span>(<span class="string">f"مقایسه حقوق:\n{salary_comparison}\n"</span>)

<span class="comment"># Merge با validate</span>
<span class="keyword">try</span>:
    validated_merge = pd.merge(employees, salaries, on=<span class="string">'کد_کارمند'</span>, validate=<span class="string">'one_to_one'</span>)
<span class="keyword">except</span> ValueError <span class="keyword">as</span> e:
    <span class="function">print</span>(<span class="string">f"خطای اعتبارسنجی: {e}"</span>)
                    </div>

                    <h3>🔄 Reshape Operations:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># عملیات تغییر شکل داده‌ها</span>
<span class="function">print</span>(<span class="string">"🔄 Reshape Operations:"</span>)

<span class="comment"># Melt - تبدیل wide به long</span>
sales_wide = pd.DataFrame({
    <span class="string">'فروشنده'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>],
    <span class="string">'Q1'</span>: [<span class="number">100</span>, <span class="number">120</span>],
    <span class="string">'Q2'</span>: [<span class="number">110</span>, <span class="number">130</span>],
    <span class="string">'Q3'</span>: [<span class="number">105</span>, <span class="number">125</span>]
})

sales_long = pd.melt(sales_wide, id_vars=[<span class="string">'فروشنده'</span>], 
                    value_vars=[<span class="string">'Q1'</span>, <span class="string">'Q2'</span>, <span class="string">'Q3'</span>],
                    var_name=<span class="string">'فصل'</span>, value_name=<span class="string">'فروش'</span>)
<span class="function">print</span>(<span class="string">f"Wide format:\n{sales_wide}\n"</span>)
<span class="function">print</span>(<span class="string">f"Long format:\n{sales_long}\n"</span>)

<span class="comment"># Pivot - تبدیل long به wide</span>
sales_pivot = sales_long.pivot(index=<span class="string">'فروشنده'</span>, columns=<span class="string">'فصل'</span>, values=<span class="string">'فروش'</span>)
<span class="function">print</span>(<span class="string">f"Pivot result:\n{sales_pivot}\n"</span>)

<span class="comment"># Stack و Unstack</span>
stacked = sales_pivot.stack()
<span class="function">print</span>(<span class="string">f"Stacked:\n{stacked}\n"</span>)

unstacked = stacked.unstack()
<span class="function">print</span>(<span class="string">f"Unstacked:\n{unstacked}"</span>)
                    </div>

                    <h3>🎯 مثال کاربردی - سیستم HR:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># مثال جامع: ایجاد گزارش جامع HR</span>
<span class="function">print</span>(<span class="string">"🎯 مثال کاربردی - سیستم HR:"</span>)

<span class="comment"># مرحله 1: ترکیب اطلاعات پایه کارمندان با حقوق</span>
base_info = pd.merge(employees, salaries, on=<span class="string">'کد_کارمند'</span>, how=<span class="string">'left'</span>)
<span class="function">print</span>(<span class="string">f"اطلاعات پایه:\n{base_info}\n"</span>)

<span class="comment"># مرحله 2: اضافه کردن اطلاعات بخش</span>
complete_info = pd.merge(base_info, departments, on=<span class="string">'بخش'</span>, how=<span class="string">'left'</span>)
<span class="function">print</span>(<span class="string">f"اطلاعات کامل:\n{complete_info}\n"</span>)

<span class="comment"># مرحله 3: محاسبه آمارهای مفید</span>
complete_info[<span class="string">'کل_درآمد'</span>] = complete_info[<span class="string">'حقوق'</span>].fillna(<span class="number">0</span>) + complete_info[<span class="string">'پاداش'</span>].fillna(<span class="number">0</span>)
complete_info[<span class="string">'درصد_از_بودجه'</span>] = (complete_info[<span class="string">'کل_درآمد'</span>] / complete_info[<span class="string">'بودجه'</span>] * <span class="number">100</span>).round(<span class="number">2</span>)

<span class="comment"># مرحله 4: تحلیل بخش‌ها</span>
department_summary = complete_info.groupby(<span class="string">'بخش'</span>).agg({
    <span class="string">'کد_کارمند'</span>: <span class="string">'count'</span>,
    <span class="string">'سن'</span>: <span class="string">'mean'</span>,
    <span class="string">'کل_درآمد'</span>: [<span class="string">'sum'</span>, <span class="string">'mean'</span>],
    <span class="string">'بودجه'</span>: <span class="string">'first'</span>
}).round(<span class="number">2</span>)

department_summary.columns = [<span class="string">'تعداد_کارمند'</span>, <span class="string">'میانگین_سن'</span>, <span class="string">'کل_هزینه'</span>, <span class="string">'میانگین_درآمد'</span>, <span class="string">'بودجه'</span>]
department_summary[<span class="string">'باقیمانده_بودجه'</span>] = department_summary[<span class="string">'بودجه'</span>] - department_summary[<span class="string">'کل_هزینه'</span>]
department_summary[<span class="string">'درصد_استفاده'</span>] = (department_summary[<span class="string">'کل_هزینه'</span>] / department_summary[<span class="string">'بودجه'</span>] * <span class="number">100</span>).round(<span class="number">2</span>)

<span class="function">print</span>(<span class="string">f"خلاصه بخش‌ها:\n{department_summary}\n"</span>)

<span class="comment"># مرحله 5: گزارش نهایی</span>
<span class="function">print</span>(<span class="string">f"📊 گزارش نهایی HR:"</span>)
<span class="function">print</span>(<span class="string">f"کل کارمندان: {complete_info['کد_کارمند'].count()}"</span>)
<span class="function">print</span>(<span class="string">f"میانگین سن: {complete_info['سن'].mean():.1f} سال"</span>)
<span class="function">print</span>(<span class="string">f"کل هزینه حقوق: {complete_info['کل_درآمد'].sum():,} تومان"</span>)
<span class="function">print</span>(<span class="string">f"کل بودجه: {departments['بودجه'].sum():,} تومان"</span>)
<span class="function">print</span>(<span class="string">f"درصد استفاده از بودجه: {(complete_info['کل_درآمد'].sum() / departments['بودجه'].sum() * 100):.1f}%"</span>)

<span class="comment"># نمایش گزارش نهایی</span>
final_report = complete_info[[<span class="string">'نام'</span>, <span class="string">'بخش'</span>, <span class="string">'سن'</span>, <span class="string">'کل_درآمد'</span>, <span class="string">'مدیر'</span>]].fillna(<span class="string">'نامشخص'</span>)
<span class="function">print</span>(<span class="string">f"\nگزارش کارمندان:\n{final_report}"</span>)
                    </div>

                    <div class="method-grid">
                        <div class="method-card">
                            <div class="method-name">pd.merge()</div>
                            <div class="method-desc">ادغام بر اساس کلید</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.join()</div>
                            <div class="method-desc">ادغام بر اساس ایندکس</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">pd.concat()</div>
                            <div class="method-desc">ترکیب عمودی/افقی</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">pd.melt()</div>
                            <div class="method-desc">تبدیل wide به long</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.pivot()</div>
                            <div class="method-desc">تبدیل long به wide</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.stack()/.unstack()</div>
                            <div class="method-desc">تغییر شکل MultiIndex</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">💡 نکات ادغام داده‌ها:</div>
                        <ul>
                            <li><strong>Inner join:</strong> فقط رکوردهای مشترک</li>
                            <li><strong>Left/Right join:</strong> همه رکوردهای یک طرف + مشترک</li>
                            <li><strong>Outer join:</strong> همه رکوردها از هر دو طرف</li>
                            <li><strong>Validate:</strong> برای اطمینان از نوع رابطه استفاده کنید</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- اسلاید 9: کار با رشته‌ها -->
            <div class="slide" id="slide9">
                <div class="slide-number">9/15</div>
                <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                <button class="close-btn" onclick="closeSlide(this)">×</button>
                <div class="icon">🔤</div>
                <div class="slide-title">کار با رشته‌ها در Pandas</div>
                <div class="slide-content">
                    <h3>🔤 String Accessor (.str):</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ایجاد DataFrame با داده‌های متنی</span>
text_data = pd.DataFrame({
    <span class="string">'نام_کامل'</span>: [<span class="string">'احمد رضایی'</span>, <span class="string">'فاطمه محمدی'</span>, <span class="string">'علی حسینی'</span>, <span class="string">'زهرا کریمی'</span>, <span class="string">'محمد احمدی'</span>],
    <span class="string">'ایمیل'</span>: [<span class="string">'ahmad.rezaei@gmail.com'</span>, <span class="string">'fateme.mohammadi@yahoo.com'</span>, 
              <span class="string">'ali.hosseini@company.ir'</span>, <span class="string">'zahra.karimi@outlook.com'</span>, <span class="string">'mohammad.ahmadi@gmail.com'</span>],
    <span class="string">'تلفن'</span>: [<span class="string">'091-234-5678'</span>, <span class="string">'0912 345 6789'</span>, <span class="string">'(0919)123-4567'</span>, 
             <span class="string">'+98 935 123 4567'</span>, <span class="string">'09151234567'</span>],
    <span class="string">'آدرس'</span>: [<span class="string">'تهران، خیابان ولیعصر، پلاک 123'</span>, <span class="string">'اصفهان، خیابان چهارباغ، پلاک 456'</span>,
             <span class="string">'شیراز، خیابان زند، پلاک 789'</span>, <span class="string">'مشهد، خیابان امام رضا، پلاک 321'</span>,
             <span class="string">'تبریز، خیابان فردوسی، پلاک 654'</span>],
    <span class="string">'توضیحات'</span>: [<span class="string">'کارمند IT با 5 سال تجربه'</span>, <span class="string">'مدیر HR'</span>, <span class="string">'حسابدار ارشد'</span>, 
                <span class="string">'متخصص بازاریابی'</span>, <span class="string">'برنامه‌نویس Python'</span>]
})

<span class="function">print</span>(<span class="string">"🔤 داده‌های متنی:"</span>)
<span class="function">print</span>(text_data)
                    </div>

                    <h3>✂️ عملیات پایه روی رشته‌ها:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># عملیات پایه</span>
<span class="function">print</span>(<span class="string">"✂️ عملیات پایه:"</span>)

<span class="comment"># طول رشته‌ها</span>
text_data[<span class="string">'طول_نام'</span>] = text_data[<span class="string">'نام_کامل'</span>].str.len()
<span class="function">print</span>(<span class="string">f"طول نام‌ها:\n{text_data[['نام_کامل', 'طول_نام']]}\n"</span>)

<span class="comment"># تبدیل به حروف بزرگ و کوچک</span>
text_data[<span class="string">'ایمیل_بزرگ'</span>] = text_data[<span class="string">'ایمیل'</span>].str.upper()
text_data[<span class="string">'ایمیل_کوچک'</span>] = text_data[<span class="string">'ایمیل'</span>].str.lower()
<span class="function">print</span>(<span class="string">f"تغییر حالت:\n{text_data[['ایمیل', 'ایمیل_بزرگ', 'ایمیل_کوچک']].head(2)}\n"</span>)

<span class="comment"># حروف اول بزرگ</span>
text_data[<span class="string">'نام_فرمت'</span>] = text_data[<span class="string">'نام_کامل'</span>].str.title()
<span class="function">print</span>(<span class="string">f"فرمت Title:\n{text_data[['نام_کامل', 'نام_فرمت']]}\n"</span>)

<span class="comment"># حذف فاصله‌های اضافی</span>
messy_names = pd.Series([<span class="string">'  احمد  '</span>, <span class="string">'فاطمه   '</span>, <span class="string">'   علی'</span>])
clean_names = messy_names.str.strip()
<span class="function">print</span>(<span class="string">f"قبل از strip: {messy_names.tolist()}"</span>)
<span class="function">print</span>(<span class="string">f"بعد از strip: {clean_names.tolist()}\n"</span>)

<span class="comment"># جایگزینی</span>
text_data[<span class="string">'تلفن_تمیز'</span>] = text_data[<span class="string">'تلفن'</span>].str.replace(<span class="string">r'[^\d]'</span>, <span class="string">''</span>, regex=<span class="keyword">True</span>)
<span class="function">print</span>(<span class="string">f"تلفن تمیز شده:\n{text_data[['تلفن', 'تلفن_تمیز']]}"</span>)
                    </div>

                    <h3>🔍 جستجو و فیلتر:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># جستجو و فیلتر در رشته‌ها</span>
<span class="function">print</span>(<span class="string">"🔍 جستجو و فیلتر:"</span>)

<span class="comment"># contains - شامل بودن</span>
gmail_users = text_data[text_data[<span class="string">'ایمیل'</span>].str.contains(<span class="string">'gmail'</span>)]
<span class="function">print</span>(<span class="string">f"کاربران Gmail:\n{gmail_users[['نام_کامل', 'ایمیل']]}\n"</span>)

<span class="comment"># startswith - شروع شدن با</span>
tehran_residents = text_data[text_data[<span class="string">'آدرس'</span>].str.startswith(<span class="string">'تهران'</span>)]
<span class="function">print</span>(<span class="string">f"ساکنان تهران:\n{tehran_residents[['نام_کامل', 'آدرس']]}\n"</span>)

<span class="comment"># endswith - تمام شدن با</span>
ir_emails = text_data[text_data[<span class="string">'ایمیل'</span>].str.endswith(<span class="string">'.ir'</span>)]
<span class="function">print</span>(<span class="string">f"ایمیل‌های ایرانی:\n{ir_emails[['نام_کامل', 'ایمیل']]}\n"</span>)

<span class="comment"># جستجوی case-insensitive</span>
it_workers = text_data[text_data[<span class="string">'توضیحات'</span>].str.contains(<span class="string">'IT'</span>, case=<span class="keyword">False</span>)]
<span class="function">print</span>(<span class="string">f"کارکنان IT:\n{it_workers[['نام_کامل', 'توضیحات']]}\n"</span>)

<span class="comment"># استفاده از regex</span>
phone_pattern = <span class="string">r'09\d{9}'</span>  <span class="comment"># الگوی موبایل ایران</span>
valid_mobiles = text_data[text_data[<span class="string">'تلفن_تمیز'</span>].str.match(phone_pattern)]
<span class="function">print</span>(<span class="string">f"موبایل‌های معتبر:\n{valid_mobiles[['نام_کامل', 'تلفن_تمیز']]}"</span>)
                    </div>

                    <h3>✂️ تقسیم و استخراج:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># تقسیم رشته‌ها</span>
<span class="function">print</span>(<span class="string">"✂️ تقسیم و استخراج:"</span>)

<span class="comment"># تقسیم نام کامل</span>
name_parts = text_data[<span class="string">'نام_کامل'</span>].str.split(<span class="string">' '</span>, expand=<span class="keyword">True</span>)
name_parts.columns = [<span class="string">'نام'</span>, <span class="string">'نام_خانوادگی'</span>]
text_data = pd.concat([text_data, name_parts], axis=<span class="number">1</span>)
<span class="function">print</span>(<span class="string">f"تقسیم نام:\n{text_data[['نام_کامل', 'نام', 'نام_خانوادگی']]}\n"</span>)

<span class="comment"># استخراج دامنه ایمیل</span>
text_data[<span class="string">'دامنه_ایمیل'</span>] = text_data[<span class="string">'ایمیل'</span>].str.split(<span class="string">'@'</span>).str[<span class="number">1</span>]
<span class="function">print</span>(<span class="string">f"دامنه ایمیل:\n{text_data[['ایمیل', 'دامنه_ایمیل']]}\n"</span>)

<span class="comment"># استخراج شهر از آدرس</span>
text_data[<span class="string">'شهر'</span>] = text_data[<span class="string">'آدرس'</span>].str.split(<span class="string">'،'</span>).str[<span class="number">0</span>]
<span class="function">print</span>(<span class="string">f"استخراج شهر:\n{text_data[['آدرس', 'شهر']]}\n"</span>)

<span class="comment"># استخراج با regex</span>
<span class="comment"># استخراج کد شهر از تلفن</span>
text_data[<span class="string">'کد_شهر'</span>] = text_data[<span class="string">'تلفن_تمیز'</span>].str.extract(<span class="string">r'(091\d)'</span>)
<span class="function">print</span>(<span class="string">f"کد شهر:\n{text_data[['تلفن_تمیز', 'کد_شهر']]}\n"</span>)

<span class="comment"># استخراج چندین گروه</span>
email_pattern = <span class="string">r'([^@]+)@([^.]+)\.(.+)'</span>
email_parts = text_data[<span class="string">'ایمیل'</span>].str.extract(email_pattern)
email_parts.columns = [<span class="string">'نام_کاربری'</span>, <span class="string">'سرویس'</span>, <span class="string">'پسوند'</span>]
<span class="function">print</span>(<span class="string">f"اجزای ایمیل:\n{email_parts}"</span>)
                    </div>

                    <h3>🔧 عملیات پیشرفته:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># عملیات پیشرفته روی رشته‌ها</span>
<span class="function">print</span>(<span class="string">"🔧 عملیات پیشرفته:"</span>)

<span class="comment"># pad - اضافه کردن کاراکتر</span>
text_data[<span class="string">'کد_کارمند'</span>] = text_data.index.astype(str).str.pad(width=<span class="number">3</span>, side=<span class="string">'left'</span>, fillchar=<span class="string">'0'</span>)
<span class="function">print</span>(<span class="string">f"کد کارمند:\n{text_data[['نام', 'کد_کارمند']]}\n"</span>)

<span class="comment"># slice - برش رشته</span>
text_data[<span class="string">'نام_کوتاه'</span>] = text_data[<span class="string">'نام'</span>].str.slice(<span class="number">0</span>, <span class="number">3</span>)
<span class="function">print</span>(<span class="string">f"نام کوتاه:\n{text_data[['نام', 'نام_کوتاه']]}\n"</span>)

<span class="comment"># repeat - تکرار</span>
text_data[<span class="string">'ستاره'</span>] = <span class="string">'*'</span> * text_data[<span class="string">'نام'</span>].str.len()
<span class="function">print</span>(<span class="string">f"ستاره‌ها:\n{text_data[['نام', 'ستاره']]}\n"</span>)

<span class="comment"># center - وسط‌چین کردن</span>
text_data[<span class="string">'نام_مرکز'</span>] = text_data[<span class="string">'نام'</span>].str.center(<span class="number">10</span>, <span class="string">'-'</span>)
<span class="function">print</span>(<span class="string">f"نام مرکز:\n{text_data[['نام', 'نام_مرکز']]}\n"</span>)

<span class="comment"># count - شمارش تکرار</span>
text_data[<span class="string">'تعداد_ا'</span>] = text_data[<span class="string">'نام_کامل'</span>].str.count(<span class="string">'ا'</span>)
<span class="function">print</span>(<span class="string">f"تعداد 'ا' در نام:\n{text_data[['نام_کامل', 'تعداد_ا']]}\n"</span>)

<span class="comment"># normalize - نرمال‌سازی Unicode</span>
<span class="keyword">import</span> unicodedata
persian_text = pd.Series([<span class="string">'سلام'</span>, <span class="string">'درود'</span>, <span class="string">'صبح بخیر'</span>])
normalized = persian_text.str.normalize(<span class="string">'NFKC'</span>)
<span class="function">print</span>(<span class="string">f"متن نرمال شده: {normalized.tolist()}"</span>)
                    </div>

                    <h3>📊 تحلیل متنی:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># تحلیل آماری متن</span>
<span class="function">print</span>(<span class="string">"📊 تحلیل متنی:"</span>)

<span class="comment"># آمار طول رشته‌ها</span>
length_stats = text_data[<span class="string">'نام_کامل'</span>].str.len().describe()
<span class="function">print</span>(<span class="string">f"آمار طول نام‌ها:\n{length_stats}\n"</span>)

<span class="comment"># فراوانی کلمات</span>
all_words = <span class="string">' '</span>.join(text_data[<span class="string">'توضیحات'</span>]).split()
word_freq = pd.Series(all_words).value_counts()
<span class="function">print</span>(<span class="string">f"فراوانی کلمات:\n{word_freq.head()}\n"</span>)

<span class="comment"># تحلیل دامنه ایمیل</span>
domain_counts = text_data[<span class="string">'دامنه_ایمیل'</span>].value_counts()
<span class="function">print</span>(<span class="string">f"توزیع دامنه‌های ایمیل:\n{domain_counts}\n"</span>)

<span class="comment"># تحلیل شهرها</span>
city_counts = text_data[<span class="string">'شهر'</span>].value_counts()
<span class="function">print</span>(<span class="string">f"توزیع شهرها:\n{city_counts}\n"</span>)

<span class="comment"># یافتن الگوهای مشترک</span>
<span class="comment"># نام‌هایی که با حروف خاص شروع می‌شوند</span>
first_letter_counts = text_data[<span class="string">'نام'</span>].str[<span class="number">0</span>].value_counts()
<span class="function">print</span>(<span class="string">f"توزیع حرف اول نام‌ها:\n{first_letter_counts}"</span>)
                    </div>

                    <h3>🛠️ تمیز‌کاری پیشرفته:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># تمیز‌کاری و استاندارد‌سازی پیشرفته</span>
<span class="function">print</span>(<span class="string">"🛠️ تمیز‌کاری پیشرفته:"</span>)

<span class="comment"># تابع تمیز‌کاری شماره تلفن</span>
<span class="keyword">def</span> <span class="function">clean_phone</span>(phone):
    <span class="string">"""تمیز‌کاری و استاندارد‌سازی شماره تلفن"""</span>
    <span class="comment"># حذف همه کاراکترهای غیرعددی</span>
    clean = re.sub(<span class="string">r'[^\d]'</span>, <span class="string">''</span>, str(phone))
    
    <span class="comment"># تبدیل کد کشور</span>
    <span class="keyword">if</span> clean.startswith(<span class="string">'98'</span>):
        clean = <span class="string">'0'</span> + clean[<span class="number">2</span>:]
    
    <span class="comment"># فرمت استاندارد</span>
    <span class="keyword">if</span> len(clean) == <span class="number">11</span> <span class="keyword">and</span> clean.startswith(<span class="string">'09'</span>):
        <span class="keyword">return</span> <span class="string">f"{clean[:4]}-{clean[4:7]}-{clean[7:]}"</span>
    <span class="keyword">else</span>:
        <span class="keyword">return</span> clean

text_data[<span class="string">'تلفن_استاندارد'</span>] = text_data[<span class="string">'تلفن'</span>].apply(clean_phone)
<span class="function">print</span>(<span class="string">f"تلفن استاندارد:\n{text_data[['تلفن', 'تلفن_استاندارد']]}\n"</span>)

<span class="comment"># تابع اعتبارسنجی ایمیل</span>
<span classHello! I'm Claude 4 Sonnet by Anthropic. I notice you asked me to continue, but I don't see the previous context of what I should be continuing. 

Based on your user memory, I can see that you've been working on a data science course with Python, specifically around session 8, and you've been creating presentation slides. The last content seems to be about GroupBy operations in Pandas.

Could you please clarify what you'd like me to continue with? Are you looking for me to:

1. Continue with the GroupBy slide content?
2. Move on to the next slide in the presentation?
3. Continue with something else specific?

Please let me know what you'd like me to continue, and I'll be


="string">email_pattern = <span class="string">r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'</span>
text_data[<span class="string">'ایمیل_معتبر'</span>] = text_data[<span class="string">'ایمیل'</span>].str.match(email_pattern)
<span class="function">print</span>(<span class="string">f"اعتبارسنجی ایمیل:\n{text_data[['ایمیل', 'ایمیل_معتبر']]}\n"</span>)

<span class="comment"># تمیز‌کاری نام‌ها</span>
<span class="keyword">def</span> <span class="function">clean_name</span>(name):
    <span class="string">"""تمیز‌کاری و استاندارد‌سازی نام"""</span>
    <span class="keyword">if</span> pd.isna(name):
        <span class="keyword">return</span> name
    
    <span class="comment"># حذف فاصله‌های اضافی</span>
    cleaned = re.sub(<span class="string">r'\s+'</span>, <span class="string">' '</span>, str(name).strip())
    
    <span class="comment"># حروف اول بزرگ</span>
    cleaned = cleaned.title()
    
    <span class="keyword">return</span> cleaned

text_data[<span class="string">'نام_تمیز'</span>] = text_data[<span class="string">'نام_کامل'</span>].apply(clean_name)
<span class="function">print</span>(<span class="string">f"نام تمیز شده:\n{text_data[['نام_کامل', 'نام_تمیز']]}\n"</span>)

<span class="comment"># استخراج اطلاعات از متن آزاد</span>
<span class="comment"># استخراج سال‌های تجربه</span>
experience_pattern = <span class="string">r'(\d+)\s*سال'</span>
text_data[<span class="string">'سال_تجربه'</span>] = text_data[<span class="string">'توضیحات'</span>].str.extract(experience_pattern).astype(float)
<span class="function">print</span>(<span class="string">f"استخراج تجربه:\n{text_data[['توضیحات', 'سال_تجربه']]}\n"</span>)

<span class="comment"># دسته‌بندی بر اساس محتوا</span>
<span class="keyword">def</span> <span class="function">categorize_role</span>(description):
    <span class="string">"""دسته‌بندی نقش بر اساس توضیحات"""</span>
    <span class="keyword">if</span> pd.isna(description):
        <span class="keyword">return</span> <span class="string">'نامشخص'</span>
    
    desc_lower = description.lower()
    <span class="keyword">if</span> <span class="string">'مدیر'</span> <span class="keyword">in</span> desc_lower:
        <span class="keyword">return</span> <span class="string">'مدیریت'</span>
    <span class="keyword">elif</span> any(tech <span class="keyword">in</span> desc_lower <span class="keyword">for</span> tech <span class="keyword">in</span> [<span class="string">'it'</span>, <span class="string">'برنامه'</span>, <span class="string">'python'</span>]):
        <span class="keyword">return</span> <span class="string">'فناوری'</span>
    <span class="keyword">elif</span> any(fin <span class="keyword">in</span> desc_lower <span class="keyword">for</span> fin <span class="keyword">in</span> [<span class="string">'حسابدار'</span>, <span class="string">'مالی'</span>]):
        <span class="keyword">return</span> <span class="string">'مالی'</span>
    <span class="keyword">elif</span> <span class="string">'بازاریابی'</span> <span class="keyword">in</span> desc_lower:
        <span class="keyword">return</span> <span class="string">'بازاریابی'</span>
    <span class="keyword">else</span>:
        <span class="keyword">return</span> <span class="string">'سایر'</span>

text_data[<span class="string">'دسته_شغلی'</span>] = text_data[<span class="string">'توضیحات'</span>].apply(categorize_role)
<span class="function">print</span>(<span class="string">f"دسته‌بندی شغلی:\n{text_data[['توضیحات', 'دسته_شغلی']]}"</span>)
                    </div>

                    <h3>📈 گزارش نهایی:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># تهیه گزارش جامع از تحلیل متنی</span>
<span class="function">print</span>(<span class="string">"📈 گزارش نهایی تحلیل متنی:"</span>)

<span class="comment"># خلاصه آماری</span>
<span class="function">print</span>(<span class="string">f"📊 آمار کلی:"</span>)
<span class="function">print</span>(<span class="string">f"تعداد کل رکوردها: {len(text_data)}"</span>)
<span class="function">print</span>(<span class="string">f"میانگین طول نام: {text_data['طول_نام'].mean():.1f} کاراکتر"</span>)
<span class="function">print</span>(<span class="string">f"تعداد ایمیل‌های معتبر: {text_data['ایمیل_معتبر'].sum()}"</span>)
<span class="function">print</span>(<span class="string">f"میانگین سال تجربه: {text_data['سال_تجربه'].mean():.1f} سال\n"</span>)

<span class="comment"># توزیع دسته‌های شغلی</span>
job_distribution = text_data[<span class="string">'دسته_شغلی'</span>].value_counts()
<span class="function">print</span>(<span class="string">f"📋 توزیع دسته‌های شغلی:"</span>)
<span class="keyword">for</span> category, count <span class="keyword">in</span> job_distribution.items():
    percentage = (count / len(text_data)) * <span class="number">100</span>
    <span class="function">print</span>(<span class="string">f"{category}: {count} نفر ({percentage:.1f}%)"</span>)

<span class="comment"># توزیع شهرها</span>
<span class="function">print</span>(<span class="string">f"\n🏙️ توزیع جغرافیایی:"</span>)
city_distribution = text_data[<span class="string">'شهر'</span>].value_counts()
<span class="keyword">for</span> city, count <span class="keyword">in</span> city_distribution.items():
    percentage = (count / len(text_data)) * <span class="number">100</span>
    <span class="function">print</span>(<span class="string">f"{city}: {count} نفر ({percentage:.1f}%)"</span>)

<span class="comment"># ارائه داده‌های تمیز شده</span>
clean_data = text_data[[<span class="string">'کد_کارمند'</span>, <span class="string">'نام_تمیز'</span>, <span class="string">'ایمیل'</span>, <span class="string">'تلفن_استاندارد'</span>, 
                        <span class="string">'شهر'</span>, <span class="string">'دسته_شغلی'</span>, <span class="string">'سال_تجربه'</span>]].copy()
clean_data.columns = [<span class="string">'کد'</span>, <span class="string">'نام'</span>, <span class="string">'ایمیل'</span>, <span class="string">'تلفن'</span>, <span class="string">'شهر'</span>, <span class="string">'شغل'</span>, <span class="string">'تجربه'</span>]

<span class="function">print</span>(<span class="string">f"\n📋 داده‌های تمیز شده:"</span>)
<span class="function">print</span>(clean_data)

<span class="comment"># ذخیره نتایج</span>
<span class="comment"># clean_data.to_csv('cleaned_employee_data.csv', index=False)</span>
<span class="function">print</span>(<span class="string">f"\n✅ پردازش متنی کامل شد!"</span>)
                    </div>

                    <div class="method-grid">
                        <div class="method-card">
                            <div class="method-name">.str.len()</div>
                            <div class="method-desc">طول رشته</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.str.contains()</div>
                            <div class="method-desc">جستجوی الگو</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.str.split()</div>
                            <div class="method-desc">تقسیم رشته</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.str.extract()</div>
                            <div class="method-desc">استخراج با regex</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.str.replace()</div>
                            <div class="method-desc">جایگزینی</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.str.strip()</div>
                            <div class="method-desc">حذف فاصله</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">💡 نکات کار با رشته‌ها:</div>
                        <ul>
                            <li><strong>Regex:</strong> برای الگوهای پیچیده استفاده کنید</li>
                            <li><strong>Case sensitivity:</strong> به حساسیت به حروف بزرگ/کوچک توجه کنید</li>
                            <li><strong>Unicode:</strong> برای متن‌های فارسی normalize استفاده کنید</li>
                            <li><strong>Validation:</strong> همیشه ورودی‌ها را اعتبارسنجی کنید</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- اسلاید 10: کار با تاریخ و زمان -->
            <div class="slide" id="slide10">
                <div class="slide-number">10/15</div>
                <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                <button class="close-btn" onclick="closeSlide(this)">×</button>
                <div class="icon">📅</div>
                <div class="slide-title">کار با تاریخ و زمان</div>
                <div class="slide-content">
                    <h3>📅 ایجاد و تبدیل تاریخ:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ایجاد DataFrame با داده‌های تاریخی</span>
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta
<span class="keyword">import</span> jdatetime  <span class="comment"># برای تاریخ شمسی</span>

<span class="comment"># انواع مختلف ایجاد تاریخ</span>
date_data = pd.DataFrame({
    <span class="string">'تاریخ_رشته'</span>: [<span class="string">'2024-01-15'</span>, <span class="string">'2024-02-20'</span>, <span class="string">'2024-03-10'</span>, <span class="string">'2024-04-05'</span>, <span class="string">'2024-05-12'</span>],
    <span class="string">'تاریخ_فارسی'</span>: [<span class="string">'1402/10/25'</span>, <span class="string">'1402/12/01'</span>, <span class="string">'1403/01/20'</span>, <span class="string">'1403/02/16'</span>, <span class="string">'1403/02/23'</span>],
    <span class="string">'زمان_کامل'</span>: [<span class="string">'2024-01-15 14:30:00'</span>, <span class="string">'2024-02-20 09:15:30'</span>, 
                   <span class="string">'2024-03-10 16:45:15'</span>, <span class="string">'2024-04-05 11:20:45'</span>, <span class="string">'2024-05-12 13:10:20'</span>],
    <span class="string">'فروش'</span>: [<span class="number">150000</span>, <span class="number">230000</span>, <span class="number">180000</span>, <span class="number">210000</span>, <span class="number">195000</span>],
    <span class="string">'مشتری'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, <span class="string">'زهرا'</span>, <span class="string">'محمد'</span>]
})

<span class="function">print</span>(<span class="string">"📅 داده‌های اولیه:"</span>)
<span class="function">print</span>(date_data)
<span class="function">print</span>(<span class="string">f"\nنوع داده‌ها:\n{date_data.dtypes}"</span>)

<span class="comment"># تبدیل رشته به datetime</span>
date_data[<span class="string">'تاریخ'</span>] = pd.to_datetime(date_data[<span class="string">'تاریخ_رشته'</span>])
date_data[<span class="string">'زمان'</span>] = pd.to_datetime(date_data[<span class="string">'زمان_کامل'</span>])

<span class="function">print</span>(<span class="string">f"\nبعد از تبدیل:\n{date_data.dtypes}"</span>)
                    </div>

                    <h3>🔧 عملیات پایه تاریخ:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># استخراج اجزای تاریخ</span>
<span class="function">print</span>(<span class="string">"🔧 استخراج اجزای تاریخ:"</span>)

<span class="comment"># استخراج سال، ماه، روز</span>
date_data[<span class="string">'سال'</span>] = date_data[<span class="string">'تاریخ'</span>].dt.year
date_data[<span class="string">'ماه'</span>] = date_data[<span class="string">'تاریخ'</span>].dt.month
date_data[<span class="string">'روز'</span>] = date_data[<span class="string">'تاریخ'</span>].dt.day
date_data[<span class="string">'روز_هفته'</span>] = date_data[<span class="string">'تاریخ'</span>].dt.day_name()
date_data[<span class="string">'هفته_سال'</span>] = date_data[<span class="string">'تاریخ'</span>].dt.isocalendar().week

<span class="function">print</span>(<span class="string">f"اجزای تاریخ:\n{date_data[['تاریخ', 'سال', 'ماه', 'روز', 'روز_هفته', 'هفته_سال']]}\n"</span>)

<span class="comment"># استخراج اجزای زمان</span>
date_data[<span class="string">'ساعت'</span>] = date_data[<span class="string">'زمان'</span>].dt.hour
date_data[<span class="string">'دقیقه'</span>] = date_data[<span class="string">'زمان'</span>].dt.minute
date_data[<span class="string">'ثانیه'</span>] = date_data[<span class="string">'زمان'</span>].dt.second

<span class="function">print</span>(<span class="string">f"اجزای زمان:\n{date_data[['زمان', 'ساعت', 'دقیقه', 'ثانیه']]}\n"</span>)

<span class="comment"># محاسبات تاریخی</span>
date_data[<span class="string">'روز_سال'</span>] = date_data[<span class="string">'تاریخ'</span>].dt.dayofyear
date_data[<span class="string">'فصل'</span>] = date_data[<span class="string">'ماه'</span>].apply(<span class="keyword">lambda</span> x: 
    <span class="string">'بهار'</span> <span class="keyword">if</span> x <span class="keyword">in</span> [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>] <span class="keyword">else</span>
    <span class="string">'تابستان'</span> <span class="keyword">if</span> x <span class="keyword">in</span> [<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>] <span class="keyword">else</span>
    <span class="string">'پاییز'</span> <span class="keyword">if</span> x <span class="keyword">in</span> [<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>] <span class="keyword">else</span> <span class="string">'زمستان'</span>
)

<span class="function">print</span>(<span class="string">f"اطلاعات اضافی:\n{date_data[['تاریخ', 'روز_سال', 'فصل']]}"</span>)
                    </div>

                    <h3>⏰ محاسبات زمانی:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># محاسبات بین تاریخ‌ها</span>
<span class="function">print</span>(<span class="string">"⏰ محاسبات زمانی:"</span>)

<span class="comment"># تاریخ مرجع</span>
reference_date = pd.to_datetime(<span class="string">'2024-01-01'</span>)
date_data[<span class="string">'روز_از_شروع_سال'</span>] = (date_data[<span class="string">'تاریخ'</span>] - reference_date).dt.days

<span class="comment"># فاصله از امروز</span>
today = pd.Timestamp.now().normalize()
date_data[<span class="string">'روز_تا_امروز'</span>] = (today - date_data[<span class="string">'تاریخ'</span>]).dt.days

<span class="function">print</span>(<span class="string">f"محاسبات فاصله:\n{date_data[['تاریخ', 'روز_از_شروع_سال', 'روز_تا_امروز']]}\n"</span>)

<span class="comment"># اضافه کردن زمان</span>
date_data[<span class="string">'یک_ماه_بعد'</span>] = date_data[<span class="string">'تاریخ'</span>] + pd.DateOffset(months=<span class="number">1</span>)
date_data[<span class="string">'ده_روز_بعد'</span>] = date_data[<span class="string">'تاریخ'</span>] + pd.Timedelta(days=<span class="number">10</span>)
date_data[<span class="string">'دو_ساعت_بعد'</span>] = date_data[<span class="string">'زمان'</span>] + pd.Timedelta(hours=<span class="number">2</span>)

<span class="function">print</span>(<span class="string">f"اضافه کردن زمان:\n{date_data[['تاریخ', 'یک_ماه_بعد', 'ده_روز_بعد']]}\n"</span>)

<span class="comment"># محاسبه سن</span>
birth_dates = pd.to_datetime([<span class="string">'1990-05-15'</span>, <span class="string">'1985-12-20'</span>, <span class="string">'1992-08-10'</span>, <span class="string">'1988-03-25'</span>, <span class="string">'1995-11-30'</span>])
ages = (today - birth_dates).dt.days / <span class="number">365.25</span>
date_data[<span class="string">'سن'</span>] = ages.round(<span class="number">1</span>)

<span class="function">print</span>(<span class="string">f"محاسبه سن:\n{date_data[['مشتری', 'سن']]}"</span>)
                    </div>

                    <h3>📊 تجمیع بر اساس زمان:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ایجاد داده‌های بیشتر برای تحلیل زمانی</span>
<span class="function">print</span>(<span class="string">"📊 تجمیع زمانی:"</span>)

<span class="comment"># ایجاد سری زمانی طولانی‌تر</span>
date_range = pd.date_range(start=<span class="string">'2024-01-01'</span>, end=<span class="string">'2024-12-31'</span>, freq=<span class="string">'D'</span>)
np.random.seed(<span class="number">42</span>)
sales_ts = pd.DataFrame({
    <span class="string">'تاریخ'</span>: date_range,
    <span class="string">'فروش'</span>: np.random.randint(<span class="number">50000</span>, <span class="number">300000</span>, len(date_range)),
    <span class="string">'تعداد_مشتری'</span>: np.random.randint(<span class="number">10</span>, <span class="number">50</span>, len(date_range))
})

<span class="comment"># تنظیم ایندکس تاریخی</span>
sales_ts.set_index(<span class="string">'تاریخ'</span>, inplace=<span class="keyword">True</span>)

<span class="function">print</span>(<span class="string">f"داده‌های سری زمانی:\n{sales_ts.head()}\n"</span>)

<span class="comment"># تجمیع ماهانه</span>
monthly_sales = sales_ts.resample(<span class="string">'M'</span>).agg({
    <span class="string">'فروش'</span>: [<span class="string">'sum'</span>, <span class="string">'mean'</span>, <span class="string">'std'</span>],
    <span class="string">'تعداد_مشتری'</span>: <span class="string">'sum'</span>
})
monthly_sales.columns = [<span class="string">'کل_فروش'</span>, <span class="string">'میانگین_فروش'</span>, <span class="string">'انحراف_فروش'</span>, <span class="string">'کل_مشتری'</span>]

<span class="function">print</span>(<span class="string">f"فروش ماهانه:\n{monthly_sales.head()}\n"</span>)

<span class="comment"># تجمیع هفتگی</span>
weekly_sales = sales_ts.resample(<span class="string">'W'</span>)[<span class="string">'فروش'</span>].sum()
<span class="function">print</span>(<span class="string">f"فروش هفتگی (5 هفته اول):\n{weekly_sales.head()}\n"</span>)

<span class="comment"># تجمیع فصلی</span>
quarterly_sales = sales_ts.resample(<span class="string">'Q'</span>).agg({
    <span class="string">'فروش'</span>: <span class="string">'sum'</span>,
    <span class="string">'تعداد_مشتری'</span>: <span class="string">'mean'</span>
})
<span class="function">print</span>(<span class="string">f"فروش فصلی:\n{quarterly_sales}"</span>)
                    </div>

                    <h3>📈 تحلیل الگوهای زمانی:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># تحلیل الگوهای زمانی</span>
<span class="function">print</span>(<span class="string">"📈 تحلیل الگوها:"</span>)

<span class="comment"># اضافه کردن اجزای زمانی</span>
sales_ts[<span class="string">'ماه'</span>] = sales_ts.index.month
sales_ts[<span class="string">'روز_هفته'</span>] = sales_ts.index.dayofweek  <span class="comment"># 0=دوشنبه، 6=یکشنبه</span>
sales_ts[<span class="string">'نام_روز'</span>] = sales_ts.index.day_name()

<span class="comment"># تحلیل بر اساس روز هفته</span>
weekday_analysis = sales_ts.groupby(<span class="string">'روز_هفته'</span>).agg({
    <span class="string">'فروش'</span>: [<span class="string">'mean'</span>, <span class="string">'std'</span>],
    <span class="string">'تعداد_مشتری'</span>: <span class="string">'mean'</span>
}).round(<span class="number">2</span>)

<span class="comment"># اضافه کردن نام روزها</span>
day_names = [<span class="string">'دوشنبه'</span>, <span class="string">'سه‌شنبه'</span>, <span class="string">'چهارشنبه'</span>, <span class="string">'پنج‌شنبه'</span>, <span class="string">'جمعه'</span>, <span class="string">'شنبه'</span>, <span class="string">'یکشنبه'</span>]
weekday_analysis.index = day_names

<span class="function">print</span>(<span class="string">f"تحلیل روزهای هفته:\n{weekday_analysis}\n"</span>)

<span class="comment"># تحلیل ماهانه</span>
monthly_analysis = sales_ts.groupby(<span class="string">'ماه'</span>)[<span class="string">'فروش'</span>].mean().round(<span class="number">2</span>)
month_names = [<span class="string">'ژانویه'</span>, <span class="string">'فوریه'</span>, <span class="string">'مارس'</span>, <span class="string">'آپریل'</span>, <span class="string">'مه'</span>, <span class="string">'ژوئن'</span>,
               <span class="string">'ژوئیه'</span>, <span class="string">'اوت'</span>, <span class="string">'سپتامبر'</span>, <span class="string">'اکتبر'</span>, <span class="string">'نوامبر'</span>, <span class="string">'دسامبر'</span>]
monthly_analysis.index = month_names

<span class="function">print</span>(<span class="string">f"میانگین فروش ماهانه:\n{monthly_analysis}\n"</span>)

<span class="comment"># یافتن بهترین و بدترین روزها</span>
best_day = sales_ts.loc[sales_ts[<span class="string">'فروش'</span>].idxmax()]
worst_day = sales_ts.loc[sales_ts[<span class="string">'فروش'</span>].idxmin()]

<span class="function">print</span>(<span class="string">f"بهترین روز فروش:"</span>)
<span class="function">print</span>(<span class="string">f"تاریخ: {sales_ts['فروش'].idxmax().strftime('%Y-%m-%d')}"</span>)
<span class="function">print</span>(<span class="string">f"فروش: {best_day['فروش']:,} تومان\n"</span>)

<span class="function">print</span>(<span class="string">f"بدترین روز فروش:"</span>)
<span class="function">print</span>(<span class="string">f"تاریخ: {sales_ts['فروش'].idxmin().strftime('%Y-%m-%d')}"</span>)
<span class="function">print</span>(<span class="string">f"فروش: {worst_day['فروش']:,} تومان"</span>)
                    </div>

                    <h3>🔄 میانگین متحرک و روندها:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># محاسبه میانگین متحرک و روندها</span>
<span class="function">print</span>(<span class="string">"🔄 میانگین متحرک:"</span>)

<span class="comment"># میانگین متحرک 7 روزه</span>
sales_ts[<span class="string">'MA_7'</span>] = sales_ts[<span class="string">'فروش'</span>].rolling(window=<span class="number">7</span>).mean()

<span class="comment"># میانگین متحرک 30 روزه</span>
sales_ts[<span class="string">'MA_30'</span>] = sales_ts[<span class="string">'فروش'</span>].rolling(window=<span class="number">30</span>).mean()

<span class="comment"># میانگین متحرک وزنی</span>
sales_ts[<span class="string">'EMA_7'</span>] = sales_ts[<span class="string">'فروش'</span>].ewm(span=<span class="number">7</span>).mean()

<span class="function">print</span>(<span class="string">f"میانگین‌های متحرک:\n{sales_ts[['فروش', 'MA_7', 'MA_30', 'EMA_7']].head(10)}\n"</span>)

<span class="comment"># محاسبه رشد</span>
sales_ts[<span class="string">'رشد_روزانه'</span>] = sales_ts[<span class="string">'فروش'</span>].pct_change() * <span class="number">100</span>
sales_ts[<span class="string">'رشد_هفتگی'</span>] = sales_ts[<span class="string">'فروش'</span>].pct_change(periods=<span class="number">7</span>) * <span class="number">100</span>

<span class="function">print</span>(<span class="string">f"نرخ رشد:\n{sales_ts[['فروش', 'رشد_روزانه', 'رشد_هفتگی']].head(10)}\n"</span>)

<span class="comment"># تشخیص روند</span>
<span class="keyword">def</span> <span class="function">detect_trend</span>(series, window=<span class="number">30</span>):
    <span class="string">"""تشخیص روند بر اساس میانگین متحرک"""</span>
    ma = series.rolling(window=window).mean()
    trend = ma.diff()
    
    <span class="keyword">return</span> pd.cut(trend, 
                   bins=[-np.inf, -<span class="number">1000</span>, <span class="number">1000</span>, np.inf], 
                   labels=[<span class="string">'نزولی'</span>, <span class="string">'ثابت'</span>, <span class="string">'صعودی'</span>])

sales_ts[<span class="string">'روند'</span>] = detect_trend(sales_ts[<span class="string">'فروش'</span>])

<span class="comment"># آمار روندها</span>
trend_stats = sales_ts[<span class="string">'روند'</span>].value_counts()
<span class="function">print</span>(<span class="string">f"توزیع روندها:\n{trend_stats}"</span>)
                    </div>

                    <h3>🎯 مثال کاربردی - گزارش فروش:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># مثال جامع: گزارش تحلیل فروش زمانی</span>
<span class="function">print</span>(<span class="string">"🎯 گزارش جامع فروش:"</span>)

<span class="comment"># خلاصه کلی</span>
total_sales = sales_ts[<span class="string">'فروش'</span>].sum()
avg_daily_sales = sales_ts[<span class="string">'فروش'</span>].mean()
total_customers = sales_ts[<span class="string">'تعداد_مشتری'</span>].sum()

<span class="function">print</span>(<span class="string">f"📊 خلاصه سال 2024:"</span>)
<span class="function">print</span>(<span class="string">f"کل فروش: {total_sales:,} تومان"</span>)
<span class="function">print</span>(<span class="string">f"میانگین فروش روزانه: {avg_daily_sales:,.0f} تومان"</span>)
<span class="function">print</span>(<span class="string">f"کل مشتریان: {total_customers:,} نفر\n"</span>)

<span class="comment"># بهترین و بدترین ماه‌ها</span>
monthly_totals = sales_ts.resample(<span class="string">'M'</span>)[<span class="string">'فروش'</span>].sum()
best_month = monthly_totals.idxmax()
worst_month = monthly_totals.idxmin()

<span class="function">print</span>(<span class="string">f"📈 عملکرد ماهانه:"</span>)
<span class="function">print</span>(<span class="string">f"بهترین ماه: {best_month.strftime('%B %Y')} - {monthly_totals[best_month]:,} تومان"</span>)
<span class="function">print</span>(<span class="string">f"ضعیف‌ترین ماه: {worst_month.strftime('%B %Y')} - {monthly_totals[worst_month]:,} تومان\n"</span>)

<span class="comment"># تحلیل فصلی</span>
seasonal_sales = sales_ts.resample(<span class="string">'Q'</span>)[<span class="string">'فروش'</span>].sum()
season_names = [<span class="string">'Q1 (زمستان-بهار)'</span>, <span class="string">'Q2 (بهار-تابستان)'</span>, <span class="string">'Q3 (تابستان-پاییز)'</span>, <span class="string">'Q4 (پاییز-زمستان)'</span>]

<span class="function">print</span>(<span class="string">f"📅 عملکرد فصلی:"</span>)
<span class="keyword">for</span> i, (quarter, sales) <span class="keyword">in</span> <span class="function">enumerate</span>(seasonal_sales.items()):
    percentage = (sales / total_sales) * <span class="number">100</span>
    <span class="function">print</span>(<span class="string">f"{season_names[i]}: {sales:,} تومان ({percentage:.1f}%)"</span>)

<span class="comment"># آمار نهایی</span>
growth_rate = ((monthly_totals.iloc[-<span class="number">1</span>] - monthly_totals.iloc[<span class="number">0</span>]) / monthly_totals.iloc[<span class="number">0</span>]) * <span class="number">100</span>
<span class="function">print</span>(<span class="string">f"\n📊 رشد سالانه: {growth_rate:.1f}%"</span>)

<span class="comment"># ذخیره گزارش</span>
summary_report = pd.DataFrame({
    <span class="string">'شاخص'</span>: [<span class="string">'کل_فروش'</span>, <span class="string">'میانگین_روزانه'</span>, <span class="string">'کل_مشتری'</span>, <span class="string">'رشد_سالانه'</span>],
    <span class="string">'مقدار'</span>: [total_sales, avg_daily_sales, total_customers, growth_rate]
})

<span class="function">print</span>(<span class="string">f"\n📋 گزارش خلاصه:\n{summary_report}"</span>)
                    </div>

                    <div class="method-grid">
                        <div class="method-card">
                            <div class="method-name">pd.to_datetime()</div>
                            <div class="method-desc">تبدیل به تاریخ</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.dt.year/.dt.month</div>
                            <div class="method-desc">استخراج اجزا</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.resample()</div>
                            <div class="method-desc">تجمیع زمانی</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.rolling()</div>
                            <div class="method-desc">میانگین متحرک</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">pd.DateOffset()</div>
                            <div class="method-desc">اضافه کردن زمان</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.pct_change()</div>
                            <div class="method-desc">نرخ رشد</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">💡 نکات کار با زمان:</div>
                        <ul>
                            <li><strong>Timezone:</strong> همیشه منطقه زمانی را مشخص کنید</li>
                            <li><strong>Frequency:</strong> از فرکانس‌های استاندارد استفاده کنید (D, W, M, Q, Y)</li>
                            <li><strong>Business days:</strong> برای روزهای کاری از 'B' استفاده کنید</li>
                            <li><strong>Persian dates:</strong> برای تاریخ شمسی از jdatetime استفاده کنید</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- ادامه اسلایدهای بعدی... -->
            <!-- اسلاید 11: مصورسازی داده‌ها -->
            <div class="slide" id="slide11">
                <div class="slide-number">11/15</div>
                <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                <button class="close-btn" onclick="closeSlide(this)">×</button>
                <div class="icon">📊</div>
                <div class="slide-title">مصورسازی داده‌ها با Matplotlib و Seaborn</div>
                <div class="slide-content">
                    <h3>📊 نمودارهای پایه با Matplotlib:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># وارد کردن کتابخانه‌ها</span>
<span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt
<span class="keyword">import</span> seaborn <span class="keyword">as</span> sns
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># تنظیمات فارسی</span>
plt.rcParams[<span class="string">'font.family'</span>] = <span class="string">'DejaVu Sans'</span>
plt.rcParams[<span class="string">'axes.unicode_minus'</span>] = <span class="keyword">False</span>

<span class="comment"># ایجاد داده‌های نمونه</span>
np.random.seed(<span class="number">42</span>)
sales_data = pd.DataFrame({
    <span class="string">'ماه'</span>: [<span class="string">'فروردین'</span>, <span class="string">'اردیبهشت'</span>, <span class="string">'خرداد'</span>, <span class="string">'تیر'</span>, <span class="string">'مرداد'</span>, <span class="string">'شهریور'</span>],
    <span class="string">'فروش'</span>: [<span class="number">120</span>, <span class="number">135</span>, <span class="number">148</span>, <span class="number">162</span>, <span class="number">158</span>, <span class="number">175</span>],
    <span class="string">'هزینه'</span>: [<span class="number">80</span>, <span class="number">85</span>, <span class="number">92</span>, <span class="number">98</span>, <span class="number">95</span>, <span class="number">105</span>],
    <span class="string">'سود'</span>: [<span class="number">40</span>, <span class="number">50</span>, <span class="number">56</span>, <span class="number">64</span>, <span class="number">63</span>, <span class="number">70</span>]
})

<span class="function">print</span>(<span class="string">"📊 داده‌های فروش:"</span>)
<span class="function">print</span>(sales_data)

<span class="comment"># نمودار خطی ساده</span>
plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))
plt.plot(sales_data[<span class="string">'ماه'</span>], sales_data[<span class="string">'فروش'</span>], marker=<span class="string">'o'</span>, linewidth=<span class="number">2</span>, label=<span class="string">'فروش'</span>)
plt.plot(sales_data[<span class="string">'ماه'</span>], sales_data[<span class="string">'هزینه'</span>], marker=<span class="string">'s'</span>, linewidth=<span class="number">2</span>, label=<span class="string">'هزینه'</span>)
plt.title(<span class="string">'روند فروش و هزینه'</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">'bold'</span>)
plt.xlabel(<span class="string">'ماه'</span>, fontsize=<span class="number">12</span>)
plt.ylabel(<span class="string">'مبلغ (میلیون تومان)'</span>, fontsize=<span class="number">12</span>)
plt.legend()
plt.grid(<span class="keyword">True</span>, alpha=<span class="number">0.3</span>)
plt.xticks(rotation=<span class="number">45</span>)
plt.tight_layout()
plt.show()

<span class="function">print</span>(<span class="string">"✅ نمودار خطی ایجاد شد"</span>)
                    </div>

                    <h3>📈 انواع نمودارها:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ایجاد چندین نمودار در یک figure</span>
fig, axes = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, figsize=(<span class="number">15</span>, <span class="number">10</span>))
fig.suptitle(<span class="string">'انواع نمودارهای تحلیل فروش'</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">'bold'</span>)

<span class="comment"># 1. نمودار میله‌ای</span>
axes[<span class="number">0</span>, <span class="number">0</span>].bar(sales_data[<span class="string">'ماه'</span>], sales_data[<span class="string">'سود'</span>], color=<span class="string">'skyblue'</span>, edgecolor=<span class="string">'navy'</span>)
axes[<span class="number">0</span>, <span class="number">0</span>].set_title(<span class="string">'سود ماهانه'</span>)
axes[<span class="number">0</span>, <span class="number">0</span>].set_ylabel(<span class="string">'سود (میلیون تومان)'</span>)
axes[<span class="number">0</span>, <span class="number">0</span>].tick_params(axis=<span class="string">'x'</span>, rotation=<span class="number">45</span>)

<span class="comment"># 2. نمودار دایره‌ای</span>
colors = [<span class="string">'gold'</span>, <span class="string">'lightcoral'</span>, <span class="string">'lightskyblue'</span>, <span class="string">'lightgreen'</span>, <span class="string">'plum'</span>, <span class="string">'wheat'</span>]
axes[<span class="number">0</span>, <span class="number">1</span>].pie(sales_data[<span class="string">'فروش'</span>], labels=sales_data[<span class="string">'ماه'</span>], autopct=<span class="string">'%1.1f%%'</span>, 
                colors=colors, startangle=<span class="number">90</span>)
axes[<span class="number">0</span>, <span class="number">1</span>].set_title(<span class="string">'توزیع فروش ماهانه'</span>)

<span class="comment"># 3. نمودار پراکندگی</span>
axes[<span class="number">1</span>, <span class="number">0</span>].scatter(sales_data[<span class="string">'هزینه'</span>], sales_data[<span class="string">'فروش'</span>], 
                    s=sales_data[<span class="string">'سود'</span>]*<span class="number">10</span>, alpha=<span class="number">0.6</span>, c=<span class="string">'red'</span>)
axes[<span class="number">1</span>, <span class="number">0</span>].set_title(<span class="string">'رابطه هزینه و فروش'</span>)
axes[<span class="number">1</span>, <span class="number">0</span>].set_xlabel(<span class="string">'هزینه (میلیون تومان)'</span>)
axes[<span class="number">1</span>, <span class="number">0</span>].set_ylabel(<span class="string">'فروش (میلیون تومان)'</span>)

<span class="comment"># 4. نمودار هیستوگرام</span>
<span class="comment"># ایجاد داده‌های تصادفی برای هیستوگرام</span>
random_sales = np.random.normal(<span class="number">150</span>, <span class="number">30</span>, <span class="number">1000</span>)
axes[<span class="number">1</span>, <span class="number">1</span>].hist(random_sales, bins=<span class="number">30</span>, alpha=<span class="number">0.7</span>, color=<span class="string">'green'</span>, edgecolor=<span class="string">'black'</span>)
axes[<span class="number">1</span>, <span class="number">1</span>].set_title(<span class="string">'توزیع فروش روزانه'</span>)
axes[<span class="number">1</span>, <span class="number">1</span>].set_xlabel(<span class="string">'فروش (میلیون تومان)'</span>)
axes[<span class="number">1</span>, <span class="number">1</span>].set_ylabel(<span class="string">'فراوانی'</span>)

plt.tight_layout()
plt.show()

<span class="function">print</span>(<span class="string">"✅ انواع نمودارها ایجاد شدند"</span>)
                    </div>

                    <h3>🎨 Seaborn برای نمودارهای آماری:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ایجاد داده‌های پیچیده‌تر</span>
np.random.seed(<span class="number">42</span>)
detailed_sales = pd.DataFrame({
    <span class="string">'منطقه'</span>: np.random.choice([<span class="string">'شمال'</span>, <span class="string">'جنوب'</span>, <span class="string">'شرق'</span>, <span class="string">'غرب'</span>], <span class="number">200</span>),
    <span class="string">'محصول'</span>: np.random.choice([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>], <span class="number">200</span>),
    <span class="string">'فروش'</span>: np.random.normal(<span class="number">100</span>, <span class="number">25</span>, <span class="number">200</span>),
    <span class="string">'قیمت'</span>: np.random.uniform(<span class="number">50</span>, <span class="number">200</span>, <span class="number">200</span>),
    <span class="string">'رضایت'</span>: np.random.randint(<span class="number">1</span>, <span class="number">6</span>, <span class="number">200</span>)
})

<span class="comment"># تنظیم استایل seaborn</span>
sns.set_style(<span class="string">"whitegrid"</span>)
plt.figure(figsize=(<span class="number">15</span>, <span class="number">12</span>))

<span class="comment"># 1. Box plot</span>
plt.subplot(<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>)
sns.boxplot(data=detailed_sales, x=<span class="string">'منطقه'</span>, y=<span class="string">'فروش'</span>)
plt.title(<span class="string">'توزیع فروش بر اساس منطقه'</span>)
plt.xticks(rotation=<span class="number">45</span>)

<span class="comment"># 2. Violin plot</span>
plt.subplot(<span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>)
sns.violinplot(data=detailed_sales, x=<span class="string">'محصول'</span>, y=<span class="string">'فروش'</span>)
plt.title(<span class="string">'توزیع فروش بر اساس محصول'</span>)

<span class="comment"># 3. Heatmap - ماتریس همبستگی</span>
plt.subplot(<span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>)
correlation_matrix = detailed_sales[[<span class="string">'فروش'</span>, <span class="string">'قیمت'</span>, <span class="string">'رضایت'</span>]].corr()
sns.heatmap(correlation_matrix, annot=<span class="keyword">True</span>, cmap=<span class="string">'coolwarm'</span>, center=<span class="number">0</span>)
plt.title(<span class="string">'ماتریس همبستگی'</span>)

<span class="comment"># 4. Scatter plot با hue</span>
plt.subplot(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)
sns.scatterplot(data=detailed_sales, x=<span class="string">'قیمت'</span>, y=<span class="string">'فروش'</span>, hue=<span class="string">'منطقه'</span>)
plt.title(<span class="string">'رابطه قیمت و فروش'</span>)

<span class="comment"># 5. Count plot</span>
plt.subplot(<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>)
sns.countplot(data=detailed_sales, x=<span class="string">'رضایت'</span>, hue=<span class="string">'منطقه'</span>)
plt.title(<span class="string">'توزیع رضایت مشتریان'</span>)

<span class="comment"># 6. Pair plot (در subplot جداگانه)</span>
plt.subplot(<span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>)
<span class="comment"># به جای pairplot از scatter استفاده می‌کنیم</span>
sns.scatterplot(data=detailed_sales, x=<span class="string">'فروش'</span>, y=<span class="string">'رضایت'</span>, hue=<span class="string">'محصول'</span>)
plt.title(<span class="string">'فروش vs رضایت'</span>)

plt.tight_layout()
plt.show()

<span class="function">print</span>(<span class="string">"✅ نمودارهای آماری seaborn ایجاد شدند"</span>)
                    </div>

                    <h3>📊 نمودارهای تخصصی:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># نمودارهای پیشرفته و تخصصی</span>
fig, axes = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, figsize=(<span class="number">15</span>, <span class="number">10</span>))

<span class="comment"># 1. نمودار میله‌ای چندگانه</span>
months = [<span class="string">'فروردین'</span>, <span class="string">'اردیبهشت'</span>, <span class="string">'خرداد'</span>]
product_a = [<span class="number">20</span>, <span class="number">25</span>, <span class="number">30</span>]
product_b = [<span class="number">15</span>, <span class="number">20</span>, <span class="number">25</span>]
product_c = [<span class="number">10</span>, <span class="number">15</span>, <span class="number">18</span>]

x = np.arange(len(months))
width = <span class="number">0.25</span>

axes[<span class="number">0</span>, <span class="number">0</span>].bar(x - width, product_a, width, label=<span class="string">'محصول A'</span>, color=<span class="string">'skyblue'</span>)
axes[<span class="number">0</span>, <span class="number">0</span>].bar(x, product_b, width, label=<span class="string">'محصول B'</span>, color=<span class="string">'lightcoral'</span>)
axes[<span class="number">0</span>, <span class="number">0</span>].bar(x + width, product_c, width, label=<span class="string">'محصول C'</span>, color=<span class="string">'lightgreen'</span>)
axes[<span class="number">0</span>, <span class="number">0</span>].set_title(<span class="string">'مقایسه فروش محصولات'</span>)
axes[<span class="number">0</span>, <span class="number">0</span>].set_xticks(x)
axes[<span class="number">0</span>, <span class="number">0</span>].set_xticklabels(months)
axes[<span class="number">0</span>, <span class="number">0</span>].legend()

<span class="comment"># 2. نمودار انباشته</span>
axes[<span class="number">0</span>, <span class="number">1</span>].bar(months, product_a, label=<span class="string">'محصول A'</span>, color=<span class="string">'skyblue'</span>)
axes[<span class="number">0</span>, <span class="number">1</span>].bar(months, product_b, bottom=product_a, label=<span class="string">'محصول B'</span>, color=<span class="string">'lightcoral'</span>)
bottom_c = [a + b <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="function">zip</span>(product_a, product_b)]
axes[<span class="number">0</span>, <span class="number">1</span>].bar(months, product_c, bottom=bottom_c, label=<span class="string">'محصول C'</span>, color=<span class="string">'lightgreen'</span>)
axes[<span class="number">0</span>, <span class="number">1</span>].set_title(<span class="string">'فروش انباشته محصولات'</span>)
axes[<span class="number">0</span>, <span class="number">1</span>].legend()

<span class="comment"># 3. نمودار Area</span>
x_area = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">100</span>)
y1 = np.sin(x_area)
y2 = np.cos(x_area)

axes[<span class="number">1</span>, <span class="number">0</span>].fill_between(x_area, y1, alpha=<span class="number">0.5</span>, label=<span class="string">'سری 1'</span>)
axes[<span class="number">1</span>, <span class="number">0</span>].fill_between(x_area, y2, alpha=<span class="number">0.5</span>, label=<span class="string">'سری 2'</span>)
axes[<span class="number">1</span>, <span class="number">0</span>].set_title(<span class="string">'نمودار ناحیه‌ای'</span>)
axes[<span class="number">1</span>, <span class="number">0</span>].legend()

<span class="comment"># 4. نمودار قطبی</span>
<span class="comment"># تبدیل subplot به قطبی</span>
axes[<span class="number">1</span>, <span class="number">1</span>].remove()  <span class="comment"># حذف subplot معمولی</span>
ax_polar = fig.add_subplot(<span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, projection=<span class="string">'polar'</span>)

theta = np.linspace(<span class="number">0</span>, <span class="number">2</span> * np.pi, <span class="number">8</span>)
values = [<span class="number">4</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">6</span>]
labels = [<span class="string">'شمال'</span>, <span class="string">'شمال‌شرق'</span>, <span class="string">'شرق'</span>, <span class="string">'جنوب‌شرق'</span>, 
          <span class="string">'جنوب'</span>, <span class="string">'جنوب‌غرب'</span>, <span class="string">'غرب'</span>, <span class="string">'شمال‌غرب'</span>]

ax_polar.plot(theta, values, <span class="string">'o-'</span>, linewidth=<span class="number">2</span>)
ax_polar.fill(theta, values, alpha=<span class="number">0.25</span>)
ax_polar.set_thetagrids(np.degrees(theta), labels)
ax_polar.set_title(<span class="string">'عملکرد مناطق'</span>, pad=<span class="number">20</span>)

plt.tight_layout()
plt.show()

<span class="function">print</span>(<span class="string">"✅ نمودارهای تخصصی ایجاد شدند"</span>)
                    </div>

                    <h3>🎨 سفارشی‌سازی نمودارها:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># سفارشی‌سازی پیشرفته نمودارها</span>
plt.style.use(<span class="string">'seaborn-v0_8'</span>)  <span class="comment"># استایل حرفه‌ای</span>

fig, ax = plt.subplots(figsize=(<span class="number">12</span>, <span class="number">8</span>))

<span class="comment"># داده‌های نمونه</span>
categories = [<span class="string">'فروش'</span>, <span class="string">'بازاریابی'</span>, <span class="string">'پشتیبانی'</span>, <span class="string">'تحقیق'</span>, <span class="string">'توسعه'</span>]
values = [<span class="number">85</span>, <span class="number">70</span>, <span class="number">90</span>, <span class="number">65</span>, <span class="number">80</span>]
colors = [<span class="string">'#FF6B6B'</span>, <span class="string">'#4ECDC4'</span>, <span class="string">'#45B7D1'</span>, <span class="string">'#96CEB4'</span>, <span class="string">'#FFEAA7'</span>]

<span class="comment"># ایجاد نمودار میله‌ای سفارشی</span>
bars = ax.bar(categories, values, color=colors, edgecolor=<span class="string">'white'</span>, linewidth=<span class="number">2</span>)

<span class="comment"># اضافه کردن مقادیر روی میله‌ها</span>
<span class="keyword">for</span> bar, value <span class="keyword">in</span> <span class="function">zip</span>(bars, values):
    height = bar.get_height()
    ax.text(bar.get_x() + bar.get_width()/<span class="number">2.</span>, height + <span class="number">1</span>,
            <span class="string">f'{value}%'</span>, ha=<span class="string">'center'</span>, va=<span class="string">'bottom'</span>, 
            fontweight=<span class="string">'bold'</span>, fontsize=<span class="number">12</span>)

<span class="comment"># سفارشی‌سازی محورها</span>
ax.set_ylim(<span class="number">0</span>, <span class="number">100</span>)
ax.set_ylabel(<span class="string">'درصد عملکرد'</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">'bold'</span>)
ax.set_xlabel(<span class="string">'بخش‌های شرکت'</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">'bold'</span>)
ax.set_title(<span class="string">'عملکرد بخش‌های مختلف شرکت'</span>, fontsize=<span class="number">18</span>, fontweight=<span class="string">'bold'</span>, pad=<span class="number">20</span>)

<span class="comment"># اضافه کردن شبکه</span>
ax.grid(axis=<span class="string">'y'</span>, alpha=<span class="number">0.3</span>, linestyle=<span class="string">'--'</span>)
ax.set_axisbelow(<span class="keyword">True</span>)

<span class="comment"># حذف خطوط اضافی</span>
ax.spines[<span class="string">'top'</span>].set_visible(<span class="keyword">False</span>)
ax.spines[<span class="string">'right'</span>].set_visible(<span class="keyword">False</span>)

<span class="comment"># اضافه کردن خط میانگین</span>
avg_value = np.mean(values)
ax.axhline(y=avg_value, color=<span class="string">'red'</span>, linestyle=<span class="string">'--'</span>, 
           label=<span class="string">f'میانگین: {avg_value:.1f}%'</span>)
ax.legend(loc=<span class="string">'upper right'</span>)

<span class="comment"># اضافه کردن متن توضیحی</span>
ax.text(<span class="number">0.02</span>, <span class="number">0.98</span>, <span class="string">'گزارش عملکرد Q1 2024'</span>, 
        transform=ax.transAxes, fontsize=<span class="number">10</span>, 
        verticalalignment=<span class="string">'top'</span>, 
        bbox=<span class="function">dict</span>(boxstyle=<span class="string">'round'</span>, facecolor=<span class="string">'wheat'</span>, alpha=<span class="number">0.5</span>))

plt.tight_layout()
plt.show()

<span class="function">print</span>(<span class="string">"✅ نمودار سفارشی ایجاد شد"</span>)
                    </div>

                    <h3>💾 ذخیره و صادرات نمودارها:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ایجاد نمودار برای ذخیره</span>
plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))

<span class="comment"># داده‌های نمونه</span>
x = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">100</span>)
y1 = np.sin(x)
y2 = np.cos(x)

plt.plot(x, y1, label=<span class="string">'sin(x)'</span>, linewidth=<span class="number">2</span>)
plt.plot(x, y2, label=<span class="string">'cos(x)'</span>, linewidth=<span class="number">2</span>)
plt.title(<span class="string">'نمودار توابع مثلثاتی'</span>, fontsize=<span class="number">16</span>)
plt.xlabel(<span class="string">'x'</span>)
plt.ylabel(<span class="string">'y'</span>)
plt.legend()
plt.grid(<span class="keyword">True</span>, alpha=<span class="number">0.3</span>)

<span class="comment"># ذخیره با فرمت‌های مختلف</span>
<span class="comment"># plt.savefig('trigonometric_functions.png', dpi=300, bbox_inches='tight')</span>
<span class="comment"># plt.savefig('trigonometric_functions.pdf', bbox_inches='tight')</span>
<span class="comment"># plt.savefig('trigonometric_functions.svg', bbox_inches='tight')</span>

plt.show()

<span class="comment"># نمایش تنظیمات ذخیره</span>
<span class="function">print</span>(<span class="string">"💾 تنظیمات ذخیره نمودار:"</span>)
<span class="function">print</span>(<span class="string">"- PNG: برای وب و ارائه (dpi=300 برای کیفیت بالا)"</span>)
<span class="function">print</span>(<span class="string">"- PDF: برای چاپ و اسناد رسمی"</span>)
<span class="function">print</span>(<span class="string">"- SVG: برای وکتور و قابلیت ویرایش"</span>)
<span class="function">print</span>(<span class="string">"- bbox_inches='tight': حذف فضای اضافی"</span>)

<span class="comment"># تابع جامع برای ایجاد داشبورد</span>
<span class="keyword">def</span> <span class="function">create_sales_dashboard</span>(data):
    <span class="string">"""ایجاد داشبورد جامع فروش"""</span>
    fig = plt.figure(figsize=(<span class="number">16</span>, <span class="number">12</span>))
    
    <span class="comment"># تنظیم layout پیچیده</span>
    gs = fig.add_gridspec(<span class="number">3</span>, <span class="number">3</span>, height_ratios=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], width_ratios=[<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>])
    
    <span class="comment"># نمودار اصلی - روند فروش</span>
    ax1 = fig.add_subplot(gs[<span class="number">0</span>, :])
    ax1.plot(data[<span class="string">'ماه'</span>], data[<span class="string">'فروش'</span>], marker=<span class="string">'o'</span>, linewidth=<span class="number">3</span>, markersize=<span class="number">8</span>)
    ax1.set_title(<span class="string">'روند فروش ماهانه'</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">'bold'</span>)
    ax1.grid(<span class="keyword">True</span>, alpha=<span class="number">0.3</span>)
    
    <span class="comment"># نمودار میله‌ای سود</span>
    ax2 = fig.add_subplot(gs[<span class="number">1</span>, <span class="number">0</span>])
    bars = ax2.bar(data[<span class="string">'ماه'</span>], data[<span class="string">'سود'</span>], color=<span class="string">'lightgreen'</span>)
    ax2.set_title(<span class="string">'سود ماهانه'</span>)
    ax2.tick_params(axis=<span class="string">'x'</span>, rotation=<span class="number">45</span>)
    
    <span class="comment"># نمودار دایره‌ای هزینه‌ها</span>
    ax3 = fig.add_subplot(gs[<span class="number">1</span>, <span class="number">1</span>])
    ax3.pie(data[<span class="string">'هزینه'</span>], labels=data[<span class="string">'ماه'</span>], autopct=<span class="string">'%1.1f%%'</span>)
    ax3.set_title(<span class="string">'توزیع هزینه‌ها'</span>)
    
    <span class="comment"># جدول آماری</span>
    ax4 = fig.add_subplot(gs[<span class="number">1</span>, <span class="number">2</span>])
    ax4.axis(<span class="string">'off'</span>)
    stats_text = <span class="string">f"""آمار کلی:
کل فروش: {data['فروش'].sum():,}
میانگین: {data['فروش'].mean():.1f}
حداکثر: {data['فروش'].max()}
حداقل: {data['فروش'].min()}"""</span>
    ax4.text(<span class="number">0.1</span>, <span class="number">0.5</span>, stats_text, fontsize=<span class="number">12</span>, 
             verticalalignment=<span class="string">'center'</span>,
             bbox=<span class="function">dict</span>(boxstyle=<span class="string">'round'</span>, facecolor=<span class="string">'lightblue'</span>))
    
    <span class="comment"># نمودار مقایسه‌ای</span>
    ax5 = fig.add_subplot(gs[<span class="number">2</span>, :])
    x_pos = np.arange(len(data[<span class="string">'ماه'</span>]))
    width = <span class="number">0.35</span>
    
    ax5.bar(x_pos - width/<span class="number">2</span>, data[<span class="string">'فروش'</span>], width, label=<span class="string">'فروش'</span>, alpha=<span class="number">0.8</span>)
    ax5.bar(x_pos + width/<span class="number">2</span>, data[<span class="string">'هزینه'</span>], width, label=<span class="string">'هزینه'</span>, alpha=<span class="number">0.8</span>)
    
    ax5.set_xlabel(<span class="string">'ماه'</span>)
    ax5.set_ylabel(<span class="string">'مبلغ (میلیون تومان)'</span>)
    ax5.set_title(<span class="string">'مقایسه فروش و هزینه'</span>)
    ax5.set_xticks(x_pos)
    ax5.set_xticklabels(data[<span class="string">'ماه'</span>], rotation=<span class="number">45</span>)
    ax5.legend()
    
    plt.suptitle(<span class="string">'داشبورد تحلیل فروش - نیمه اول 1403'</span>, fontsize=<span class="number">20</span>, fontweight=<span class="string">'bold'</span>)
    plt.tight_layout()
    
    <span class="keyword">return</span> fig

<span class="comment"># ایجاد داشبورد</span>
dashboard = create_sales_dashboard(sales_data)
plt.show()

<span class="function">print</span>(<span class="string">"✅ داشبورد جامع ایجاد شد"</span>)
                    </div>

                    <div class="method-grid">
                        <div class="method-card">
                            <div class="method-name">plt.plot()</div>
                            <div class="method-desc">نمودار خطی</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">plt.bar()</div>
                            <div class="method-desc">نمودار میله‌ای</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">plt.scatter()</div>
                            <div class="method-desc">نمودار پراکندگی</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">sns.heatmap()</div>
                            <div class="method-desc">نقشه حرارتی</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">plt.pie()</div>
                            <div class="method-desc">نمودار دایره‌ای</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">plt.savefig()</div>
                            <div class="method-desc">ذخیره نمودار</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">💡 نکات مصورسازی:</div>
                        <ul>
                            <li><strong>انتخاب نمودار:</strong> بر اساس نوع داده مناسب‌ترین نمودار را انتخاب کنید</li>
                            <li><strong>رنگ‌بندی:</strong> از رنگ‌های مناسب و قابل تشخیص استفاده کنید</li>
                            <li><strong>عناوین:</strong> عناوین واضح و توصیفی اضافه کنید</li>
                            <li><strong>کیفیت:</strong> برای چاپ از DPI بالا استفاده کنید</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- اسلاید 12: خواندن و نوشتن فایل‌ها -->
            <div class="slide" id="slide12">
                <div class="slide-number">12/15</div>
                <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                <button class="close-btn" onclick="closeSlide(this)">×</button>
                <div class="icon">📁</div>
                <div class="slide-title">خواندن و نوشتن فایل‌ها</div>
                <div class="slide-content">
                    <h3>📄 فایل‌های CSV:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># خواندن و نوشتن فایل‌های CSV</span>
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> io <span class="keyword">import</span> StringIO

<span class="comment"># ایجاد داده‌های نمونه</span>
sample_data = pd.DataFrame({
    <span class="string">'نام'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, <span class="string">'زهرا'</span>, <span class="string">'محمد'</span>],
    <span class="string">'سن'</span>: [<span class="number">25</span>, <span class="number">30</span>, <span class="number">28</span>, <span class="number">32</span>, <span class="number">27</span>],
    <span class="string">'شهر'</span>: [<span class="string">'تهران'</span>, <span class="string">'اصفهان'</span>, <span class="string">'شیراز'</span>, <span class="string">'مشهد'</span>, <span class="string">'تبریز'</span>],
    <span class="string">'حقوق'</span>: [<span class="number">5000000</span>, <span class="number">4500000</span>, <span class="number">5200000</span>, <span class="number">4800000</span>, <span class="number">5100000</span>],
    <span class="string">'تاریخ_استخدام'</span>: pd.to_datetime([<span class="string">'2020-01-15'</span>, <span class="string">'2019-05-20'</span>, <span class="string">'2021-03-10'</span>, 
                                          <span class="string">'2018-11-25'</span>, <span class="string">'2020-09-08'</span>])
})

<span class="function">print</span>(<span class="string">"📄 داده‌های نمونه:"</span>)
<span class="function">print</span>(sample_data)

<span class="comment"># نوشتن به فایل CSV</span>
<span class="comment"># sample_data.to_csv('employees.csv', index=False, encoding='utf-8-sig')</span>
<span class="function">print</span>(<span class="string">f"\n✅ فایل CSV ایجاد شد"</span>)

<span class="comment"># خواندن از فایل CSV با تنظیمات مختلف</span>
csv_content = sample_data.to_csv(index=<span class="keyword">False</span>)
<span class="function">print</span>(<span class="string">f"\nمحتوای CSV:\n{csv_content}"</span>)

<span class="comment"># خواندن با تنظیمات خاص</span>
<span class="comment"># df_read = pd.read_csv('employees.csv', encoding='utf-8-sig')</span>

<span class="comment"># شبیه‌سازی خواندن از StringIO</span>
df_read = pd.read_csv(StringIO(csv_content))
<span class="function">print</span>(<span class="string">f"خواندن از CSV:\n{df_read}"</span>)

<span class="comment"># خواندن با تنظیمات پیشرفته</span>
advanced_csv = <span class="string">"""نام,سن,شهر,حقوق
احمد,25,تهران,5000000
فاطمه,30,اصفهان,4500000
علی,,شیراز,5200000
زهرا,32,,4800000
محمد,27,تبریز,"""</span>

df_advanced = pd.read_csv(
    StringIO(advanced_csv),
    na_values=[<span class="string">''</span>, <span class="string">'N/A'</span>, <span class="string">'null'</span>],  <span class="comment"># مقادیر خالی</span>
    dtype={<span class="string">'نام'</span>: <span class="string">'string'</span>, <span class="string">'شهر'</span>: <span class="string">'string'</span>},  <span class="comment"># تعیین نوع داده</span>
    thousands=<span class="string">','</span>  <span class="comment"># جداکننده هزارگان</span>
)

<span class="function">print</span>(<span class="string">f"\nخواندن پیشرفته:\n{df_advanced}"</span>)
<span class="function">print</span>(<span class="string">f"نوع داده‌ها:\n{df_advanced.dtypes}"</span>)
                    </div>

                    <h3>📊 فایل‌های Excel:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># کار با فایل‌های Excel</span>
<span class="function">print</span>(<span class="string">"📊 کار با Excel:"</span>)

<span class="comment"># ایجاد چندین DataFrame برای sheet های مختلف</span>
employees_df = sample_data.copy()
sales_df = pd.DataFrame({
    <span class="string">'محصول'</span>: [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>],
    <span class="string">'فروش'</span>: [<span class="number">150000</span>, <span class="number">200000</span>, <span class="number">180000</span>, <span class="number">220000</span>],
    <span class="string">'سود'</span>: [<span class="number">45000</span>, <span class="number">60000</span>, <span class="number">54000</span>, <span class="number">66000</span>]
})

departments_df = pd.DataFrame({
    <span class="string">'بخش'</span>: [<span class="string">'IT'</span>, <span class="string">'HR'</span>, <span class="string">'Finance'</span>, <span class="string">'Marketing'</span>],
    <span class="string">'بودجه'</span>: [<span class="number">500000000</span>, <span class="number">300000000</span>, <span class="number">400000000</span>, <span class="number">250000000</span>],
    <span class="string">'تعداد_کارمند'</span>: [<span class="number">15</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">10</span>]
})

<span class="comment"># نوشتن به Excel با چندین sheet</span>
<span class="comment">"""
with pd.ExcelWriter('company_data.xlsx', engine='openpyxl') as writer:
    employees_df.to_excel(writer, sheet_name='کارمندان', index=False)
    sales_df.to_excel(writer, sheet_name='فروش', index=False)
    departments_df.to_excel(writer, sheet_name='بخش‌ها', index=False)
"""</span>

<span class="function">print</span>(<span class="string">"✅ فایل Excel با 3 sheet ایجاد شد"</span>)

<span class="comment"># خواندن از Excel</span>
<span class="comment">"""
# خواندن sheet خاص
employees_read = pd.read_excel('company_data.xlsx', sheet_name='کارمندان')
print(f"خواندن sheet کارمندان:\n{employees_read}")

# خواندن همه sheet ها
all_sheets = pd.read_excel('company_data.xlsx', sheet_name=None)
print(f"نام sheet ها: {list(all_sheets.keys())}")

# خواندن چندین sheet
selected_sheets = pd.read_excel('company_data.xlsx', 
                               sheet_name=['کارمندان', 'فروش'])
"""</span>

<span class="comment"># نمایش داده‌ها</span>
<span class="function">print</span>(<span class="string">f"\nکارمندان:\n{employees_df}"</span>)
<span class="function">print</span>(<span class="string">f"\nفروش:\n{sales_df}"</span>)
<span class="function">print</span>(<span class="string">f"\nبخش‌ها:\n{departments_df}"</span>)

<span class="comment"># تنظیمات پیشرفته Excel</span>
<span class="function">print</span>(<span class="string">f"\n🔧 تنظیمات پیشرفته Excel:"</span>)
<span class="function">print</span>(<span class="string">"- engine='openpyxl': برای فایل‌های .xlsx"</span>)
<span class="function">print</span>(<span class="string">"- engine='xlsxwriter': برای نوشتن با فرمت‌بندی"</span>)
<span class="function">print</span>(<span class="string">"- startrow/startcol: تعیین موقعیت شروع"</span>)
<span class="function">print</span>(<span class="string">"- header=False: بدون سرستون"</span>)
                    </div>

                    <h3>🗄️ فایل‌های JSON:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># کار با فایل‌های JSON</span>
<span class="keyword">import</span> json

<span class="function">print</span>(<span class="string">"🗄️ کار با JSON:"</span>)

<span class="comment"># تبدیل DataFrame به JSON</span>
json_data = employees_df.to_json(orient=<span class="string">'records'</span>, force_ascii=<span class="keyword">False</span>, 
                                date_format=<span class="string">'iso'</span>, indent=<span class="number">2</span>)
<span class="function">print</span>(<span class="string">f"JSON format 'records':\n{json_data[:200]}...\n"</span>)

<span class="comment"># انواع مختلف orient</span>
orientations = [<span class="string">'records'</span>, <span class="string">'index'</span>, <span class="string">'values'</span>, <span class="string">'columns'</span>]

<span class="keyword">for</span> orient <span class="keyword">in</span> orientations:
    json_sample = employees_df.head(<span class="number">2</span>).to_json(orient=orient, force_ascii=<span class="keyword">False</span>)
    <span class="function">print</span>(<span class="string">f"Orient '{orient}':\n{json_sample}\n"</span>)

<span class="comment"># خواندن از JSON</span>
df_from_json = pd.read_json(json_data, orient=<span class="string">'records'</span>)
<span class="function">print</span>(<span class="string">f"خواندن از JSON:\n{df_from_json}"</span>)

<span class="comment"># کار با JSON پیچیده</span>
complex_json = <span class="string">"""{
    "company": "شرکت نمونه",
    "employees": [
        {
            "name": "احمد",
            "age": 25,
            "skills": ["Python", "SQL", "Excel"],
            "address": {
                "city": "تهران",
                "district": "ولنجک"
            }
        },
        {
            "name": "فاطمه", 
            "age": 30,
            "skills": ["Java", "MongoDB"],
            "address": {
                "city": "اصفهان",
                "district": "جلفا"
            }
        }
    ]
}"""</span>

<span class="comment"># تبدیل JSON پیچیده به DataFrame</span>
complex_data = json.loads(complex_json)
df_complex = pd.json_normalize(complex_data[<span class="string">'employees'</span>])
<span class="function">print</span>(<span class="string">f"\nJSON پیچیده:\n{df_complex}"</span>)

<span class="comment"># نوشتن به فایل JSON</span>
<span class="comment"># employees_df.to_json('employees.json', orient='records', force_ascii=False, indent=2)</span>
<span class="function">print</span>(<span class="string">f"\n✅ فایل JSON ایجاد شد"</span>)
                    </div>

                    <h3>🗃️ فایل‌های Parquet و Pickle:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># فرمت‌های پیشرفته ذخیره‌سازی</span>
<span class="function">print</span>(<span class="string">"🗃️ فرمت‌های پیشرفته:"</span>)

<span class="comment"># Parquet - فرمت بهینه برای داده‌های بزرگ</span>
<span class="function">print</span>(<span class="string">"📦 فرمت Parquet:"</span>)
<span class="comment"># employees_df.to_parquet('employees.parquet', compression='snappy')</span>
<span class="comment"># df_parquet = pd.read_parquet('employees.parquet')</span>

<span class="function">print</span>(<span class="string">"مزایای Parquet:"</span>)
<span class="function">print</span>(<span class="string">"- فشرده‌سازی بالا"</span>)
<span class="function">print</span>(<span class="string">"- سرعت خواندن بالا"</span>)
<span class="function">print</span>(<span class="string">"- حفظ نوع داده‌ها"</span>)
<span class="function">print</span>(<span class="string">"- سازگار با Apache Spark"</span>)

<span class="comment"># Pickle - ذخیره اشیاء Python</span>
<span class="function">print</span>(<span class="string">f"\n🥒 فرمت Pickle:"</span>)
<span class="comment"># employees_df.to_pickle('employees.pkl')</span>
<span class="comment"># df_pickle = pd.read_pickle('employees.pkl')</span>

<span class="function">print</span>(<span class="string">"مزایای Pickle:"</span>)
<span class="function">print</span>(<span class="string">"- حفظ کامل ساختار داده"</span>)
<span class="function">print</span>(<span class="string">"- سرعت بالا"</span>)
<span class="function">print</span>(<span class="string">"- پشتیبانی از انواع پیچیده Python"</span>)

<span class="comment"># HDF5 - برای داده‌های علمی</span>
<span class="function">print</span>(<span class="string">f"\n🔬 فرمت HDF5:"</span>)
<span class="comment"># employees_df.to_hdf('data.h5', key='employees', mode='w')</span>
<span class="comment"># df_hdf = pd.read_hdf('data.h5', key='employees')</span>

<span class="function">print</span>(<span class="string">"مزایای HDF5:"</span>)
<span class="function">print</span>(<span class="string">"- مناسب برای داده‌های بزرگ"</span>)
<span class="function">print</span>(<span class="string">"- پشتیبانی از فشرده‌سازی"</span>)
<span class="function">print</span>(<span class="string">"- امکان ذخیره چندین dataset"</span>)

<span class="comment"># مقایسه سرعت و اندازه فایل</span>
<span class="keyword">import</span> time
<span class="keyword">import</span> os

<span class="comment"># ایجاد داده‌های بزرگ‌تر برای تست</span>
large_data = pd.DataFrame({
    <span class="string">'col1'</span>: np.random.randint(<span class="number">0</span>, <span class="number">1000</span>, <span class="number">10000</span>),
    <span class="string">'col2'</span>: np.random.random(<span class="number">10000</span>),
    <span class="string">'col3'</span>: np.random.choice([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>], <span class="number">10000</span>),
    <span class="string">'col4'</span>: pd.date_range(<span class="string">'2020-01-01'</span>, periods=<span class="number">10000</span>, freq=<span class="string">'H'</span>)
})

<span class="function">print</span>(<span class="string">f"\n⚡ مقایسه عملکرد (10,000 سطر):"</span>)
<span class="function">print</span>(<span class="string">f"اندازه DataFrame در حافظه: {large_data.memory_usage(deep=True).sum() / 1024:.1f} KB"</span>)

<span class="comment"># شبیه‌سازی نوشتن و خواندن</span>
formats = {
    <span class="string">'CSV'</span>: (<span class="keyword">lambda</span> df: df.to_csv(index=<span class="keyword">False</span>), <span class="keyword">lambda</span> data: pd.read_csv(StringIO(data))),
    <span class="string">'JSON'</span>: (<span class="keyword">lambda</span> df: df.to_json(orient=<span class="string">'records'</span>), <span class="keyword">lambda</span> data: pd.read_json(data, orient=<span class="string">'records'</span>))
}

<span class="keyword">for</span> fmt_name, (write_func, read_func) <span class="keyword">in</span> formats.items():
    <span class="comment"># تست نوشتن</span>
    start_time = time.time()
    data_str = write_func(large_data.head(<span class="number">100</span>))  <span class="comment"># تست با داده کمتر</span>
    write_time = time.time() - start_time
    
    <span class="comment"># تست خواندن</span>
    start_time = time.time()
    df_read = read_func(data_str)
    read_time = time.time() - start_time
    
    <span class="function">print</span>(<span class="string">f"{fmt_name}: نوشتن {write_time:.4f}s, خواندن {read_time:.4f}s, اندازه {len(data_str)/1024:.1f}KB"</span>)
                    </div>

                    <h3>🌐 خواندن از منابع آنلاین:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># خواندن داده از منابع آنلاین</span>
<span class="function">print</span>(<span class="string">"🌐 خواندن از منابع آنلاین:"</span>)

<span class="comment"># خواندن از URL</span>
<span class="function">print</span>(<span class="string">"📡 نمونه خواندن از URL:"</span>)
<span class="comment">"""
# مثال خواندن از GitHub
url = 'https://raw.githubusercontent.com/pandas-dev/pandas/main/pandas/tests/io/data/csv/iris.csv'
df_online = pd.read_csv(url)
print(f"داده از URL:\n{df_online.head()}")
"""</span>

<span class="comment"># خواندن از API</span>
<span class="function">print</span>(<span class="string">f"\n🔌 خواندن از API:"</span>)
<span class="comment">"""
import requests

# مثال API
api_url = 'https://jsonplaceholder.typicode.com/users'
response = requests.get(api_url)
if response.status_code == 200:
    df_api = pd.json_normalize(response.json())
    print(f"داده از API:\n{df_api.head()}")
"""</span>

<span class="comment"># شبیه‌سازی داده API</span>
api_data = [
    {<span class="string">'id'</span>: <span class="number">1</span>, <span class="string">'name'</span>: <span class="string">'احمد'</span>, <span class="string">'email'</span>: <span class="string">'ahmad@example.com'</span>},
    {<span class="string">'id'</span>: <span class="number">2</span>, <span class="string">'name'</span>: <span class="string">'فاطمه'</span>, <span class="string">'email'</span>: <span class="string">'fateme@example.com'</span>}
]
df_api_sim = pd.json_normalize(api_data)
<span class="function">print</span>(<span class="string">f"شبیه‌سازی داده API:\n{df_api_sim}"</span>)

<span class="comment"># خواندن از کلیپ‌بورد</span>
<span class="function">print</span>(<span class="string">f"\n📋 خواندن از کلیپ‌بورد:"</span>)
<span class="comment"># df_clipboard = pd.read_clipboard()</span>
<span class="function">print</span>(<span class="string">"برای خواندن از کلیپ‌بورد:"</span>)
<span class="function">print</span>(<span class="string">"df = pd.read_clipboard()"</span>)

<span class="comment"># خواندن از HTML</span>
<span class="function">print</span>(<span class="string">f"\n🌐 خواندن از HTML:"</span>)
html_content = <span class="string">"""
<table>
    <tr><th>نام</th><th>سن</th><th>شهر</th></tr>
    <tr><td>احمد</td><td>25</td><td>تهران</td></tr>
    <tr><td>فاطمه</td><td>30</td><td>اصفهان</td></tr>
</table>
"""</span>

<span class="comment"># df_html = pd.read_html(html_content)[0]</span>
<span class="function">print</span>(<span class="string">"برای خواندن از HTML:"</span>)
<span class="function">print</span>(<span class="string">"tables = pd.read_html('url_or_html_string')"</span>)
                    </div>

                    <h3>⚙️ تنظیمات و بهینه‌سازی:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># تنظیمات و بهینه‌سازی عملکرد</span>
<span class="function">print</span>(<span class="string">"⚙️ تنظیمات بهینه‌سازی:"</span>)

<span class="comment"># خواندن بخشی از فایل</span>
<span class="function">print</span>(<span class="string">"📊 خواندن بخشی از داده:"</span>)
<span class="comment">"""
# خواندن فقط n سطر اول
df_sample = pd.read_csv('large_file.csv', nrows=1000)

# خواندن ستون‌های خاص
df_selected = pd.read_csv('file.csv', usecols=['col1', 'col2', 'col3'])

# خواندن با chunk
chunk_size = 1000
for chunk in pd.read_csv('large_file.csv', chunksize=chunk_size):
    # پردازش هر chunk
    process_chunk(chunk)
"""</span>

<span class="comment"># نمونه chunk processing</span>
<span class="keyword">def</span> <span class="function">process_large_file_in_chunks</span>(data, chunk_size=<span class="number">1000</span>):
    <span class="string">"""پردازش فایل بزرگ به صورت تکه‌ای"""</span>
    results = []
    
    <span class="comment"># شبیه‌سازی chunk processing</span>
    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(<span class="number">0</span>, len(data), chunk_size):
        chunk = data.iloc[i:i+chunk_size]
        
        <span class="comment"># پردازش chunk</span>
        chunk_result = chunk.groupby(<span class="string">'col3'</span>)[<span class="string">'col1'</span>].mean() <span class="keyword">if</span> <span class="string">'col3'</span> <span class="keyword">in</span> chunk.columns <span class="keyword">else</span> <span class="keyword">None</span>
        <span class="keyword">if</span> chunk_result <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:
            results.append(chunk_result)
    
    <span class="keyword">return</span> pd.concat(results) <span class="keyword">if</span> results <span class="keyword">else</span> pd.Series()

<span class="comment"># تست با داده نمونه</span>
result = process_large_file_in_chunks(large_data.head(<span class="number">100</span>), chunk_size=<span class="number">25</span>)
<span class="function">print</span>(<span class="string">f"نتیجه پردازش chunk:\n{result}"</span>)

<span class="comment"># تنظیمات dtype برای بهینه‌سازی حافظه</span>
<span class="function">print</span>(<span class="string">f"\n💾 بهینه‌سازی حافظه:"</span>)
memory_efficient_dtypes = {
    <span class="string">'col1'</span>: <span class="string">'int16'</span>,  <span class="comment"># به جای int64</span>
    <span class="string">'col2'</span>: <span class="string">'float32'</span>,  <span class="comment"># به جای float64</span>
    <span class="string">'col3'</span>: <span class="string">'category'</span>  <span class="comment"># برای داده‌های تکراری</span>
}

<span class="comment"># مقایسه استفاده حافظه</span>
original_memory = large_data.memory_usage(deep=<span class="keyword">True</span>).sum()
optimized_data = large_data.astype({<span class="string">'col3'</span>: <span class="string">'category'</span>})
optimized_memory = optimized_data.memory_usage(deep=<span class="keyword">True</span>).sum()

<span class="function">print</span>(<span class="string">f"حافظه اصلی: {original_memory / 1024:.1f} KB"</span>)
<span class="function">print</span>(<span class="string">f"حافظه بهینه: {optimized_memory / 1024:.1f} KB"</span>)
<span class="function">print</span>(<span class="string">f"صرفه‌جویی: {(1 - optimized_memory/original_memory)*100:.1f}%"</span>)

<span class="comment"># نکات مهم</span>
<span class="function">print</span>(<span class="string">f"\n📝 نکات مهم:"</span>)
<span class="function">print</span>(<span class="string">"1. برای فایل‌های بزرگ از chunksize استفاده کنید"</span>)
<span class="function">print</span>(<span class="string">"2. dtype مناسب انتخاب کنید"</span>)
<span class="function">print</span>(<span class="string">"3. فقط ستون‌های مورد نیاز را بخوانید"</span>)
<span class="function">print</span>(<span class="string">"4. از فرمت‌های بهینه مثل Parquet استفاده کنید"</span>)
<span class="function">print</span>(<span class="string">"5. برای داده‌های تکراری از category استفاده کنید"</span>)
                    </div>

                    <div class="method-grid">
                        <div class="method-card">
                            <div class="method-name">pd.read_csv()</div>
                            <div class="method-desc">خواندن CSV</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">pd.read_excel()</div>
                            <div class="method-desc">خواندن Excel</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">pd.read_json()</div>
                            <div class="method-desc">خواندن JSON</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">pd.read_parquet()</div>
                            <div class="method-desc">خواندن Parquet</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.to_csv()</div>
                            <div class="method-desc">نوشتن CSV</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.to_excel()</div>
                            <div class="method-desc">نوشتن Excel</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">💡 نکات فایل I/O:</div>
                        <ul>
                            <li><strong>Encoding:</strong> برای متن فارسی از utf-8-sig استفاده کنید</li>
                            <li><strong>Performance:</strong> برای فایل‌های بزرگ از Parquet استفاده کنید</li>
                            <li><strong>Memory:</strong> از chunksize برای داده‌های بزرگ استفاده کنید</li>
                            <li><strong>Data types:</strong> dtype مناسب برای بهینه‌سازی حافظه تعیین کنید</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- اسلاید 13: اتصال به پایگاه داده -->
            <div class="slide" id="slide13">
                <div class="slide-number">13/15</div>
                <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                <button class="close-btn" onclick="closeSlide(this)">×</button>
                <div class="icon">🗄️</div>
                <div class="slide-title">اتصال به پایگاه داده</div>
                <div class="slide-content">
                    <h3>🔗 اتصال به SQLite:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># اتصال به پایگاه داده SQLite</span>
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">import</span> sqlite3
<span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta

<span class="comment"># ایجاد پایگاه داده SQLite در حافظه</span>
conn = sqlite3.connect(<span class="string">':memory:'</span>)  <span class="comment"># یا 'database.db' برای فایل</span>

<span class="function">print</span>(<span class="string">"🔗 اتصال به SQLite برقرار شد"</span>)

<span class="comment"># ایجاد داده‌های نمونه</span>
employees = pd.DataFrame({
    <span class="string">'id'</span>: <span class="function">range</span>(<span class="number">1</span>, <span class="number">11</span>),
    <span class="string">'name'</span>: [<span class="string">'احمد'</span>, <span class="string">'فاطمه'</span>, <span class="string">'علی'</span>, <span class="string">'زهرا'</span>, <span class="string">'محمد'</span>, 
              <span class="string">'مریم'</span>, <span class="string">'حسن'</span>, <span class="string">'نرگس'</span>, <span class="string">'رضا'</span>, <span class="string">'سارا'</span>],
    <span class="string">'department'</span>: [<span class="string">'IT'</span>, <span class="string">'HR'</span>, <span class="string">'Finance'</span>, <span class="string">'IT'</span>, <span class="string">'Marketing'</span>,
                   <span class="string">'HR'</span>, <span class="string">'Finance'</span>, <span class="string">'IT'</span>, <span class="string">'Marketing'</span>, <span class="string">'Finance'</span>],
    <span class="string">'salary'</span>: [<span class="number">5000000</span>, <span class="number">4500000</span>, <span class="number">5200000</span>, <span class="number">4800000</span>, <span class="number">5100000</span>,
              <span class="number">4700000</span>, <span class="number">5300000</span>, <span class="number">4900000</span>, <span class="number">5000000</span>, <span class="number">4600000</span>],
    <span class="string">'hire_date'</span>: pd.date_range(<span class="string">'2020-01-01'</span>, periods=<span class="number">10</span>, freq=<span class="string">'30D'</span>)
})

sales = pd.DataFrame({
    <span class="string">'id'</span>: <span class="function">range</span>(<span class="number">1</span>, <span class="number">21</span>),
    <span class="string">'employee_id'</span>: np.random.choice(<span class="function">range</span>(<span class="number">1</span>, <span class="number">11</span>), <span class="number">20</span>),
    <span class="string">'product'</span>: np.random.choice([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>], <span class="number">20</span>),
    <span class="string">'amount'</span>: np.random.randint(<span class="number">100000</span>, <span class="number">500000</span>, <span class="number">20</span>),
    <span class="string">'sale_date'</span>: pd.date_range(<span class="string">'2024-01-01'</span>, periods=<span class="number">20</span>, freq=<span class="string">'5D'</span>)
})

<span class="function">print</span>(<span class="string">f"📊 داده‌های کارمندان:\n{employees.head()}\n"</span>)
<span class="function">print</span>(<span class="string">f"💰 داده‌های فروش:\n{sales.head()}"</span>)

<span class="comment"># نوشتن DataFrame ها به پایگاه داده</span>
employees.to_sql(<span class="string">'employees'</span>, conn, index=<span class="keyword">False</span>, if_exists=<span class="string">'replace'</span>)
sales.to_sql(<span class="string">'sales'</span>, conn, index=<span class="keyword">False</span>, if_exists=<span class="string">'replace'</span>)

<span class="function">print</span>(<span class="string">f"\n✅ جداول در پایگاه داده ایجاد شدند"</span>)
                    </div>

                    <h3>📊 اجرای کوئری‌های SQL:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># اجرای کوئری‌های مختلف</span>
<span class="function">print</span>(<span class="string">"📊 اجرای کوئری‌های SQL:"</span>)

<span class="comment"># کوئری ساده</span>
query1 = <span class="string">"SELECT * FROM employees WHERE department = 'IT'"</span>
it_employees = pd.read_sql_query(query1, conn)
<span class="function">print</span>(<span class="string">f"کارمندان IT:\n{it_employees}\n"</span>)

<span class="comment"># کوئری با JOIN</span>
query2 = <span class="string">"""
SELECT 
    e.name,
    e.department,
    e.salary,
    COUNT(s.id) as total_sales,
    SUM(s.amount) as total_amount
FROM employees e
LEFT JOIN sales s ON e.id = s.employee_id
GROUP BY e.id, e.name, e.department, e.salary
ORDER BY total_amount DESC
"""</span>

employee_sales = pd.read_sql_query(query2, conn)
<span class="function">print</span>(<span class="string">f"گزارش فروش کارمندان:\n{employee_sales}\n"</span>)

<span class="comment"># کوئری با تاریخ</span>
query3 = <span class="string">"""
SELECT 
    strftime('%Y-%m', sale_date) as month,
    product,
    COUNT(*) as count,
    SUM(amount) as total,
    AVG(amount) as average
FROM sales
GROUP BY strftime('%Y-%m', sale_date), product
ORDER BY month, product
"""</span>

monthly_sales = pd.read_sql_query(query3, conn)
<span class="function">print</span>(<span class="string">f"فروش ماهانه به تفکیک محصول:\n{monthly_sales}\n"</span>)

<span class="comment"># کوئری با پارامتر</span>
<span class="keyword">def</span> <span class="function">get_employee_sales</span>(department):
    <span class="string">"""دریافت فروش کارمندان یک بخش خاص"""</span>
    query = <span class="string">"""
    SELECT 
        e.name,
        s.product,
        s.amount,
        s.sale_date
    FROM employees e
    JOIN sales s ON e.id = s.employee_id
    WHERE e.department = ?
    ORDER BY s.sale_date DESC
    """</span>
    <span class="keyword">return</span> pd.read_sql_query(query, conn, params=[department])

it_sales = get_employee_sales(<span class="string">'IT'</span>)
<span class="function">print</span>(<span class="string">f"فروش بخش IT:\n{it_sales.head()}"</span>)
                    </div>

                    <h3>🔄 عملیات CRUD:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># عملیات Create, Read, Update, Delete</span>
<span class="function">print</span>(<span class="string">"🔄 عملیات CRUD:"</span>)

<span class="comment"># CREATE - اضافه کردن رکورد جدید</span>
new_employee = pd.DataFrame({
    <span class="string">'id'</span>: [<span class="number">11</span>],
    <span class="string">'name'</span>: [<span class="string">'امیر'</span>],
    <span class="string">'department'</span>: [<span class="string">'Sales'</span>],
    <span class="string">'salary'</span>: [<span class="number">4800000</span>],
    <span class="string">'hire_date'</span>: [datetime.now()]
})

new_employee.to_sql(<span class="string">'employees'</span>, conn, index=<span class="keyword">False</span>, if_exists=<span class="string">'append'</span>)
<span class="function">print</span>(<span class="string">"✅ کارمند جدید اضافه شد"</span>)

<span class="comment"># READ - خواندن با شرایط پیچیده</span>
complex_query = <span class="string">"""
SELECT 
    department,
    COUNT(*) as employee_count,
    AVG(salary) as avg_salary,
    MIN(hire_date) as first_hire,
    MAX(hire_date) as last_hire
FROM employees
GROUP BY department
HAVING COUNT(*) > 1
"""</span>

dept_stats = pd.read_sql_query(complex_query, conn)
<span class="function">print</span>(<span class="string">f"\nآمار بخش‌ها:\n{dept_stats}\n"</span>)

<span class="comment"># UPDATE - به‌روزرسانی با pandas</span>
cursor = conn.cursor()
cursor.execute(<span class="string">"UPDATE employees SET salary = salary * 1.1 WHERE department = 'IT'"</span>)
conn.commit()
<span class="function">print</span>(<span class="string">"✅ حقوق بخش IT 10% افزایش یافت"</span>)

<span class="comment"># تأیید به‌روزرسانی</span>
updated_it = pd.read_sql_query(<span class="string">"SELECT name, salary FROM employees WHERE department = 'IT'"</span>, conn)
<span class="function">print</span>(<span class="string">f"حقوق جدید IT:\n{updated_it}\n"</span>)

<span class="comment"># DELETE - حذف با شرط</span>
cursor.execute(<span class="string">"DELETE FROM sales WHERE amount < 150000"</span>)
conn.commit()
deleted_count = cursor.rowcount
<span class="function">print</span>(<span class="string">f"✅ {deleted_count} فروش کم‌مبلغ حذف شد"</span>)

<span class="comment"># بررسی تعداد باقیمانده</span>
remaining_sales = pd.read_sql_query(<span class="string">"SELECT COUNT(*) as count FROM sales"</span>, conn)
<span class="function">print</span>(<span class="string">f"تعداد فروش باقیمانده: {remaining_sales.iloc[0]['count']}"</span>)
                    </div>

                    <h3>🏢 اتصال به پایگاه‌های داده مختلف:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># اتصال به انواع مختلف پایگاه داده</span>
<span class="function">print</span>(<span class="string">"🏢 اتصال به پایگاه‌های مختلف:"</span>)

<span class="comment"># MySQL</span>
<span class="function">print</span>(<span class="string">"🐬 MySQL:"</span>)
mysql_example = <span class="string">"""
import pymysql
from sqlalchemy import create_engine

# رشته اتصال MySQL
mysql_engine = create_engine(
    'mysql+pymysql://username:password@localhost:3306/database_name',
    echo=False
)

# خواندن از MySQL
df = pd.read_sql_query('SELECT * FROM table_name', mysql_engine)

# نوشتن به MySQL
df.to_sql('new_table', mysql_engine, if_exists='replace', index=False)
"""</span>
<span class="function">print</span>(mysql_example)

<span class="comment"># PostgreSQL</span>
<span class="function">print</span>(<span class="string">"🐘 PostgreSQL:"</span>)
postgres_example = <span class="string">"""
import psycopg2
from sqlalchemy import create_engine

# رشته اتصال PostgreSQL
postgres_engine = create_engine(
    'postgresql://username:password@localhost:5432/database_name'
)

# خواندن از PostgreSQL
df = pd.read_sql_query('SELECT * FROM table_name', postgres_engine)

# نوشتن به PostgreSQL
df.to_sql('new_table', postgres_engine, if_exists='replace', index=False)
"""</span>
<span class="function">print</span>(postgres_example)

<span class="comment"># SQL Server</span>
<span class="function">print</span>(<span class="string">"🏢 SQL Server:"</span>)
sqlserver_example = <span class="string">"""
import pyodbc
from sqlalchemy import create_engine

# رشته اتصال SQL Server
sqlserver_engine = create_engine(
    'mssql+pyodbc://username:password@server/database?driver=ODBC+Driver+17+for+SQL+Server'
)

# یا با Windows Authentication
sqlserver_engine = create_engine(
    'mssql+pyodbc://server/database?driver=ODBC+Driver+17+for+SQL+Server&trusted_connection=yes'
)
"""</span>
<span class="function">print</span>(sqlserver_example)

<span class="comment"># Oracle</span>
<span class="function">print</span>(<span class="string">"🔮 Oracle:"</span>)
oracle_example = <span class="string">"""
import cx_Oracle
from sqlalchemy import create_engine

# رشته اتصال Oracle
oracle_engine = create_engine(
    'oracle+cx_oracle://username:password@localhost:1521/xe'
)
"""</span>
<span class="function">print</span>(oracle_example)
                    </div>

                    <h3>⚡ بهینه‌سازی عملکرد:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># بهینه‌سازی عملکرد پایگاه داده</span>
<span class="function">print</span>(<span class="string">"⚡ بهینه‌سازی عملکرد:"</span>)

<span class="comment"># 1. استفاده از chunksize برای داده‌های بزرگ</span>
<span class="function">print</span>(<span class="string">"📦 پردازش chunk:"</span>)
<span class="keyword">def</span> <span class="function">process_large_table</span>(table_name, chunk_size=<span class="number">1000</span>):
    <span class="string">"""پردازش جدول بزرگ به صورت تکه‌ای"""</span>
    query = <span class="string">f"SELECT * FROM {table_name}"</span>
    
    results = []
    <span class="keyword">for</span> chunk <span class="keyword">in</span> pd.read_sql_query(query, conn, chunksize=chunk_size):
        <span class="comment"># پردازش هر chunk</span>
        processed_chunk = chunk.groupby(<span class="string">'department'</span>)[<span class="string">'salary'</span>].mean()
        results.append(processed_chunk)
    
    <span class="keyword">return</span> pd.concat(results, axis=<span class="number">1</span>).mean(axis=<span class="number">1</span>)

<span class="comment"># نمونه استفاده</span>
avg_salaries = process_large_table(<span class="string">'employees'</span>, chunk_size=<span class="number">5</span>)
<span class="function">print</span>(<span class="string">f"میانگین حقوق بخش‌ها:\n{avg_salaries}\n"</span>)

<span class="comment"># 2. استفاده از ایندکس</span>
<span class="function">print</span>(<span class="string">"🔍 ایجاد ایندکس:"</span>)
cursor = conn.cursor()
cursor.execute(<span class="string">"CREATE INDEX IF NOT EXISTS idx_department ON employees(department)"</span>)
cursor.execute(<span class="string">"CREATE INDEX IF NOT EXISTS idx_employee_id ON sales(employee_id)"</span>)
cursor.execute(<span class="string">"CREATE INDEX IF NOT EXISTS idx_sale_date ON sales(sale_date)"</span>)
conn.commit()
<span class="function">print</span>(<span class="string">"✅ ایندکس‌ها ایجاد شدند"</span>)

<span class="comment"># 3. استفاده از پارامترهای بهینه</span>
<span class="function">print</span>(<span class="string">f"\n⚙️ تنظیمات بهینه:"</span>)
optimized_query = <span class="string">"""
SELECT 
    e.department,
    COUNT(e.id) as employee_count,
    AVG(e.salary) as avg_salary,
    SUM(COALESCE(s.total_sales, 0)) as total_sales
FROM employees e
LEFT JOIN (
    SELECT 
        employee_id, 
        SUM(amount) as total_sales
    FROM sales 
    GROUP BY employee_id
) s ON e.id = s.employee_id
GROUP BY e.department
ORDER BY total_sales DESC
"""</span>

optimized_result = pd.read_sql_query(optimized_query, conn)
<span class="function">print</span>(<span class="string">f"نتیجه بهینه‌شده:\n{optimized_result}\n"</span>)

<span class="comment"># 4. استفاده از prepared statements</span>
<span class="function">print</span>(<span class="string">"🛡️ Prepared Statements:"</span>)
<span class="keyword">def</span> <span class="function">get_sales_by_date_range</span>(start_date, end_date):
    <span class="string">"""دریافت فروش در بازه زمانی مشخص"""</span>
    query = <span class="string">"""
    SELECT 
        s.*,
        e.name as employee_name,
        e.department
    FROM sales s
    JOIN employees e ON s.employee_id = e.id
    WHERE s.sale_date BETWEEN ? AND ?
    ORDER BY s.sale_date DESC
    """</span>
    <span class="keyword">return</span> pd.read_sql_query(query, conn, params=[start_date, end_date])

<span class="comment"># تست</span>
recent_sales = get_sales_by_date_range(<span class="string">'2024-02-01'</span>, <span class="string">'2024-03-01'</span>)
<span class="function">print</span>(<span class="string">f"فروش اخیر:\n{recent_sales.head()}"</span>)

<span class="comment"># 5. نکات عملکرد</span>
<span class="function">print</span>(<span class="string">f"\n📈 نکات بهینه‌سازی:"</span>)
performance_tips = [
    <span class="string">"1. از LIMIT برای محدود کردن نتایج استفاده کنید"</span>,
    <span class="string">"2. ایندکس روی ستون‌های WHERE و JOIN ایجاد کنید"</span>,
    <span class="string">"3. از SELECT * اجتناب کنید"</span>,
    <span class="string">"4. برای داده‌های بزرگ از chunksize استفاده کنید"</span>,
    <span class="string">"5. کوئری‌ها را در سمت پایگاه داده بهینه کنید"</span>,
    <span class="string">"6. از connection pooling استفاده کنید"</span>,
    <span class="string">"7. تراکنش‌ها را مدیریت کنید"</span>
]

<span class="keyword">for</span> tip <span class="keyword">in</span> performance_tips:
    <span class="function">print</span>(tip)
                    </div>

                    <h3>🔐 امنیت و مدیریت اتصال:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># امنیت و مدیریت اتصال</span>
<span class="function">print</span>(<span class="string">"🔐 امنیت و مدیریت:"</span>)

<span class="comment"># 1. مدیریت اتصال با context manager</span>
<span class="function">print</span>(<span class="string">"🔗 مدیریت اتصال:"</span>)
connection_example = <span class="string">"""
from contextlib import contextmanager

@contextmanager
def get_db_connection(db_path):
    conn = sqlite3.connect(db_path)
    try:
        yield conn
    finally:
        conn.close()

# استفاده
with get_db_connection('database.db') as conn:
    df = pd.read_sql_query('SELECT * FROM table', conn)
    # اتصال خودکار بسته می‌شود
"""</span>
<span class="function">print</span>(connection_example)

<span class="comment"># 2. مدیریت خطاها</span>
<span class="function">print</span>(<span class="string">"⚠️ مدیریت خطا:"</span>)
<span class="keyword">def</span> <span class="function">safe_query</span>(query, connection, params=<span class="keyword">None</span>):
    <span class="string">"""اجرای ایمن کوئری"""</span>
    <span class="keyword">try</span>:
        <span class="keyword">if</span> params:
            result = pd.read_sql_query(query, connection, params=params)
        <span class="keyword">else</span>:
            result = pd.read_sql_query(query, connection)
        <span class="keyword">return</span> result, <span class="keyword">None</span>
    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
        <span class="keyword">return</span> <span class="keyword">None</span>, <span class="string">f"خطا در اجرای کوئری: {str(e)}"</span>

<span class="comment"># تست</span>
result, error = safe_query(<span class="string">"SELECT * FROM employees WHERE department = ?"</span>, conn, [<span class="string">'IT'</span>])
<span class="keyword">if</span> error:
    <span class="function">print</span>(<span class="string">f"خطا: {error}"</span>)
<span class="keyword">else</span>:
    <span class="function">print</span>(<span class="string">f"✅ کوئری با موفقیت اجرا شد. تعداد سطرها: {len(result)}"</span>)

<span class="comment"># 3. تراکنش‌ها</span>
<span class="function">print</span>(<span class="string">f"\n💳 مدیریت تراکنش:"</span>)
<span class="keyword">def</span> <span class="function">transfer_employee</span>(employee_id, new_department):
    <span class="string">"""انتقال کارمند با تراکنش"""</span>
    <span class="keyword">try</span>:
        conn.execute(<span class="string">"BEGIN"</span>)
        
        <span class="comment"># بررسی وجود کارمند</span>
        check_query = <span class="string">"SELECT COUNT(*) as count FROM employees WHERE id = ?"</span>
        result = pd.read_sql_query(check_query, conn, params=[employee_id])
        
        <span class="keyword">if</span> result.iloc[<span class="number">0</span>][<span class="string">'count'</span>] == <span class="number">0</span>:
            <span class="keyword">raise</span> ValueError(<span class="string">"کارمند یافت نشد"</span>)
        
        <span class="comment"># به‌روزرسانی بخش</span>
        cursor = conn.cursor()
        cursor.execute(<span class="string">"UPDATE employees SET department = ? WHERE id = ?"</span>, 
                      [new_department, employee_id])
        
        <span class="comment"># ثبت لاگ</span>
        cursor.execute(<span class="string">"""INSERT INTO employee_logs (employee_id, action, timestamp) 
                          VALUES (?, ?, ?)"""</span>, 
                      [employee_id, <span class="string">f"Transferred to {new_department}"</span>, datetime.now()])
        
        conn.commit()
        <span class="keyword">return</span> <span class="keyword">True</span>, <span class="string">"انتقال با موفقیت انجام شد"</span>
        
    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
        conn.rollback()
        <span class="keyword">return</span> <span class="keyword">False</span>, <span class="string">f"خطا در انتقال: {str(e)}"</span>

<span class="comment"># ایجاد جدول لاگ</span>
conn.execute(<span class="string">"""CREATE TABLE IF NOT EXISTS employee_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    employee_id INTEGER,
    action TEXT,
    timestamp TEXT
)"""</span>)

<span class="comment"># تست انتقال</span>
success, message = transfer_employee(<span class="number">1</span>, <span class="string">'Sales'</span>)
<span class="function">print</span>(<span class="string">f"نتیجه انتقال: {message}"</span>)

<span class="comment"># 4. بستن اتصال</span>
<span class="function">print</span>(<span class="string">f"\n🔒 بستن اتصال:"</span>)
conn.close()
<span class="function">print</span>(<span class="string">"✅ اتصال پایگاه داده بسته شد"</span>)

<span class="comment"># نکات امنیتی</span>
<span class="function">print</span>(<span class="string">f"\n🛡️ نکات امنیتی:"</span>)
security_tips = [
    <span class="string">"1. هرگز از string concatenation برای کوئری استفاده نکنید"</span>,
    <span class="string">"2. همیشه از parameterized queries استفاده کنید"</span>,
    <span class="string">"3. اطلاعات اتصال را در متغیرهای محیطی ذخیره کنید"</span>,
    <span class="string">"4. دسترسی‌های پایگاه داده را محدود کنید"</span>,
    <span class="string">"5. از SSL برای اتصال‌های remote استفاده کنید"</span>,
    <span class="string">"6. اتصال‌ها را همیشه ببندید"</span>,
    <span class="string">"7. از connection pooling استفاده کنید"</span>
]

<span class="keyword">for</span> tip <span class="keyword">in</span> security_tips:
    <span class="function">print</span>(tip)
                    </div>

                    <div class="method-grid">
                        <div class="method-card">
                            <div class="method-name">pd.read_sql_query()</div>
                            <div class="method-desc">اجرای SELECT</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.to_sql()</div>
                            <div class="method-desc">نوشتن به جدول</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">sqlite3.connect()</div>
                            <div class="method-desc">اتصال SQLite</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">create_engine()</div
                                <div class="method-desc">SQLAlchemy Engine</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">cursor.execute()</div>
                            <div class="method-desc">اجرای مستقیم SQL</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">conn.commit()</div>
                            <div class="method-desc">تأیید تغییرات</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">💡 نکات پایگاه داده:</div>
                        <ul>
                            <li><strong>Security:</strong> همیشه از parameterized queries استفاده کنید</li>
                            <li><strong>Performance:</strong> برای داده‌های بزرگ از chunksize استفاده کنید</li>
                            <li><strong>Indexing:</strong> ایندکس مناسب برای کوئری‌های پرتکرار ایجاد کنید</li>
                            <li><strong>Transactions:</strong> برای عملیات‌های مهم از transaction استفاده کنید</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- اسلاید 14: مقدمه یادگیری ماشین -->
            <div class="slide" id="slide14">
                <div class="slide-number">14/15</div>
                <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                <button class="close-btn" onclick="closeSlide(this)">×</button>
                <div class="icon">🤖</div>
                <div class="slide-title">مقدمه یادگیری ماشین با Scikit-learn</div>
                <div class="slide-content">
                    <h3>🧠 مفاهیم پایه یادگیری ماشین:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># مقدمه یادگیری ماشین</span>
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt
<span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split
<span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler, LabelEncoder
<span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression, LogisticRegression
<span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier
<span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor
<span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, mean_squared_error, classification_report
<span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_regression, make_classification

<span class="function">print</span>(<span class="string">"🧠 مقدمه یادگیری ماشین"</span>)

<span class="comment"># انواع یادگیری ماشین</span>
<span class="function">print</span>(<span class="string">f"""
📚 انواع یادگیری ماشین:

1️⃣ یادگیری نظارت‌شده (Supervised Learning):
   - رگرسیون (Regression): پیش‌بینی مقادیر عددی
   - طبقه‌بندی (Classification): پیش‌بینی دسته‌ها

2️⃣ یادگیری غیرنظارت‌شده (Unsupervised Learning):
   - خوشه‌بندی (Clustering)
   - کاهش ابعاد (Dimensionality Reduction)

3️⃣ یادگیری تقویتی (Reinforcement Learning):
   - یادگیری از طریق تعامل با محیط
"""</span>)

<span class="comment"># ایجاد داده‌های نمونه برای رگرسیون</span>
np.random.seed(<span class="number">42</span>)
X_reg, y_reg = make_regression(n_samples=<span class="number">1000</span>, n_features=<span class="number">5</span>, noise=<span class="number">10</span>, random_state=<span class="number">42</span>)
feature_names = [<span class="string">f'ویژگی_{i+1}'</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(<span class="number">5</span>)]

regression_data = pd.DataFrame(X_reg, columns=feature_names)
regression_data[<span class="string">'هدف'</span>] = y_reg

<span class="function">print</span>(<span class="string">f"📊 داده‌های رگرسیون:\n{regression_data.head()}\n"</span>)
<span class="function">print</span>(<span class="string">f"شکل داده: {regression_data.shape}"</span>)
<span class="function">print</span>(<span class="string">f"آمار توصیفی:\n{regression_data.describe()}"</span>)
                    </div>

                    <h3>📈 رگرسیون خطی:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># رگرسیون خطی - پیش‌بینی قیمت خانه</span>
<span class="function">print</span>(<span class="string">"📈 مثال رگرسیون خطی - پیش‌بینی قیمت:"</span>)

<span class="comment"># ایجاد داده‌های واقعی‌تر</span>
np.random.seed(<span class="number">42</span>)
house_data = pd.DataFrame({
    <span class="string">'متراژ'</span>: np.random.normal(<span class="number">120</span>, <span class="number">30</span>, <span class="number">500</span>),
    <span class="string">'تعداد_اتاق'</span>: np.random.randint(<span class="number">1</span>, <span class="number">5</span>, <span class="number">500</span>),
    <span class="string">'سن_بنا'</span>: np.random.randint(<span class="number">0</span>, <span class="number">30</span>, <span class="number">500</span>),
    <span class="string">'فاصله_مرکز'</span>: np.random.uniform(<span class="number">1</span>, <span class="number">50</span>, <span class="number">500</span>),
    <span class="string">'امتیاز_محله'</span>: np.random.uniform(<span class="number">1</span>, <span class="number">10</span>, <span class="number">500</span>)
})

<span class="comment"># محاسبه قیمت بر اساس فرمول واقعی</span>
house_data[<span class="string">'قیمت'</span>] = (
    house_data[<span class="string">'متراژ'</span>] * <span class="number">2000000</span> +  <span class="comment"># 2 میلیون تومان به ازای هر متر</span>
    house_data[<span class="string">'تعداد_اتاق'</span>] * <span class="number">50000000</span> +  <span class="comment"># 50 میلیون برای هر اتاق</span>
    -house_data[<span class="string">'سن_بنا'</span>] * <span class="number">5000000</span> +  <span class="comment"># کسر 5 میلیون برای هر سال قدمت</span>
    -house_data[<span class="string">'فاصله_مرکز'</span>] * <span class="number">1000000</span> +  <span class="comment"># کسر 1 میلیون برای هر کیلومتر فاصله</span>
    house_data[<span class="string">'امتیاز_محله'</span>] * <span class="number">30000000</span> +  <span class="comment"># 30 میلیون برای هر امتیاز محله</span>
    np.random.normal(<span class="number">0</span>, <span class="number">20000000</span>, <span class="number">500</span>)  <span class="comment"># نویز</span>
)

<span class="function">print</span>(<span class="string">f"داده‌های خانه:\n{house_data.head()}\n"</span>)

<span class="comment"># تقسیم داده‌ها</span>
X = house_data.drop(<span class="string">'قیمت'</span>, axis=<span class="number">1</span>)
y = house_data[<span class="string">'قیمت'</span>]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span>)

<span class="function">print</span>(<span class="string">f"تعداد نمونه‌های آموزش: {len(X_train)}"</span>)
<span class="function">print</span>(<span class="string">f"تعداد نمونه‌های تست: {len(X_test)}\n"</span>)

<span class="comment"># آموزش مدل</span>
model = LinearRegression()
model.fit(X_train, y_train)

<span class="comment"># پیش‌بینی</span>
y_pred = model.predict(X_test)

<span class="comment"># ارزیابی مدل</span>
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
r2_score = model.score(X_test, y_test)

<span class="function">print</span>(<span class="string">f"📊 نتایج ارزیابی:"</span>)
<span class="function">print</span>(<span class="string">f"خطای جذر میانگین مربعات (RMSE): {rmse:,.0f} تومان"</span>)
<span class="function">print</span>(<span class="string">f"ضریب تعیین (R²): {r2_score:.3f}"</span>)

<span class="comment"># نمایش ضرایب</span>
coefficients = pd.DataFrame({
    <span class="string">'ویژگی'</span>: X.columns,
    <span class="string">'ضریب'</span>: model.coef_,
    <span class="string">'تأثیر'</span>: np.abs(model.coef_)
}).sort_values(<span class="string">'تأثیر'</span>, ascending=<span class="keyword">False</span>)

<span class="function">print</span>(<span class="string">f"\n🎯 ضرایب مدل:\n{coefficients}"</span>)
<span class="function">print</span>(<span class="string">f"عرض از مبدأ: {model.intercept_:,.0f}"</span>)

<span class="comment"># پیش‌بینی نمونه</span>
sample_house = pd.DataFrame({
    <span class="string">'متراژ'</span>: [<span class="number">100</span>],
    <span class="string">'تعداد_اتاق'</span>: [<span class="number">3</span>],
    <span class="string">'سن_بنا'</span>: [<span class="number">5</span>],
    <span class="string">'فاصله_مرکز'</span>: [<span class="number">10</span>],
    <span class="string">'امتیاز_محله'</span>: [<span class="number">8</span>]
})

predicted_price = model.predict(sample_house)[<span class="number">0</span>]
<span class="function">print</span>(<span class="string">f"\n🏠 پیش‌بینی قیمت خانه نمونه:"</span>)
<span class="function">print</span>(<span class="string">f"ویژگی‌ها: {sample_house.iloc[0].to_dict()}"</span>)
<span class="function">print</span>(<span class="string">f"قیمت پیش‌بینی شده: {predicted_price:,.0f} تومان"</span>)
                    </div>

                    <h3>🎯 طبقه‌بندی:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># طبقه‌بندی - تشخیص رضایت مشتری</span>
<span class="function">print</span>(<span class="string">"🎯 مثال طبقه‌بندی - تشخیص رضایت مشتری:"</span>)

<span class="comment"># ایجاد داده‌های مشتری</span>
np.random.seed(<span class="number">42</span>)
customer_data = pd.DataFrame({
    <span class="string">'سن'</span>: np.random.randint(<span class="number">18</span>, <span class="number">70</span>, <span class="number">1000</span>),
    <span class="string">'درآمد'</span>: np.random.normal(<span class="number">5000000</span>, <span class="number">2000000</span>, <span class="number">1000</span>),
    <span class="string">'مدت_مشتری'</span>: np.random.randint(<span class="number">1</span>, <span class="number">60</span>, <span class="number">1000</span>),  <span class="comment"># ماه</span>
    <span class="string">'تعداد_خرید'</span>: np.random.randint(<span class="number">1</span>, <span class="number">50</span>, <span class="number">1000</span>),
    <span class="string">'مبلغ_خرید'</span>: np.random.uniform(<span class="number">100000</span>, <span class="number">5000000</span>, <span class="number">1000</span>),
    <span class="string">'تماس_پشتیبانی'</span>: np.random.randint(<span class="number">0</span>, <span class="number">10</span>, <span class="number">1000</span>)
})

<span class="comment"># محاسبه رضایت بر اساس قوانین منطقی</span>
satisfaction_score = (
    (customer_data[<span class="string">'درآمد'</span>] / <span class="number">1000000</span>) * <span class="number">0.1</span> +
    (customer_data[<span class="string">'مدت_مشتری'</span>] / <span class="number">12</span>) * <span class="number">0.2</span> +
    (customer_data[<span class="string">'تعداد_خرید'</span>] / <span class="number">10</span>) * <span class="number">0.3</span> +
    (customer_data[<span class="string">'مبلغ_خرید'</span>] / <span class="number">1000000</span>) * <span class="number">0.2</span> +
    -customer_data[<span class="string">'تماس_پشتیبانی'</span>] * <span class="number">0.1</span> +
    np.random.normal(<span class="number">0</span>, <span class="number">0.5</span>, <span class="number">1000</span>)
)

<span class="comment"># تبدیل به دسته‌های رضایت</span>
customer_data[<span class="string">'رضایت'</span>] = pd.cut(satisfaction_score, 
                                   bins=[-np.inf, <span class="number">1</span>, <span class="number">2.5</span>, np.inf],
                                   labels=[<span class="string">'ناراضی'</span>, <span class="string">'متوسط'</span>, <span class="string">'راضی'</span>])

<span class="function">print</span>(<span class="string">f"داده‌های مشتری:\n{customer_data.head()}\n"</span>)

<span class="comment"># توزیع کلاس‌ها</span>
class_distribution = customer_data[<span class="string">'رضایت'</span>].value_counts()
<span class="function">print</span>(<span class="string">f"توزیع رضایت:\n{class_distribution}\n"</span>)

<span class="comment"># آماده‌سازی داده‌ها</span>
X = customer_data.drop(<span class="string">'رضایت'</span>, axis=<span class="number">1</span>)
y = customer_data[<span class="string">'رضایت'</span>]

<span class="comment"># تقسیم داده‌ها</span>
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span>, stratify=y)

<span class="comment"># استانداردسازی داده‌ها</span>
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

<span class="comment"># آموزش مدل‌های مختلف</span>
models = {
    <span class="string">'رگرسیون لجستیک'</span>: LogisticRegression(random_state=<span class="number">42</span>, max_iter=<span class="number">1000</span>),
    <span class="string">'درخت تصمیم'</span>: DecisionTreeClassifier(random_state=<span class="number">42</span>)
}

results = {}
<span class="keyword">for</span> name, model <span class="keyword">in</span> models.items():
    <span class="comment"># آموزش</span>
    <span class="keyword">if</span> name == <span class="string">'رگرسیون لجستیک'</span>:
        model.fit(X_train_scaled, y_train)
        y_pred = model.predict(X_test_scaled)
    <span class="keyword">else</span>:
        model.fit(X_train, y_train)
        y_pred = model.predict(X_test)
    
    <span class="comment"># ارزیابی</span>
    accuracy = accuracy_score(y_test, y_pred)
    results[name] = {<span class="string">'accuracy'</span>: accuracy, <span class="string">'predictions'</span>: y_pred}
    
    <span class="function">print</span>(<span class="string">f"📊 {name}:"</span>)
    <span class="function">print</span>(<span class="string">f"دقت: {accuracy:.3f}"</span>)
    <span class="function">print</span>(<span class="string">f"گزارش طبقه‌بندی:\n{classification_report(y_test, y_pred)}\n"</span>)

<span class="comment"># پیش‌بینی مشتری نمونه</span>
sample_customer = pd.DataFrame({
    <span class="string">'سن'</span>: [<span class="number">35</span>],
    <span class="string">'درآمد'</span>: [<span class="number">6000000</span>],
    <span class="string">'مدت_مشتری'</span>: [<span class="number">24</span>],
    <span class="string">'تعداد_خرید'</span>: [<span class="number">15</span>],
    <span class="string">'مبلغ_خرید'</span>: [<span class="number">2000000</span>],
    <span class="string">'تماس_پشتیبانی'</span>: [<span class="number">2</span>]
})

sample_scaled = scaler.transform(sample_customer)
best_model = models[<span class="string">'رگرسیون لجستیک'</span>]
predicted_satisfaction = best_model.predict(sample_scaled)[<span class="number">0</span>]
prediction_proba = best_model.predict_proba(sample_scaled)[<span class="number">0</span>]

<span class="function">print</span>(<span class="string">f"👤 پیش‌بینی مشتری نمونه:"</span>)
<span class="function">print</span>(<span class="string">f"مشخصات: {sample_customer.iloc[0].to_dict()}"</span>)
<span class="function">print</span>(<span class="string">f"رضایت پیش‌بینی شده: {predicted_satisfaction}"</span>)
<span class="function">print</span>(<span class="string">f"احتمالات: {dict(zip(best_model.classes_, prediction_proba))}"</span>)
                    </div>

                    <h3>🌳 الگوریتم‌های پیشرفته:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># الگوریتم‌های ensemble - Random Forest</span>
<span class="function">print</span>(<span class="string">"🌳 Random Forest - پیش‌بینی فروش:"</span>)

<span class="comment"># ایجاد داده‌های فروش</span>
np.random.seed(<span class="number">42</span>)
sales_features = pd.DataFrame({
    <span class="string">'تبلیغات_آنلاین'</span>: np.random.uniform(<span class="number">0</span>, <span class="number">100000</span>, <span class="number">500</span>),
    <span class="string">'تبلیغات_سنتی'</span>: np.random.uniform(<span class="number">0</span>, <span class="number">50000</span>, <span class="number">500</span>),
    <span class="string">'قیمت_محصول'</span>: np.random.uniform(<span class="number">50000</span>, <span class="number">500000</span>, <span class="number">500</span>),
    <span class="string">'فصل'</span>: np.random.choice([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="number">500</span>),  <span class="comment"># 1=بهار، 2=تابستان، ...</span>
    <span class="string">'تعداد_رقیب'</span>: np.random.randint(<span class="number">1</span>, <span class="number">10</span>, <span class="number">500</span>),
    <span class="string">'امتیاز_محصول'</span>: np.random.uniform(<span class="number">1</span>, <span class="number">5</span>, <span class="number">500</span>)
})

<span class="comment"># محاسبه فروش بر اساس فرمول پیچیده</span>
sales_target = (
    sales_features[<span class="string">'تبلیغات_آنلاین'</span>] * <span class="number">0.8</span> +
    sales_features[<span class="string">'تبلیغات_سنتی'</span>] * <span class="number">0.5</span> +
    -sales_features[<span class="string">'قیمت_محصول'</span>] * <span class="number">0.3</span> +
    sales_features[<span class="string">'فصل'</span>] * <span class="number">5000</span> +
    -sales_features[<span class="string">'تعداد_رقیب'</span>] * <span class="number">2000</span> +
    sales_features[<span class="string">'امتیاز_محصول'</span>] * <span class="number">15000</span> +
    np.random.normal(<span class="number">0</span>, <span class="number">5000</span>, <span class="number">500</span>)
)

<span class="function">print</span>(<span class="string">f"ویژگی‌های فروش:\n{sales_features.head()}\n"</span>)

<span class="comment"># تقسیم داده‌ها</span>
X_train, X_test, y_train, y_test = train_test_split(
    sales_features, sales_target, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span>
)

<span class="comment"># مقایسه مدل‌های مختلف</span>
models_comparison = {
    <span class="string">'رگرسیون خطی'</span>: LinearRegression(),
    <span class="string">'Random Forest'</span>: RandomForestRegressor(n_estimators=<span class="number">100</span>, random_state=<span class="number">42</span>)
}

<span class="keyword">for</span> name, model <span class="keyword">in</span> models_comparison.items():
    <span class="comment"># آموزش</span>
    model.fit(X_train, y_train)
    
    <span class="comment"># پیش‌بینی</span>
    y_pred = model.predict(X_test)
    
    <span class="comment"># ارزیابی</span>
    mse = mean_squared_error(y_test, y_pred)
    rmse = np.sqrt(mse)
    r2 = model.score(X_test, y_test)
    
    <span class="function">print</span>(<span class="string">f"📊 {name}:"</span>)
    <span class="function">print</span>(<span class="string">f"RMSE: {rmse:.2f}"</span>)
    <span class="function">print</span>(<span class="string">f"R²: {r2:.3f}"</span>)
    
    <span class="comment"># اهمیت ویژگی‌ها (فقط برای Random Forest)</span>
    <span class="keyword">if</span> hasattr(model, <span class="string">'feature_importances_'</span>):
        feature_importance = pd.DataFrame({
            <span class="string">'ویژگی'</span>: sales_features.columns,
            <span class="string">'اهمیت'</span>: model.feature_importances_
        }).sort_values(<span class="string">'اهمیت'</span>, ascending=<span class="keyword">False</span>)
        
        <span class="function">print</span>(<span class="string">f"اهمیت ویژگی‌ها:\n{feature_importance}"</span>)
    
    <span class="function">print</span>(<span class="string">"-" * 50</span>)

<span class="comment"># پیش‌بینی سناریوی جدید</span>
new_campaign = pd.DataFrame({
    <span class="string">'تبلیغات_آنلاین'</span>: [<span class="number">80000</span>],
    <span class="string">'تبلیغات_سنتی'</span>: [<span class="number">30000</span>],
    <span class="string">'قیمت_محصول'</span>: [<span class="number">200000</span>],
    <span class="string">'فصل'</span>: [<span class="number">2</span>],  <span class="comment"># تابستان</span>
    <span class="string">'تعداد_رقیب'</span>: [<span class="number">5</span>],
    <span class="string">'امتیاز_محصول'</span>: [<span class="number">4.2</span>]
})

rf_model = models_comparison[<span class="string">'Random Forest'</span>]
predicted_sales = rf_model.predict(new_campaign)[<span class="number">0</span>]

<span class="function">print</span>(<span class="string">f"🎯 پیش‌بینی کمپین جدید:"</span>)
<span class="function">print</span>(<span class="string">f"مشخصات کمپین: {new_campaign.iloc[0].to_dict()}"</span>)
<span class="function">print</span>(<span class="string">f"فروش پیش‌بینی شده: {predicted_sales:,.0f} واحد"</span>)
                    </div>

                    <h3>🔍 ارزیابی و بهبود مدل:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ارزیابی و بهبود مدل</span>
<span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score, GridSearchCV
<span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix

<span class="function">print</span>(<span class="string">"🔍 ارزیابی و بهبود مدل:"</span>)

<span class="comment"># Cross Validation</span>
<span class="function">print</span>(<span class="string">"📊 اعتبارسنجی متقابل:"</span>)

<span class="comment"># برای مدل طبقه‌بندی</span>
dt_model = DecisionTreeClassifier(random_state=<span class="number">42</span>)
cv_scores = cross_val_score(dt_model, X_train, y_train, cv=<span class="number">5</span>, scoring=<span class="string">'accuracy'</span>)

<span class="function">print</span>(<span class="string">f"امتیازهای CV: {cv_scores}"</span>)
<span class="function">print</span>(<span class="string">f"میانگین CV: {cv_scores.mean():.3f} ± {cv_scores.std():.3f}"</span>)

<span class="comment"># Grid Search برای بهینه‌سازی پارامترها</span>
<span class="function">print</span>(<span class="string">f"\n🎛️ بهینه‌سازی پارامترها:"</span>)

param_grid = {
    <span class="string">'max_depth'</span>: [<span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">10</span>],
    <span class="string">'min_samples_split'</span>: [<span class="number">2</span>, <span class="number">5</span>, <span class="number">10</span>],
    <span class="string">'min_samples_leaf'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>]
}

grid_search = GridSearchCV(
    DecisionTreeClassifier(random_state=<span class="number">42</span>),
    param_grid,
    cv=<span class="number">5</span>,
    scoring=<span class="string">'accuracy'</span>,
    n_jobs=-<span class="number">1</span>
)

grid_search.fit(X_train, y_train)

<span class="function">print</span>(<span class="string">f"بهترین پارامترها: {grid_search.best_params_}"</span>)
<span class="function">print</span>(<span class="string">f"بهترین امتیاز CV: {grid_search.best_score_:.3f}"</span>)

<span class="comment"># ارزیابی مدل بهینه</span>
best_model = grid_search.best_estimator_
y_pred_best = best_model.predict(X_test)
accuracy_best = accuracy_score(y_test, y_pred_best)

<span class="function">print</span>(<span class="string">f"دقت مدل بهینه روی تست: {accuracy_best:.3f}"</span>)

<span class="comment"># ماتریس درهم‌ریختگی</span>
<span class="function">print</span>(<span class="string">f"\n🔢 ماتریس درهم‌ریختگی:"</span>)
cm = confusion_matrix(y_test, y_pred_best)
cm_df = pd.DataFrame(cm, 
                     index=[<span class="string">f'واقعی_{cls}'</span> <span class="keyword">for</span> cls <span class="keyword">in</span> best_model.classes_],
                     columns=[<span class="string">f'پیش‌بینی_{cls}'</span> <span class="keyword">for</span> cls <span class="keyword">in</span> best_model.classes_])

<span class="function">print</span>(cm_df)

<span class="comment"># محاسبه معیارهای دقیق‌تر</span>
<span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> precision_recall_fscore_support

precision, recall, f1, support = precision_recall_fscore_support(y_test, y_pred_best, average=<span class="keyword">None</span>)

metrics_df = pd.DataFrame({
    <span class="string">'کلاس'</span>: best_model.classes_,
    <span class="string">'دقت'</span>: precision,
    <span class="string">'بازخوانی'</span>: recall,
    <span class="string">'F1-Score'</span>: f1,
    <span class="string">'تعداد'</span>: support
})

<span class="function">print</span>(<span class="string">f"\n📈 معیارهای تفصیلی:\n{metrics_df}"</span>)

<span class="comment"># نکات مهم یادگیری ماشین</span>
<span class="function">print</span>(<span class="string">f"""
💡 نکات مهم یادگیری ماشین:

1️⃣ آماده‌سازی داده:
   - تمیزکاری داده‌ها
   - مدیریت مقادیر گمشده
   - استانداردسازی/نرمال‌سازی

2️⃣ انتخاب ویژگی:
   - حذف ویژگی‌های غیرمرتبط
   - ایجاد ویژگی‌های جدید
   - کاهش ابعاد

3️⃣ انتخاب مدل:
   - شروع با مدل‌های ساده
   - مقایسه چندین الگوریتم
   - در نظر گیری پیچیدگی محاسباتی

4️⃣ ارزیابی:
   - استفاده از cross-validation
   - معیارهای مناسب برای مسئله
   - بررسی overfitting/underfitting

5️⃣ بهینه‌سازی:
   - تنظیم پارامترها
   - ensemble methods
   - regularization
"""</span>)
                    </div>

                    <div class="method-grid">
                        <div class="method-card">
                            <div class="method-name">train_test_split()</div>
                            <div class="method-desc">تقسیم داده</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">LinearRegression()</div>
                            <div class="method-desc">رگرسیون خطی</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">LogisticRegression()</div>
                            <div class="method-desc">رگرسیون لجستیک</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">RandomForestRegressor()</div>
                            <div class="method-desc">جنگل تصادفی</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">cross_val_score()</div>
                            <div class="method-desc">اعتبارسنجی متقابل</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">GridSearchCV()</div>
                            <div class="method-desc">بهینه‌سازی پارامتر</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">💡 نکات یادگیری ماشین:</div>
                        <ul>
                            <li><strong>Data Quality:</strong> کیفیت داده مهم‌تر از الگوریتم است</li>
                            <li><strong>Simple First:</strong> با مدل‌های ساده شروع کنید</li>
                            <li><strong>Cross Validation:</strong> همیشه از CV برای ارزیابی استفاده کنید</li>
                            <li><strong>Domain Knowledge:</strong> دانش حوزه‌ای را در نظر بگیرید</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- اسلاید 15: پروژه نهایی -->
            <div class="slide" id="slide15">
                <div class="slide-number">15/15</div>
                <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                <button class="close-btn" onclick="closeSlide(this)">×</button>
                <div class="icon">🚀</div>
                <div class="slide-title">پروژه نهایی - تحلیل جامع داده</div>
                <div class="slide-content">
                    <h3>🎯 معرفی پروژه:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># پروژه نهایی: تحلیل جامع فروشگاه آنلاین</span>
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt
<span class="keyword">import</span> seaborn <span class="keyword">as</span> sns
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta
<span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split
<span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor
<span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error
<span class="keyword">import</span> warnings
warnings.filterwarnings(<span class="string">'ignore'</span>)

<span class="function">print</span>(<span class="string">"""
🚀 پروژه نهایی: تحلیل جامع فروشگاه آنلاین

🎯 اهداف پروژه:
1️⃣ تحلیل اکتشافی داده‌ها (EDA)
2️⃣ تمیزکاری و آماده‌سازی داده‌ها
3️⃣ تحلیل رفتار مشتریان
4️⃣ پیش‌بینی فروش
5️⃣ ارائه توصیه‌های کسب‌وکار

📊 داده‌ها شامل:
- اطلاعات مشتریان
- سفارشات و محصولات
- بازخوردها و امتیازات
- داده‌های زمانی فروش
"""</span>)

<span class="comment"># ایجاد داده‌های شبیه‌سازی شده</span>
np.random.seed(<span class="number">42</span>)

<span class="comment"># 1. داده‌های مشتریان</span>
n_customers = <span class="number">1000</span>
customers = pd.DataFrame({
    <span class="string">'customer_id'</span>: <span class="function">range</span>(<span class="number">1</span>, n_customers + <span class="number">1</span>),
    <span class="string">'age'</span>: np.random.randint(<span class="number">18</span>, <span class="number">70</span>, n_customers),
    <span class="string">'gender'</span>: np.random.choice([<span class="string">'M'</span>, <span class="string">'F'</span>], n_customers),
    <span class="string">'city'</span>: np.random.choice([<span class="string">'تهران'</span>, <span class="string">'اصفهان'</span>, <span class="string">'شیراز'</span>, <span class="string">'مشهد'</span>, <span class="string">'تبریز'</span>], n_customers),
    <span class="string">'registration_date'</span>: pd.date_range(<span class="string">'2022-01-01'</span>, <span class="string">'2024-01-01'</span>, periods=n_customers),
    <span class="string">'income_level'</span>: np.random.choice([<span class="string">'Low'</span>, <span class="string">'Medium'</span>, <span class="string">'High'</span>], n_customers, p=[<span class="number">0.3</span>, <span class="number">0.5</span>, <span class="number">0.2</span>])
})

<span class="function">print</span>(<span class="string">f"👥 داده‌های مشتریان ({len(customers)} مشتری):\n{customers.head()}\n"</span>)
                    </div>

                    <h3>📊 تولید داده‌های پروژه:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># 2. داده‌های محصولات</span>
products = pd.DataFrame({
    <span class="string">'product_id'</span>: <span class="function">range</span>(<span class="number">1</span>, <span class="number">101</span>),
    <span class="string">'category'</span>: np.random.choice([<span class="string">'الکترونیک'</span>, <span class="string">'پوشاک'</span>, <span class="string">'خانه'</span>, <span class="string">'کتاب'</span>, <span class="string">'ورزش'</span>], <span class="number">100</span>),
    <span class="string">'price'</span>: np.random.uniform(<span class="number">10000</span>, <span class="number">5000000</span>, <span class="number">100</span>),
    <span class="string">'cost'</span>: <span class="keyword">lambda</span> df: df[<span class="string">'price'</span>] * np.random.uniform(<span class="number">0.4</span>, <span class="number">0.8</span>, <span class="number">100</span>)
})
products[<span class="string">'cost'</span>] = products[<span class="string">'price'</span>] * np.random.uniform(<span class="number">0.4</span>, <span class="number">0.8</span>, <span class="number">100</span>)
products[<span class="string">'profit_margin'</span>] = (products[<span class="string">'price'</span>] - products[<span class="string">'cost'</span>]) / products[<span class="string">'price'</span>]

<span class="comment"># 3. داده‌های سفارشات</span>
n_orders = <span class="number">5000</span>
orders = pd.DataFrame({
    <span class="string">'order_id'</span>: <span class="function">range</span>(<span class="number">1</span>, n_orders + <span class="number">1</span>),
    <span class="string">'customer_id'</span>: np.random.choice(customers[<span class="string">'customer_id'</span>], n_orders),
    <span class="string">'product_id'</span>: np.random.choice(products[<span class="string">'product_id'</span>], n_orders),
    <span class="string">'quantity'</span>: np.random.randint(<span class="number">1</span>, <span class="number">5</span>, n_orders),
    <span class="string">'order_date'</span>: pd.date_range(<span class="string">'2023-01-01'</span>, <span class="string">'2024-09-01'</span>, periods=n_orders),
    <span class="string">'discount'</span>: np.random.uniform(<span class="number">0</span>, <span class="number">0.3</span>, n_orders),
    <span class="string">'rating'</span>: np.random.choice([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], n_orders, p=[<span class="number">0.05</span>, <span class="number">0.1</span>, <span class="number">0.15</span>, <span class="number">0.3</span>, <span class="number">0.4</span>])
})

<span class="comment"># محاسبه مبلغ سفارش</span>
orders = orders.merge(products[[<span class="string">'product_id'</span>, <span class="string">'price'</span>]], on=<span class="string">'product_id'</span>)
orders[<span class="string">'total_amount'</span>] = orders[<span class="string">'quantity'</span>] * orders[<span class="string">'price'</span>] * (<span class="number">1</span> - orders[<span class="string">'discount'</span>])

<span class="function">print</span>(<span class="string">f"🛒 داده‌های سفارشات ({len(orders)} سفارش):\n{orders.head()}\n"</span>)

<span class="comment"># 4. ترکیب داده‌ها</span>
<span class="comment"># اتصال جداول برای تحلیل جامع</span>
full_data = orders.merge(customers, on=<span class="string">'customer_id'</span>, how=<span class="string">'left'</span>)
full_data = full_data.merge(products[[<span class="string">'product_id'</span>, <span class="string">'category'</span>, <span class="string">'profit_margin'</span>]], on=<span class="string">'product_id'</span>, how=<span class="string">'left'</span>)

<span class="comment"># اضافه کردن ویژگی‌های زمانی</span>
full_data[<span class="string">'order_month'</span>] = full_data[<span class="string">'order_date'</span>].dt.month
full_data[<span class="string">'order_day_of_week'</span>] = full_data[<span class="string">'order_date'</span>].dt.dayofweek
full_data[<span class="string">'customer_age_at_order'</span>] = full_data[<span class="string">'age'</span>] + (
    (full_data[<span class="string">'order_date'</span>] - full_data[<span class="string">'registration_date'</span>]).dt.days / <span class="number">365</span>
).round(<span class="number">1</span>)

<span class="function">print</span>(<span class="string">f"📋 داده‌های ترکیب شده:\n{full_data.head()}\n"</span>)
<span class="function">print</span>(<span class="string">f"شکل داده نهایی: {full_data.shape}"</span>)
                    </div>

                    <h3>🔍 تحلیل اکتشافی داده‌ها (EDA):</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># تحلیل اکتشافی داده‌ها</span>
<span class="function">print</span>(<span class="string">"🔍 تحلیل اکتشافی داده‌ها (EDA):"</span>)

<span class="comment"># 1. آمار توصیفی کلی</span>
<span class="function">print</span>(<span class="string">"📊 آمار کلی:"</span>)
<span class="function">print</span>(<span class="string">f"تعداد مشتریان منحصربه‌فرد: {full_data['customer_id'].nunique():,}"</span>)
<span class="function">print</span>(<span class="string">f"تعداد محصولات منحصربه‌فرد: {full_data['product_id'].nunique():,}"</span>)
<span class="function">print</span>(<span class="string">f"کل فروش: {full_data['total_amount'].sum():,.0f} تومان"</span>)
<span class="function">print</span>(<span class="string">f"میانگین مبلغ سفارش: {full_data['total_amount'].mean():,.0f} تومان"</span>)
<span class="function">print</span>(<span class="string">f"بازه زمانی: {full_data['order_date'].min()} تا {full_data['order_date'].max()}\n"</span>)

<span class="comment"># 2. تحلیل بر اساس دسته‌بندی</span>
category_analysis = full_data.groupby(<span class="string">'category'</span>).agg({
    <span class="string">'total_amount'</span>: [<span class="string">'sum'</span>, <span class="string">'mean'</span>, <span class="string">'count'</span>],
    <span class="string">'rating'</span>: <span class="string">'mean'</span>,
    <span class="string">'profit_margin'</span>: <span class="string">'mean'</span>
}).round(<span class="number">2</span>)

category_analysis.columns = [<span class="string">'کل_فروش'</span>, <span class="string">'میانگین_فروش'</span>, <span class="string">'تعداد_سفارش'</span>, <span class="string">'میانگین_امتیاز'</span>, <span class="string">'میانگین_سود'</span>]
category_analysis = category_analysis.sort_values(<span class="string">'کل_فروش'</span>, ascending=<span class="keyword">False</span>)

<span class="function">print</span>(<span class="string">f"📈 تحلیل دسته‌بندی محصولات:\n{category_analysis}\n"</span>)

<span class="comment"># 3. تحلیل مشتریان</span>
customer_behavior = full_data.groupby(<span class="string">'customer_id'</span>).agg({
    <span class="string">'total_amount'</span>: [<span class="string">'sum'</span>, <span class="string">'count'</span>],
    <span class="string">'rating'</span>: <span class="string">'mean'</span>,
    <span class="string">'order_date'</span>: [<span class="string">'min'</span>, <span class="string">'max'</span>]
}).round(<span class="number">2</span>)

customer_behavior.columns = [<span class="string">'کل_خرید'</span>, <span class="string">'تعداد_سفارش'</span>, <span class="string">'میانگین_امتیاز'</span>, <span class="string">'اولین_خرید'</span>, <span class="string">'آخرین_خرید'</span>]
customer_behavior[<span class="string">'مدت_مشتری_روز'</span>] = (customer_behavior[<span class="string">'آخرین_خرید'</span>] - customer_behavior[<span class="string">'اولین_خرید'</span>]).dt.days
customer_behavior[<span class="string">'میانگین_مبلغ_سفارش'</span>] = customer_behavior[<span class="string">'کل_خرید'</span>] / customer_behavior[<span class="string">'تعداد_سفارش'</span>]

<span class="comment"># دسته‌بندی مشتریان</span>
customer_behavior[<span class="string">'نوع_مشتری'</span>] = pd.cut(
    customer_behavior[<span class="string">'کل_خرید'</span>],
    bins=[<span class="number">0</span>, <span class="number">500000</span>, <span class="number">2000000</span>, np.inf],
    labels=[<span class="string">'برنزی'</span>, <span class="string">'نقره‌ای'</span>, <span class="string">'طلایی'</span>]
)

customer_segments = customer_behavior[<span class="string">'نوع_مشتری'</span>].value_counts()
<span class="function">print</span>(<span class="string">f"🎯 دسته‌بندی مشتریان:\n{customer_segments}\n"</span>)

<span class="comment"># 4. تحلیل زمانی</span>
monthly_sales = full_data.groupby(full_data[<span class="string">'order_date'</span>].dt.to_period(<span class="string">'M'</span>)).agg({
    <span class="string">'total_amount'</span>: <span class="string">'sum'</span>,
    <span class="string">'order_id'</span>: <span class="string">'count'</span>
}).rename(columns={<span class="string">'order_id'</span>: <span class="string">'تعداد_سفارش'</span>, <span class="string">'total_amount'</span>: <span class="string">'فروش_ماهانه'</span>})

<span class="function">print</span>(<span class="string">f"📅 روند فروش ماهانه:\n{monthly_sales.tail()}\n"</span>)

<span class="comment"># 5. تحلیل رضایت مشتریان</span>
satisfaction_analysis = full_data.groupby([<span class="string">'category'</span>, <span class="string">'rating'</span>]).size().unstack(fill_value=<span class="number">0</span>)
satisfaction_percentage = satisfaction_analysis.div(satisfaction_analysis.sum(axis=<span class="number">1</span>), axis=<span class="number">0</span>) * <span class="number">100</span>

<span class="function">print</span>(<span class="string">f"😊 توزیع رضایت به تفکیک دسته (درصد):\n{satisfaction_percentage.round(1)}"</span>)
                    </div>

                    <h3>🧹 تمیزکاری و آماده‌سازی داده‌ها:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># تمیزکاری و آماده‌سازی داده‌ها</span>
<span class="function">print</span>(<span class="string">"🧹 تمیزکاری و آماده‌سازی داده‌ها:"</span>)

<span class="comment"># 1. بررسی مقادیر گمشده</span>
missing_data = full_data.isnull().sum()
<span class="function">print</span>(<span class="string">f"❌ مقادیر گمشده:\n{missing_data[missing_data > 0]}"</span>)

<span class="keyword">if</span> missing_data.sum() == <span class="number">0</span>:
    <span class="function">print</span>(<span class="string">"✅ هیچ مقدار گمشده‌ای یافت نشد"</span>)

<span class="comment"># 2. شناسایی و حذف outliers</span>
<span class="function">print</span>(<span class="string">f"\n🔍 شناسایی outliers:"</span>)

<span class="keyword">def</span> <span class="function">detect_outliers</span>(df, column):
    <span class="string">"""شناسایی outliers با استفاده از IQR"""</span>
    Q1 = df[column].quantile(<span class="number">0.25</span>)
    Q3 = df[column].quantile(<span class="number">0.75</span>)
    IQR = Q3 - Q1
    lower_bound = Q1 - <span class="number">1.5</span> * IQR
    upper_bound = Q3 + <span class="number">1.5</span> * IQR
    
    outliers = df[(df[column] < lower_bound) | (df[column] > upper_bound)]
    <span class="keyword">return</span> outliers, lower_bound, upper_bound

<span class="comment"># بررسی outliers در مبلغ سفارش</span>
outliers, lower, upper = detect_outliers(full_data, <span class="string">'total_amount'</span>)
<span class="function">print</span>(<span class="string">f"تعداد outliers در مبلغ: {len(outliers)} ({len(outliers)/len(full_data)*100:.1f}%)"</span>)
<span class="function">print</span>(<span class="string">f"محدوده طبیعی: {lower:,.0f} تا {upper:,.0f} تومان"</span>)

<span class="comment"># حذف outliers شدید (اختیاری)</span>
clean_data = full_data[
    (full_data[<span class="string">'total_amount'</span>] >= full_data[<span class="string">'total_amount'</span>].quantile(<span class="number">0.01</span>)) &
    (full_data[<span class="string">'total_amount'</span>] <= full_data[<span class="string">'total_amount'</span>].quantile(<span class="number">0.99</span>))
].copy()

<span class="function">print</span>(<span class="string">f"داده‌های تمیز: {len(clean_data)} سطر ({len(clean_data)/len(full_data)*100:.1f}% از کل)"</span>)

<span class="comment"># 3. ایجاد ویژگی‌های جدید</span>
<span class="function">print</span>(<span class="string">f"\n🔧 ایجاد ویژگی‌های جدید:"</span>)

<span class="comment"># ویژگی‌های مشتری</span>
customer_features = clean_data.groupby(<span class="string">'customer_id'</span>).agg({
    <span class="string">'total_amount'</span>: [<span class="string">'sum'</span>, <span class="string">'mean'</span>, <span class="string">'count'</span>],
    <span class="string">'rating'</span>: <span class="string">'mean'</span>,
    <span class="string">'discount'</span>: <span class="string">'mean'</span>,
    <span class="string">'order_date'</span>: [<span class="string">'min'</span>, <span class="string">'max'</span>]
}).round(<span class="number">2</span>)

customer_features.columns = [
    <span class="string">'total_spent'</span>, <span class="string">'avg_order_value'</span>, <span class="string">'order_frequency'</span>,
    <span class="string">'avg_rating'</span>, <span class="string">'avg_discount'</span>, <span class="string">'first_order'</span>, <span class="string">'last_order'</span>
]

<span class="comment"># محاسبه مدت مشتری بودن</span>
customer_features[<span class="string">'customer_lifetime_days'</span>] = (
    customer_features[<span class="string">'last_order'</span>] - customer_features[<span class="string">'first_order'</span>]
).dt.days + <span class="number">1</span>

<span class="comment"># محاسبه CLV (Customer Lifetime Value) ساده</span>
customer_features[<span class="string">'clv_estimate'</span>] = (
    customer_features[<span class="string">'avg_order_value'</span>] * 
    customer_features[<span class="string">'order_frequency'</span>] * 
    (customer_features[<span class="string">'customer_lifetime_days'</span>] / <span class="number">30</span>)  <span class="comment"># تبدیل به ماه</span>
)

<span class="function">print</span>(<span class="string">f"ویژگی‌های مشتری ایجاد شد: {customer_features.shape}"</span>)
<span class="function">print</span>(<span class="string">f"نمونه:\n{customer_features.head()}"</span>)

<span class="comment"># 4. رمزگذاری متغیرهای دسته‌ای</span>
<span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder

categorical_columns = [<span class="string">'gender'</span>, <span class="string">'city'</span>, <span class="string">'income_level'</span>, <span class="string">'category'</span>]
clean_data_encoded = clean_data.copy()

<span class="keyword">for</span> col <span class="keyword">in</span> categorical_columns:
    <span class="keyword">if</span> col <span class="keyword">in</span> clean_data_encoded.columns:
        le = LabelEncoder()
        clean_data_encoded[<span class="string">f'{col}_encoded'</span>] = le.fit_transform(clean_data_encoded[col])
        <span class="function">print</span>(<span class="string">f"✅ {col} رمزگذاری شد"</span>)
                    </div>

                    <h3>🤖 مدل‌سازی پیش‌بینی:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># مدل‌سازی پیش‌بینی فروش</span>
<span class="function">print</span>(<span class="string">"🤖 مدل‌سازی پیش‌بینی فروش:"</span>)

<span class="comment"># آماده‌سازی داده‌ها برای مدل</span>
<span class="comment"># هدف: پیش‌بینی مبلغ سفارش بعدی مشتری</span>

model_data = clean_data_encoded.copy()

<span class="comment"># انتخاب ویژگی‌ها</span>
feature_columns = [
    <span class="string">'age'</span>, <span class="string">'gender_encoded'</span>, <span class="string">'city_encoded'</span>, <span class="string">'income_level_encoded'</span>,```html
                            <div class="method-desc">SQLAlchemy Engine</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">cursor.execute()</div>
                            <div class="method-desc">اجرای مستقیم SQL</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">conn.commit()</div>
                            <div class="method-desc">تایید تراکنش</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">💡 نکات پایگاه داده:</div>
                        <ul>
                            <li><strong>Security:</strong> همیشه از parameterized queries استفاده کنید</li>
                            <li><strong>Performance:</strong> برای داده‌های بزرگ از chunksize استفاده کنید</li>
                            <li><strong>Transactions:</strong> عملیات مهم را در تراکنش قرار دهید</li>
                            <li><strong>Connections:</strong> اتصال‌ها را مدیریت و بسته کنید</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- اسلاید 14: مقدمه‌ای بر یادگیری ماشین -->
            <div class="slide" id="slide14">
                <div class="slide-number">14/15</div>
                <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                <button class="close-btn" onclick="closeSlide(this)">×</button>
                <div class="icon">🤖</div>
                <div class="slide-title">مقدمه‌ای بر یادگیری ماشین با Scikit-learn</div>
                <div class="slide-content">
                    <h3>🎯 آماده‌سازی داده برای یادگیری ماشین:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># وارد کردن کتابخانه‌های مورد نیاز</span>
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt
<span class="keyword">import</span> seaborn <span class="keyword">as</span> sns
<span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split
<span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler, LabelEncoder
<span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression, LogisticRegression
<span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier
<span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor
<span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, mean_squared_error, classification_report
<span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans

<span class="comment"># ایجاد داده‌های نمونه</span>
np.random.seed(<span class="number">42</span>)

<span class="comment"># داده‌های مشتریان برای تحلیل</span>
customers = pd.DataFrame({
    <span class="string">'سن'</span>: np.random.randint(<span class="number">18</span>, <span class="number">70</span>, <span class="number">1000</span>),
    <span class="string">'درآمد'</span>: np.random.normal(<span class="number">50000</span>, <span class="number">20000</span>, <span class="number">1000</span>),
    <span class="string">'امتیاز_اعتباری'</span>: np.random.randint(<span class="number">300</span>, <span class="number">850</span>, <span class="number">1000</span>),
    <span class="string">'سابقه_خرید'</span>: np.random.randint(<span class="number">0</span>, <span class="number">60</span>, <span class="number">1000</span>),
    <span class="string">'جنسیت'</span>: np.random.choice([<span class="string">'مرد'</span>, <span class="string">'زن'</span>], <span class="number">1000</span>),
    <span class="string">'شهر'</span>: np.random.choice([<span class="string">'تهران'</span>, <span class="string">'اصفهان'</span>, <span class="string">'شیراز'</span>, <span class="string">'مشهد'</span>], <span class="number">1000</span>)
})

<span class="comment"># ایجاد متغیر هدف (خرید محصول)</span>
<span class="comment"># احتمال خرید بر اساس ویژگی‌ها</span>
purchase_probability = (
    (customers[<span class="string">'درآمد'</span>] / <span class="number">100000</span>) * <span class="number">0.3</span> +
    (customers[<span class="string">'امتیاز_اعتباری'</span>] / <span class="number">850</span>) * <span class="number">0.4</span> +
    (customers[<span class="string">'سابقه_خرید'</span>] / <span class="number">60</span>) * <span class="number">0.3</span>
)

customers[<span class="string">'خرید'</span>] = (purchase_probability + np.random.normal(<span class="number">0</span>, <span class="number">0.1</span>, <span class="number">1000</span>) > <span class="number">0.5</span>).astype(int)

<span class="comment"># ایجاد متغیر پیوسته (مبلغ خرید)</span>
customers[<span class="string">'مبلغ_خرید'</span>] = np.where(
    customers[<span class="string">'خرید'</span>] == <span class="number">1</span>,
    customers[<span class="string">'درآمد'</span>] * <span class="number">0.1</span> + np.random.normal(<span class="number">0</span>, <span class="number">1000</span>, <span class="number">1000</span>),
    <span class="number">0</span>
)

<span class="function">print</span>(<span class="string">"🎯 داده‌های مشتریان:"</span>)
<span class="function">print</span>(<span class="string">f"شکل داده: {customers.shape}"</span>)
<span class="function">print</span>(<span class="string">f"ستون‌ها: {list(customers.columns)}"</span>)
<span class="function">print</span>(<span class="string">f"\nنمونه داده‌ها:\n{customers.head()}"</span>)
<span class="function">print</span>(<span class="string">f"\nآمار توصیفی:\n{customers.describe()}"</span>)

<span class="comment"># بررسی توزیع متغیر هدف</span>
<span class="function">print</span>(<span class="string">f"\nتوزیع خرید:\n{customers['خرید'].value_counts()}"</span>)
<span class="function">print</span>(<span class="string">f"درصد خریداران: {customers['خرید'].mean()*100:.1f}%"</span>)
                    </div>

                    <h3>🔧 پیش‌پردازش داده‌ها:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># پیش‌پردازش داده‌ها</span>
<span class="function">print</span>(<span class="string">"🔧 پیش‌پردازش داده‌ها:"</span>)

<span class="comment"># کپی از داده‌های اصلی</span>
data_processed = customers.copy()

<span class="comment"># 1. تبدیل متغیرهای کیفی به عددی</span>
<span class="function">print</span>(<span class="string">"🔤 تبدیل متغیرهای کیفی:"</span>)

<span class="comment"># Label Encoding برای جنسیت</span>
le_gender = LabelEncoder()
data_processed[<span class="string">'جنسیت_کد'</span>] = le_gender.fit_transform(data_processed[<span class="string">'جنسیت'</span>])
<span class="function">print</span>(<span class="string">f"جنسیت: {dict(zip(le_gender.classes_, le_gender.transform(le_gender.classes_)))}"</span>)

<span class="comment"># One-Hot Encoding برای شهر</span>
city_dummies = pd.get_dummies(data_processed[<span class="string">'شهر'</span>], prefix=<span class="string">'شهر'</span>)
data_processed = pd.concat([data_processed, city_dummies], axis=<span class="number">1</span>)

<span class="function">print</span>(<span class="string">f"ستون‌های جدید شهر: {list(city_dummies.columns)}"</span>)

<span class="comment"># 2. استانداردسازی متغیرهای عددی</span>
<span class="function">print</span>(<span class="string">f"\n📏 استانداردسازی:"</span>)

numeric_features = [<span class="string">'سن'</span>, <span class="string">'درآمد'</span>, <span class="string">'امتیاز_اعتباری'</span>, <span class="string">'سابقه_خرید'</span>]
scaler = StandardScaler()

<span class="comment"># نمایش قبل از استانداردسازی</span>
<span class="function">print</span>(<span class="string">"قبل از استانداردسازی:"</span>)
<span class="function">print</span>(data_processed[numeric_features].describe().round(<span class="number">2</span>))

<span class="comment"># استانداردسازی</span>
data_processed[numeric_features] = scaler.fit_transform(data_processed[numeric_features])

<span class="function">print</span>(<span class="string">f"\nبعد از استانداردسازی:"</span>)
<span class="function">print</span>(data_processed[numeric_features].describe().round(<span class="number">2</span>))

<span class="comment"># 3. انتخاب ویژگی‌ها برای مدل‌سازی</span>
feature_columns = numeric_features + [<span class="string">'جنسیت_کد'</span>] + list(city_dummies.columns)
X = data_processed[feature_columns]
y_classification = data_processed[<span class="string">'خرید'</span>]
y_regression = data_processed[<span class="string">'مبلغ_خرید'</span>]

<span class="function">print</span>(<span class="string">f"\n📊 ویژگی‌های نهایی:"</span>)
<span class="function">print</span>(<span class="string">f"تعداد ویژگی: {X.shape[1]}"</span>)
<span class="function">print</span>(<span class="string">f"نام ویژگی‌ها: {list(X.columns)}"</span>)
<span class="function">print</span>(<span class="string">f"شکل X: {X.shape}"</span>)
<span class="function">print</span>(<span class="string">f"شکل y (طبقه‌بندی): {y_classification.shape}"</span>)
<span class="function">print</span>(<span class="string">f"شکل y (رگرسیون): {y_regression.shape}"</span>)
                    </div>

                    <h3>🎯 طبقه‌بندی (Classification):</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># طبقه‌بندی - پیش‌بینی خرید مشتری</span>
<span class="function">print</span>(<span class="string">"🎯 طبقه‌بندی - پیش‌بینی خرید:"</span>)

<span class="comment"># تقسیم داده به آموزش و تست</span>
X_train, X_test, y_train, y_test = train_test_split(
    X, y_classification, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span>, stratify=y_classification
)

<span class="function">print</span>(<span class="string">f"📊 تقسیم داده:"</span>)
<span class="function">print</span>(<span class="string">f"آموزش: {X_train.shape[0]} نمونه"</span>)
<span class="function">print</span>(<span class="string">f"تست: {X_test.shape[0]} نمونه"</span>)

<span class="comment"># 1. رگرسیون لجستیک</span>
<span class="function">print</span>(<span class="string">f"\n🔮 رگرسیون لجستیک:"</span>)
lr_model = LogisticRegression(random_state=<span class="number">42</span>)
lr_model.fit(X_train, y_train)

lr_predictions = lr_model.predict(X_test)
lr_accuracy = accuracy_score(y_test, lr_predictions)

<span class="function">print</span>(<span class="string">f"دقت: {lr_accuracy:.3f}"</span>)
<span class="function">print</span>(<span class="string">f"گزارش طبقه‌بندی:\n{classification_report(y_test, lr_predictions)}"</span>)

<span class="comment"># 2. درخت تصمیم</span>
<span class="function">print</span>(<span class="string">f"🌳 درخت تصمیم:"</span>)
dt_model = DecisionTreeClassifier(random_state=<span class="number">42</span>, max_depth=<span class="number">5</span>)
dt_model.fit(X_train, y_train)

dt_predictions = dt_model.predict(X_test)
dt_accuracy = accuracy_score(y_test, dt_predictions)

<span class="function">print</span>(<span class="string">f"دقت: {dt_accuracy:.3f}"</span>)

<span class="comment"># اهمیت ویژگی‌ها در درخت تصمیم</span>
feature_importance = pd.DataFrame({
    <span class="string">'ویژگی'</span>: X.columns,
    <span class="string">'اهمیت'</span>: dt_model.feature_importances_
}).sort_values(<span class="string">'اهمیت'</span>, ascending=<span class="keyword">False</span>)

<span class="function">print</span>(<span class="string">f"\n📊 اهمیت ویژگی‌ها:\n{feature_importance.head()}"</span>)

<span class="comment"># 3. مقایسه مدل‌ها</span>
<span class="function">print</span>(<span class="string">f"\n🏆 مقایسه مدل‌ها:"</span>)
comparison = pd.DataFrame({
    <span class="string">'مدل'</span>: [<span class="string">'رگرسیون لجستیک'</span>, <span class="string">'درخت تصمیم'</span>],
    <span class="string">'دقت'</span>: [lr_accuracy, dt_accuracy]
})
<span class="function">print</span>(comparison)

<span class="comment"># پیش‌بینی برای مشتری جدید</span>
<span class="function">print</span>(<span class="string">f"\n🔮 پیش‌بینی برای مشتری جدید:"</span>)
new_customer = pd.DataFrame({
    <span class="string">'سن'</span>: [<span class="number">35</span>],
    <span class="string">'درآمد'</span>: [<span class="number">60000</span>],
    <span class="string">'امتیاز_اعتباری'</span>: [<span class="number">750</span>],
    <span class="string">'سابقه_خرید'</span>: [<span class="number">24</span>],
    <span class="string">'جنسیت'</span>: [<span class="string">'زن'</span>],
    <span class="string">'شهر'</span>: [<span class="string">'تهران'</span>]
})

<span class="comment"># پیش‌پردازش مشتری جدید</span>
new_customer[<span class="string">'جنسیت_کد'</span>] = le_gender.transform(new_customer[<span class="string">'جنسیت'</span>])
new_city_dummies = pd.get_dummies(new_customer[<span class="string">'شهر'</span>], prefix=<span class="string">'شهر'</span>)

<span class="comment"># اضافه کردن ستون‌های گم‌شده</span>
<span class="keyword">for</span> col <span class="keyword">in</span> city_dummies.columns:
    <span class="keyword">if</span> col <span class="keyword">not</span> <span class="keyword">in</span> new_city_dummies.columns:
        new_city_dummies[col] = <span class="number">0</span>

new_customer = pd.concat([new_customer, new_city_dummies], axis=<span class="number">1</span>)
new_customer[numeric_features] = scaler.transform(new_customer[numeric_features])

X_new = new_customer[feature_columns]

lr_pred = lr_model.predict(X_new)[<span class="number">0</span>]
lr_proba = lr_model.predict_proba(X_new)[<span class="number">0</span>, <span class="number">1</span>]

<span class="function">print</span>(<span class="string">f"پیش‌بینی خرید: {'خرید می‌کند' if lr_pred == 1 else 'خرید نمی‌کند'}"</span>)
<span class="function">print</span>(<span class="string">f"احتمال خرید: {lr_proba:.3f}"</span>)
                    </div>

                    <h3>📈 رگرسیون (Regression):</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># رگرسیون - پیش‌بینی مبلغ خرید</span>
<span class="function">print</span>(<span class="string">"📈 رگرسیون - پیش‌بینی مبلغ خرید:"</span>)

<span class="comment"># فیلتر کردن فقط مشتریانی که خرید کرده‌اند</span>
buyers_mask = customers[<span class="string">'خرید'</span>] == <span class="number">1</span>
X_buyers = X[buyers_mask]
y_buyers = y_regression[buyers_mask]

<span class="function">print</span>(<span class="string">f"تعداد خریداران: {len(X_buyers)}"</span>)
<span class="function">print</span>(<span class="string">f"میانگین مبلغ خرید: {y_buyers.mean():,.0f} تومان"</span>)

<span class="comment"># تقسیم داده</span>
X_train_reg, X_test_reg, y_train_reg, y_test_reg = train_test_split(
    X_buyers, y_buyers, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span>
)

<span class="comment"># 1. رگرسیون خطی</span>
<span class="function">print</span>(<span class="string">f"\n📊 رگرسیون خطی:"</span>)
linear_model = LinearRegression()
linear_model.fit(X_train_reg, y_train_reg)

linear_predictions = linear_model.predict(X_test_reg)
linear_mse = mean_squared_error(y_test_reg, linear_predictions)
linear_rmse = np.sqrt(linear_mse)

<span class="function">print</span>(<span class="string">f"RMSE: {linear_rmse:,.0f} تومان"</span>)
<span class="function">print</span>(<span class="string">f"R²: {linear_model.score(X_test_reg, y_test_reg):.3f}"</span>)

<span class="comment"># 2. Random Forest</span>
<span class="function">print</span>(<span class="string">f"\n🌲 Random Forest:"</span>)
rf_model = RandomForestRegressor(n_estimators=<span class="number">100</span>, random_state=<span class="number">42</span>)
rf_model.fit(X_train_reg, y_train_reg)

rf_predictions = rf_model.predict(X_test_reg)
rf_mse = mean_squared_error(y_test_reg, rf_predictions)
rf_rmse = np.sqrt(rf_mse)

<span class="function">print</span>(<span class="string">f"RMSE: {rf_rmse:,.0f} تومان"</span>)
<span class="function">print</span>(<span class="string">f"R²: {rf_model.score(X_test_reg, y_test_reg):.3f}"</span>)

<span class="comment"># اهمیت ویژگی‌ها در Random Forest</span>
rf_importance = pd.DataFrame({
    <span class="string">'ویژگی'</span>: X.columns,
    <span class="string">'اهمیت'</span>: rf_model.feature_importances_
}).sort_values(<span class="string">'اهمیت'</span>, ascending=<span class="keyword">False</span>)

<span class="function">print</span>(<span class="string">f"\n📊 اهمیت ویژگی‌ها در Random Forest:\n{rf_importance.head()}"</span>)

<span class="comment"># مقایسه مدل‌های رگرسیون</span>
<span class="function">print</span>(<span class="string">f"\n🏆 مقایسه مدل‌های رگرسیون:"</span>)
regression_comparison = pd.DataFrame({
    <span class="string">'مدل'</span>: [<span class="string">'رگرسیون خطی'</span>, <span class="string">'Random Forest'</span>],
    <span class="string">'RMSE'</span>: [linear_rmse, rf_rmse],
    <span class="string">'R²'</span>: [linear_model.score(X_test_reg, y_test_reg), 
           rf_model.score(X_test_reg, y_test_reg)]
})
<span class="function">print</span>(regression_comparison.round(<span class="number">3</span>))

<span class="comment"># پیش‌بینی مبلغ برای مشتری جدید</span>
<span class="keyword">if</span> lr_pred == <span class="number">1</span>:  <span class="comment"># اگر پیش‌بینی شد که خرید می‌کند</span>
    predicted_amount = rf_model.predict(X_new)[<span class="number">0</span>]
    <span class="function">print</span>(<span class="string">f"\n💰 پیش‌بینی مبلغ خرید مشتری جدید: {predicted_amount:,.0f} تومان"</span>)
</div>

                    <h3>🎯 خوشه‌بندی (Clustering):</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># خوشه‌بندی مشتریان</span>
<span class="function">print</span>(<span class="string">"🎯 خوشه‌بندی مشتریان:"</span>)

<span class="comment"># انتخاب ویژگی‌های مناسب برای خوشه‌بندی</span>
clustering_features = [<span class="string">'سن'</span>, <span class="string">'درآمد'</span>, <span class="string">'امتیاز_اعتباری'</span>, <span class="string">'سابقه_خرید'</span>]
X_cluster = data_processed[clustering_features]

<span class="function">print</span>(<span class="string">f"ویژگی‌های خوشه‌بندی: {clustering_features}"</span>)

<span class="comment"># تعیین تعداد بهینه خوشه با روش Elbow</span>
<span class="function">print</span>(<span class="string">f"\n📊 تعیین تعداد بهینه خوشه:"</span>)
inertias = []
k_range = <span class="function">range</span>(<span class="number">1</span>, <span class="number">11</span>)

<span class="keyword">for</span> k <span class="keyword">in</span> k_range:
    kmeans = KMeans(n_clusters=k, random_state=<span class="number">42</span>, n_init=<span class="number">10</span>)
    kmeans.fit(X_cluster)
    inertias.append(kmeans.inertia_)

<span class="comment"># نمایش نتایج Elbow</span>
elbow_results = pd.DataFrame({
    <span class="string">'تعداد_خوشه'</span>: k_range,
    <span class="string">'Inertia'</span>: inertias
})
<span class="function">print</span>(elbow_results)

<span class="comment"># اجرای K-Means با تعداد بهینه خوشه</span>
optimal_k = <span class="number">4</span>  <span class="comment"># بر اساس نمودار Elbow</span>
<span class="function">print</span>(<span class="string">f"\n🎯 خوشه‌بندی با {optimal_k} خوشه:"</span>)

kmeans_final = KMeans(n_clusters=optimal_k, random_state=<span class="number">42</span>, n_init=<span class="number">10</span>)
cluster_labels = kmeans_final.fit_predict(X_cluster)

<span class="comment"># اضافه کردن برچسب خوشه به داده</span>
customers_clustered = customers.copy()
customers_clustered[<span class="string">'خوشه'</span>] = cluster_labels

<span class="comment"># تحلیل خوشه‌ها</span>
<span class="function">print</span>(<span class="string">f"توزیع خوشه‌ها:\n{pd.Series(cluster_labels).value_counts().sort_index()}"</span>)

<span class="comment"># آمار هر خوشه</span>
<span class="function">print</span>(<span class="string">f"\n📊 مشخصات هر خوشه:"</span>)
cluster_analysis = customers_clustered.groupby(<span class="string">'خوشه'</span>).agg({
    <span class="string">'سن'</span>: <span class="string">'mean'</span>,
    <span class="string">'درآمد'</span>: <span class="string">'mean'</span>,
    <span class="string">'امتیاز_اعتباری'</span>: <span class="string">'mean'</span>,
    <span class="string">'سابقه_خرید'</span>: <span class="string">'mean'</span>,
    <span class="string">'خرید'</span>: <span class="string">'mean'</span>,
    <span class="string">'مبلغ_خرید'</span>: <span class="string">'mean'</span>
}).round(<span class="number">2</span>)

cluster_analysis.columns = [<span class="string">'میانگین_سن'</span>, <span class="string">'میانگین_درآمد'</span>, <span class="string">'میانگین_امتیاز'</span>, 
                           <span class="string">'میانگین_سابقه'</span>, <span class="string">'نرخ_خرید'</span>, <span class="string">'میانگین_مبلغ'</span>]

<span class="function">print</span>(cluster_analysis)

<span class="comment"># تفسیر خوشه‌ها</span>
<span class="function">print</span>(<span class="string">f"\n🔍 تفسیر خوشه‌ها:"</span>)
cluster_names = {
    <span class="number">0</span>: <span class="string">"مشتریان جوان با درآمد پایین"</span>,
    <span class="number">1</span>: <span class="string">"مشتریان متوسط"</span>,
    <span class="number">2</span>: <span class="string">"مشتریان پرارزش"</span>,
    <span class="number">3</span>: <span class="string">"مشتریان مسن با سابقه بالا"</span>
}

<span class="keyword">for</span> cluster_id, name <span class="keyword">in</span> cluster_names.items():
    count = (cluster_labels == cluster_id).sum()
    purchase_rate = customers_clustered[customers_clustered[<span class="string">'خوشه'</span>] == cluster_id][<span class="string">'خرید'</span>].mean()
    <span class="function">print</span>(<span class="string">f"خوشه {cluster_id}: {name} ({count} نفر, نرخ خرید: {purchase_rate:.1%})"</span>)
                    </div>

                    <h3>📊 ارزیابی و تفسیر نتایج:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># ارزیابی جامع و تفسیر نتایج</span>
<span class="function">print</span>(<span class="string">"📊 گزارش نهایی تحلیل:"</span>)

<span class="comment"># خلاصه عملکرد مدل‌ها</span>
<span class="function">print</span>(<span class="string">f"\n🏆 خلاصه عملکرد مدل‌ها:"</span>)
<span class="function">print</span>(<span class="string">f"بهترین مدل طبقه‌بندی: {'رگرسیون لجستیک' if lr_accuracy > dt_accuracy else 'درخت تصمیم'}"</span>)
<span class="function">print</span>(<span class="string">f"دقت: {max(lr_accuracy, dt_accuracy):.3f}"</span>)

<span class="function">print</span>(<span class="string">f"\nبهترین مدل رگرسیون: {'رگرسیون خطی' if linear_rmse < rf_rmse else 'Random Forest'}"</span>)
<span class="function">print</span>(<span class="string">f"RMSE: {min(linear_rmse, rf_rmse):,.0f} تومان"</span>)

<span class="comment"># تحلیل ویژگی‌های مهم</span>
<span class="function">print</span>(<span class="string">f"\n🔍 مهم‌ترین ویژگی‌ها:"</span>)
top_features = feature_importance.head(<span class="number">3</span>)
<span class="keyword">for</span> idx, row <span class="keyword">in</span> top_features.iterrows():
    <span class="function">print</span>(<span class="string">f"{row['ویژگی']}: {row['اهمیت']:.3f}"</span>)

<span class="comment"># توصیه‌های کسب‌وکار</span>
<span class="function">print</span>(<span class="string">f"\n💡 توصیه‌های کسب‌وکار:"</span>)
business_insights = [
    <span class="string">f"1. خوشه {cluster_analysis['نرخ_خرید'].idxmax()} بالاترین نرخ خرید را دارد ({cluster_analysis['نرخ_خرید'].max():.1%})"</span>,
    <span class="string">f"2. میانگین مبلغ خرید: {customers[customers['خرید']==1]['مبلغ_خرید'].mean():,.0f} تومان"</span>,
    <span class="string">f"3. {feature_importance.iloc[0]['ویژگی']} مهم‌ترین عامل در تصمیم خرید است"</span>,
    <span class="string">f"4. {len(customers_clustered[customers_clustered['خوشه']==cluster_analysis['نرخ_خرید'].idxmax()])} مشتری در گروه پرارزش قرار دارند"</span>
]

<span class="keyword">for</span> insight <span class="keyword">in</span> business_insights:
    <span class="function">print</span>(insight)

<span class="comment"># آمار کلی</span>
<span class="function">print</span>(<span class="string">f"\n📈 آمار کلی:"</span>)
total_customers = len(customers)
total_buyers = customers[<span class="string">'خرید'</span>].sum()
total_revenue = customers[<span class="string">'مبلغ_خرید'</span>].sum()
avg_customer_value = total_revenue / total_customers

<span class="function">print</span>(<span class="string">f"کل مشتریان: {total_customers:,}"</span>)
<span class="function">print</span>(<span class="string">f"تعداد خریداران: {total_buyers:,} ({total_buyers/total_customers:.1%})"</span>)
<span class="function">print</span>(<span class="string">f"کل درآمد: {total_revenue:,.0f} تومان"</span>)
<span class="function">print</span>(<span class="string">f"ارزش متوسط مشتری: {avg_customer_value:,.0f} تومان"</span>)

<span class="comment"># نکات آموزشی</span>
<span class="function">print</span>(<span class="string">f"\n📚 نکات مهم یادگیری ماشین:"</span>)
ml_tips = [
    <span class="string">"1. همیشه داده‌ها را به train/test تقسیم کنید"</span>,
    <span class="string">"2. ویژگی‌های کیفی را به عددی تبدیل کنید"</span>,
    <span class="string">"3. داده‌ها را استانداردسازی کنید"</span>,
    <span class="string">"4. چندین مدل را امتحان و مقایسه کنید"</span>,
    <span class="string">"5. اهمیت ویژگی‌ها را بررسی کنید"</span>,
    <span class="string">"6. نتایج را از نظر کسب‌وکار تفسیر کنید"</span>,
    <span class="string">"7. مدل را با داده‌های جدید ارزیابی کنید"</span>
]

<span class="keyword">for</span> tip <span class="keyword">in</span> ml_tips:
    <span class="function">print</span>(tip)

<span class="function">print</span>(<span class="string">f"\n✅ تحلیل یادگیری ماشین کامل شد!"</span>)
                    </div>

                    <div class="method-grid">
                        <div class="method-card">
                            <div class="method-name">train_test_split()</div>
                            <div class="method-desc">تقسیم داده</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">StandardScaler()</div>
                            <div class="method-desc">استانداردسازی</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">LogisticRegression()</div>
                            <div class="method-desc">طبقه‌بندی</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">LinearRegression()</div>
                            <div class="method-desc">رگرسیون</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">KMeans()</div>
                            <div class="method-desc">خوشه‌بندی</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">accuracy_score()</div>
                            <div class="method-desc">ارزیابی</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">💡 نکات یادگیری ماشین:</div>
                        <ul>
                            <li><strong>Data Quality:</strong> کیفیت داده مهم‌تر از الگوریتم است</li>
                            <li><strong>Feature Engineering:</strong> ویژگی‌های مناسب انتخاب کنید</li>
                            <li><strong>Cross-validation:</strong> برای ارزیابی بهتر استفاده کنید</li>
                            <li><strong>Business Context:</strong> نتایج را در زمینه کسب‌وکار تفسیر کنید</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- اسلاید 15: پروژه عملی و جمع‌بندی -->
            <div class="slide" id="slide15">
                <div class="slide-number">15/15</div>
                <button class="expand-btn" onclick="expandSlide(this)">🔍 بزرگنمایی</button>
                <button class="close-btn" onclick="closeSlide(this)">×</button>
                <div class="icon">🎯</div>
                <div class="slide-title">پروژه عملی: تحلیل جامع فروش</div>
                <div class="slide-content">
                    <h3>🎯 پروژه جامع: سیستم تحلیل فروش:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># پروژه جامع: سیستم تحلیل فروش شرکت</span>
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt
<span class="keyword">import</span> seaborn <span class="keyword">as</span> sns
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta
<span class="keyword">import</span> warnings
warnings.filterwarnings(<span class="string">'ignore'</span>)

<span class="function">print</span>(<span class="string">"🎯 پروژه جامع: سیستم تحلیل فروش شرکت"</span>)
<span class="function">print</span>(<span class="string">"="</span> * <span class="number">50</span>)

<span class="comment"># 1. ایجاد داده‌های واقعی شرکت</span>
np.random.seed(<span class="number">42</span>)

<span class="comment"># جدول محصولات</span>
products = pd.DataFrame({
    <span class="string">'product_id'</span>: <span class="function">range</span>(<span class="number">1</span>, <span class="number">21</span>),
    <span class="string">'product_name'</span>: [<span class="string">f'محصول_{i}'</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(<span class="number">1</span>, <span class="number">21</span>)],
    <span class="string">'category'</span>: np.random.choice([<span class="string">'الکترونیک'</span>, <span class="string">'پوشاک'</span>, <span class="string">'خانه'</span>, <span class="string">'ورزش'</span>], <span class="number">20</span>),
    <span class="string">'price'</span>: np.random.randint(<span class="number">50000</span>, <span class="number">500000</span>, <span class="number">20</span>),
    <span class="string">'cost'</span>: <span class="keyword">lambda</span> x: x * <span class="number">0.6</span>  <span class="comment"># 60% قیمت فروش</span>
})
products[<span class="string">'cost'</span>] = products[<span class="string">'price'</span>] * <span class="number">0.6</span>
products[<span class="string">'profit_margin'</span>] = (products[<span class="string">'price'</span>] - products[<span class="string">'cost'</span>]) / products[<span class="string">'price'</span>]

<span class="comment"># جدول مشتریان</span>
customers = pd.DataFrame({
    <span class="string">'customer_id'</span>: <span class="function">range</span>(<span class="number">1</span>, <span class="number">101</span>),
    <span class="string">'name'</span>: [<span class="string">f'مشتری_{i}'</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(<span class="number">1</span>, <span class="number">101</span>)],
    <span class="string">'city'</span>: np.random.choice([<span class="string">'تهران'</span>, <span class="string">'اصفهان'</span>, <span class="string">'شیراز'</span>, <span class="string">'مشهد'</span>, <span class="string">'تبریز'</span>], <span class="number">100</span>),
    <span class="string">'age'</span>: np.random.randint(<span class="number">18</span>, <span class="number">70</span>, <span class="number">100</span>),
    <span class="string">'gender'</span>: np.random.choice([<span class="string">'مرد'</span>, <span class="string">'زن'</span>], <span class="number">100</span>),
    <span class="string">'registration_date'</span>: pd.date_range(<span class="string">'2023-01-01'</span>, periods=<span class="number">100</span>, freq=<span class="string">'3D'</span>)
})

<span class="comment"># جدول فروش (6 ماه داده)</span>
n_sales = <span class="number">2000</span>
sales = pd.DataFrame({
    <span class="string">'sale_id'</span>: <span class="function">range</span>(<span class="number">1</span>, n_sales + <span class="number">1</span>),
    <span class="string">'customer_id'</span>: np.random.choice(customers[<span class="string">'customer_id'</span>], n_sales),
    <span class="string">'product_id'</span>: np.random.choice(products[<span class="string">'product_id'</span>], n_sales),
    <span class="string">'quantity'</span>: np.random.randint(<span class="number">1</span>, <span class="number">5</span>, n_sales),
    <span class="string">'sale_date'</span>: pd.date_range(<span class="string">'2024-01-01'</span>, <span class="string">'2024-06-30'</span>, periods=n_sales),
    <span class="string">'discount'</span>: np.random.choice([<span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">20</span>], n_sales, p=[<span class="number">0.4</span>, <span class="number">0.25</span>, <span class="number">0.2</span>, <span class="number">0.1</span>, <span class="number">0.05</span>])
})

<span class="function">print</span>(<span class="string">f"📊 داده‌های ایجاد شده:"</span>)
<span class="function">print</span>(<span class="string">f"محصولات: {len(products)} عدد"</span>)
<span class="function">print</span>(<span class="string">f"مشتریان: {len(customers)} نفر"</span>)
<span class="function">print</span>(<span class="string">f"فروش: {len(sales)} تراکنش"</span>)
                    </div>

                    <h3>🔄 ادغام و پیش‌پردازش داده‌ها:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># 2. ادغام داده‌ها و محاسبات</span>
<span class="function">print</span>(<span class="string">f"\n🔄 ادغام و پیش‌پردازش:"</span>)

<span class="comment"># ادغام جداول</span>
sales_detailed = sales.merge(products, on=<span class="string">'product_id'</span>).merge(customers, on=<span class="string">'customer_id'</span>)

<span class="comment"># محاسبات مالی</span>
sales_detailed[<span class="string">'unit_price_after_discount'</span>] = sales_detailed[<span class="string">'price'</span>] * (
    <span class="number">1</span> - sales_detailed[<span class="string">'discount'</span>] / <span class="number">100</span>
)
sales_detailed[<span class="string">'total_revenue'</span>] = sales_detailed[<span class="string">'quantity'</span>] * sales_detailed[<span class="string">'unit_price_after_discount'</span>]
sales_detailed[<span class="string">'total_cost'</span>] = sales_detailed[<span class="string">'quantity'</span>] * sales_detailed[<span class="string">'cost'</span>]
sales_detailed[<span class="string">'total_profit'</span>] = sales_detailed[<span class="string">'total_revenue'</span>] - sales_detailed[<span class="string">'total_cost'</span>]

<span class="comment"># اضافه کردن ویژگی‌های زمانی</span>
sales_detailed[<span class="string">'year'</span>] = sales_detailed[<span class="string">'sale_date'</span>].dt.year
sales_detailed[<span class="string">'month'</span>] = sales_detailed[<span class="string">'sale_date'</span>].dt.month
sales_detailed[<span class="string">'day_of_week'</span>] = sales_detailed[<span class="string">'sale_date'</span>].dt.day_name()
sales_detailed[<span class="string">'is_weekend'</span>] = sales_detailed[<span class="string">'sale_date'</span>].dt.weekday >= <span class="number">5</span>

<span class="function">print</span>(<span class="string">f"✅ داده‌های ادغام شده: {sales_detailed.shape}"</span>)
<span class="function">print</span>(<span class="string">f"ستون‌های جدید: {list(sales_detailed.columns[-8:])}"</span>)

<span class="comment"># بررسی کیفیت داده</span>
<span class="function">print</span>(<span class="string">f"\n🔍 بررسی کیفیت داده:"</span>)
<span class="function">print</span>(<span class="string">f"مقادیر خالی:\n{sales_detailed.isnull().sum()[sales_detailed.isnull().sum() > 0]}"</span>)
<span class="function">print</span>(<span class="string">f"مقادیر تکراری: {sales_detailed.duplicated().sum()}"</span>)

<span class="comment"># نمایش نمونه داده‌های نهایی</span>
<span class="function">print</span>(<span class="string">f"\n📋 نمونه داده‌های نهایی:"</span>)
display_columns = [<span class="string">'sale_date'</span>, <span class="string">'name'</span>, <span class="string">'product_name'</span>, <span class="string">'quantity'</span>, 
                   <span class="string">'total_revenue'</span>, <span class="string">'total_profit'</span>]
<span class="function">print</span>(sales_detailed[display_columns].head())
                    </div>

                    <h3>📊 تحلیل‌های جامع:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># 3. تحلیل‌های جامع</span>
<span class="function">print</span>(<span class="string">f"\n📊 تحلیل‌های جامع:"</span>)

<span class="comment"># آمار کلی</span>
total_revenue = sales_detailed[<span class="string">'total_revenue'</span>].sum()
total_profit = sales_detailed[<span class="string">'total_profit'</span>].sum()
total_transactions = len(sales_detailed)
unique_customers = sales_detailed[<span class="string">'customer_id'</span>].nunique()
avg_order_value = total_revenue / total_transactions

<span class="function">print</span>(<span class="string">f"💰 آمار مالی:"</span>)
<span class="function">print</span>(<span class="string">f"کل درآمد: {total_revenue:,.0f} تومان"</span>)
<span class="function">print</span>(<span class="string">f"کل سود: {total_profit:,.0f} تومان"</span>)
<span class="function">print</span>(<span class="string">f"حاشیه سود: {(total_profit/total_revenue)*100:.1f}%"</span>)
<span class="function">print</span>(<span class="string">f"میانگین ارزش سفارش: {avg_order_value:,.0f} تومان"</span>)

<span class="function">print</span>(<span class="string">f"\n👥 آمار مشتریان:"</span>)
<span class="function">print</span>(<span class="string">f"کل تراکنش‌ها: {total_transactions:,}"</span>)
<span class="function">print</span>(<span class="string">f"مشتریان فعال: {unique_customers} نفر"</span>)
<span class="function">print</span>(<span class="string">f"میانگین تراکنش هر مشتری: {total_transactions/unique_customers:.1f}"</span>)

<span class="comment"># تحلیل زمانی</span>
<span class="function">print</span>(<span class="string">f"\n📅 تحلیل زمانی:"</span>)
monthly_sales = sales_detailed.groupby(<span class="string">'month'</span>).agg({
    <span class="string">'total_revenue'</span>: <span class="string">'sum'</span>,
    <span class="string">'total_profit'</span>: <span class="string">'sum'</span>,
    <span class="string">'sale_id'</span>: <span class="string">'count'</span>
}).round(<span class="number">0</span>)
monthly_sales.columns = [<span class="string">'درآمد'</span>, <span class="string">'سود'</span>, <span class="string">'تعداد_تراکنش'</span>]
monthly_sales.index = [<span class="string">'ژانویه'</span>, <span class="string">'فوریه'</span>, <span class="string">'مارس'</span>, <span class="string">'آپریل'</span>, <span class="string">'مه'</span>, <span class="string">'ژوئن'</span>]

<span class="function">print</span>(<span class="string">f"فروش ماهانه:\n{monthly_sales}"</span>)

<span class="comment"># تحلیل محصولات</span>
<span class="function">print</span>(<span class="string">f"\n📦 تحلیل محصولات:"</span>)
product_analysis = sales_detailed.groupby([<span class="string">'category'</span>, <span class="string">'product_name'</span>]).agg({
    <span class="string">'total_revenue'</span>: <span class="string">'sum'</span>,
    <span class="string">'total_profit'</span>: <span class="string">'sum'</span>,
    <span class="string">'quantity'</span>: <span class="string">'sum'</span>
}).sort_values(<span class="string">'total_revenue'</span>, ascending=<span class="keyword">False</span>)

top_products = product_analysis.head(<span class="number">5</span>)
<span class="function">print</span>(<span class="string">f"5 محصول پرفروش:\n{top_products}"</span>)

category_performance = sales_detailed.groupby(<span class="string">'category'</span>).agg({
    <span class="string">'total_revenue'</span>: <span class="string">'sum'</span>,
    <span class="string">'total_profit'</span>: <span class="string">'sum'</span>,
    <span class="string">'sale_id'</span>: <span class="string">'count'</span>
}).sort_values(<span class="string">'total_revenue'</span>, ascending=<span class="keyword">False</span>)

<span class="function">print</span>(<span class="string">f"\nعملکرد دسته‌بندی‌ها:\n{category_performance}"</span>)

<span class="comment"># تحلیل مشتریان</span>
<span class="function">print</span>(<span class="string">f"\n👤 تحلیل مشتریان:"</span>)
customer_analysis = sales_detailed.groupby(<span class="string">'customer_id'</span>).agg({
    <span class="string">'total_revenue'</span>: <span class="string">'sum'</span>,
    <span class="string">'total_profit'</span>: <span class="string">'sum'</span>,
    <span class="string">'sale_id'</span>: <span class="string">'count'</span>,
    <span class="string">'sale_date'</span>: [<span class="string">'min'</span>, <span class="string">'max'</span>]
})

customer_analysis.columns = [<span class="string">'کل_خرید'</span>, <span class="string">'کل_سود'</span>, <span class="string">'تعداد_خرید'</span>, <span class="string">'اولین_خرید'</span>, <span class="string">'آخرین_خرید'</span>]
customer_analysis[<span class="string">'متوسط_خرید'</span>] = customer_analysis[<span class="string">'کل_خرید'</span>] / customer_analysis[<span class="string">'تعداد_خرید'</span>]

top_customers = customer_analysis.sort_values(<span class="string">'کل_خرید'</span>, ascending=<span class="keyword">False</span>).head(<span class="number">5</span>)
<span class="function">print</span>(<span class="string">f"5 مشتری برتر:\n{top_customers[['کل_خرید', 'تعداد_خرید', 'متوسط_خرید']].round(0)}"</span>)

<span class="comment"># تحلیل جغرافیایی</span>
<span class="function">print</span>(<span class="string">f"\n🗺️ تحلیل جغرافیایی:"</span>)
city_analysis = sales_detailed.groupby(<span class="string">'city'</span>).agg({
    <span class="string">'total_revenue'</span>: <span class="string">'sum'</span>,
    <span class="string">'customer_id'</span>: <span class="string">'nunique'</span>,
    <span class="string">'sale_id'</span>: <span class="string">'count'</span>
}).sort_values(<span class="string">'total_revenue'</span>, ascending=<span class="keyword">False</span>)

city_analysis.columns = [<span class="string">'درآمد'</span>, <span class="string">'تعداد_مشتری'</span>, <span class="string">'تعداد_تراکنش'</span>]
city_analysis[<span class="string">'درآمد_هر_مشتری'</span>] = city_analysis[<span class="string">'درآمد'</span>] / city_analysis[<span class="string">'تعداد_مشتری'</span>]

<span class="function">print</span>(<span class="string">f"عملکرد شهرها:\n{city_analysis.round(0)}"</span>)
                    </div>

                    <h3>📈 مصورسازی و داشبورد:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># 4. مصورسازی و داشبورد</span>
<span class="function">print</span>(<span class="string">f"\n📈 ایجاد داشبورد تحلیلی:"</span>)

<span class="comment"># تنظیمات نمودار</span>
plt.style.use(<span class="string">'seaborn-v0_8'</span>)
fig = plt.figure(figsize=(<span class="number">20</span>, <span class="number">15</span>))

<span class="comment"># 1. روند فروش ماهانه</span>
plt.subplot(<span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>)
monthly_sales[<span class="string">'درآمد'</span>].plot(kind=<span class="string">'line'</span>, marker=<span class="string">'o'</span>, linewidth=<span class="number">3</span>)
plt.title(<span class="string">'روند درآمد ماهانه'</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">'bold'</span>)
plt.ylabel(<span class="string">'درآمد (تومان)'</span>)
plt.xticks(rotation=<span class="number">45</span>)
plt.grid(<span class="keyword">True</span>, alpha=<span class="number">0.3</span>)

<span class="comment"># 2. عملکرد دسته‌بندی‌ها</span>
plt.subplot(<span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>)
category_performance[<span class="string">'total_revenue'</span>].plot(kind=<span class="string">'bar'</span>, color=[<span class="string">'skyblue'</span>, <span class="string">'lightcoral'</span>, <span class="string">'lightgreen'</span>, <span class="string">'gold'</span>])
plt.title(<span class="string">'درآمد به تفکیک دسته‌بندی'</span>, fontweight=<span class="string">'bold'</span>)
plt.ylabel(<span class="string">'درآمد (تومان)'</span>)
plt.xticks(rotation=<span class="number">45</span>)

<span class="comment"># 3. توزیع مشتریان در شهرها</span>
plt.subplot(<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>)
city_analysis[<span class="string">'تعداد_مشتری'</span>].plot(kind=<span class="string">'pie'</span>, autopct=<span class="string">'%1.1f%%'</span>)
plt.title(<span class="string">'توزیع مشتریان در شهرها'</span>, fontweight=<span class="string">'bold'</span>)

<span class="comment"># 4. پراکندگی قیمت و سود</span>
plt.subplot(<span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>)
plt.scatter(sales_detailed[<span class="string">'total_revenue'</span>], sales_detailed[<span class="string">'total_profit'</span>], 
           alpha=<span class="number">0.6</span>, c=<span class="string">'purple'</span>)
plt.xlabel(<span class="string">'درآمد'</span>)
plt.ylabel(<span class="string">'سود'</span>)
plt.title(<span class="string">'رابطه درآمد و سود'</span>, fontweight=<span class="string">'bold'</span>)

<span class="comment"># 5. فروش در روزهای هفته</span>
plt.subplot(<span class="number">3</span>, <span class="number">3</span>, <span class="number">5</span>)
weekday_sales = sales_detailed.groupby(<span class="string">'day_of_week'</span>)[<span class="string">'total_revenue'</span>].sum()
weekday_order = [<span class="string">'Monday'</span>, <span class="string">'Tuesday'</span>, <span class="string">'Wednesday'</span>, <span class="string">'Thursday'</span>, <span class="string">'Friday'</span>, <span class="string">'Saturday'</span>, <span class="string">'Sunday'</span>]
weekday_sales = weekday_sales.reindex(weekday_order)
weekday_sales.plot(kind=<span class="string">'bar'</span>, color=<span class="string">'orange'</span>)
plt.title(<span class="string">'فروش در روزهای هفته'</span>, fontweight=<span class="string">'bold'</span>)
plt.xticks(rotation=<span class="number">45</span>)

<span class="comment"># 6. توزیع تخفیفات</span>
plt.subplot(<span class="number">3</span>, <span class="number">3</span>, <span class="number">6</span>)
discount_analysis = sales_detailed.groupby(<span class="string">'discount'</span>)[<span class="string">'sale_id'</span>].count()
discount_analysis.plot(kind=<span class="string">'bar'</span>, color=<span class="string">'red'</span>)
plt.title(<span class="string">'توزیع تخفیفات'</span>, fontweight=<span class="string">'bold'</span>)
plt.xlabel(<span class="string">'درصد تخفیف'</span>)
plt.ylabel(<span class="string">'تعداد فروش'</span>)

<span class="comment"># 7. هیستوگرام ارزش سفارشات</span>
plt.subplot(<span class="number">3</span>, <span class="number">3</span>, <span class="number">7</span>)
plt.hist(sales_detailed[<span class="string">'total_revenue'</span>], bins=<span class="number">30</span>, alpha=<span class="number">0.7</span>, color=<span class="string">'green'</span>)
plt.title(<span class="string">'توزیع ارزش سفارشات'</span>, fontweight=<span class="string">'bold'</span>)
plt.xlabel(<span class="string">'ارزش سفارش (تومان)'</span>)
plt.ylabel(<span class="string">'فراوانی'</span>)

<span class="comment"># 8. مقایسه جنسیت</span>
plt.subplot(<span class="number">3</span>, <span class="number">3</span>, <span class="number">8</span>)
gender_analysis = sales_detailed.groupby(<span class="string">'gender'</span>)[<span class="string">'total_revenue'</span>].sum()
gender_analysis.plot(kind=<span class="string">'bar'</span>, color=[<span class="string">'lightblue'</span>, <span class="string">'pink'</span>])
plt.title(<span class="string">'فروش به تفکیک جنسیت'</span>, fontweight=<span class="string">'bold'</span>)
plt.xticks(rotation=<span class="number">0</span>)

<span class="comment"># 9. حاشیه سود محصولات</span>
plt.subplot(<span class="number">3</span>, <span class="number">3</span>, <span class="number">9</span>)
product_margin = sales_detailed.groupby(<span class="string">'category'</span>).apply(
    <span class="keyword">lambda</span> x: (x[<span class="string">'total_profit'</span>].sum() / x[<span class="string">'total_revenue'</span>].sum()) * <span class="number">100</span>
)
product_margin.plot(kind=<span class="string">'bar'</span>, color=<span class="string">'teal'</span>)
plt.title(<span class="string">'حاشیه سود دسته‌بندی‌ها'</span>, fontweight=<span class="string">'bold'</span>)
plt.ylabel(<span class="string">'حاشیه سود (%)'</span>)
plt.xticks(rotation=<span class="number">45</span>)

plt.suptitle(<span class="string">'داشبورد تحلیل فروش شرکت'</span>, fontsize=<span class="number">20</span>, fontweight=<span class="string">'bold'</span>)
plt.tight_layout()
plt.show()

<span class="function">print</span>(<span class="string">"✅ داشبورد تحلیلی ایجاد شد"</span>)
                    </div>

                    <h3>🎯 نتیجه‌گیری و توصیه‌ها:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># 5. نتیجه‌گیری و توصیه‌های کسب‌وکار</span>
<span class="function">print</span>(<span class="string">f"\n🎯 گزارش نهایی و توصیه‌ها:"</span>)
<span class="function">print</span>(<span class="string">"="</span> * <span class="number">50</span>)

<span class="comment"># یافته‌های کلیدی</span>
<span class="function">print</span>(<span class="string">f"🔍 یافته‌های کلیدی:"</span>)

<span class="comment"># بهترین و بدترین ماه</span>
best_month = monthly_sales[<span class="string">'درآمد'</span>].idxmax()
worst_month = monthly_sales[<span class="string">'درآمد'</span>].idxmin()
<span class="function">print</span>(<span class="string">f"1. بهترین ماه فروش: {best_month} ({monthly_sales.loc[best_month, 'درآمد']:,.0f} تومان)"</span>)
<span class="function">print</span>(<span class="string">f"2. ضعیف‌ترین ماه: {worst_month} ({monthly_sales.loc[worst_month, 'درآمد']:,.0f} تومان)"</span>)

<span class="comment"># بهترین دسته‌بندی</span>
best_category = category_performance[<span class="string">'total_revenue'</span>].idxmax()
<span class="function">print</span>(<span class="string">f"3. پردرآمدترین دسته: {best_category} ({category_performance.loc[best_category, 'total_revenue']:,.0f} تومان)"</span>)

<span class="comment"># بهترین شهر</span>
best_city = city_analysis[<span class="string">'درآمد'</span>].idxmax()
<span class="function">print</span>(<span class="string">f"4. بهترین شهر: {best_city} ({city_analysis.loc[best_city, 'درآمد']:,.0f} تومان)"</span>)

<span class="comment"># تحلیل تخفیفات</span>
avg_discount = sales_detailed[<span class="string">'discount'</span>].mean()
discount_impact = sales_detailed.groupby(<span class="string">'discount'</span>)[<span class="string">'total_profit'</span>].mean()
<span class="function">print</span>(<span class="string">f"5. میانگین تخفیف: {avg_discount:.1f}%"</span>)

<span class="comment"># آمار مشتریان</span>
repeat_customers = customer_analysis[customer_
<span class="string">'تعداد_خرید'</span>] > <span class="number">1</span>].shape[<span class="number">0</span>]
customer_retention = (repeat_customers / len(customer_analysis)) * <span class="number">100</span>
<span class="function">print</span>(<span class="string">f"6. نرخ بازگشت مشتریان: {customer_retention:.1f}%"</span>)

<span class="comment"># توصیه‌های استراتژیک</span>
<span class="function">print</span>(<span class="string">f"\n💡 توصیه‌های استراتژیک:"</span>)

recommendations = [
    <span class="string">f"📈 تمرکز بر دسته {best_category} که بالاترین درآمد را دارد"</span>,
    <span class="string">f"🏙️ گسترش فعالیت در شهر {best_city} به دلیل عملکرد عالی"</span>,
    <span class="string">f"🎯 بهبود استراتژی نگهداری مشتری (فعلاً {customer_retention:.1f}%)"</span>,
    <span class="string">f"💰 بازنگری سیاست تخفیف (میانگین {avg_discount:.1f}%)"</span>,
    <span class="string">f"📊 تقویت فروش در ماه {worst_month} با کمپین‌های ویژه"</span>
]

<span class="keyword">for</span> i, rec <span class="keyword">in</span> <span class="function">enumerate</span>(recommendations, <span class="number">1</span>):
    <span class="function">print</span>(<span class="string">f"{i}. {rec}"</span>)

<span class="comment"># KPI های کلیدی</span>
<span class="function">print</span>(<span class="string">f"\n📊 KPI های کلیدی:"</span>)
kpis = {
    <span class="string">'کل درآمد'</span>: <span class="string">f"{total_revenue:,.0f} تومان"</span>,
    <span class="string">'حاشیه سود کلی'</span>: <span class="string">f"{(total_profit/total_revenue)*100:.1f}%"</span>,
    <span class="string">'متوسط ارزش سفارش'</span>: <span class="string">f"{avg_order_value:,.0f} تومان"</span>,
    <span class="string">'تعداد مشتریان فعال'</span>: <span class="string">f"{unique_customers} نفر"</span>,
    <span class="string">'متوسط خرید هر مشتری'</span>: <span class="string">f"{total_revenue/unique_customers:,.0f} تومان"</span>,
    <span class="string">'نرخ بازگشت مشتری'</span>: <span class="string">f"{customer_retention:.1f}%"</span>
}

<span class="keyword">for</span> kpi, value <span class="keyword">in</span> kpis.items():
    <span class="function">print</span>(<span class="string">f"• {kpi}: {value}"</span>)

<span class="comment"># پیش‌بینی و برنامه‌ریزی</span>
<span class="function">print</span>(<span class="string">f"\n🔮 پیش‌بینی و برنامه‌ریزی:"</span>)

<span class="comment"># محاسبه روند رشد</span>
monthly_growth = monthly_sales[<span class="string">'درآمد'</span>].pct_change().mean() * <span class="number">100</span>
projected_next_month = monthly_sales[<span class="string">'درآمد'</span>].iloc[-<span class="number">1</span>] * (<span class="number">1</span> + monthly_growth/<span class="number">100</span>)

<span class="function">print</span>(<span class="string">f"• روند رشد ماهانه: {monthly_growth:.1f}%"</span>)
<span class="function">print</span>(<span class="string">f"• پیش‌بینی درآمد ماه آینده: {projected_next_month:,.0f} تومان"</span>)

<span class="comment"># اهداف پیشنهادی</span>
<span class="function">print</span>(<span class="string">f"\n🎯 اهداف پیشنهادی برای 6 ماه آینده:"</span>)
goals = [
    <span class="string">f"افزایش درآمد به {total_revenue * 1.2:,.0f} تومان (20% رشد)"</span>,
    <span class="string">f"بهبود حاشیه سود به {(total_profit/total_revenue)*100 + 2:.1f}%"</span>,
    <span class="string">f"افزایش نرخ بازگشت مشتری به {customer_retention + 10:.1f}%"</span>,
    <span class="string">f"جذب {unique_customers * 0.5:.0f} مشتری جدید"</span>
]

<span class="keyword">for</span> i, goal <span class="keyword">in</span> <span class="function">enumerate</span>(goals, <span class="number">1</span>):
    <span class="function">print</span>(<span class="string">f"{i}. {goal}"</span>)

<span class="comment"># خلاصه پروژه</span>
<span class="function">print</span>(<span class="string">f"\n✅ خلاصه پروژه:"</span>)
project_summary = [
    <span class="string">f"📊 {len(sales_detailed)} تراکنش فروش تحلیل شد"</span>,
    <span class="string">f"👥 {unique_customers} مشتری بررسی شد"</span>,
    <span class="string">f"📦 {len(products)} محصول در {products['category'].nunique()} دسته"</span>,
    <span class="string">f"🏙️ {customers['city'].nunique()} شهر پوشش داده شد"</span>,
    <span class="string">f"📈 {len(monthly_sales)} ماه داده تحلیل شد"</span>,
    <span class="string">f"💰 {total_revenue:,.0f} تومان درآمد کل"</span>
]

<span class="keyword">for</span> item <span class="keyword">in</span> project_summary:
    <span class="function">print</span>(<span class="string">f"• {item}"</span>)

<span class="function">print</span>(<span class="string">f"\n🎉 پروژه تحلیل جامع فروش با موفقیت تکمیل شد!"</span>)
                    </div>

                    <h3>📚 جمع‌بندی دوره:</h3>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی</button>
<span class="comment"># جمع‌بندی نهایی دوره</span>
<span class="function">print</span>(<span class="string">f"\n📚 جمع‌بندی دوره مبانی علم داده با پایتون:"</span>)
<span class="function">print</span>(<span class="string">"="</span> * <span class="number">60</span>)

<span class="comment"># مروری بر مباحث آموخته شده</span>
course_topics = {
    <span class="string">'جلسه 1'</span>: <span class="string">'مقدمه پایتون و محیط توسعه'</span>,
    <span class="string">'جلسه 2'</span>: <span class="string">'انواع داده و متغیرها'</span>,
    <span class="string">'جلسه 3'</span>: <span class="string">'ساختارهای کنترل'</span>,
    <span class="string">'جلسه 4'</span>: <span class="string">'توابع و ماژول‌ها'</span>,
    <span class="string">'جلسه 5'</span>: <span class="string">'ساختارهای داده پیشرفته'</span>,
    <span class="string">'جلسه 6'</span>: <span class="string">'کار با فایل‌ها و خطاها'</span>,
    <span class="string">'جلسه 7'</span>: <span class="string">'مقدمه NumPy'</span>,
    <span class="string">'جلسه 8'</span>: <span class="string">'مقدمه Pandas'</span>,
    <span class="string">'جلسه 9'</span>: <span class="string">'تحلیل و پاک‌سازی داده'</span>,
    <span class="string">'جلسه 10'</span>: <span class="string">'تجمیع و گروه‌بندی داده'</span>,
    <span class="string">'جلسه 11'</span>: <span class="string">'مصورسازی داده با Matplotlib'</span>,
    <span class="string">'جلسه 12'</span>: <span class="string">'خواندن و نوشتن فایل‌ها'</span>,
    <span class="string">'جلسه 13'</span>: <span class="string">'اتصال به پایگاه داده'</span>,
    <span class="string">'جلسه 14'</span>: <span class="string">'مقدمه یادگیری ماشین'</span>,
    <span class="string">'جلسه 15'</span>: <span class="string">'پروژه عملی جامع'</span>
}

<span class="function">print</span>(<span class="string">f"🎯 مباحث پوشش داده شده:"</span>)
<span class="keyword">for</span> session, topic <span class="keyword">in</span> course_topics.items():
    <span class="function">print</span>(<span class="string">f"✅ {session}: {topic}"</span>)

<span class="comment"># مهارت‌های کسب شده</span>
<span class="function">print</span>(<span class="string">f"\n🚀 مهارت‌های کسب شده:"</span>)
skills = [
    <span class="string">"برنامه‌نویسی پایتون از صفر تا پیشرفته"</span>,
    <span class="string">"کار با کتابخانه‌های NumPy و Pandas"</span>,
    <span class="string">"تحلیل و پاک‌سازی داده‌های واقعی"</span>,
    <span class="string">"مصورسازی داده‌ها با Matplotlib و Seaborn"</span>,
    <span class="string">"اتصال به پایگاه‌های داده مختلف"</span>,
    <span class="string">"پیاده‌سازی الگوریتم‌های یادگیری ماشین"</span>,
    <span class="string">"ایجاد پروژه‌های تحلیل داده کامل"</span>,
    <span class="string">"تفسیر نتایج و ارائه توصیه‌های کسب‌وکار"</span>
]

<span class="keyword">for</span> i, skill <span class="keyword">in</span> <span class="function">enumerate</span>(skills, <span class="number">1</span>):
    <span class="function">print</span>(<span class="string">f"{i}. {skill}"</span>)

<span class="comment"># ابزارهای یادگیری شده</span>
<span class="function">print</span>(<span class="string">f"\n🛠️ ابزارهای تسلط یافته:"</span>)
tools = [
    <span class="string">"Python (زبان برنامه‌نویسی)"</span>,
    <span class="string">"Jupyter Notebook / Google Colab"</span>,
    <span class="string">"NumPy (محاسبات عددی)"</span>,
    <span class="string">"Pandas (تحلیل داده)"</span>,
    <span class="string">"Matplotlib (مصورسازی)"</span>,
    <span class="string">"Seaborn (مصورسازی آماری)"</span>,
    <span class="string">"Scikit-learn (یادگیری ماشین)"</span>,
    <span class="string">"SQLite/MySQL (پایگاه داده)"</span>
]

<span class="keyword">for</span> tool <span class="keyword">in</span> tools:
    <span class="function">print</span>(<span class="string">f"• {tool}"</span>)

<span class="comment"># مسیر ادامه یادگیری</span>
<span class="function">print</span>(<span class="string">f"\n🎓 مسیر ادامه یادگیری:"</span>)
next_steps = [
    <span class="string">"🤖 یادگیری عمیق (Deep Learning) با TensorFlow/PyTorch"</span>,
    <span class="string">"📊 تحلیل داده‌های بزرگ با Apache Spark"</span>,
    <span class="string">"🌐 توسعه وب با Django/Flask"</span>,
    <span class="string">"📈 تحلیل سری زمانی و پیش‌بینی"</span>,
    <span class="string">"🗺️ تحلیل داده‌های مکانی (GIS)"</span>,
    <span class="string">"☁️ علم داده در کلود (AWS/Azure/GCP)"</span>,
    <span class="string">"📱 توسعه اپلیکیشن‌های تحلیل داده"</span>
]

<span class="keyword">for</span> step <span class="keyword">in</span> next_steps:
    <span class="function">print</span>(<span class="string">f"{step}"</span>)

<span class="comment"># منابع مطالعه بیشتر</span>
<span class="function">print</span>(<span class="string">f"\n📖 منابع پیشنهادی برای مطالعه بیشتر:"</span>)
resources = [
    <span class="string">"کتاب: Python for Data Analysis - Wes McKinney"</span>,
    <span class="string">"کتاب: Hands-On Machine Learning - Aurélien Géron"</span>,
    <span class="string">"سایت: Kaggle.com (مسابقات و دیتاست)"</span>,
    <span class="string">"سایت: Towards Data Science (مقالات)"</span>,
    <span class="string">"دوره: CS229 Stanford (Machine Learning)"</span>,
    <span class="string">"کانال یوتیوب: 3Blue1Brown (ریاضیات)"</span>
]

<span class="keyword">for</span> resource <span class="keyword">in</span> resources:
    <span class="function">print</span>(<span class="string">f"• {resource}"</span>)

<span class="comment"># پیام نهایی</span>
<span class="function">print</span>(<span class="string">f"\n🎉 تبریک! شما با موفقیت دوره مبانی علم داده با پایتون را تکمیل کردید!"</span>)
<span class="function">print</span>(<span class="string">f"\n💪 اکنون آماده‌اید تا:"</span>)
final_capabilities = [
    <span class="string">"پروژه‌های واقعی علم داده انجام دهید"</span>,
    <span class="string">"در تیم‌های تحلیل داده مشارکت کنید"</span>,
    <span class="string">"مسائل کسب‌وکار را با داده حل کنید"</span>,
    <span class="string">"مهارت‌های خود را در پروژه‌های شخصی توسعه دهید"</span>
]

<span class="keyword">for</span> capability <span class="keyword">in</span> final_capabilities:
    <span class="function">print</span>(<span class="string">f"✨ {capability}"</span>)

<span class="function">print</span>(<span class="string">f"\n🚀 موفق باشید در مسیر علم داده!"</span>)
<span class="function">print</span>(<span class="string">"="</span> * <span class="number">60</span>)
                    </div>

                    <div class="method-grid">
                        <div class="method-card">
                            <div class="method-name">DataFrame.merge()</div>
                            <div class="method-desc">ادغام جداول</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">groupby().agg()</div>
                            <div class="method-desc">تجمیع پیشرفته</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">plt.subplot()</div>
                            <div class="method-desc">چندین نمودار</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.pct_change()</div>
                            <div class="method-desc">محاسبه رشد</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">.apply(lambda)</div>
                            <div class="method-desc">اعمال تابع</div>
                        </div>
                        <div class="method-card">
                            <div class="method-name">Business Analysis</div>
                            <div class="method-desc">تحلیل کسب‌وکار</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">🎯 نکات پروژه‌های واقعی:</div>
                        <ul>
                            <li><strong>Business Understanding:</strong> همیشه از درک مسئله کسب‌وکار شروع کنید</li>
                            <li><strong>Data Quality:</strong> کیفیت داده را بررسی و تضمین کنید</li>
                            <li><strong>Visualization:</strong> نتایج را به صورت قابل فهم ارائه دهید</li>
                            <li><strong>Actionable Insights:</strong> توصیه‌های عملی و قابل اجرا ارائه دهید</li>
                        </ul>
                    </div>

                    <div class="final-message">
                        <h2>🎓 تبریک! دوره با موفقیت تکمیل شد</h2>
                        <p>شما اکنون مهارت‌های لازم برای شروع کار در حوزه علم داده را دارید. با تمرین مداوم و کار روی پروژه‌های واقعی، می‌توانید به یک متخصص علم داده تبدیل شوید.</p>
                        <div class="success-badge">✅ گواهی تکمیل دوره</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- کنترل‌های ناوبری -->
        <div class="navigation">
            <button id="prevBtn" onclick="changeSlide(-1)">❮ قبلی</button>
            <span id="slideInfo">1 / 15</span>
            <button id="nextBtn" onclick="changeSlide(1)">بعدی ❯</button>
        </div>

        <!-- فهرست اسلایدها -->
        <div class="slide-list">
            <h3>📋 فهرست جلسات:</h3>
            <div class="slide-links">
                <a href="#" onclick="goToSlide(1)">1. مقدمه و نصب</a>
                <a href="#" onclick="goToSlide(2)">2. متغیرها و انواع داده</a>
                <a href="#" onclick="goToSlide(3)">3. ساختارهای کنترل</a>
                <a href="#" onclick="goToSlide(4)">4. توابع و ماژول‌ها</a>
                <a href="#" onclick="goToSlide(5)">5. ساختارهای داده</a>
                <a href="#" onclick="goToSlide(6)">6. کار با فایل‌ها</a>
                <a href="#" onclick="goToSlide(7)">7. مقدمه NumPy</a>
                <a href="#" onclick="goToSlide(8)">8. مقدمه Pandas</a>
                <a href="#" onclick="goToSlide(9)">9. تحلیل داده</a>
                <a href="#" onclick="goToSlide(10)">10. تجمیع و گروه‌بندی</a>
                <a href="#" onclick="goToSlide(11)">11. مصورسازی</a>
                <a href="#" onclick="goToSlide(12)">12. خواندن فایل‌ها</a>
                <a href="#" onclick="goToSlide(13)">13. پایگاه داده</a>
                <a href="#" onclick="goToSlide(14)">14. یادگیری ماشین</a>
                <a href="#" onclick="goToSlide(15)">15. پروژه نهایی</a>
            </div>
        </div>
    </div>

    <script>
        let currentSlide = 1;
        const totalSlides = 15;

        function showSlide(n) {
            const slides = document.querySelectorAll('.slide');
            
            if (n > totalSlides) currentSlide = 1;
            if (n < 1) currentSlide = totalSlides;
            
            slides.forEach(slide => slide.style.display = 'none');
            document.getElementById(`slide${currentSlide}`).style.display = 'block';
            
            document.getElementById('slideInfo').textContent = `${currentSlide} / ${totalSlides}`;
            
            // به‌روزرسانی دکمه‌های ناوبری
            document.getElementById('prevBtn').style.opacity = currentSlide === 1 ? '0.5' : '1';
            document.getElementById('nextBtn').style.opacity = currentSlide === totalSlides ? '0.5' : '1';
        }

        function changeSlide(n) {
            currentSlide += n;
            showSlide(currentSlide);
        }

        function goToSlide(n) {
            currentSlide = n;
            showSlide(currentSlide);
        }

        function expandSlide(btn) {
            const slide = btn.closest('.slide');
            slide.classList.add('expanded');
        }

        function closeSlide(btn) {
            const slide = btn.closest('.slide');
            slide.classList.remove('expanded');
        }

        function copyCode(btn) {
            const codeBlock = btn.nextElementSibling;
            const text = codeBlock.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                btn.textContent = '✅ کپی شد';
                setTimeout(() => {
                    btn.textContent = 'کپی';
                }, 2000);
            });
        }

        // کلیدهای میانبر
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') changeSlide(-1);
            if (e.key === 'ArrowRight') changeSlide(1);
            if (e.key === 'Escape') {
                document.querySelectorAll('.slide.expanded').forEach(slide => {
                    slide.classList.remove('expanded');
                });
            }
        });

        // نمایش اولین اسلاید
        showSlide(1);

        // اضافه کردن انیمیشن به اسلایدها
        function addSlideAnimation() {
            const currentSlideElement = document.getElementById(`slide${currentSlide}`);
            currentSlideElement.style.animation = 'slideIn 0.5s ease-in-out';
            
            setTimeout(() => {
                currentSlideElement.style.animation = '';
            }, 500);
        }

        // به‌روزرسانی تابع showSlide
        const originalShowSlide = showSlide;
        showSlide = function(n) {
            originalShowSlide(n);
            addSlideAnimation();
        };
    </script>
</body>
</html>